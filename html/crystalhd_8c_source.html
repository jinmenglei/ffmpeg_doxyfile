<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: E:/github/ffmpeg/libavcodec/crystalhd.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_737c44b861ba7ee498141742fb455fa8.html">ffmpeg</a></li><li class="navelem"><a class="el" href="dir_56ad1dd09ca1ce410b5ba2c46dd71e4b.html">libavcodec</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">crystalhd.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="crystalhd_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * - CrystalHD decoder module -</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * Copyright(C) 2010,2011 Philip Langdale &lt;ffmpeg.philipl@overt.org&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * This file is part of FFmpeg.</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * FFmpeg is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * FFmpeg is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * License along with FFmpeg; if not, write to the Free Software</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> * - Principles of Operation -</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> * The CrystalHD decoder operates at the bitstream level - which is an even</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> * higher level than the decoding hardware you typically see in modern GPUs.</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> * This means it has a very simple interface, in principle. You feed demuxed</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> * packets in one end and get decoded picture (fields/frames) out the other.</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"> * Of course, nothing is ever that simple. Due, at the very least, to b-frame</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"> * dependencies in the supported formats, the hardware has a delay between</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"> * when a packet goes in, and when a picture comes out. Furthermore, this delay</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"> * is not just a function of time, but also one of the dependency on additional</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"> * frames being fed into the decoder to satisfy the b-frame dependencies.</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"> * As such, the hardware can only be used effectively with a decode API that</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"> * doesn&#39;t assume a 1:1 relationship between input packets and output frames.</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"> * The new avcodec decode API is such an API (an m:n API) while the old one is</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment"> * 1:1. Consequently, we no longer support the old API, which allows us to avoid</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"> * the vicious hacks that are required to approximate 1:1 operation.</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">/*****************************************************************************</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"> * Includes</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment"> ****************************************************************************/</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="crystalhd_8c.html#a78c99ffd76a7bb3c8c74db76207e9ab4">   48</a></span>&#160;<span class="preprocessor">#define _XOPEN_SOURCE 600</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &lt;inttypes.h&gt;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &lt;libcrystalhd/bc_dts_types.h&gt;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &lt;libcrystalhd/bc_dts_defs.h&gt;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &lt;libcrystalhd/libcrystalhd_if.h&gt;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="avcodec_8h.html">avcodec.h</a>&quot;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="decode_8h.html">decode.h</a>&quot;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="libavutil_2internal_8h.html">internal.h</a>&quot;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="imgutils_8h.html">libavutil/imgutils.h</a>&quot;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="intreadwrite_8h.html">libavutil/intreadwrite.h</a>&quot;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="opt_8h.html">libavutil/opt.h</a>&quot;</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#if HAVE_UNISTD_H</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#include &lt;unistd.h&gt;</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="crystalhd_8c.html#adb8242fb3a594ce608a984b81c5f67b9">   69</a></span>&#160;<span class="preprocessor">#define OUTPUT_PROC_TIMEOUT 50</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="crystalhd_8c.html#ad58908e9a076f611df638d0cbc3b8b64">   71</a></span>&#160;<span class="preprocessor">#define TIMESTAMP_UNIT 100000</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">/*****************************************************************************</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment"> * Module private data</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment"> ****************************************************************************/</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="crystalhd_8c.html#a1851d3e21348a8826d7241fae4946cf1">   78</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">enum</span> {</div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="crystalhd_8c.html#a1851d3e21348a8826d7241fae4946cf1ae8ed27c1aabd77d519426a8ad340d76c">   79</a></span>&#160;    <a class="code" href="crystalhd_8c.html#a1851d3e21348a8826d7241fae4946cf1ae8ed27c1aabd77d519426a8ad340d76c">RET_ERROR</a>           = -1,</div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="crystalhd_8c.html#a1851d3e21348a8826d7241fae4946cf1a4894234446e2d92068943b3d6d3a0bdc">   80</a></span>&#160;    <a class="code" href="crystalhd_8c.html#a1851d3e21348a8826d7241fae4946cf1a4894234446e2d92068943b3d6d3a0bdc">RET_OK</a>              = 0,</div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="crystalhd_8c.html#a1851d3e21348a8826d7241fae4946cf1a5b3f9fd990577d6129995fcbceb62265">   81</a></span>&#160;    <a class="code" href="crystalhd_8c.html#a1851d3e21348a8826d7241fae4946cf1a5b3f9fd990577d6129995fcbceb62265">RET_COPY_AGAIN</a>      = 1,</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;} <a class="code" href="crystalhd_8c.html#a1851d3e21348a8826d7241fae4946cf1">CopyRet</a>;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="struct_opaque_list.html">   84</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct_opaque_list.html">OpaqueList</a> {</div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="struct_opaque_list.html#ac1fe4c65aaeb8155cd46205594cac678">   85</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="struct_opaque_list.html">OpaqueList</a> *<a class="code" href="struct_opaque_list.html#ac1fe4c65aaeb8155cd46205594cac678">next</a>;</div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="struct_opaque_list.html#a699c7b5e0af17ac414381a220e8d0b1f">   86</a></span>&#160;    uint64_t <a class="code" href="struct_opaque_list.html#a699c7b5e0af17ac414381a220e8d0b1f">fake_timestamp</a>;</div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="struct_opaque_list.html#a3a63011fcb4c1f450e0686a71feded5a">   87</a></span>&#160;    uint64_t <a class="code" href="struct_opaque_list.html#a3a63011fcb4c1f450e0686a71feded5a">reordered_opaque</a>;</div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="crystalhd_8c.html#a1f206fc8daebabfdc387acd398aa2445">   88</a></span>&#160;} <a class="code" href="crystalhd_8c.html#a1f206fc8daebabfdc387acd398aa2445">OpaqueList</a>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="struct_c_h_d_context.html">   90</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="struct_c_h_d_context.html#a6b96309837c07d874c3ea95786077990">   91</a></span>&#160;    <a class="code" href="struct_a_v_class.html">AVClass</a> *<a class="code" href="struct_c_h_d_context.html#a6b96309837c07d874c3ea95786077990">av_class</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="struct_c_h_d_context.html#a6dd16b6d003847a00597ea361ad261a7">   92</a></span>&#160;    <a class="code" href="struct_a_v_codec_context.html">AVCodecContext</a> *<a class="code" href="struct_c_h_d_context.html#a6dd16b6d003847a00597ea361ad261a7">avctx</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="struct_c_h_d_context.html#a92deb863439db0a19b2c1c223a94792d">   93</a></span>&#160;    HANDLE <a class="code" href="struct_c_h_d_context.html#a92deb863439db0a19b2c1c223a94792d">dev</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="struct_c_h_d_context.html#a16c1813cd9cbd8dd5811057506305650">   95</a></span>&#160;    <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> <a class="code" href="struct_c_h_d_context.html#a16c1813cd9cbd8dd5811057506305650">is_70012</a>;</div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="struct_c_h_d_context.html#aab52285abc2f1d82c453598cc53d9866">   96</a></span>&#160;    <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> <a class="code" href="struct_c_h_d_context.html#aab52285abc2f1d82c453598cc53d9866">need_second_field</a>;</div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="struct_c_h_d_context.html#a715e32610f8597046a731a1bd0ae3748">   97</a></span>&#160;    <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> <a class="code" href="struct_c_h_d_context.html#a715e32610f8597046a731a1bd0ae3748">draining</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="struct_c_h_d_context.html#a51e69223662ba0a15dfc131008e91d56">   99</a></span>&#160;    <a class="code" href="struct_opaque_list.html">OpaqueList</a> *<a class="code" href="struct_c_h_d_context.html#a51e69223662ba0a15dfc131008e91d56">head</a>;</div>
<div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="struct_c_h_d_context.html#a2f3102807f9443db0af849d9272f1e1e">  100</a></span>&#160;    <a class="code" href="struct_opaque_list.html">OpaqueList</a> *<a class="code" href="struct_c_h_d_context.html#a2f3102807f9443db0af849d9272f1e1e">tail</a>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">/* Options */</span></div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="struct_c_h_d_context.html#a8e1fca061985805d3cc8e1f0c3daf8d6">  103</a></span>&#160;    uint32_t <a class="code" href="struct_c_h_d_context.html#a8e1fca061985805d3cc8e1f0c3daf8d6">sWidth</a>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;} <a class="code" href="struct_c_h_d_context.html">CHDContext</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="crystalhd_8c.html#a384ff94b5139f441c282c9b4c7b985e6">  106</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="struct_a_v_option.html">AVOption</a> <a class="code" href="crystalhd_8c.html#a384ff94b5139f441c282c9b4c7b985e6">options</a>[] = {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    { <span class="stringliteral">&quot;crystalhd_downscale_width&quot;</span>,</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <span class="stringliteral">&quot;Turn on downscaling to the specified width&quot;</span>,</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      offsetof(<a class="code" href="struct_c_h_d_context.html">CHDContext</a>, sWidth),</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <a class="code" href="group__avoptions.html#ggabd75aa30eb8ad6387672df9a1fa79444ac068b8f6afeeb293a13aeabb5d702411">AV_OPT_TYPE_INT</a>, {.i64 = 0}, 0, UINT32_MAX,</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <a class="code" href="opt_8h.html#aaf3d0af9d7eca757034486a8eb896246">AV_OPT_FLAG_VIDEO_PARAM</a> | <a class="code" href="opt_8h.html#aad820197915e73441f76f5e0c384d78a">AV_OPT_FLAG_DECODING_PARAM</a>, },</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    { <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, },</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;};</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">/*****************************************************************************</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment"> * Helper functions</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment"> ****************************************************************************/</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="crystalhd_8c.html#a89b6bc0eb06a3841eb2d02a765816a50">  120</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> BC_MEDIA_SUBTYPE <a class="code" href="crystalhd_8c.html#a89b6bc0eb06a3841eb2d02a765816a50">id2subtype</a>(<a class="code" href="struct_c_h_d_context.html">CHDContext</a> *priv, <span class="keyword">enum</span> <a class="code" href="group__lavc__core.html#gaadca229ad2c20e060a14fec08a5cc7ce">AVCodecID</a> <span class="keywordtype">id</span>)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;{</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">switch</span> (<span class="keywordtype">id</span>) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__lavc__core.html#ggaadca229ad2c20e060a14fec08a5cc7cead95dfdf68b462db508b45fb693a4c09e">AV_CODEC_ID_MPEG4</a>:</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keywordflow">return</span> BC_MSUBTYPE_DIVX;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__lavc__core.html#ggaadca229ad2c20e060a14fec08a5cc7ceaf2c51d3f6f70b731f3b316d352e0fc62">AV_CODEC_ID_MSMPEG4V3</a>:</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keywordflow">return</span> BC_MSUBTYPE_DIVX311;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__lavc__core.html#ggaadca229ad2c20e060a14fec08a5cc7ceaf614abb36f7c5d0c42ed522c1d6c99f0">AV_CODEC_ID_MPEG2VIDEO</a>:</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordflow">return</span> BC_MSUBTYPE_MPEG2VIDEO;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__lavc__core.html#ggaadca229ad2c20e060a14fec08a5cc7cea7765c5c02c05ea1a96ef1ca35dad068f">AV_CODEC_ID_VC1</a>:</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keywordflow">return</span> BC_MSUBTYPE_VC1;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__lavc__core.html#ggaadca229ad2c20e060a14fec08a5cc7ceadb3fab61116754cc08f3168dd26ff776">AV_CODEC_ID_WMV3</a>:</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keywordflow">return</span> BC_MSUBTYPE_WMV3;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__lavc__core.html#ggaadca229ad2c20e060a14fec08a5cc7cea3d4c051c8b18a3c18750676a308c10be">AV_CODEC_ID_H264</a>:</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordflow">return</span> BC_MSUBTYPE_H264;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordflow">return</span> BC_MSUBTYPE_INVALID;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;}</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="crystalhd_8c.html#a32b6d11d289bd0fc06bff12ff00a704f">  140</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="crystalhd_8c.html#a32b6d11d289bd0fc06bff12ff00a704f">print_frame_info</a>(<a class="code" href="struct_c_h_d_context.html">CHDContext</a> *priv, BC_DTS_PROC_OUT *<a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>)</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;{</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a6dd16b6d003847a00597ea361ad261a7">avctx</a>, <a class="code" href="group__lavu__log__constants.html#ga030300ea4843c53b2fe178a434964b39">AV_LOG_TRACE</a>, <span class="stringliteral">&quot;\tYBuffSz: %u\n&quot;</span>, <a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>-&gt;YbuffSz);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a6dd16b6d003847a00597ea361ad261a7">avctx</a>, <a class="code" href="group__lavu__log__constants.html#ga030300ea4843c53b2fe178a434964b39">AV_LOG_TRACE</a>, <span class="stringliteral">&quot;\tYBuffDoneSz: %u\n&quot;</span>,</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;           <a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>-&gt;YBuffDoneSz);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a6dd16b6d003847a00597ea361ad261a7">avctx</a>, <a class="code" href="group__lavu__log__constants.html#ga030300ea4843c53b2fe178a434964b39">AV_LOG_TRACE</a>, <span class="stringliteral">&quot;\tUVBuffDoneSz: %u\n&quot;</span>,</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;           <a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>-&gt;UVBuffDoneSz);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a6dd16b6d003847a00597ea361ad261a7">avctx</a>, <a class="code" href="group__lavu__log__constants.html#ga030300ea4843c53b2fe178a434964b39">AV_LOG_TRACE</a>, <span class="stringliteral">&quot;\tTimestamp: %&quot;</span>PRIu64<span class="stringliteral">&quot;\n&quot;</span>,</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;           <a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>-&gt;PicInfo.timeStamp);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a6dd16b6d003847a00597ea361ad261a7">avctx</a>, <a class="code" href="group__lavu__log__constants.html#ga030300ea4843c53b2fe178a434964b39">AV_LOG_TRACE</a>, <span class="stringliteral">&quot;\tPicture Number: %u\n&quot;</span>,</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;           <a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>-&gt;PicInfo.picture_number);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a6dd16b6d003847a00597ea361ad261a7">avctx</a>, <a class="code" href="group__lavu__log__constants.html#ga030300ea4843c53b2fe178a434964b39">AV_LOG_TRACE</a>, <span class="stringliteral">&quot;\tWidth: %u\n&quot;</span>,</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;           <a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>-&gt;PicInfo.width);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a6dd16b6d003847a00597ea361ad261a7">avctx</a>, <a class="code" href="group__lavu__log__constants.html#ga030300ea4843c53b2fe178a434964b39">AV_LOG_TRACE</a>, <span class="stringliteral">&quot;\tHeight: %u\n&quot;</span>,</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;           <a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>-&gt;PicInfo.height);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a6dd16b6d003847a00597ea361ad261a7">avctx</a>, <a class="code" href="group__lavu__log__constants.html#ga030300ea4843c53b2fe178a434964b39">AV_LOG_TRACE</a>, <span class="stringliteral">&quot;\tChroma: 0x%03x\n&quot;</span>,</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;           <a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>-&gt;PicInfo.chroma_format);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a6dd16b6d003847a00597ea361ad261a7">avctx</a>, <a class="code" href="group__lavu__log__constants.html#ga030300ea4843c53b2fe178a434964b39">AV_LOG_TRACE</a>, <span class="stringliteral">&quot;\tPulldown: %u\n&quot;</span>,</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;           <a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>-&gt;PicInfo.pulldown);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a6dd16b6d003847a00597ea361ad261a7">avctx</a>, <a class="code" href="group__lavu__log__constants.html#ga030300ea4843c53b2fe178a434964b39">AV_LOG_TRACE</a>, <span class="stringliteral">&quot;\tFlags: 0x%08x\n&quot;</span>,</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;           <a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>-&gt;PicInfo.flags);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a6dd16b6d003847a00597ea361ad261a7">avctx</a>, <a class="code" href="group__lavu__log__constants.html#ga030300ea4843c53b2fe178a434964b39">AV_LOG_TRACE</a>, <span class="stringliteral">&quot;\tFrame Rate/Res: %u\n&quot;</span>,</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;           <a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>-&gt;PicInfo.frame_rate);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a6dd16b6d003847a00597ea361ad261a7">avctx</a>, <a class="code" href="group__lavu__log__constants.html#ga030300ea4843c53b2fe178a434964b39">AV_LOG_TRACE</a>, <span class="stringliteral">&quot;\tAspect Ratio: %u\n&quot;</span>,</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;           <a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>-&gt;PicInfo.aspect_ratio);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a6dd16b6d003847a00597ea361ad261a7">avctx</a>, <a class="code" href="group__lavu__log__constants.html#ga030300ea4843c53b2fe178a434964b39">AV_LOG_TRACE</a>, <span class="stringliteral">&quot;\tColor Primaries: %u\n&quot;</span>,</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;           <a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>-&gt;PicInfo.colour_primaries);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a6dd16b6d003847a00597ea361ad261a7">avctx</a>, <a class="code" href="group__lavu__log__constants.html#ga030300ea4843c53b2fe178a434964b39">AV_LOG_TRACE</a>, <span class="stringliteral">&quot;\tMetaData: %u\n&quot;</span>,</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;           <a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>-&gt;PicInfo.picture_meta_payload);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a6dd16b6d003847a00597ea361ad261a7">avctx</a>, <a class="code" href="group__lavu__log__constants.html#ga030300ea4843c53b2fe178a434964b39">AV_LOG_TRACE</a>, <span class="stringliteral">&quot;\tSession Number: %u\n&quot;</span>,</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;           <a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>-&gt;PicInfo.sess_num);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a6dd16b6d003847a00597ea361ad261a7">avctx</a>, <a class="code" href="group__lavu__log__constants.html#ga030300ea4843c53b2fe178a434964b39">AV_LOG_TRACE</a>, <span class="stringliteral">&quot;\tycom: %u\n&quot;</span>,</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;           <a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>-&gt;PicInfo.ycom);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a6dd16b6d003847a00597ea361ad261a7">avctx</a>, <a class="code" href="group__lavu__log__constants.html#ga030300ea4843c53b2fe178a434964b39">AV_LOG_TRACE</a>, <span class="stringliteral">&quot;\tCustom Aspect: %u\n&quot;</span>,</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;           <a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>-&gt;PicInfo.custom_aspect_ratio_width_height);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a6dd16b6d003847a00597ea361ad261a7">avctx</a>, <a class="code" href="group__lavu__log__constants.html#ga030300ea4843c53b2fe178a434964b39">AV_LOG_TRACE</a>, <span class="stringliteral">&quot;\tFrames to Drop: %u\n&quot;</span>,</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;           <a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>-&gt;PicInfo.n_drop);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a6dd16b6d003847a00597ea361ad261a7">avctx</a>, <a class="code" href="group__lavu__log__constants.html#ga030300ea4843c53b2fe178a434964b39">AV_LOG_TRACE</a>, <span class="stringliteral">&quot;\tH264 Valid Fields: 0x%08x\n&quot;</span>,</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;           <a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>-&gt;PicInfo.other.h264.valid);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;}</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">/*****************************************************************************</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment"> * OpaqueList functions</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment"> ****************************************************************************/</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno"><a class="line" href="crystalhd_8c.html#a990eb3fd769da9bba40bfec66aedd156">  186</a></span>&#160;<span class="keyword">static</span> uint64_t <a class="code" href="crystalhd_8c.html#a990eb3fd769da9bba40bfec66aedd156">opaque_list_push</a>(<a class="code" href="struct_c_h_d_context.html">CHDContext</a> *priv, uint64_t reordered_opaque)</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;{</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <a class="code" href="struct_opaque_list.html">OpaqueList</a> *newNode = <a class="code" href="group__lavu__mem__funcs.html#gaf143ecab33a3868b57345466c39de7c1">av_mallocz</a>(<span class="keyword">sizeof</span> (<a class="code" href="struct_opaque_list.html">OpaqueList</a>));</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordflow">if</span> (!newNode) {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a6dd16b6d003847a00597ea361ad261a7">avctx</a>, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>,</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;               <span class="stringliteral">&quot;Unable to allocate new node in OpaqueList.\n&quot;</span>);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">if</span> (!priv-&gt;<a class="code" href="struct_c_h_d_context.html#a51e69223662ba0a15dfc131008e91d56">head</a>) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        newNode-&gt;<a class="code" href="struct_opaque_list.html#a699c7b5e0af17ac414381a220e8d0b1f">fake_timestamp</a> = <a class="code" href="crystalhd_8c.html#ad58908e9a076f611df638d0cbc3b8b64">TIMESTAMP_UNIT</a>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        priv-&gt;<a class="code" href="struct_c_h_d_context.html#a51e69223662ba0a15dfc131008e91d56">head</a>              = newNode;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        newNode-&gt;<a class="code" href="struct_opaque_list.html#a699c7b5e0af17ac414381a220e8d0b1f">fake_timestamp</a> = priv-&gt;<a class="code" href="struct_c_h_d_context.html#a2f3102807f9443db0af849d9272f1e1e">tail</a>-&gt;<a class="code" href="struct_opaque_list.html#a699c7b5e0af17ac414381a220e8d0b1f">fake_timestamp</a> + <a class="code" href="crystalhd_8c.html#ad58908e9a076f611df638d0cbc3b8b64">TIMESTAMP_UNIT</a>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        priv-&gt;<a class="code" href="struct_c_h_d_context.html#a2f3102807f9443db0af849d9272f1e1e">tail</a>-&gt;<a class="code" href="struct_opaque_list.html#ac1fe4c65aaeb8155cd46205594cac678">next</a>        = newNode;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    priv-&gt;<a class="code" href="struct_c_h_d_context.html#a2f3102807f9443db0af849d9272f1e1e">tail</a> = newNode;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    newNode-&gt;<a class="code" href="struct_opaque_list.html#a3a63011fcb4c1f450e0686a71feded5a">reordered_opaque</a> = reordered_opaque;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">return</span> newNode-&gt;<a class="code" href="struct_opaque_list.html#a699c7b5e0af17ac414381a220e8d0b1f">fake_timestamp</a>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;}</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment"> * The OpaqueList is built in decode order, while elements will be removed</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment"> * in presentation order. If frames are reordered, this means we must be</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment"> * able to remove elements that are not the first element.</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment"> * Returned node must be freed by caller.</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="crystalhd_8c.html#af731d0707ed09ccb41d9f19ab2a05401">  214</a></span>&#160;<span class="keyword">static</span> <a class="code" href="struct_opaque_list.html">OpaqueList</a> *<a class="code" href="crystalhd_8c.html#af731d0707ed09ccb41d9f19ab2a05401">opaque_list_pop</a>(<a class="code" href="struct_c_h_d_context.html">CHDContext</a> *priv, uint64_t fake_timestamp)</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;{</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="struct_opaque_list.html">OpaqueList</a> *node = priv-&gt;<a class="code" href="struct_c_h_d_context.html#a51e69223662ba0a15dfc131008e91d56">head</a>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">if</span> (!priv-&gt;<a class="code" href="struct_c_h_d_context.html#a51e69223662ba0a15dfc131008e91d56">head</a>) {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a6dd16b6d003847a00597ea361ad261a7">avctx</a>, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>,</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;               <span class="stringliteral">&quot;CrystalHD: Attempted to query non-existent timestamps.\n&quot;</span>);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">     * The first element is special-cased because we have to manipulate</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">     * the head pointer rather than the previous element in the list.</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">if</span> (priv-&gt;<a class="code" href="struct_c_h_d_context.html#a51e69223662ba0a15dfc131008e91d56">head</a>-&gt;<a class="code" href="struct_opaque_list.html#a699c7b5e0af17ac414381a220e8d0b1f">fake_timestamp</a> == fake_timestamp) {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        priv-&gt;<a class="code" href="struct_c_h_d_context.html#a51e69223662ba0a15dfc131008e91d56">head</a> = node-&gt;<a class="code" href="struct_opaque_list.html#ac1fe4c65aaeb8155cd46205594cac678">next</a>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordflow">if</span> (!priv-&gt;<a class="code" href="struct_c_h_d_context.html#a51e69223662ba0a15dfc131008e91d56">head</a>-&gt;<a class="code" href="struct_opaque_list.html#ac1fe4c65aaeb8155cd46205594cac678">next</a>)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            priv-&gt;<a class="code" href="struct_c_h_d_context.html#a2f3102807f9443db0af849d9272f1e1e">tail</a> = priv-&gt;<a class="code" href="struct_c_h_d_context.html#a51e69223662ba0a15dfc131008e91d56">head</a>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        node-&gt;<a class="code" href="struct_opaque_list.html#ac1fe4c65aaeb8155cd46205594cac678">next</a> = <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keywordflow">return</span> node;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">     * The list is processed at arm&#39;s length so that we have the</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">     * previous element available to rewrite its next pointer.</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">while</span> (node-&gt;<a class="code" href="struct_opaque_list.html#ac1fe4c65aaeb8155cd46205594cac678">next</a>) {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <a class="code" href="struct_opaque_list.html">OpaqueList</a> *current = node-&gt;<a class="code" href="struct_opaque_list.html#ac1fe4c65aaeb8155cd46205594cac678">next</a>;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keywordflow">if</span> (current-&gt;<a class="code" href="struct_opaque_list.html#a699c7b5e0af17ac414381a220e8d0b1f">fake_timestamp</a> == fake_timestamp) {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            node-&gt;<a class="code" href="struct_opaque_list.html#ac1fe4c65aaeb8155cd46205594cac678">next</a> = current-&gt;<a class="code" href="struct_opaque_list.html#ac1fe4c65aaeb8155cd46205594cac678">next</a>;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <span class="keywordflow">if</span> (!node-&gt;<a class="code" href="struct_opaque_list.html#ac1fe4c65aaeb8155cd46205594cac678">next</a>)</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;               priv-&gt;<a class="code" href="struct_c_h_d_context.html#a2f3102807f9443db0af849d9272f1e1e">tail</a> = node;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            current-&gt;<a class="code" href="struct_opaque_list.html#ac1fe4c65aaeb8155cd46205594cac678">next</a> = <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            <span class="keywordflow">return</span> current;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            node = current;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a6dd16b6d003847a00597ea361ad261a7">avctx</a>, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>,</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;           <span class="stringliteral">&quot;CrystalHD: Couldn&#39;t match fake_timestamp.\n&quot;</span>);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;}</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">/*****************************************************************************</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"> * Video decoder API function definitions</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment"> ****************************************************************************/</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno"><a class="line" href="crystalhd_8c.html#affa0ccbe2ef7fd24bb8c61e28d1a6631">  267</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="crystalhd_8c.html#affa0ccbe2ef7fd24bb8c61e28d1a6631">flush</a>(<a class="code" href="struct_a_v_codec_context.html">AVCodecContext</a> *avctx)</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;{</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <a class="code" href="struct_c_h_d_context.html">CHDContext</a> *priv = avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#af3379123060ad8cc9c321c29af4f8360">priv_data</a>;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    priv-&gt;<a class="code" href="struct_c_h_d_context.html#aab52285abc2f1d82c453598cc53d9866">need_second_field</a> = 0;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    priv-&gt;<a class="code" href="struct_c_h_d_context.html#a715e32610f8597046a731a1bd0ae3748">draining</a>          = 0;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="comment">/* Flush mode 4 flushes all software and hardware buffers. */</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    DtsFlushInput(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a92deb863439db0a19b2c1c223a94792d">dev</a>, 4);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;}</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno"><a class="line" href="crystalhd_8c.html#a47e28e6ea289d3f83ad1883ddde5a422">  279</a></span>&#160;<span class="keyword">static</span> <a class="code" href="attributes_8h.html#abeeb324fff79a5335d36774704e2475c">av_cold</a> <span class="keywordtype">int</span> <a class="code" href="crystalhd_8c.html#a47e28e6ea289d3f83ad1883ddde5a422">uninit</a>(<a class="code" href="struct_a_v_codec_context.html">AVCodecContext</a> *avctx)</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;{</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <a class="code" href="struct_c_h_d_context.html">CHDContext</a> *priv = avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#af3379123060ad8cc9c321c29af4f8360">priv_data</a>;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    HANDLE device;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    device = priv-&gt;<a class="code" href="struct_c_h_d_context.html#a92deb863439db0a19b2c1c223a94792d">dev</a>;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    DtsStopDecoder(device);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    DtsCloseDecoder(device);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    DtsDeviceClose(device);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordflow">if</span> (priv-&gt;<a class="code" href="struct_c_h_d_context.html#a51e69223662ba0a15dfc131008e91d56">head</a>) {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;       <a class="code" href="struct_opaque_list.html">OpaqueList</a> *node = priv-&gt;<a class="code" href="struct_c_h_d_context.html#a51e69223662ba0a15dfc131008e91d56">head</a>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;       <span class="keywordflow">while</span> (node) {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;          <a class="code" href="struct_opaque_list.html">OpaqueList</a> *next = node-&gt;<a class="code" href="struct_opaque_list.html#ac1fe4c65aaeb8155cd46205594cac678">next</a>;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;          <a class="code" href="tableprint__vlc_8h.html#a079eab092887563f2bef9106c6120089">av_free</a>(node);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;          node = next;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;       }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;}</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno"><a class="line" href="crystalhd_8c.html#a41c0c9c8aa8e1fd12d65b18dd6948b09">  301</a></span>&#160;<span class="keyword">static</span> <a class="code" href="attributes_8h.html#abeeb324fff79a5335d36774704e2475c">av_cold</a> <span class="keywordtype">int</span> <a class="code" href="crystalhd_8c.html#a41c0c9c8aa8e1fd12d65b18dd6948b09">init</a>(<a class="code" href="struct_a_v_codec_context.html">AVCodecContext</a> *avctx)</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;{</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <a class="code" href="struct_c_h_d_context.html">CHDContext</a>* priv;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    BC_STATUS <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    BC_INFO_CRYSTAL <a class="code" href="libkvazaar_8c.html#a4c7a521b8f1a0769c09bfa4a1fca7dab">version</a>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    BC_INPUT_FORMAT <a class="code" href="filter__design_8txt.html#a7d537039ea0e18164d9edb0b5ca984dd">format</a> = {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        .FGTEnable   = FALSE,</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        .Progressive = TRUE,</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        .OptFlags    = 0x80000000 | vdecFrameRate59_94 | 0x40,</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        .<a class="code" href="struct_a_v_frame.html#a1e71ce60cedd5f3b6811714a9f7f9e0a">width</a>       = avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#a0d8f46461754e8abea0847dcbc41b956">width</a>,</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        .height      = avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#a0449afd803eb107bd4dbc8b5ea22e363">height</a>,</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    };</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    BC_MEDIA_SUBTYPE subtype;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    uint32_t <a class="code" href="ebur128_8h.html#a1a6b6fb557d8d37d59700faf4e4c9167">mode</a> = DTS_PLAYBACK_MODE |</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                    DTS_LOAD_FILE_PLAY_FW |</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                    DTS_SKIP_TX_CHK_CPB |</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                    DTS_PLAYBACK_DROP_RPT_MODE |</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                    DTS_SINGLE_THREADED_MODE |</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                    DTS_DFLT_RESOLUTION(vdecRESOLUTION_1080p23_976);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(avctx, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>, <span class="stringliteral">&quot;CrystalHD Init for %s\n&quot;</span>,</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;           avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#a6e606effa68724cae2ef5cc05f7fd9cb">codec</a>-&gt;<a class="code" href="struct_a_v_codec.html#ad3daa3e729850b573c139a83be8938ca">name</a>);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#a0425c77b3d06d71e5db88b1d7e1b37f2">pix_fmt</a> = <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5ac755aea7c3277b09a42253882ec0444e">AV_PIX_FMT_YUYV422</a>;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">/* Initialize the library */</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    priv               = avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#af3379123060ad8cc9c321c29af4f8360">priv_data</a>;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    priv-&gt;<a class="code" href="struct_c_h_d_context.html#a6dd16b6d003847a00597ea361ad261a7">avctx</a>        = avctx;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    priv-&gt;<a class="code" href="struct_c_h_d_context.html#a715e32610f8597046a731a1bd0ae3748">draining</a>     = 0;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    subtype = <a class="code" href="crystalhd_8c.html#a89b6bc0eb06a3841eb2d02a765816a50">id2subtype</a>(priv, avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#a6e606effa68724cae2ef5cc05f7fd9cb">codec</a>-&gt;<a class="code" href="struct_a_v_codec.html#a01a53d07936f4c7ee280444793b6967b">id</a>);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">switch</span> (subtype) {</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordflow">case</span> BC_MSUBTYPE_H264:</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <a class="code" href="filter__design_8txt.html#a7d537039ea0e18164d9edb0b5ca984dd">format</a>.startCodeSz = 4;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="comment">// Fall-through</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordflow">case</span> BC_MSUBTYPE_VC1:</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordflow">case</span> BC_MSUBTYPE_WVC1:</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">case</span> BC_MSUBTYPE_WMV3:</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordflow">case</span> BC_MSUBTYPE_WMVA:</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">case</span> BC_MSUBTYPE_MPEG2VIDEO:</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">case</span> BC_MSUBTYPE_DIVX:</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordflow">case</span> BC_MSUBTYPE_DIVX311:</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <a class="code" href="filter__design_8txt.html#a7d537039ea0e18164d9edb0b5ca984dd">format</a>.pMetaData  = avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#abe964316aaaa61967b012efdcced79c4">extradata</a>;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <a class="code" href="filter__design_8txt.html#a7d537039ea0e18164d9edb0b5ca984dd">format</a>.metaDataSz = avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#ae246ca7a1c72c151891ed0599e8dbfba">extradata_size</a>;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(avctx, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;CrystalHD: Unknown codec name\n&quot;</span>);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <a class="code" href="filter__design_8txt.html#a7d537039ea0e18164d9edb0b5ca984dd">format</a>.mSubtype = subtype;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordflow">if</span> (priv-&gt;<a class="code" href="struct_c_h_d_context.html#a8e1fca061985805d3cc8e1f0c3daf8d6">sWidth</a>) {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <a class="code" href="filter__design_8txt.html#a7d537039ea0e18164d9edb0b5ca984dd">format</a>.bEnableScaling = 1;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <a class="code" href="filter__design_8txt.html#a7d537039ea0e18164d9edb0b5ca984dd">format</a>.ScalingParams.sWidth = priv-&gt;<a class="code" href="struct_c_h_d_context.html#a8e1fca061985805d3cc8e1f0c3daf8d6">sWidth</a>;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">/* Get a decoder instance */</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(avctx, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>, <span class="stringliteral">&quot;CrystalHD: starting up\n&quot;</span>);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="comment">// Initialize the Link and Decoder devices</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = DtsDeviceOpen(&amp;priv-&gt;<a class="code" href="struct_c_h_d_context.html#a92deb863439db0a19b2c1c223a94792d">dev</a>, <a class="code" href="ebur128_8h.html#a1a6b6fb557d8d37d59700faf4e4c9167">mode</a>);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> != BC_STS_SUCCESS) {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(avctx, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>, <span class="stringliteral">&quot;CrystalHD: DtsDeviceOpen failed\n&quot;</span>);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = DtsCrystalHDVersion(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a92deb863439db0a19b2c1c223a94792d">dev</a>, &amp;<a class="code" href="libkvazaar_8c.html#a4c7a521b8f1a0769c09bfa4a1fca7dab">version</a>);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> != BC_STS_SUCCESS) {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(avctx, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>,</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;               <span class="stringliteral">&quot;CrystalHD: DtsCrystalHDVersion failed\n&quot;</span>);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    }</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    priv-&gt;<a class="code" href="struct_c_h_d_context.html#a16c1813cd9cbd8dd5811057506305650">is_70012</a> = <a class="code" href="libkvazaar_8c.html#a4c7a521b8f1a0769c09bfa4a1fca7dab">version</a>.device == 0;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordflow">if</span> (priv-&gt;<a class="code" href="struct_c_h_d_context.html#a16c1813cd9cbd8dd5811057506305650">is_70012</a> &amp;&amp;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        (subtype == BC_MSUBTYPE_DIVX || subtype == BC_MSUBTYPE_DIVX311)) {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(avctx, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>,</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;               <span class="stringliteral">&quot;CrystalHD: BCM70012 doesn&#39;t support MPEG4-ASP/DivX/Xvid\n&quot;</span>);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    }</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = DtsSetInputFormat(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a92deb863439db0a19b2c1c223a94792d">dev</a>, &amp;<a class="code" href="filter__design_8txt.html#a7d537039ea0e18164d9edb0b5ca984dd">format</a>);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> != BC_STS_SUCCESS) {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(avctx, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;CrystalHD: SetInputFormat failed\n&quot;</span>);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = DtsOpenDecoder(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a92deb863439db0a19b2c1c223a94792d">dev</a>, BC_STREAM_TYPE_ES);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> != BC_STS_SUCCESS) {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(avctx, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;CrystalHD: DtsOpenDecoder failed\n&quot;</span>);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = DtsSetColorSpace(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a92deb863439db0a19b2c1c223a94792d">dev</a>, OUTPUT_MODE422_YUY2);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> != BC_STS_SUCCESS) {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(avctx, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;CrystalHD: DtsSetColorSpace failed\n&quot;</span>);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    }</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = DtsStartDecoder(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a92deb863439db0a19b2c1c223a94792d">dev</a>);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> != BC_STS_SUCCESS) {</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(avctx, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;CrystalHD: DtsStartDecoder failed\n&quot;</span>);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = DtsStartCapture(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a92deb863439db0a19b2c1c223a94792d">dev</a>);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> != BC_STS_SUCCESS) {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(avctx, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;CrystalHD: DtsStartCapture failed\n&quot;</span>);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(avctx, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>, <span class="stringliteral">&quot;CrystalHD: Init complete.\n&quot;</span>);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>:</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <a class="code" href="crystalhd_8c.html#a47e28e6ea289d3f83ad1883ddde5a422">uninit</a>(avctx);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;}</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno"><a class="line" href="crystalhd_8c.html#a4625ea480d3c3578027bf735979ca134">  421</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="crystalhd_8c.html#a1851d3e21348a8826d7241fae4946cf1">CopyRet</a> <a class="code" href="crystalhd_8c.html#a4625ea480d3c3578027bf735979ca134">copy_frame</a>(<a class="code" href="struct_a_v_codec_context.html">AVCodecContext</a> *avctx,</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                                 BC_DTS_PROC_OUT *<a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>,</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                                 <a class="code" href="struct_a_v_frame.html">AVFrame</a> *<a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>, <span class="keywordtype">int</span> *got_frame)</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;{</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    BC_STATUS <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    BC_DTS_STATUS decoder_status = { 0, };</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> <a class="code" href="mxfenc_8c.html#a418fe46b202d0fdab1bdc116a863571a">interlaced</a>;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <a class="code" href="struct_c_h_d_context.html">CHDContext</a> *priv = avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#af3379123060ad8cc9c321c29af4f8360">priv_data</a>;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    int64_t pkt_pts  = <a class="code" href="group__lavu__time.html#ga2eaefe702f95f619ea6f2d08afa01be1">AV_NOPTS_VALUE</a>;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> bottom_field = (<a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>-&gt;PicInfo.flags &amp; VDEC_FLAG_BOTTOMFIELD) ==</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                           VDEC_FLAG_BOTTOMFIELD;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> bottom_first = !!(<a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>-&gt;PicInfo.flags &amp; VDEC_FLAG_BOTTOM_FIRST);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="tests_2snowenc_8c.html#a667b04d7fb6ef46db4da4af554c5b6f7">width</a>    = <a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>-&gt;PicInfo.width;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="tests_2snowenc_8c.html#a64f9f90ece96c7bab4aee3deacf170e0">height</a>   = <a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>-&gt;PicInfo.height;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordtype">int</span> bwidth;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a> = <a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>-&gt;Ybuff;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordtype">int</span> sStride;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *dst;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordtype">int</span> dStride;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>-&gt;PicInfo.timeStamp != 0) {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <a class="code" href="struct_opaque_list.html">OpaqueList</a> *node = <a class="code" href="crystalhd_8c.html#af731d0707ed09ccb41d9f19ab2a05401">opaque_list_pop</a>(priv, <a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>-&gt;PicInfo.timeStamp);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="keywordflow">if</span> (node) {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            pkt_pts = node-&gt;<a class="code" href="struct_opaque_list.html#a3a63011fcb4c1f450e0686a71feded5a">reordered_opaque</a>;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#a079eab092887563f2bef9106c6120089">av_free</a>(node);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            <span class="comment">/*</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">             * We will encounter a situation where a timestamp cannot be</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">             * popped if a second field is being returned. In this case,</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">             * each field has the same timestamp and the first one will</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">             * cause it to be popped. We&#39;ll avoid overwriting the valid</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">             * timestamp below.</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">             */</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(avctx, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>, <span class="stringliteral">&quot;output \&quot;pts\&quot;: %&quot;</span>PRIu64<span class="stringliteral">&quot;\n&quot;</span>,</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;               <a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>-&gt;PicInfo.timeStamp);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    }</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = DtsGetDriverStatus(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a92deb863439db0a19b2c1c223a94792d">dev</a>, &amp;decoder_status);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> != BC_STS_SUCCESS) {</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(avctx, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>,</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;               <span class="stringliteral">&quot;CrystalHD: GetDriverStatus failed: %u\n&quot;</span>, <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;       <span class="keywordflow">return</span> <a class="code" href="crystalhd_8c.html#a1851d3e21348a8826d7241fae4946cf1ae8ed27c1aabd77d519426a8ad340d76c">RET_ERROR</a>;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    }</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <a class="code" href="mxfenc_8c.html#a418fe46b202d0fdab1bdc116a863571a">interlaced</a> = <a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>-&gt;PicInfo.flags &amp; VDEC_FLAG_INTERLACED_SRC;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(avctx, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>, <span class="stringliteral">&quot;Interlaced state: %d\n&quot;</span>,</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;           <a class="code" href="mxfenc_8c.html#a418fe46b202d0fdab1bdc116a863571a">interlaced</a>);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160; </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    priv-&gt;<a class="code" href="struct_c_h_d_context.html#aab52285abc2f1d82c453598cc53d9866">need_second_field</a> = <a class="code" href="mxfenc_8c.html#a418fe46b202d0fdab1bdc116a863571a">interlaced</a> &amp;&amp; !priv-&gt;<a class="code" href="struct_c_h_d_context.html#aab52285abc2f1d82c453598cc53d9866">need_second_field</a>;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;data[0]) {</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="decode_8c.html#a0d5adb2b84051826883605b3ab4d1bab">ff_get_buffer</a>(avctx, <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>, 0) &lt; 0)</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="crystalhd_8c.html#a1851d3e21348a8826d7241fae4946cf1ae8ed27c1aabd77d519426a8ad340d76c">RET_ERROR</a>;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    }</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    bwidth = <a class="code" href="group__lavu__picture.html#ga8eddd074d5eb6a235591013675ac1055">av_image_get_linesize</a>(avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#a0425c77b3d06d71e5db88b1d7e1b37f2">pix_fmt</a>, <a class="code" href="tests_2snowenc_8c.html#a667b04d7fb6ef46db4da4af554c5b6f7">width</a>, 0);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordflow">if</span> (bwidth &lt; 0)</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;       <span class="keywordflow">return</span> <a class="code" href="crystalhd_8c.html#a1851d3e21348a8826d7241fae4946cf1ae8ed27c1aabd77d519426a8ad340d76c">RET_ERROR</a>;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordflow">if</span> (priv-&gt;<a class="code" href="struct_c_h_d_context.html#a16c1813cd9cbd8dd5811057506305650">is_70012</a>) {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <span class="keywordtype">int</span> pStride;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="tests_2snowenc_8c.html#a667b04d7fb6ef46db4da4af554c5b6f7">width</a> &lt;= 720)</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            pStride = 720;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="tests_2snowenc_8c.html#a667b04d7fb6ef46db4da4af554c5b6f7">width</a> &lt;= 1280)</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;            pStride = 1280;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="keywordflow">else</span> pStride = 1920;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        sStride = <a class="code" href="group__lavu__picture.html#ga8eddd074d5eb6a235591013675ac1055">av_image_get_linesize</a>(avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#a0425c77b3d06d71e5db88b1d7e1b37f2">pix_fmt</a>, pStride, 0);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        <span class="keywordflow">if</span> (sStride &lt; 0)</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="crystalhd_8c.html#a1851d3e21348a8826d7241fae4946cf1ae8ed27c1aabd77d519426a8ad340d76c">RET_ERROR</a>;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        sStride = bwidth;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    }</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    dStride = <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;linesize[0];</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    dst     = <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;data[0];</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a6dd16b6d003847a00597ea361ad261a7">avctx</a>, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>, <span class="stringliteral">&quot;CrystalHD: Copying out frame\n&quot;</span>);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160; </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">     * The hardware doesn&#39;t return the first sample of a picture.</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">     * Ignoring why it behaves this way, it&#39;s better to copy the sample from</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">     * the second line, rather than the next sample across because the chroma</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">     * values should be correct (assuming the decoded video was 4:2:0, which</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">     * it was).</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    *((uint32_t *)<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>) = *((uint32_t *)(<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a> + sStride));</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="mxfenc_8c.html#a418fe46b202d0fdab1bdc116a863571a">interlaced</a>) {</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="keywordtype">int</span> dY = 0;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="keywordtype">int</span> sY = 0;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <a class="code" href="tests_2snowenc_8c.html#a64f9f90ece96c7bab4aee3deacf170e0">height</a> /= 2;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <span class="keywordflow">if</span> (bottom_field) {</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a6dd16b6d003847a00597ea361ad261a7">avctx</a>, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>, <span class="stringliteral">&quot;Interlaced: bottom field\n&quot;</span>);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            dY = 1;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a6dd16b6d003847a00597ea361ad261a7">avctx</a>, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>, <span class="stringliteral">&quot;Interlaced: top field\n&quot;</span>);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            dY = 0;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        }</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160; </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <span class="keywordflow">for</span> (sY = 0; sY &lt; <a class="code" href="tests_2snowenc_8c.html#a64f9f90ece96c7bab4aee3deacf170e0">height</a>; dY++, sY++) {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            memcpy(&amp;(dst[dY * dStride]), &amp;(<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>[sY * sStride]), bwidth);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            dY++;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        }</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <a class="code" href="group__lavu__picture.html#ga735cb949320867e9c2fffcb327d0ece2">av_image_copy_plane</a>(dst, dStride, <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>, sStride, bwidth, <a class="code" href="tests_2snowenc_8c.html#a64f9f90ece96c7bab4aee3deacf170e0">height</a>);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;interlaced_frame = <a class="code" href="mxfenc_8c.html#a418fe46b202d0fdab1bdc116a863571a">interlaced</a>;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="mxfenc_8c.html#a418fe46b202d0fdab1bdc116a863571a">interlaced</a>)</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;top_field_first = !bottom_first;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160; </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;pts = pkt_pts;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="preprocessor">#if FF_API_PKT_PTS</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<a class="code" href="libavutil_2internal_8h.html#a5837cafc419c2b5ecdb1dfa330675d13">FF_DISABLE_DEPRECATION_WARNINGS</a></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;pkt_pts = pkt_pts;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<a class="code" href="libavutil_2internal_8h.html#aa6ef004d10669ab4ee062367a014ea33">FF_ENABLE_DEPRECATION_WARNINGS</a></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;pkt_pos = -1;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;pkt_duration = 0;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;pkt_size = -1;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160; </div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="keywordflow">if</span> (!priv-&gt;<a class="code" href="struct_c_h_d_context.html#aab52285abc2f1d82c453598cc53d9866">need_second_field</a>) {</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        *got_frame       = 1;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="crystalhd_8c.html#a1851d3e21348a8826d7241fae4946cf1a5b3f9fd990577d6129995fcbceb62265">RET_COPY_AGAIN</a>;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    }</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160; </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="crystalhd_8c.html#a1851d3e21348a8826d7241fae4946cf1a4894234446e2d92068943b3d6d3a0bdc">RET_OK</a>;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;}</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno"><a class="line" href="crystalhd_8c.html#aa7c77736ee6ba0c6242841bec52e8550">  560</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="crystalhd_8c.html#a1851d3e21348a8826d7241fae4946cf1">CopyRet</a> <a class="code" href="crystalhd_8c.html#aa7c77736ee6ba0c6242841bec52e8550">receive_frame</a>(<a class="code" href="struct_a_v_codec_context.html">AVCodecContext</a> *avctx,</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                                    <a class="code" href="struct_a_v_frame.html">AVFrame</a> *<a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>, <span class="keywordtype">int</span> *got_frame)</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;{</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    BC_STATUS <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    BC_DTS_PROC_OUT <a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a> = {</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        .PicInfo.width  = avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#a0d8f46461754e8abea0847dcbc41b956">width</a>,</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        .PicInfo.height = avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#a0449afd803eb107bd4dbc8b5ea22e363">height</a>,</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    };</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <a class="code" href="struct_c_h_d_context.html">CHDContext</a> *priv = avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#af3379123060ad8cc9c321c29af4f8360">priv_data</a>;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    HANDLE dev       = priv-&gt;<a class="code" href="struct_c_h_d_context.html#a92deb863439db0a19b2c1c223a94792d">dev</a>;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160; </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    *got_frame = 0;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="comment">// Request decoded data from the driver</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = DtsProcOutputNoCopy(dev, <a class="code" href="crystalhd_8c.html#adb8242fb3a594ce608a984b81c5f67b9">OUTPUT_PROC_TIMEOUT</a>, &amp;<a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> == BC_STS_FMT_CHANGE) {</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(avctx, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>, <span class="stringliteral">&quot;CrystalHD: Initial format change\n&quot;</span>);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#a0d8f46461754e8abea0847dcbc41b956">width</a>  = <a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>.PicInfo.width;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#a0449afd803eb107bd4dbc8b5ea22e363">height</a> = <a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>.PicInfo.height;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <span class="keywordflow">switch</span> ( <a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>.PicInfo.aspect_ratio ) {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <span class="keywordflow">case</span> vdecAspectRatioSquare:</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#a5252d34fbce300228d4dbda19a8c3293">sample_aspect_ratio</a> = (<a class="code" href="group__lavu__math__rational.html#ga6eff035c271caa5a533987a1e00ad43e">AVRational</a>) {  1,  1};</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <span class="keywordflow">case</span> vdecAspectRatio12_11:</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#a5252d34fbce300228d4dbda19a8c3293">sample_aspect_ratio</a> = (<a class="code" href="group__lavu__math__rational.html#ga6eff035c271caa5a533987a1e00ad43e">AVRational</a>) { 12, 11};</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <span class="keywordflow">case</span> vdecAspectRatio10_11:</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#a5252d34fbce300228d4dbda19a8c3293">sample_aspect_ratio</a> = (<a class="code" href="group__lavu__math__rational.html#ga6eff035c271caa5a533987a1e00ad43e">AVRational</a>) { 10, 11};</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <span class="keywordflow">case</span> vdecAspectRatio16_11:</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#a5252d34fbce300228d4dbda19a8c3293">sample_aspect_ratio</a> = (<a class="code" href="group__lavu__math__rational.html#ga6eff035c271caa5a533987a1e00ad43e">AVRational</a>) { 16, 11};</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <span class="keywordflow">case</span> vdecAspectRatio40_33:</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#a5252d34fbce300228d4dbda19a8c3293">sample_aspect_ratio</a> = (<a class="code" href="group__lavu__math__rational.html#ga6eff035c271caa5a533987a1e00ad43e">AVRational</a>) { 40, 33};</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <span class="keywordflow">case</span> vdecAspectRatio24_11:</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#a5252d34fbce300228d4dbda19a8c3293">sample_aspect_ratio</a> = (<a class="code" href="group__lavu__math__rational.html#ga6eff035c271caa5a533987a1e00ad43e">AVRational</a>) { 24, 11};</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <span class="keywordflow">case</span> vdecAspectRatio20_11:</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#a5252d34fbce300228d4dbda19a8c3293">sample_aspect_ratio</a> = (<a class="code" href="group__lavu__math__rational.html#ga6eff035c271caa5a533987a1e00ad43e">AVRational</a>) { 20, 11};</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <span class="keywordflow">case</span> vdecAspectRatio32_11:</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#a5252d34fbce300228d4dbda19a8c3293">sample_aspect_ratio</a> = (<a class="code" href="group__lavu__math__rational.html#ga6eff035c271caa5a533987a1e00ad43e">AVRational</a>) { 32, 11};</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        <span class="keywordflow">case</span> vdecAspectRatio80_33:</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#a5252d34fbce300228d4dbda19a8c3293">sample_aspect_ratio</a> = (<a class="code" href="group__lavu__math__rational.html#ga6eff035c271caa5a533987a1e00ad43e">AVRational</a>) { 80, 33};</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        <span class="keywordflow">case</span> vdecAspectRatio18_11:</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#a5252d34fbce300228d4dbda19a8c3293">sample_aspect_ratio</a> = (<a class="code" href="group__lavu__math__rational.html#ga6eff035c271caa5a533987a1e00ad43e">AVRational</a>) { 18, 11};</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <span class="keywordflow">case</span> vdecAspectRatio15_11:</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#a5252d34fbce300228d4dbda19a8c3293">sample_aspect_ratio</a> = (<a class="code" href="group__lavu__math__rational.html#ga6eff035c271caa5a533987a1e00ad43e">AVRational</a>) { 15, 11};</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <span class="keywordflow">case</span> vdecAspectRatio64_33:</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#a5252d34fbce300228d4dbda19a8c3293">sample_aspect_ratio</a> = (<a class="code" href="group__lavu__math__rational.html#ga6eff035c271caa5a533987a1e00ad43e">AVRational</a>) { 64, 33};</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="keywordflow">case</span> vdecAspectRatio160_99:</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#a5252d34fbce300228d4dbda19a8c3293">sample_aspect_ratio</a> = (<a class="code" href="group__lavu__math__rational.html#ga6eff035c271caa5a533987a1e00ad43e">AVRational</a>) {160, 99};</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        <span class="keywordflow">case</span> vdecAspectRatio4_3:</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#a5252d34fbce300228d4dbda19a8c3293">sample_aspect_ratio</a> = (<a class="code" href="group__lavu__math__rational.html#ga6eff035c271caa5a533987a1e00ad43e">AVRational</a>) {  4,  3};</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <span class="keywordflow">case</span> vdecAspectRatio16_9:</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#a5252d34fbce300228d4dbda19a8c3293">sample_aspect_ratio</a> = (<a class="code" href="group__lavu__math__rational.html#ga6eff035c271caa5a533987a1e00ad43e">AVRational</a>) { 16,  9};</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <span class="keywordflow">case</span> vdecAspectRatio221_1:</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#a5252d34fbce300228d4dbda19a8c3293">sample_aspect_ratio</a> = (<a class="code" href="group__lavu__math__rational.html#ga6eff035c271caa5a533987a1e00ad43e">AVRational</a>) {221,  1};</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        }</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="crystalhd_8c.html#a1851d3e21348a8826d7241fae4946cf1a5b3f9fd990577d6129995fcbceb62265">RET_COPY_AGAIN</a>;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> == BC_STS_SUCCESS) {</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        <span class="keywordtype">int</span> copy_ret = -1;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>.PoutFlags &amp; BC_POUT_FLAGS_PIB_VALID) {</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            <a class="code" href="crystalhd_8c.html#a32b6d11d289bd0fc06bff12ff00a704f">print_frame_info</a>(priv, &amp;<a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            copy_ret = <a class="code" href="crystalhd_8c.html#a4625ea480d3c3578027bf735979ca134">copy_frame</a>(avctx, &amp;<a class="code" href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a>, <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>, got_frame);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            <span class="comment">/*</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">             * An invalid frame has been consumed.</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">             */</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(avctx, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;CrystalHD: ProcOutput succeeded with &quot;</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                                        <span class="stringliteral">&quot;invalid PIB\n&quot;</span>);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            copy_ret = <a class="code" href="crystalhd_8c.html#a1851d3e21348a8826d7241fae4946cf1a5b3f9fd990577d6129995fcbceb62265">RET_COPY_AGAIN</a>;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        }</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        DtsReleaseOutputBuffs(dev, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, FALSE);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160; </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        <span class="keywordflow">return</span> copy_ret;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> == BC_STS_BUSY) {</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="crystalhd_8c.html#a1851d3e21348a8826d7241fae4946cf1a5b3f9fd990577d6129995fcbceb62265">RET_COPY_AGAIN</a>;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(avctx, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;CrystalHD: ProcOutput failed %d\n&quot;</span>, <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="crystalhd_8c.html#a1851d3e21348a8826d7241fae4946cf1ae8ed27c1aabd77d519426a8ad340d76c">RET_ERROR</a>;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    }</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;}</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160; </div>
<div class="line"><a name="l00655"></a><span class="lineno"><a class="line" href="crystalhd_8c.html#a457b3fea2efcb946f1b863baac4077c3">  655</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="crystalhd_8c.html#a457b3fea2efcb946f1b863baac4077c3">crystalhd_decode_packet</a>(<a class="code" href="struct_a_v_codec_context.html">AVCodecContext</a> *avctx, <span class="keyword">const</span> <a class="code" href="struct_a_v_packet.html">AVPacket</a> *avpkt)</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;{</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    BC_STATUS bc_ret;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <a class="code" href="struct_c_h_d_context.html">CHDContext</a> *priv   = avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#af3379123060ad8cc9c321c29af4f8360">priv_data</a>;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    HANDLE dev         = priv-&gt;<a class="code" href="struct_c_h_d_context.html#a92deb863439db0a19b2c1c223a94792d">dev</a>;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = 0;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(avctx, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>, <span class="stringliteral">&quot;CrystalHD: decode_packet\n&quot;</span>);</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="keywordflow">if</span> (avpkt &amp;&amp; avpkt-&gt;<a class="code" href="struct_a_v_packet.html#a4d1ea19f63eb107111fd650ca514d1f4">size</a>) {</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        uint64_t <a class="code" href="transcode__aac_8c.html#a4fbb704fb96c36a78a36eee010306ce7">pts</a>;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160; </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">         * Despite being notionally opaque, either libcrystalhd or</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">         * the hardware itself will mangle pts values that are too</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">         * small or too large. The docs claim it should be in units</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">         * of 100ns. Given that we&#39;re nominally dealing with a black</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">         * box on both sides, any transform we do has no guarantee of</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">         * avoiding mangling so we need to build a mapping to values</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">         * we know will not be mangled.</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <a class="code" href="transcode__aac_8c.html#a4fbb704fb96c36a78a36eee010306ce7">pts</a> = <a class="code" href="crystalhd_8c.html#a990eb3fd769da9bba40bfec66aedd156">opaque_list_push</a>(priv, avpkt-&gt;<a class="code" href="struct_a_v_packet.html#a73bde0a37f3b1efc839f11295bfbf42a">pts</a>);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="transcode__aac_8c.html#a4fbb704fb96c36a78a36eee010306ce7">pts</a>) {</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            <span class="keywordflow">goto</span> exit;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        }</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(priv-&gt;<a class="code" href="struct_c_h_d_context.html#a6dd16b6d003847a00597ea361ad261a7">avctx</a>, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>,</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;               <span class="stringliteral">&quot;input \&quot;pts\&quot;: %&quot;</span>PRIu64<span class="stringliteral">&quot;\n&quot;</span>, <a class="code" href="transcode__aac_8c.html#a4fbb704fb96c36a78a36eee010306ce7">pts</a>);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        bc_ret = DtsProcInput(dev, avpkt-&gt;<a class="code" href="struct_a_v_packet.html#aaf4fe58dfcc7c232c1f2268b539d8367">data</a>, avpkt-&gt;<a class="code" href="struct_a_v_packet.html#a4d1ea19f63eb107111fd650ca514d1f4">size</a>, <a class="code" href="transcode__aac_8c.html#a4fbb704fb96c36a78a36eee010306ce7">pts</a>, 0);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <span class="keywordflow">if</span> (bc_ret == BC_STS_BUSY) {</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(avctx, <a class="code" href="group__lavu__log__constants.html#ga85b57516ca703cc47d9bbe5f4658c716">AV_LOG_WARNING</a>,</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                   <span class="stringliteral">&quot;CrystalHD: ProcInput returned busy\n&quot;</span>);</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EAGAIN);</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            <span class="keywordflow">goto</span> exit;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bc_ret != BC_STS_SUCCESS) {</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(avctx, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>,</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                   <span class="stringliteral">&quot;CrystalHD: ProcInput failed: %u\n&quot;</span>, <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = -1;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            <span class="keywordflow">goto</span> exit;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        }</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(avctx, <a class="code" href="group__lavu__log__constants.html#gad172eacfed8653e454c6fdcbe53baab3">AV_LOG_INFO</a>, <span class="stringliteral">&quot;CrystalHD: No more input data\n&quot;</span>);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        priv-&gt;<a class="code" href="struct_c_h_d_context.html#a715e32610f8597046a731a1bd0ae3748">draining</a> = 1;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = <a class="code" href="group__lavu__error.html#gab4faa0afdf35076914824200331defff">AVERROR_EOF</a>;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        <span class="keywordflow">goto</span> exit;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    }</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160; exit:</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;}</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno"><a class="line" href="crystalhd_8c.html#aa5841517e408b870f51440cc7f7b3571">  705</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="crystalhd_8c.html#aa5841517e408b870f51440cc7f7b3571">crystalhd_receive_frame</a>(<a class="code" href="struct_a_v_codec_context.html">AVCodecContext</a> *avctx, <a class="code" href="struct_a_v_frame.html">AVFrame</a> *<a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>)</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;{</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    BC_STATUS bc_ret;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    BC_DTS_STATUS decoder_status = { 0, };</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <a class="code" href="crystalhd_8c.html#a1851d3e21348a8826d7241fae4946cf1">CopyRet</a> rec_ret;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <a class="code" href="struct_c_h_d_context.html">CHDContext</a> *priv   = avctx-&gt;<a class="code" href="struct_a_v_codec_context.html#af3379123060ad8cc9c321c29af4f8360">priv_data</a>;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    HANDLE dev         = priv-&gt;<a class="code" href="struct_c_h_d_context.html#a92deb863439db0a19b2c1c223a94792d">dev</a>;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="keywordtype">int</span> got_frame = 0;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = 0;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <a class="code" href="struct_a_v_packet.html">AVPacket</a> <a class="code" href="demuxing__decoding_8c.html#a3d4c6562f0b27cf0cacbbea5c038c090">pkt</a> = {0};</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160; </div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(avctx, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>, <span class="stringliteral">&quot;CrystalHD: receive_frame\n&quot;</span>);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160; </div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = <a class="code" href="decode_8c.html#a87fcb1ca6a586c1480f9eaf926a3f09c">ff_decode_get_packet</a>(avctx, &amp;<a class="code" href="demuxing__decoding_8c.html#a3d4c6562f0b27cf0cacbbea5c038c090">pkt</a>);</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> &lt; 0 &amp;&amp; <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> != <a class="code" href="group__lavu__error.html#gab4faa0afdf35076914824200331defff">AVERROR_EOF</a>) {</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    }</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160; </div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="demuxing__decoding_8c.html#a3d4c6562f0b27cf0cacbbea5c038c090">pkt</a>.<a class="code" href="struct_a_v_packet.html#a4d1ea19f63eb107111fd650ca514d1f4">size</a> &gt; DtsTxFreeSize(dev)) {</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment">         * Block until there is space in the buffer for the next packet.</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment">         * We assume that the hardware will make forward progress at this</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment">         * point, although in pathological cases that may not happen.</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(avctx, <a class="code" href="group__lavu__log__constants.html#ga030300ea4843c53b2fe178a434964b39">AV_LOG_TRACE</a>, <span class="stringliteral">&quot;CrystalHD: Waiting for space in input buffer\n&quot;</span>);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    }</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160; </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = <a class="code" href="crystalhd_8c.html#a457b3fea2efcb946f1b863baac4077c3">crystalhd_decode_packet</a>(avctx, &amp;<a class="code" href="demuxing__decoding_8c.html#a3d4c6562f0b27cf0cacbbea5c038c090">pkt</a>);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <a class="code" href="group__lavc__packet.html#ga63d5a489b419bd5d45cfd09091cbcbc2">av_packet_unref</a>(&amp;<a class="code" href="demuxing__decoding_8c.html#a3d4c6562f0b27cf0cacbbea5c038c090">pkt</a>);</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="comment">// crystalhd_is_buffer_full() should avoid this.</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> == <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EAGAIN)) {</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = <a class="code" href="group__lavu__error.html#ga9c520e483ba8648495620ffdb4c491f2">AVERROR_EXTERNAL</a>;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    }</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> &lt; 0 &amp;&amp; <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> != <a class="code" href="group__lavu__error.html#gab4faa0afdf35076914824200331defff">AVERROR_EOF</a>) {</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    }</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        bc_ret = DtsGetDriverStatus(dev, &amp;decoder_status);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        <span class="keywordflow">if</span> (bc_ret != BC_STS_SUCCESS) {</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(avctx, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;CrystalHD: GetDriverStatus failed\n&quot;</span>);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;            <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        }</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160; </div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        <span class="keywordflow">if</span> (decoder_status.ReadyListCount == 0) {</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(avctx, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>, <span class="stringliteral">&quot;CrystalHD: Insufficient frames ready. Returning\n&quot;</span>);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            got_frame = 0;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            rec_ret = <a class="code" href="crystalhd_8c.html#a1851d3e21348a8826d7241fae4946cf1a4894234446e2d92068943b3d6d3a0bdc">RET_OK</a>;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        }</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160; </div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        rec_ret = <a class="code" href="crystalhd_8c.html#aa7c77736ee6ba0c6242841bec52e8550">receive_frame</a>(avctx, <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>, &amp;got_frame);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    } <span class="keywordflow">while</span> (rec_ret == <a class="code" href="crystalhd_8c.html#a1851d3e21348a8826d7241fae4946cf1a5b3f9fd990577d6129995fcbceb62265">RET_COPY_AGAIN</a>);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160; </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="keywordflow">if</span> (rec_ret == <a class="code" href="crystalhd_8c.html#a1851d3e21348a8826d7241fae4946cf1ae8ed27c1aabd77d519426a8ad340d76c">RET_ERROR</a>) {</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (got_frame == 0) {</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        <span class="keywordflow">return</span> priv-&gt;<a class="code" href="struct_c_h_d_context.html#a715e32610f8597046a731a1bd0ae3748">draining</a> ? <a class="code" href="group__lavu__error.html#gab4faa0afdf35076914824200331defff">AVERROR_EOF</a> : <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EAGAIN);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    }</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;}</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160; </div>
<div class="line"><a name="l00768"></a><span class="lineno"><a class="line" href="crystalhd_8c.html#a65cc7c2e94324c9d7435ecb60c92e410">  768</a></span>&#160;<span class="preprocessor">#define DEFINE_CRYSTALHD_DECODER(x, X, bsf_name) \</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="preprocessor">    static const AVClass x##_crystalhd_class = { \</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="preprocessor">        .class_name = #x &quot;_crystalhd&quot;, \</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="preprocessor">        .item_name = av_default_item_name, \</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="preprocessor">        .option = options, \</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="preprocessor">        .version = LIBAVUTIL_VERSION_INT, \</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="preprocessor">    }; \</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="preprocessor">    AVCodec ff_##x##_crystalhd_decoder = { \</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="preprocessor">        .name           = #x &quot;_crystalhd&quot;, \</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="preprocessor">        .long_name      = NULL_IF_CONFIG_SMALL(&quot;CrystalHD &quot; #X &quot; decoder&quot;), \</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="preprocessor">        .type           = AVMEDIA_TYPE_VIDEO, \</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="preprocessor">        .id             = AV_CODEC_ID_##X, \</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="preprocessor">        .priv_data_size = sizeof(CHDContext), \</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="preprocessor">        .priv_class     = &amp;x##_crystalhd_class, \</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="preprocessor">        .init           = init, \</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="preprocessor">        .close          = uninit, \</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="preprocessor">        .receive_frame  = crystalhd_receive_frame, \</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="preprocessor">        .flush          = flush, \</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="preprocessor">        .bsfs           = bsf_name, \</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="preprocessor">        .capabilities   = AV_CODEC_CAP_DELAY | AV_CODEC_CAP_AVOID_PROBING | AV_CODEC_CAP_HARDWARE, \</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="preprocessor">        .pix_fmts       = (const enum AVPixelFormat[]){AV_PIX_FMT_YUYV422, AV_PIX_FMT_NONE}, \</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="preprocessor">        .wrapper_name   = &quot;crystalhd&quot;, \</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="preprocessor">    };</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160; </div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="preprocessor">#if CONFIG_H264_CRYSTALHD_DECODER</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<a class="code" href="crystalhd_8c.html#a65cc7c2e94324c9d7435ecb60c92e410">DEFINE_CRYSTALHD_DECODER</a>(h264, H264, <span class="stringliteral">&quot;h264_mp4toannexb&quot;</span>)</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="preprocessor">#if CONFIG_MPEG2_CRYSTALHD_DECODER</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<a class="code" href="crystalhd_8c.html#a65cc7c2e94324c9d7435ecb60c92e410">DEFINE_CRYSTALHD_DECODER</a>(mpeg2, MPEG2VIDEO, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160; </div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="preprocessor">#if CONFIG_MPEG4_CRYSTALHD_DECODER</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<a class="code" href="crystalhd_8c.html#a65cc7c2e94324c9d7435ecb60c92e410">DEFINE_CRYSTALHD_DECODER</a>(mpeg4, MPEG4, <span class="stringliteral">&quot;mpeg4_unpack_bframes&quot;</span>)</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160; </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="preprocessor">#if CONFIG_MSMPEG4_CRYSTALHD_DECODER</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<a class="code" href="crystalhd_8c.html#a65cc7c2e94324c9d7435ecb60c92e410">DEFINE_CRYSTALHD_DECODER</a>(msmpeg4, MSMPEG4V3, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160; </div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="preprocessor">#if CONFIG_VC1_CRYSTALHD_DECODER</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<a class="code" href="crystalhd_8c.html#a65cc7c2e94324c9d7435ecb60c92e410">DEFINE_CRYSTALHD_DECODER</a>(vc1, VC1, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160; </div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="preprocessor">#if CONFIG_WMV3_CRYSTALHD_DECODER</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<a class="code" href="crystalhd_8c.html#a65cc7c2e94324c9d7435ecb60c92e410">DEFINE_CRYSTALHD_DECODER</a>(wmv3, WMV3, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="acrystalhd_8c_html_a384ff94b5139f441c282c9b4c7b985e6"><div class="ttname"><a href="crystalhd_8c.html#a384ff94b5139f441c282c9b4c7b985e6">options</a></div><div class="ttdeci">static const AVOption options[]</div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00106">crystalhd.c:106</a></div></div>
<div class="ttc" id="agroup__lavc__packet_html_ga63d5a489b419bd5d45cfd09091cbcbc2"><div class="ttname"><a href="group__lavc__packet.html#ga63d5a489b419bd5d45cfd09091cbcbc2">av_packet_unref</a></div><div class="ttdeci">void av_packet_unref(AVPacket *pkt)</div><div class="ttdef"><b>Definition:</b> <a href="avpacket_8c_source.html#l00606">avpacket.c:606</a></div></div>
<div class="ttc" id="alibavutil_2internal_8h_html_aa6ef004d10669ab4ee062367a014ea33"><div class="ttname"><a href="libavutil_2internal_8h.html#aa6ef004d10669ab4ee062367a014ea33">FF_ENABLE_DEPRECATION_WARNINGS</a></div><div class="ttdeci">#define FF_ENABLE_DEPRECATION_WARNINGS</div><div class="ttdef"><b>Definition:</b> <a href="libavutil_2internal_8h_source.html#l00085">internal.h:85</a></div></div>
<div class="ttc" id="adecode_8c_html_a87fcb1ca6a586c1480f9eaf926a3f09c"><div class="ttname"><a href="decode_8c.html#a87fcb1ca6a586c1480f9eaf926a3f09c">ff_decode_get_packet</a></div><div class="ttdeci">int ff_decode_get_packet(AVCodecContext *avctx, AVPacket *pkt)</div><div class="ttdef"><b>Definition:</b> <a href="decode_8c_source.html#l00248">decode.c:248</a></div></div>
<div class="ttc" id="agroup__lavu__log__constants_html_ga85b57516ca703cc47d9bbe5f4658c716"><div class="ttname"><a href="group__lavu__log__constants.html#ga85b57516ca703cc47d9bbe5f4658c716">AV_LOG_WARNING</a></div><div class="ttdeci">#define AV_LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="log_8h_source.html#l00200">log.h:200</a></div></div>
<div class="ttc" id="astruct_a_v_codec_context_html"><div class="ttname"><a href="struct_a_v_codec_context.html">AVCodecContext</a></div><div class="ttdef"><b>Definition:</b> <a href="avcodec_8h_source.html#l00526">avcodec.h:526</a></div></div>
<div class="ttc" id="afilter__design_8txt_html_adf2fb515710d47541f7150ecd2950e76"><div class="ttname"><a href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a></div><div class="ttdeci">Filter the word frame indicates either a video frame or a group of audio as stored in an AVFrame structure Format for each input and each output the list of supported formats For video that means pixel format For audio that means channel sample they are references to shared objects When the negotiation mechanism computes the intersection of the formats supported at each end of a all references to both lists are replaced with a reference to the intersection And when a single format is eventually chosen for a link amongst the remaining all references to the list are updated That means that if a filter requires that its input and output have the same format amongst a supported all it has to do is use a reference to the same list of formats query_formats can leave some formats unset and return AVERROR(EAGAIN) to cause the negotiation mechanism toagain later. That can be used by filters with complex requirements to use the format negotiated on one link to set the formats supported on another. Frame references ownership and permissions</div></div>
<div class="ttc" id="aopt_8h_html"><div class="ttname"><a href="opt_8h.html">opt.h</a></div></div>
<div class="ttc" id="aopt_8h_html_aaf3d0af9d7eca757034486a8eb896246"><div class="ttname"><a href="opt_8h.html#aaf3d0af9d7eca757034486a8eb896246">AV_OPT_FLAG_VIDEO_PARAM</a></div><div class="ttdeci">#define AV_OPT_FLAG_VIDEO_PARAM</div><div class="ttdef"><b>Definition:</b> <a href="opt_8h_source.html#l00281">opt.h:281</a></div></div>
<div class="ttc" id="astruct_a_v_codec_context_html_a0449afd803eb107bd4dbc8b5ea22e363"><div class="ttname"><a href="struct_a_v_codec_context.html#a0449afd803eb107bd4dbc8b5ea22e363">AVCodecContext::height</a></div><div class="ttdeci">int height</div><div class="ttdef"><b>Definition:</b> <a href="avcodec_8h_source.html#l00699">avcodec.h:699</a></div></div>
<div class="ttc" id="astruct_a_v_codec_context_html_af3379123060ad8cc9c321c29af4f8360"><div class="ttname"><a href="struct_a_v_codec_context.html#af3379123060ad8cc9c321c29af4f8360">AVCodecContext::priv_data</a></div><div class="ttdeci">void * priv_data</div><div class="ttdef"><b>Definition:</b> <a href="avcodec_8h_source.html#l00553">avcodec.h:553</a></div></div>
<div class="ttc" id="agroup__lavu__error_html_gab4faa0afdf35076914824200331defff"><div class="ttname"><a href="group__lavu__error.html#gab4faa0afdf35076914824200331defff">AVERROR_EOF</a></div><div class="ttdeci">#define AVERROR_EOF</div><div class="ttdoc">End of file.</div><div class="ttdef"><b>Definition:</b> <a href="error_8h_source.html#l00055">error.h:55</a></div></div>
<div class="ttc" id="afilter__design_8txt_html_aa4e1c6357e04ee6960702c705448a76a"><div class="ttname"><a href="filter__design_8txt.html#aa4e1c6357e04ee6960702c705448a76a">output</a></div><div class="ttdeci">filter_frame For filters that do not use the this method is called when a frame is pushed to the filter s input It can be called at any time except in a reentrant way If the input frame is enough to produce output</div><div class="ttdef"><b>Definition:</b> <a href="filter__design_8txt_source.html#l00225">filter_design.txt:225</a></div></div>
<div class="ttc" id="agroup__lavc__core_html_ggaadca229ad2c20e060a14fec08a5cc7cead95dfdf68b462db508b45fb693a4c09e"><div class="ttname"><a href="group__lavc__core.html#ggaadca229ad2c20e060a14fec08a5cc7cead95dfdf68b462db508b45fb693a4c09e">AV_CODEC_ID_MPEG4</a></div><div class="ttdeci">@ AV_CODEC_ID_MPEG4</div><div class="ttdef"><b>Definition:</b> <a href="codec__id_8h_source.html#l00061">codec_id.h:61</a></div></div>
<div class="ttc" id="agroup__lavu__log__constants_html_ga9b58b28e2d429b930b69db19877f76a8"><div class="ttname"><a href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a></div><div class="ttdeci">#define AV_LOG_VERBOSE</div><div class="ttdef"><b>Definition:</b> <a href="log_8h_source.html#l00210">log.h:210</a></div></div>
<div class="ttc" id="astruct_c_h_d_context_html_a2f3102807f9443db0af849d9272f1e1e"><div class="ttname"><a href="struct_c_h_d_context.html#a2f3102807f9443db0af849d9272f1e1e">CHDContext::tail</a></div><div class="ttdeci">OpaqueList * tail</div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00100">crystalhd.c:100</a></div></div>
<div class="ttc" id="acrystalhd_8c_html_a89b6bc0eb06a3841eb2d02a765816a50"><div class="ttname"><a href="crystalhd_8c.html#a89b6bc0eb06a3841eb2d02a765816a50">id2subtype</a></div><div class="ttdeci">static BC_MEDIA_SUBTYPE id2subtype(CHDContext *priv, enum AVCodecID id)</div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00120">crystalhd.c:120</a></div></div>
<div class="ttc" id="astruct_a_v_packet_html_aaf4fe58dfcc7c232c1f2268b539d8367"><div class="ttname"><a href="struct_a_v_packet.html#aaf4fe58dfcc7c232c1f2268b539d8367">AVPacket::data</a></div><div class="ttdeci">uint8_t * data</div><div class="ttdef"><b>Definition:</b> <a href="packet_8h_source.html#l00363">packet.h:363</a></div></div>
<div class="ttc" id="agroup__lavu__picture_html_ga735cb949320867e9c2fffcb327d0ece2"><div class="ttname"><a href="group__lavu__picture.html#ga735cb949320867e9c2fffcb327d0ece2">av_image_copy_plane</a></div><div class="ttdeci">void av_image_copy_plane(uint8_t *dst, int dst_linesize, const uint8_t *src, int src_linesize, int bytewidth, int height)</div><div class="ttdef"><b>Definition:</b> <a href="imgutils_8c_source.html#l00373">imgutils.c:373</a></div></div>
<div class="ttc" id="astruct_a_v_codec_context_html_ae246ca7a1c72c151891ed0599e8dbfba"><div class="ttname"><a href="struct_a_v_codec_context.html#ae246ca7a1c72c151891ed0599e8dbfba">AVCodecContext::extradata_size</a></div><div class="ttdeci">int extradata_size</div><div class="ttdef"><b>Definition:</b> <a href="avcodec_8h_source.html#l00628">avcodec.h:628</a></div></div>
<div class="ttc" id="acheckasm_8h_html_a73a3b169ac8c3419cbe15327e75ffcfd"><div class="ttname"><a href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a></div><div class="ttdeci">#define fail()</div><div class="ttdef"><b>Definition:</b> <a href="checkasm_8h_source.html#l00123">checkasm.h:123</a></div></div>
<div class="ttc" id="acrystalhd_8c_html_a4625ea480d3c3578027bf735979ca134"><div class="ttname"><a href="crystalhd_8c.html#a4625ea480d3c3578027bf735979ca134">copy_frame</a></div><div class="ttdeci">static CopyRet copy_frame(AVCodecContext *avctx, BC_DTS_PROC_OUT *output, AVFrame *frame, int *got_frame)</div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00421">crystalhd.c:421</a></div></div>
<div class="ttc" id="atranscode__aac_8c_html_a4fbb704fb96c36a78a36eee010306ce7"><div class="ttname"><a href="transcode__aac_8c.html#a4fbb704fb96c36a78a36eee010306ce7">pts</a></div><div class="ttdeci">static int64_t pts</div><div class="ttdef"><b>Definition:</b> <a href="transcode__aac_8c_source.html#l00647">transcode_aac.c:647</a></div></div>
<div class="ttc" id="acrystalhd_8c_html_a1851d3e21348a8826d7241fae4946cf1a5b3f9fd990577d6129995fcbceb62265"><div class="ttname"><a href="crystalhd_8c.html#a1851d3e21348a8826d7241fae4946cf1a5b3f9fd990577d6129995fcbceb62265">RET_COPY_AGAIN</a></div><div class="ttdeci">@ RET_COPY_AGAIN</div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00081">crystalhd.c:81</a></div></div>
<div class="ttc" id="astruct_c_h_d_context_html_aab52285abc2f1d82c453598cc53d9866"><div class="ttname"><a href="struct_c_h_d_context.html#aab52285abc2f1d82c453598cc53d9866">CHDContext::need_second_field</a></div><div class="ttdeci">uint8_t need_second_field</div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00096">crystalhd.c:96</a></div></div>
<div class="ttc" id="agroup__lavu__log__constants_html_ga030300ea4843c53b2fe178a434964b39"><div class="ttname"><a href="group__lavu__log__constants.html#ga030300ea4843c53b2fe178a434964b39">AV_LOG_TRACE</a></div><div class="ttdeci">#define AV_LOG_TRACE</div><div class="ttdef"><b>Definition:</b> <a href="log_8h_source.html#l00220">log.h:220</a></div></div>
<div class="ttc" id="agroup__lavu__log__constants_html_gaffe151ff4cd8a24b2e77ac8d9616c85c"><div class="ttname"><a href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a></div><div class="ttdeci">#define AV_LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="log_8h_source.html#l00194">log.h:194</a></div></div>
<div class="ttc" id="aattributes_8h_html_abeeb324fff79a5335d36774704e2475c"><div class="ttname"><a href="attributes_8h.html#abeeb324fff79a5335d36774704e2475c">av_cold</a></div><div class="ttdeci">#define av_cold</div><div class="ttdef"><b>Definition:</b> <a href="attributes_8h_source.html#l00090">attributes.h:90</a></div></div>
<div class="ttc" id="acrystalhd_8c_html_adb8242fb3a594ce608a984b81c5f67b9"><div class="ttname"><a href="crystalhd_8c.html#adb8242fb3a594ce608a984b81c5f67b9">OUTPUT_PROC_TIMEOUT</a></div><div class="ttdeci">#define OUTPUT_PROC_TIMEOUT</div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00069">crystalhd.c:69</a></div></div>
<div class="ttc" id="atests_2snowenc_8c_html_a667b04d7fb6ef46db4da4af554c5b6f7"><div class="ttname"><a href="tests_2snowenc_8c.html#a667b04d7fb6ef46db4da4af554c5b6f7">width</a></div><div class="ttdeci">#define width</div></div>
<div class="ttc" id="aintreadwrite_8h_html"><div class="ttname"><a href="intreadwrite_8h.html">intreadwrite.h</a></div></div>
<div class="ttc" id="afilter__design_8txt_html_a7d537039ea0e18164d9edb0b5ca984dd"><div class="ttname"><a href="filter__design_8txt.html#a7d537039ea0e18164d9edb0b5ca984dd">format</a></div><div class="ttdeci">Filter the word frame indicates either a video frame or a group of audio as stored in an AVFrame structure Format for each input and each output the list of supported formats For video that means pixel format For audio that means channel sample format(the sample packing is implied by the sample format) and sample rate. The lists are not just lists</div></div>
<div class="ttc" id="astruct_a_v_codec_context_html_a5252d34fbce300228d4dbda19a8c3293"><div class="ttname"><a href="struct_a_v_codec_context.html#a5252d34fbce300228d4dbda19a8c3293">AVCodecContext::sample_aspect_ratio</a></div><div class="ttdeci">AVRational sample_aspect_ratio</div><div class="ttdef"><b>Definition:</b> <a href="avcodec_8h_source.html#l00905">avcodec.h:905</a></div></div>
<div class="ttc" id="astruct_a_v_option_html"><div class="ttname"><a href="struct_a_v_option.html">AVOption</a></div><div class="ttdef"><b>Definition:</b> <a href="opt_8h_source.html#l00248">opt.h:248</a></div></div>
<div class="ttc" id="adecode_8h_html"><div class="ttname"><a href="decode_8h.html">decode.h</a></div></div>
<div class="ttc" id="astruct_a_v_packet_html_a73bde0a37f3b1efc839f11295bfbf42a"><div class="ttname"><a href="struct_a_v_packet.html#a73bde0a37f3b1efc839f11295bfbf42a">AVPacket::pts</a></div><div class="ttdeci">int64_t pts</div><div class="ttdef"><b>Definition:</b> <a href="packet_8h_source.html#l00356">packet.h:356</a></div></div>
<div class="ttc" id="astruct_c_h_d_context_html_a715e32610f8597046a731a1bd0ae3748"><div class="ttname"><a href="struct_c_h_d_context.html#a715e32610f8597046a731a1bd0ae3748">CHDContext::draining</a></div><div class="ttdeci">uint8_t draining</div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00097">crystalhd.c:97</a></div></div>
<div class="ttc" id="agroup__lavc__core_html_ggaadca229ad2c20e060a14fec08a5cc7cea3d4c051c8b18a3c18750676a308c10be"><div class="ttname"><a href="group__lavc__core.html#ggaadca229ad2c20e060a14fec08a5cc7cea3d4c051c8b18a3c18750676a308c10be">AV_CODEC_ID_H264</a></div><div class="ttdeci">@ AV_CODEC_ID_H264</div><div class="ttdef"><b>Definition:</b> <a href="codec__id_8h_source.html#l00076">codec_id.h:76</a></div></div>
<div class="ttc" id="agroup__lavu__math__rational_html_ga6eff035c271caa5a533987a1e00ad43e"><div class="ttname"><a href="group__lavu__math__rational.html#ga6eff035c271caa5a533987a1e00ad43e">AVRational</a></div><div class="ttdeci">struct AVRational AVRational</div></div>
<div class="ttc" id="agroup__lavc__core_html_ggaadca229ad2c20e060a14fec08a5cc7ceadb3fab61116754cc08f3168dd26ff776"><div class="ttname"><a href="group__lavc__core.html#ggaadca229ad2c20e060a14fec08a5cc7ceadb3fab61116754cc08f3168dd26ff776">AV_CODEC_ID_WMV3</a></div><div class="ttdeci">@ AV_CODEC_ID_WMV3</div><div class="ttdef"><b>Definition:</b> <a href="codec__id_8h_source.html#l00120">codec_id.h:120</a></div></div>
<div class="ttc" id="acoverity_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="coverity_8c_source.html#l00032">coverity.c:32</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5ac755aea7c3277b09a42253882ec0444e"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5ac755aea7c3277b09a42253882ec0444e">AV_PIX_FMT_YUYV422</a></div><div class="ttdeci">@ AV_PIX_FMT_YUYV422</div><div class="ttdoc">packed YUV 4:2:2, 16bpp, Y0 Cb Y1 Cr</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00067">pixfmt.h:67</a></div></div>
<div class="ttc" id="acrystalhd_8c_html_aa7c77736ee6ba0c6242841bec52e8550"><div class="ttname"><a href="crystalhd_8c.html#aa7c77736ee6ba0c6242841bec52e8550">receive_frame</a></div><div class="ttdeci">static CopyRet receive_frame(AVCodecContext *avctx, AVFrame *frame, int *got_frame)</div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00560">crystalhd.c:560</a></div></div>
<div class="ttc" id="atests_2checkasm_2vp8dsp_8c_html_a858376c0918f93e656c8c0d76c63dbe8"><div class="ttname"><a href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a></div><div class="ttdeci">#define src</div><div class="ttdef"><b>Definition:</b> <a href="tests_2checkasm_2vp8dsp_8c_source.html#l00254">vp8dsp.c:254</a></div></div>
<div class="ttc" id="acrystalhd_8c_html_a41c0c9c8aa8e1fd12d65b18dd6948b09"><div class="ttname"><a href="crystalhd_8c.html#a41c0c9c8aa8e1fd12d65b18dd6948b09">init</a></div><div class="ttdeci">static av_cold int init(AVCodecContext *avctx)</div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00301">crystalhd.c:301</a></div></div>
<div class="ttc" id="acrystalhd_8c_html_a990eb3fd769da9bba40bfec66aedd156"><div class="ttname"><a href="crystalhd_8c.html#a990eb3fd769da9bba40bfec66aedd156">opaque_list_push</a></div><div class="ttdeci">static uint64_t opaque_list_push(CHDContext *priv, uint64_t reordered_opaque)</div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00186">crystalhd.c:186</a></div></div>
<div class="ttc" id="acrystalhd_8c_html_a1851d3e21348a8826d7241fae4946cf1ae8ed27c1aabd77d519426a8ad340d76c"><div class="ttname"><a href="crystalhd_8c.html#a1851d3e21348a8826d7241fae4946cf1ae8ed27c1aabd77d519426a8ad340d76c">RET_ERROR</a></div><div class="ttdeci">@ RET_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00079">crystalhd.c:79</a></div></div>
<div class="ttc" id="astruct_opaque_list_html"><div class="ttname"><a href="struct_opaque_list.html">OpaqueList</a></div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00084">crystalhd.c:84</a></div></div>
<div class="ttc" id="agroup__lavc__core_html_gaadca229ad2c20e060a14fec08a5cc7ce"><div class="ttname"><a href="group__lavc__core.html#gaadca229ad2c20e060a14fec08a5cc7ce">AVCodecID</a></div><div class="ttdeci">AVCodecID</div><div class="ttdef"><b>Definition:</b> <a href="codec__id_8h_source.html#l00046">codec_id.h:46</a></div></div>
<div class="ttc" id="agroup__lavu__mem__funcs_html_gaf143ecab33a3868b57345466c39de7c1"><div class="ttname"><a href="group__lavu__mem__funcs.html#gaf143ecab33a3868b57345466c39de7c1">av_mallocz</a></div><div class="ttdeci">void * av_mallocz(size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="mem_8c_source.html#l00237">mem.c:237</a></div></div>
<div class="ttc" id="adecode_8c_html_a0d5adb2b84051826883605b3ab4d1bab"><div class="ttname"><a href="decode_8c.html#a0d5adb2b84051826883605b3ab4d1bab">ff_get_buffer</a></div><div class="ttdeci">int ff_get_buffer(AVCodecContext *avctx, AVFrame *frame, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="decode_8c_source.html#l01879">decode.c:1879</a></div></div>
<div class="ttc" id="astruct_opaque_list_html_a699c7b5e0af17ac414381a220e8d0b1f"><div class="ttname"><a href="struct_opaque_list.html#a699c7b5e0af17ac414381a220e8d0b1f">OpaqueList::fake_timestamp</a></div><div class="ttdeci">uint64_t fake_timestamp</div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00086">crystalhd.c:86</a></div></div>
<div class="ttc" id="astruct_opaque_list_html_ac1fe4c65aaeb8155cd46205594cac678"><div class="ttname"><a href="struct_opaque_list.html#ac1fe4c65aaeb8155cd46205594cac678">OpaqueList::next</a></div><div class="ttdeci">struct OpaqueList * next</div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00085">crystalhd.c:85</a></div></div>
<div class="ttc" id="astruct_a_v_codec_html_a01a53d07936f4c7ee280444793b6967b"><div class="ttname"><a href="struct_a_v_codec.html#a01a53d07936f4c7ee280444793b6967b">AVCodec::id</a></div><div class="ttdeci">enum AVCodecID id</div><div class="ttdef"><b>Definition:</b> <a href="codec_8h_source.html#l00202">codec.h:204</a></div></div>
<div class="ttc" id="agroup__lavu__time_html_ga2eaefe702f95f619ea6f2d08afa01be1"><div class="ttname"><a href="group__lavu__time.html#ga2eaefe702f95f619ea6f2d08afa01be1">AV_NOPTS_VALUE</a></div><div class="ttdeci">#define AV_NOPTS_VALUE</div><div class="ttdoc">Undefined timestamp value.</div><div class="ttdef"><b>Definition:</b> <a href="avutil_8h_source.html#l00248">avutil.h:248</a></div></div>
<div class="ttc" id="astruct_c_h_d_context_html_a51e69223662ba0a15dfc131008e91d56"><div class="ttname"><a href="struct_c_h_d_context.html#a51e69223662ba0a15dfc131008e91d56">CHDContext::head</a></div><div class="ttdeci">OpaqueList * head</div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00099">crystalhd.c:99</a></div></div>
<div class="ttc" id="astruct_a_v_codec_context_html_a0d8f46461754e8abea0847dcbc41b956"><div class="ttname"><a href="struct_a_v_codec_context.html#a0d8f46461754e8abea0847dcbc41b956">AVCodecContext::width</a></div><div class="ttdeci">int width</div><div class="ttdef"><b>Definition:</b> <a href="avcodec_8h_source.html#l00699">avcodec.h:699</a></div></div>
<div class="ttc" id="astruct_c_h_d_context_html_a6b96309837c07d874c3ea95786077990"><div class="ttname"><a href="struct_c_h_d_context.html#a6b96309837c07d874c3ea95786077990">CHDContext::av_class</a></div><div class="ttdeci">AVClass * av_class</div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00091">crystalhd.c:91</a></div></div>
<div class="ttc" id="acrystalhd_8c_html_a457b3fea2efcb946f1b863baac4077c3"><div class="ttname"><a href="crystalhd_8c.html#a457b3fea2efcb946f1b863baac4077c3">crystalhd_decode_packet</a></div><div class="ttdeci">static int crystalhd_decode_packet(AVCodecContext *avctx, const AVPacket *avpkt)</div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00655">crystalhd.c:655</a></div></div>
<div class="ttc" id="astruct_a_v_class_html"><div class="ttname"><a href="struct_a_v_class.html">AVClass</a></div><div class="ttdef"><b>Definition:</b> <a href="log_8h_source.html#l00067">log.h:67</a></div></div>
<div class="ttc" id="acrystalhd_8c_html_af731d0707ed09ccb41d9f19ab2a05401"><div class="ttname"><a href="crystalhd_8c.html#af731d0707ed09ccb41d9f19ab2a05401">opaque_list_pop</a></div><div class="ttdeci">static OpaqueList * opaque_list_pop(CHDContext *priv, uint64_t fake_timestamp)</div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00214">crystalhd.c:214</a></div></div>
<div class="ttc" id="atests_2snowenc_8c_html_a64f9f90ece96c7bab4aee3deacf170e0"><div class="ttname"><a href="tests_2snowenc_8c.html#a64f9f90ece96c7bab4aee3deacf170e0">height</a></div><div class="ttdeci">#define height</div></div>
<div class="ttc" id="agroup__lavu__error_html_ga9c520e483ba8648495620ffdb4c491f2"><div class="ttname"><a href="group__lavu__error.html#ga9c520e483ba8648495620ffdb4c491f2">AVERROR_EXTERNAL</a></div><div class="ttdeci">#define AVERROR_EXTERNAL</div><div class="ttdoc">Generic error in an external library.</div><div class="ttdef"><b>Definition:</b> <a href="error_8h_source.html#l00057">error.h:57</a></div></div>
<div class="ttc" id="astruct_a_v_frame_html_a1e71ce60cedd5f3b6811714a9f7f9e0a"><div class="ttname"><a href="struct_a_v_frame.html#a1e71ce60cedd5f3b6811714a9f7f9e0a">AVFrame::width</a></div><div class="ttdeci">int width</div><div class="ttdef"><b>Definition:</b> <a href="frame_8h_source.html#l00366">frame.h:366</a></div></div>
<div class="ttc" id="alibkvazaar_8c_html_a4c7a521b8f1a0769c09bfa4a1fca7dab"><div class="ttname"><a href="libkvazaar_8c.html#a4c7a521b8f1a0769c09bfa4a1fca7dab">version</a></div><div class="ttdeci">version</div><div class="ttdef"><b>Definition:</b> <a href="libkvazaar_8c_source.html#l00317">libkvazaar.c:317</a></div></div>
<div class="ttc" id="agroup__lavu__log__constants_html_gad172eacfed8653e454c6fdcbe53baab3"><div class="ttname"><a href="group__lavu__log__constants.html#gad172eacfed8653e454c6fdcbe53baab3">AV_LOG_INFO</a></div><div class="ttdeci">#define AV_LOG_INFO</div><div class="ttdef"><b>Definition:</b> <a href="log_8h_source.html#l00205">log.h:205</a></div></div>
<div class="ttc" id="agroup__lavu__picture_html_ga8eddd074d5eb6a235591013675ac1055"><div class="ttname"><a href="group__lavu__picture.html#ga8eddd074d5eb6a235591013675ac1055">av_image_get_linesize</a></div><div class="ttdeci">int av_image_get_linesize(enum AVPixelFormat pix_fmt, int width, int plane)</div><div class="ttdef"><b>Definition:</b> <a href="imgutils_8c_source.html#l00076">imgutils.c:76</a></div></div>
<div class="ttc" id="acrystalhd_8c_html_a65cc7c2e94324c9d7435ecb60c92e410"><div class="ttname"><a href="crystalhd_8c.html#a65cc7c2e94324c9d7435ecb60c92e410">DEFINE_CRYSTALHD_DECODER</a></div><div class="ttdeci">#define DEFINE_CRYSTALHD_DECODER(x, X, bsf_name)</div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00768">crystalhd.c:768</a></div></div>
<div class="ttc" id="amxfenc_8c_html_a418fe46b202d0fdab1bdc116a863571a"><div class="ttname"><a href="mxfenc_8c.html#a418fe46b202d0fdab1bdc116a863571a">interlaced</a></div><div class="ttdeci">uint8_t interlaced</div><div class="ttdef"><b>Definition:</b> <a href="mxfenc_8c_source.html#l02168">mxfenc.c:2168</a></div></div>
<div class="ttc" id="alibavutil_2internal_8h_html"><div class="ttname"><a href="libavutil_2internal_8h.html">internal.h</a></div></div>
<div class="ttc" id="acrystalhd_8c_html_a1851d3e21348a8826d7241fae4946cf1"><div class="ttname"><a href="crystalhd_8c.html#a1851d3e21348a8826d7241fae4946cf1">CopyRet</a></div><div class="ttdeci">CopyRet</div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00078">crystalhd.c:78</a></div></div>
<div class="ttc" id="aopt_8h_html_aad820197915e73441f76f5e0c384d78a"><div class="ttname"><a href="opt_8h.html#aad820197915e73441f76f5e0c384d78a">AV_OPT_FLAG_DECODING_PARAM</a></div><div class="ttdeci">#define AV_OPT_FLAG_DECODING_PARAM</div><div class="ttdoc">a generic parameter which can be set by the user for demuxing or decoding</div><div class="ttdef"><b>Definition:</b> <a href="opt_8h_source.html#l00279">opt.h:279</a></div></div>
<div class="ttc" id="aaudio__convert_8c_html_ae1affc9ca37cfb624959c866a73f83c2"><div class="ttname"><a href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a></div><div class="ttdeci">uint8_t</div><div class="ttdef"><b>Definition:</b> <a href="audio__convert_8c_source.html#l00194">audio_convert.c:194</a></div></div>
<div class="ttc" id="acrystalhd_8c_html_a1851d3e21348a8826d7241fae4946cf1a4894234446e2d92068943b3d6d3a0bdc"><div class="ttname"><a href="crystalhd_8c.html#a1851d3e21348a8826d7241fae4946cf1a4894234446e2d92068943b3d6d3a0bdc">RET_OK</a></div><div class="ttdeci">@ RET_OK</div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00080">crystalhd.c:80</a></div></div>
<div class="ttc" id="agroup__lavc__core_html_ggaadca229ad2c20e060a14fec08a5cc7cea7765c5c02c05ea1a96ef1ca35dad068f"><div class="ttname"><a href="group__lavc__core.html#ggaadca229ad2c20e060a14fec08a5cc7cea7765c5c02c05ea1a96ef1ca35dad068f">AV_CODEC_ID_VC1</a></div><div class="ttdeci">@ AV_CODEC_ID_VC1</div><div class="ttdef"><b>Definition:</b> <a href="codec__id_8h_source.html#l00119">codec_id.h:119</a></div></div>
<div class="ttc" id="astruct_a_v_codec_html_ad3daa3e729850b573c139a83be8938ca"><div class="ttname"><a href="struct_a_v_codec.html#ad3daa3e729850b573c139a83be8938ca">AVCodec::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="codec_8h_source.html#l00197">codec.h:197</a></div></div>
<div class="ttc" id="aavcodec_8h_html"><div class="ttname"><a href="avcodec_8h.html">avcodec.h</a></div></div>
<div class="ttc" id="afilter__design_8txt_html_af1ec77bdca1b30e8153fc5da88f603db"><div class="ttname"><a href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a></div><div class="ttdeci">ret</div><div class="ttdef"><b>Definition:</b> <a href="filter__design_8txt_source.html#l00187">filter_design.txt:187</a></div></div>
<div class="ttc" id="afilter__design_8txt_html_a48ad71a5b40cdd5f23c601f33665a953"><div class="ttname"><a href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a></div><div class="ttdeci">these buffered frames must be flushed immediately if a new input produces new the filter must not call request_frame to get more It must just process the frame or queue it The task of requesting more frames is left to the filter s request_frame method or the application If a filter has several the filter must be ready for frames arriving randomly on any input any filter with several inputs will most likely require some kind of queuing mechanism It is perfectly acceptable to have a limited queue and to drop frames when the inputs are too unbalanced request_frame For filters that do not use the this method is called when a frame is wanted on an output For a it should directly call filter_frame on the corresponding output For a if there are queued frames already one of these frames should be pushed If the filter should request a frame on one of its repeatedly until at least one frame has been pushed Return or at least make progress towards producing a frame</div><div class="ttdef"><b>Definition:</b> <a href="filter__design_8txt_source.html#l00264">filter_design.txt:264</a></div></div>
<div class="ttc" id="astruct_a_v_codec_context_html_abe964316aaaa61967b012efdcced79c4"><div class="ttname"><a href="struct_a_v_codec_context.html#abe964316aaaa61967b012efdcced79c4">AVCodecContext::extradata</a></div><div class="ttdeci">uint8_t * extradata</div><div class="ttdef"><b>Definition:</b> <a href="avcodec_8h_source.html#l00627">avcodec.h:627</a></div></div>
<div class="ttc" id="astruct_a_v_packet_html"><div class="ttname"><a href="struct_a_v_packet.html">AVPacket</a></div><div class="ttdef"><b>Definition:</b> <a href="packet_8h_source.html#l00340">packet.h:340</a></div></div>
<div class="ttc" id="astruct_opaque_list_html_a3a63011fcb4c1f450e0686a71feded5a"><div class="ttname"><a href="struct_opaque_list.html#a3a63011fcb4c1f450e0686a71feded5a">OpaqueList::reordered_opaque</a></div><div class="ttdeci">uint64_t reordered_opaque</div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00087">crystalhd.c:87</a></div></div>
<div class="ttc" id="ademuxing__decoding_8c_html_a3d4c6562f0b27cf0cacbbea5c038c090"><div class="ttname"><a href="demuxing__decoding_8c.html#a3d4c6562f0b27cf0cacbbea5c038c090">pkt</a></div><div class="ttdeci">static AVPacket pkt</div><div class="ttdef"><b>Definition:</b> <a href="demuxing__decoding_8c_source.html#l00054">demuxing_decoding.c:54</a></div></div>
<div class="ttc" id="aebur128_8h_html_a1a6b6fb557d8d37d59700faf4e4c9167"><div class="ttname"><a href="ebur128_8h.html#a1a6b6fb557d8d37d59700faf4e4c9167">mode</a></div><div class="ttdeci">mode</div><div class="ttdef"><b>Definition:</b> <a href="ebur128_8h_source.html#l00083">ebur128.h:83</a></div></div>
<div class="ttc" id="agroup__avoptions_html_ggabd75aa30eb8ad6387672df9a1fa79444ac068b8f6afeeb293a13aeabb5d702411"><div class="ttname"><a href="group__avoptions.html#ggabd75aa30eb8ad6387672df9a1fa79444ac068b8f6afeeb293a13aeabb5d702411">AV_OPT_TYPE_INT</a></div><div class="ttdeci">@ AV_OPT_TYPE_INT</div><div class="ttdef"><b>Definition:</b> <a href="opt_8h_source.html#l00225">opt.h:225</a></div></div>
<div class="ttc" id="astruct_a_v_packet_html_a4d1ea19f63eb107111fd650ca514d1f4"><div class="ttname"><a href="struct_a_v_packet.html#a4d1ea19f63eb107111fd650ca514d1f4">AVPacket::size</a></div><div class="ttdeci">int size</div><div class="ttdef"><b>Definition:</b> <a href="packet_8h_source.html#l00364">packet.h:364</a></div></div>
<div class="ttc" id="astruct_c_h_d_context_html"><div class="ttname"><a href="struct_c_h_d_context.html">CHDContext</a></div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00090">crystalhd.c:90</a></div></div>
<div class="ttc" id="alibavutil_2internal_8h_html_a5837cafc419c2b5ecdb1dfa330675d13"><div class="ttname"><a href="libavutil_2internal_8h.html#a5837cafc419c2b5ecdb1dfa330675d13">FF_DISABLE_DEPRECATION_WARNINGS</a></div><div class="ttdeci">#define FF_DISABLE_DEPRECATION_WARNINGS</div><div class="ttdef"><b>Definition:</b> <a href="libavutil_2internal_8h_source.html#l00084">internal.h:84</a></div></div>
<div class="ttc" id="astruct_c_h_d_context_html_a6dd16b6d003847a00597ea361ad261a7"><div class="ttname"><a href="struct_c_h_d_context.html#a6dd16b6d003847a00597ea361ad261a7">CHDContext::avctx</a></div><div class="ttdeci">AVCodecContext * avctx</div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00092">crystalhd.c:92</a></div></div>
<div class="ttc" id="acrystalhd_8c_html_aa5841517e408b870f51440cc7f7b3571"><div class="ttname"><a href="crystalhd_8c.html#aa5841517e408b870f51440cc7f7b3571">crystalhd_receive_frame</a></div><div class="ttdeci">static int crystalhd_receive_frame(AVCodecContext *avctx, AVFrame *frame)</div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00705">crystalhd.c:705</a></div></div>
<div class="ttc" id="astruct_c_h_d_context_html_a92deb863439db0a19b2c1c223a94792d"><div class="ttname"><a href="struct_c_h_d_context.html#a92deb863439db0a19b2c1c223a94792d">CHDContext::dev</a></div><div class="ttdeci">HANDLE dev</div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00093">crystalhd.c:93</a></div></div>
<div class="ttc" id="acrystalhd_8c_html_ad58908e9a076f611df638d0cbc3b8b64"><div class="ttname"><a href="crystalhd_8c.html#ad58908e9a076f611df638d0cbc3b8b64">TIMESTAMP_UNIT</a></div><div class="ttdeci">#define TIMESTAMP_UNIT</div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00071">crystalhd.c:71</a></div></div>
<div class="ttc" id="astruct_a_v_codec_context_html_a0425c77b3d06d71e5db88b1d7e1b37f2"><div class="ttname"><a href="struct_a_v_codec_context.html#a0425c77b3d06d71e5db88b1d7e1b37f2">AVCodecContext::pix_fmt</a></div><div class="ttdeci">enum AVPixelFormat pix_fmt</div><div class="ttdef"><b>Definition:</b> <a href="avcodec_8h_source.html#l00721">avcodec.h:736</a></div></div>
<div class="ttc" id="atableprint__vlc_8h_html_a079eab092887563f2bef9106c6120089"><div class="ttname"><a href="tableprint__vlc_8h.html#a079eab092887563f2bef9106c6120089">av_free</a></div><div class="ttdeci">#define av_free(p)</div><div class="ttdef"><b>Definition:</b> <a href="tableprint__vlc_8h_source.html#l00034">tableprint_vlc.h:34</a></div></div>
<div class="ttc" id="astruct_c_h_d_context_html_a16c1813cd9cbd8dd5811057506305650"><div class="ttname"><a href="struct_c_h_d_context.html#a16c1813cd9cbd8dd5811057506305650">CHDContext::is_70012</a></div><div class="ttdeci">uint8_t is_70012</div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00095">crystalhd.c:95</a></div></div>
<div class="ttc" id="acrystalhd_8c_html_affa0ccbe2ef7fd24bb8c61e28d1a6631"><div class="ttname"><a href="crystalhd_8c.html#affa0ccbe2ef7fd24bb8c61e28d1a6631">flush</a></div><div class="ttdeci">static void flush(AVCodecContext *avctx)</div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00267">crystalhd.c:267</a></div></div>
<div class="ttc" id="aimgutils_8h_html"><div class="ttname"><a href="imgutils_8h.html">imgutils.h</a></div></div>
<div class="ttc" id="acrystalhd_8c_html_a1f206fc8daebabfdc387acd398aa2445"><div class="ttname"><a href="crystalhd_8c.html#a1f206fc8daebabfdc387acd398aa2445">OpaqueList</a></div><div class="ttdeci">struct OpaqueList OpaqueList</div></div>
<div class="ttc" id="atableprint__vlc_8h_html_af38b91523053c244564a94f1ef862c2c"><div class="ttname"><a href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a></div><div class="ttdeci">#define av_log(a,...)</div><div class="ttdef"><b>Definition:</b> <a href="tableprint__vlc_8h_source.html#l00028">tableprint_vlc.h:28</a></div></div>
<div class="ttc" id="astruct_c_h_d_context_html_a8e1fca061985805d3cc8e1f0c3daf8d6"><div class="ttname"><a href="struct_c_h_d_context.html#a8e1fca061985805d3cc8e1f0c3daf8d6">CHDContext::sWidth</a></div><div class="ttdeci">uint32_t sWidth</div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00103">crystalhd.c:103</a></div></div>
<div class="ttc" id="agroup__lavc__core_html_ggaadca229ad2c20e060a14fec08a5cc7ceaf2c51d3f6f70b731f3b316d352e0fc62"><div class="ttname"><a href="group__lavc__core.html#ggaadca229ad2c20e060a14fec08a5cc7ceaf2c51d3f6f70b731f3b316d352e0fc62">AV_CODEC_ID_MSMPEG4V3</a></div><div class="ttdeci">@ AV_CODEC_ID_MSMPEG4V3</div><div class="ttdef"><b>Definition:</b> <a href="codec__id_8h_source.html#l00065">codec_id.h:65</a></div></div>
<div class="ttc" id="acrystalhd_8c_html_a47e28e6ea289d3f83ad1883ddde5a422"><div class="ttname"><a href="crystalhd_8c.html#a47e28e6ea289d3f83ad1883ddde5a422">uninit</a></div><div class="ttdeci">static av_cold int uninit(AVCodecContext *avctx)</div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00279">crystalhd.c:279</a></div></div>
<div class="ttc" id="astruct_a_v_codec_context_html_a6e606effa68724cae2ef5cc05f7fd9cb"><div class="ttname"><a href="struct_a_v_codec_context.html#a6e606effa68724cae2ef5cc05f7fd9cb">AVCodecContext::codec</a></div><div class="ttdeci">const struct AVCodec * codec</div><div class="ttdef"><b>Definition:</b> <a href="avcodec_8h_source.html#l00535">avcodec.h:535</a></div></div>
<div class="ttc" id="astruct_a_v_frame_html"><div class="ttname"><a href="struct_a_v_frame.html">AVFrame</a></div><div class="ttdef"><b>Definition:</b> <a href="frame_8h_source.html#l00308">frame.h:308</a></div></div>
<div class="ttc" id="agroup__lavc__core_html_ggaadca229ad2c20e060a14fec08a5cc7ceaf614abb36f7c5d0c42ed522c1d6c99f0"><div class="ttname"><a href="group__lavc__core.html#ggaadca229ad2c20e060a14fec08a5cc7ceaf614abb36f7c5d0c42ed522c1d6c99f0">AV_CODEC_ID_MPEG2VIDEO</a></div><div class="ttdeci">@ AV_CODEC_ID_MPEG2VIDEO</div><div class="ttdoc">preferred ID for MPEG-1/2 video decoding</div><div class="ttdef"><b>Definition:</b> <a href="codec__id_8h_source.html#l00051">codec_id.h:51</a></div></div>
<div class="ttc" id="acrystalhd_8c_html_a32b6d11d289bd0fc06bff12ff00a704f"><div class="ttname"><a href="crystalhd_8c.html#a32b6d11d289bd0fc06bff12ff00a704f">print_frame_info</a></div><div class="ttdeci">static void print_frame_info(CHDContext *priv, BC_DTS_PROC_OUT *output)</div><div class="ttdef"><b>Definition:</b> <a href="crystalhd_8c_source.html#l00140">crystalhd.c:140</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
