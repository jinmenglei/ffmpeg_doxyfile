<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: E:/github/ffmpeg/libavfilter/vf_deshake.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_737c44b861ba7ee498141742fb455fa8.html">ffmpeg</a></li><li class="navelem"><a class="el" href="dir_e1bd69597e95623f2084619f16269321.html">libavfilter</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">vf_deshake.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="vf__deshake_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Copyright (C) 2010 Georg Martius &lt;georg.martius@web.de&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * Copyright (C) 2010 Daniel G. Taylor &lt;dan@programmer-art.org&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * This file is part of FFmpeg.</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * FFmpeg is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * FFmpeg is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> * You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * License along with FFmpeg; if not, write to the Free Software</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="avfilter_8h.html">avfilter.h</a>&quot;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="formats_8h.html">formats.h</a>&quot;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="libavutil_2internal_8h.html">internal.h</a>&quot;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="video_8h.html">video.h</a>&quot;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="common_8h.html">libavutil/common.h</a>&quot;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mem_8h.html">libavutil/mem.h</a>&quot;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="opt_8h.html">libavutil/opt.h</a>&quot;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="pixdesc_8h.html">libavutil/pixdesc.h</a>&quot;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="qsort_8h.html">libavutil/qsort.h</a>&quot;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="deshake_8h.html">deshake.h</a>&quot;</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="vf__deshake_8c.html#ad12dce0a7bf9d908b172a28155b3d261">   64</a></span>&#160;<span class="preprocessor">#define OFFSET(x) offsetof(DeshakeContext, x)</span></div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="vf__deshake_8c.html#a6ccad09b4a2a06ae178418fdccf5940d">   65</a></span>&#160;<span class="preprocessor">#define FLAGS AV_OPT_FLAG_VIDEO_PARAM|AV_OPT_FLAG_FILTERING_PARAM</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="vf__deshake_8c.html#a0b5a799705df7848bf12916293611edb">   67</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="struct_a_v_option.html">AVOption</a> <a class="code" href="vf__deshake_8c.html#a0b5a799705df7848bf12916293611edb">deshake_options</a>[] = {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    { <span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;set x for the rectangular search area&quot;</span>,      <a class="code" href="vf__deshake_8c.html#ad12dce0a7bf9d908b172a28155b3d261">OFFSET</a>(cx), <a class="code" href="group__avoptions.html#ggabd75aa30eb8ad6387672df9a1fa79444ac068b8f6afeeb293a13aeabb5d702411">AV_OPT_TYPE_INT</a>, {.i64=-1}, -1, INT_MAX, .flags = <a class="code" href="vf__deshake_8c.html#a6ccad09b4a2a06ae178418fdccf5940d">FLAGS</a> },</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    { <span class="stringliteral">&quot;y&quot;</span>, <span class="stringliteral">&quot;set y for the rectangular search area&quot;</span>,      <a class="code" href="vf__deshake_8c.html#ad12dce0a7bf9d908b172a28155b3d261">OFFSET</a>(cy), <a class="code" href="group__avoptions.html#ggabd75aa30eb8ad6387672df9a1fa79444ac068b8f6afeeb293a13aeabb5d702411">AV_OPT_TYPE_INT</a>, {.i64=-1}, -1, INT_MAX, .flags = <a class="code" href="vf__deshake_8c.html#a6ccad09b4a2a06ae178418fdccf5940d">FLAGS</a> },</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    { <span class="stringliteral">&quot;w&quot;</span>, <span class="stringliteral">&quot;set width for the rectangular search area&quot;</span>,  <a class="code" href="vf__deshake_8c.html#ad12dce0a7bf9d908b172a28155b3d261">OFFSET</a>(cw), <a class="code" href="group__avoptions.html#ggabd75aa30eb8ad6387672df9a1fa79444ac068b8f6afeeb293a13aeabb5d702411">AV_OPT_TYPE_INT</a>, {.i64=-1}, -1, INT_MAX, .flags = <a class="code" href="vf__deshake_8c.html#a6ccad09b4a2a06ae178418fdccf5940d">FLAGS</a> },</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    { <span class="stringliteral">&quot;h&quot;</span>, <span class="stringliteral">&quot;set height for the rectangular search area&quot;</span>, <a class="code" href="vf__deshake_8c.html#ad12dce0a7bf9d908b172a28155b3d261">OFFSET</a>(ch), <a class="code" href="group__avoptions.html#ggabd75aa30eb8ad6387672df9a1fa79444ac068b8f6afeeb293a13aeabb5d702411">AV_OPT_TYPE_INT</a>, {.i64=-1}, -1, INT_MAX, .flags = <a class="code" href="vf__deshake_8c.html#a6ccad09b4a2a06ae178418fdccf5940d">FLAGS</a> },</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    { <span class="stringliteral">&quot;rx&quot;</span>, <span class="stringliteral">&quot;set x for the rectangular search area&quot;</span>,     <a class="code" href="vf__deshake_8c.html#ad12dce0a7bf9d908b172a28155b3d261">OFFSET</a>(rx), <a class="code" href="group__avoptions.html#ggabd75aa30eb8ad6387672df9a1fa79444ac068b8f6afeeb293a13aeabb5d702411">AV_OPT_TYPE_INT</a>, {.i64=16}, 0, <a class="code" href="deshake_8h.html#aebc02c5400ecf25b185fb5804e8ca88a">MAX_R</a>, .flags = <a class="code" href="vf__deshake_8c.html#a6ccad09b4a2a06ae178418fdccf5940d">FLAGS</a> },</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    { <span class="stringliteral">&quot;ry&quot;</span>, <span class="stringliteral">&quot;set y for the rectangular search area&quot;</span>,     <a class="code" href="vf__deshake_8c.html#ad12dce0a7bf9d908b172a28155b3d261">OFFSET</a>(ry), <a class="code" href="group__avoptions.html#ggabd75aa30eb8ad6387672df9a1fa79444ac068b8f6afeeb293a13aeabb5d702411">AV_OPT_TYPE_INT</a>, {.i64=16}, 0, <a class="code" href="deshake_8h.html#aebc02c5400ecf25b185fb5804e8ca88a">MAX_R</a>, .flags = <a class="code" href="vf__deshake_8c.html#a6ccad09b4a2a06ae178418fdccf5940d">FLAGS</a> },</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    { <span class="stringliteral">&quot;edge&quot;</span>, <span class="stringliteral">&quot;set edge mode&quot;</span>, <a class="code" href="vf__deshake_8c.html#ad12dce0a7bf9d908b172a28155b3d261">OFFSET</a>(edge), <a class="code" href="group__avoptions.html#ggabd75aa30eb8ad6387672df9a1fa79444ac068b8f6afeeb293a13aeabb5d702411">AV_OPT_TYPE_INT</a>, {.i64=<a class="code" href="transform_8h.html#af4d5243b6d8328548c892fc886768392a6a25bf8b2724eb544a2dbd84fff34b45">FILL_MIRROR</a>}, <a class="code" href="transform_8h.html#af4d5243b6d8328548c892fc886768392a50856ca498d2adde2a521ba661d5cd1c">FILL_BLANK</a>, <a class="code" href="transform_8h.html#af4d5243b6d8328548c892fc886768392a9b94f4ae4a71614bc55bbf53fccf7fe9">FILL_COUNT</a>-1, <a class="code" href="vf__deshake_8c.html#a6ccad09b4a2a06ae178418fdccf5940d">FLAGS</a>, <span class="stringliteral">&quot;edge&quot;</span>},</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        { <span class="stringliteral">&quot;blank&quot;</span>,    <span class="stringliteral">&quot;fill zeroes at blank locations&quot;</span>,         0, <a class="code" href="group__avoptions.html#ggabd75aa30eb8ad6387672df9a1fa79444a0fa9f07d428bdc32495fe55c365c5329">AV_OPT_TYPE_CONST</a>, {.i64=<a class="code" href="transform_8h.html#af4d5243b6d8328548c892fc886768392a50856ca498d2adde2a521ba661d5cd1c">FILL_BLANK</a>},    INT_MIN, INT_MAX, <a class="code" href="vf__deshake_8c.html#a6ccad09b4a2a06ae178418fdccf5940d">FLAGS</a>, <span class="stringliteral">&quot;edge&quot;</span> },</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        { <span class="stringliteral">&quot;original&quot;</span>, <span class="stringliteral">&quot;original image at blank locations&quot;</span>,      0, <a class="code" href="group__avoptions.html#ggabd75aa30eb8ad6387672df9a1fa79444a0fa9f07d428bdc32495fe55c365c5329">AV_OPT_TYPE_CONST</a>, {.i64=<a class="code" href="transform_8h.html#af4d5243b6d8328548c892fc886768392ae0120c83a90c5d1cb3f3dce4a71cb249">FILL_ORIGINAL</a>}, INT_MIN, INT_MAX, <a class="code" href="vf__deshake_8c.html#a6ccad09b4a2a06ae178418fdccf5940d">FLAGS</a>, <span class="stringliteral">&quot;edge&quot;</span> },</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        { <span class="stringliteral">&quot;clamp&quot;</span>,    <span class="stringliteral">&quot;extruded edge value at blank locations&quot;</span>, 0, <a class="code" href="group__avoptions.html#ggabd75aa30eb8ad6387672df9a1fa79444a0fa9f07d428bdc32495fe55c365c5329">AV_OPT_TYPE_CONST</a>, {.i64=<a class="code" href="transform_8h.html#af4d5243b6d8328548c892fc886768392aae9f7b288c817d8ef959d090fd0e9dbb">FILL_CLAMP</a>},    INT_MIN, INT_MAX, <a class="code" href="vf__deshake_8c.html#a6ccad09b4a2a06ae178418fdccf5940d">FLAGS</a>, <span class="stringliteral">&quot;edge&quot;</span> },</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        { <span class="stringliteral">&quot;mirror&quot;</span>,   <span class="stringliteral">&quot;mirrored edge at blank locations&quot;</span>,       0, <a class="code" href="group__avoptions.html#ggabd75aa30eb8ad6387672df9a1fa79444a0fa9f07d428bdc32495fe55c365c5329">AV_OPT_TYPE_CONST</a>, {.i64=<a class="code" href="transform_8h.html#af4d5243b6d8328548c892fc886768392a6a25bf8b2724eb544a2dbd84fff34b45">FILL_MIRROR</a>},   INT_MIN, INT_MAX, <a class="code" href="vf__deshake_8c.html#a6ccad09b4a2a06ae178418fdccf5940d">FLAGS</a>, <span class="stringliteral">&quot;edge&quot;</span> },</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    { <span class="stringliteral">&quot;blocksize&quot;</span>, <span class="stringliteral">&quot;set motion search blocksize&quot;</span>,       <a class="code" href="vf__deshake_8c.html#ad12dce0a7bf9d908b172a28155b3d261">OFFSET</a>(blocksize), <a class="code" href="group__avoptions.html#ggabd75aa30eb8ad6387672df9a1fa79444ac068b8f6afeeb293a13aeabb5d702411">AV_OPT_TYPE_INT</a>, {.i64=8},   4, 128, .flags = <a class="code" href="vf__deshake_8c.html#a6ccad09b4a2a06ae178418fdccf5940d">FLAGS</a> },</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    { <span class="stringliteral">&quot;contrast&quot;</span>,  <span class="stringliteral">&quot;set contrast threshold for blocks&quot;</span>, <a class="code" href="vf__deshake_8c.html#ad12dce0a7bf9d908b172a28155b3d261">OFFSET</a>(contrast),  <a class="code" href="group__avoptions.html#ggabd75aa30eb8ad6387672df9a1fa79444ac068b8f6afeeb293a13aeabb5d702411">AV_OPT_TYPE_INT</a>, {.i64=125}, 1, 255, .flags = <a class="code" href="vf__deshake_8c.html#a6ccad09b4a2a06ae178418fdccf5940d">FLAGS</a> },</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    { <span class="stringliteral">&quot;search&quot;</span>,  <span class="stringliteral">&quot;set search strategy&quot;</span>, <a class="code" href="vf__deshake_8c.html#ad12dce0a7bf9d908b172a28155b3d261">OFFSET</a>(<a class="code" href="vf__find__rect_8c.html#af87d9de85f8aed850024a07b377fe315">search</a>), <a class="code" href="group__avoptions.html#ggabd75aa30eb8ad6387672df9a1fa79444ac068b8f6afeeb293a13aeabb5d702411">AV_OPT_TYPE_INT</a>, {.i64=<a class="code" href="deshake_8h.html#abd60910b52e9fd2a0b8f4b030183f02ca7fc6856beca4e0f17a909d5445fcda71">EXHAUSTIVE</a>}, <a class="code" href="deshake_8h.html#abd60910b52e9fd2a0b8f4b030183f02ca7fc6856beca4e0f17a909d5445fcda71">EXHAUSTIVE</a>, <a class="code" href="deshake_8h.html#abd60910b52e9fd2a0b8f4b030183f02ca1d1c0640efc4301d2e764b00b0ab2763">SEARCH_COUNT</a>-1, <a class="code" href="vf__deshake_8c.html#a6ccad09b4a2a06ae178418fdccf5940d">FLAGS</a>, <span class="stringliteral">&quot;smode&quot;</span> },</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        { <span class="stringliteral">&quot;exhaustive&quot;</span>, <span class="stringliteral">&quot;exhaustive search&quot;</span>,      0, <a class="code" href="group__avoptions.html#ggabd75aa30eb8ad6387672df9a1fa79444a0fa9f07d428bdc32495fe55c365c5329">AV_OPT_TYPE_CONST</a>, {.i64=<a class="code" href="deshake_8h.html#abd60910b52e9fd2a0b8f4b030183f02ca7fc6856beca4e0f17a909d5445fcda71">EXHAUSTIVE</a>},       INT_MIN, INT_MAX, <a class="code" href="vf__deshake_8c.html#a6ccad09b4a2a06ae178418fdccf5940d">FLAGS</a>, <span class="stringliteral">&quot;smode&quot;</span> },</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        { <span class="stringliteral">&quot;less&quot;</span>,       <span class="stringliteral">&quot;less exhaustive search&quot;</span>, 0, <a class="code" href="group__avoptions.html#ggabd75aa30eb8ad6387672df9a1fa79444a0fa9f07d428bdc32495fe55c365c5329">AV_OPT_TYPE_CONST</a>, {.i64=<a class="code" href="deshake_8h.html#abd60910b52e9fd2a0b8f4b030183f02ca26c5472355765851213d23cd291e4af7">SMART_EXHAUSTIVE</a>}, INT_MIN, INT_MAX, <a class="code" href="vf__deshake_8c.html#a6ccad09b4a2a06ae178418fdccf5940d">FLAGS</a>, <span class="stringliteral">&quot;smode&quot;</span> },</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    { <span class="stringliteral">&quot;filename&quot;</span>, <span class="stringliteral">&quot;set motion search detailed log file name&quot;</span>, <a class="code" href="vf__deshake_8c.html#ad12dce0a7bf9d908b172a28155b3d261">OFFSET</a>(filename), <a class="code" href="group__avoptions.html#ggabd75aa30eb8ad6387672df9a1fa79444afadddce95ad3b690dd38644b458b96c4">AV_OPT_TYPE_STRING</a>, {.str=<a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>}, .flags = <a class="code" href="vf__deshake_8c.html#a6ccad09b4a2a06ae178418fdccf5940d">FLAGS</a> },</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    { <span class="stringliteral">&quot;opencl&quot;</span>, <span class="stringliteral">&quot;ignored&quot;</span>,                              <a class="code" href="vf__deshake_8c.html#ad12dce0a7bf9d908b172a28155b3d261">OFFSET</a>(opencl), <a class="code" href="group__avoptions.html#ggabd75aa30eb8ad6387672df9a1fa79444af3898696f46dc79b74b708d8fa4b52a7">AV_OPT_TYPE_BOOL</a>, {.i64=0}, 0, 1, .flags = <a class="code" href="vf__deshake_8c.html#a6ccad09b4a2a06ae178418fdccf5940d">FLAGS</a> },</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    { <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;};</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="vf__deshake_8c.html#aab22bd58952aaae386b1e791eb38bcfd">   89</a></span>&#160;<a class="code" href="vf__deshake_8c.html#aab22bd58952aaae386b1e791eb38bcfd">AVFILTER_DEFINE_CLASS</a>(deshake);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="vf__deshake_8c.html#a6f91b4cd1af5dc277444c465e2ca3ab6">   91</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="vf__deshake_8c.html#a6f91b4cd1af5dc277444c465e2ca3ab6">cmp</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="undefined_8txt.html#ad99f336d4c117c453fef82993434eb4d">a</a>, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="input_8c.html#ad6cdb6a14abe3eab42eaaadc93409aec">b</a>)</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;{</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="common_8h.html#add8913a6f8e5714b6174eeaad5751006">FFDIFFSIGN</a>(*(<span class="keyword">const</span> <span class="keywordtype">double</span> *)<a class="code" href="undefined_8txt.html#ad99f336d4c117c453fef82993434eb4d">a</a>, *(<span class="keyword">const</span> <span class="keywordtype">double</span> *)<a class="code" href="input_8c.html#ad6cdb6a14abe3eab42eaaadc93409aec">b</a>);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;}</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="vf__deshake_8c.html#a3e236414798d891d2ffed620dc2d3dba">   99</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="vf__deshake_8c.html#a3e236414798d891d2ffed620dc2d3dba">clean_mean</a>(<span class="keywordtype">double</span> *<a class="code" href="filter__design_8txt.html#ad283c679febe22c5a4d36e3764daf32b">values</a>, <span class="keywordtype">int</span> count)</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;{</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordtype">double</span> mean = 0;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordtype">int</span> cut = count / 5;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordtype">int</span> x;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="qsort_8h.html#a5a4ed81988ea43d4cca5bfe9a18147f6">AV_QSORT</a>(<a class="code" href="filter__design_8txt.html#ad283c679febe22c5a4d36e3764daf32b">values</a>, count, <span class="keywordtype">double</span>, <a class="code" href="vf__deshake_8c.html#a6f91b4cd1af5dc277444c465e2ca3ab6">cmp</a>);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordflow">for</span> (x = cut; x &lt; count - cut; x++) {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        mean += <a class="code" href="filter__design_8txt.html#ad283c679febe22c5a4d36e3764daf32b">values</a>[x];</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">return</span> mean / (count - cut * 2);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;}</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="vf__deshake_8c.html#adc52044925d04f6334b3b436c454f793">  120</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="vf__deshake_8c.html#adc52044925d04f6334b3b436c454f793">find_block_motion</a>(<a class="code" href="struct_deshake_context.html">DeshakeContext</a> *deshake, <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *<a class="code" href="tests_2checkasm_2h264pred_8c.html#a631c6befc8ec221896734437f964a631">src1</a>,</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                              <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *src2, <span class="keywordtype">int</span> cx, <span class="keywordtype">int</span> cy, <span class="keywordtype">int</span> <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>,</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                              <a class="code" href="struct_int_motion_vector.html">IntMotionVector</a> *<a class="code" href="libavcodec_24xm_8c.html#a19c59215a57cc549287f6d8481937b12">mv</a>)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;{</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordtype">int</span> x, y;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="vf__palettegen_8c.html#a0fa5abf62b01f8a592bca729cb14390b">diff</a>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordtype">int</span> smallest = INT_MAX;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordtype">int</span> tmp, tmp2;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="preprocessor">    #define CMP(i, j) deshake-&gt;sad(src1 + cy  * stride + cx,  stride,\</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="preprocessor">                                   src2 + (j) * stride + (i), stride)</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">if</span> (deshake-&gt;<a class="code" href="struct_deshake_context.html#ac1204397baeebe361b27575bb7bcd941">search</a> == <a class="code" href="deshake_8h.html#abd60910b52e9fd2a0b8f4b030183f02ca7fc6856beca4e0f17a909d5445fcda71">EXHAUSTIVE</a>) {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="comment">// Compare every possible position - this is sloooow!</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordflow">for</span> (y = -deshake-&gt;<a class="code" href="struct_deshake_context.html#abdb580132fa6a0e8412667fa7c285bce">ry</a>; y &lt;= deshake-&gt;ry; y++) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <span class="keywordflow">for</span> (x = -deshake-&gt;<a class="code" href="struct_deshake_context.html#aad54a481fde4715adc86c3ba4be8a02b">rx</a>; x &lt;= deshake-&gt;rx; x++) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                <a class="code" href="vf__palettegen_8c.html#a0fa5abf62b01f8a592bca729cb14390b">diff</a> = <a class="code" href="vf__deshake_8c.html#aaf5d3ea2fc8c31e0b02d3dd6fd96fc7e">CMP</a>(cx - x, cy - y);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="vf__palettegen_8c.html#a0fa5abf62b01f8a592bca729cb14390b">diff</a> &lt; smallest) {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                    smallest = <a class="code" href="vf__palettegen_8c.html#a0fa5abf62b01f8a592bca729cb14390b">diff</a>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                    <a class="code" href="libavcodec_24xm_8c.html#a19c59215a57cc549287f6d8481937b12">mv</a>-&gt;x = x;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                    <a class="code" href="libavcodec_24xm_8c.html#a19c59215a57cc549287f6d8481937b12">mv</a>-&gt;y = y;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (deshake-&gt;<a class="code" href="struct_deshake_context.html#ac1204397baeebe361b27575bb7bcd941">search</a> == <a class="code" href="deshake_8h.html#abd60910b52e9fd2a0b8f4b030183f02ca26c5472355765851213d23cd291e4af7">SMART_EXHAUSTIVE</a>) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="comment">// Compare every other possible position and find the best match</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordflow">for</span> (y = -deshake-&gt;<a class="code" href="struct_deshake_context.html#abdb580132fa6a0e8412667fa7c285bce">ry</a> + 1; y &lt; deshake-&gt;ry; y += 2) {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            <span class="keywordflow">for</span> (x = -deshake-&gt;<a class="code" href="struct_deshake_context.html#aad54a481fde4715adc86c3ba4be8a02b">rx</a> + 1; x &lt; deshake-&gt;rx; x += 2) {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                <a class="code" href="vf__palettegen_8c.html#a0fa5abf62b01f8a592bca729cb14390b">diff</a> = <a class="code" href="vf__deshake_8c.html#aaf5d3ea2fc8c31e0b02d3dd6fd96fc7e">CMP</a>(cx - x, cy - y);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="vf__palettegen_8c.html#a0fa5abf62b01f8a592bca729cb14390b">diff</a> &lt; smallest) {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                    smallest = <a class="code" href="vf__palettegen_8c.html#a0fa5abf62b01f8a592bca729cb14390b">diff</a>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                    <a class="code" href="libavcodec_24xm_8c.html#a19c59215a57cc549287f6d8481937b12">mv</a>-&gt;x = x;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                    <a class="code" href="libavcodec_24xm_8c.html#a19c59215a57cc549287f6d8481937b12">mv</a>-&gt;y = y;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="comment">// Hone in on the specific best match around the match we found above</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        tmp = <a class="code" href="libavcodec_24xm_8c.html#a19c59215a57cc549287f6d8481937b12">mv</a>-&gt;x;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        tmp2 = <a class="code" href="libavcodec_24xm_8c.html#a19c59215a57cc549287f6d8481937b12">mv</a>-&gt;y;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">for</span> (y = tmp2 - 1; y &lt;= tmp2 + 1; y++) {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <span class="keywordflow">for</span> (x = tmp - 1; x &lt;= tmp + 1; x++) {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                <span class="keywordflow">if</span> (x == tmp &amp;&amp; y == tmp2)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                <a class="code" href="vf__palettegen_8c.html#a0fa5abf62b01f8a592bca729cb14390b">diff</a> = <a class="code" href="vf__deshake_8c.html#aaf5d3ea2fc8c31e0b02d3dd6fd96fc7e">CMP</a>(cx - x, cy - y);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="vf__palettegen_8c.html#a0fa5abf62b01f8a592bca729cb14390b">diff</a> &lt; smallest) {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                    smallest = <a class="code" href="vf__palettegen_8c.html#a0fa5abf62b01f8a592bca729cb14390b">diff</a>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                    <a class="code" href="libavcodec_24xm_8c.html#a19c59215a57cc549287f6d8481937b12">mv</a>-&gt;x = x;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                    <a class="code" href="libavcodec_24xm_8c.html#a19c59215a57cc549287f6d8481937b12">mv</a>-&gt;y = y;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordflow">if</span> (smallest &gt; 512) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <a class="code" href="libavcodec_24xm_8c.html#a19c59215a57cc549287f6d8481937b12">mv</a>-&gt;x = -1;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <a class="code" href="libavcodec_24xm_8c.html#a19c59215a57cc549287f6d8481937b12">mv</a>-&gt;y = -1;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="libavutil_2internal_8h.html#ae59bb66df9495df417c2632403e23aa7">emms_c</a>();</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">//av_log(NULL, AV_LOG_ERROR, &quot;%d\n&quot;, smallest);</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">//av_log(NULL, AV_LOG_ERROR, &quot;Final: (%d, %d) = %d x %d\n&quot;, cx, cy, mv-&gt;x, mv-&gt;y);</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;}</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="vf__deshake_8c.html#aecfebc764eb913f6445cc9fffd51948f">  190</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="vf__deshake_8c.html#aecfebc764eb913f6445cc9fffd51948f">block_contrast</a>(<a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <span class="keywordtype">int</span> blocksize)</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;{</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordtype">int</span> highest = 0;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordtype">int</span> lowest = 255;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, j, <a class="code" href="spdifenc_8c.html#addcb93d939ffa259ff1d9247bdd590fd">pos</a>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;= blocksize * 2; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="comment">// We use a width of 16 here to match the sad function</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt;= 15; j++) {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <a class="code" href="spdifenc_8c.html#addcb93d939ffa259ff1d9247bdd590fd">pos</a> = (y + <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>) * <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a> + (x + j);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>[<a class="code" href="spdifenc_8c.html#addcb93d939ffa259ff1d9247bdd590fd">pos</a>] &lt; lowest)</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                lowest = <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>[<a class="code" href="spdifenc_8c.html#addcb93d939ffa259ff1d9247bdd590fd">pos</a>];</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>[<a class="code" href="spdifenc_8c.html#addcb93d939ffa259ff1d9247bdd590fd">pos</a>] &gt; highest) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                highest = <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>[<a class="code" href="spdifenc_8c.html#addcb93d939ffa259ff1d9247bdd590fd">pos</a>];</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">return</span> highest - lowest;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;}</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="vf__deshake_8c.html#aa24bf614ee38d45bcf498a6ab95d5bec">  214</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="vf__deshake_8c.html#aa24bf614ee38d45bcf498a6ab95d5bec">block_angle</a>(<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> cx, <span class="keywordtype">int</span> cy, <a class="code" href="struct_int_motion_vector.html">IntMotionVector</a> *<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>)</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;{</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="regdef_8h.html#ab89a77e63a7226fffaecb2e2c2ab5219">a1</a>, <a class="code" href="regdef_8h.html#aa3fd046b2956875cf908d73a51a96b42">a2</a>, <a class="code" href="vf__palettegen_8c.html#a0fa5abf62b01f8a592bca729cb14390b">diff</a>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="regdef_8h.html#ab89a77e63a7226fffaecb2e2c2ab5219">a1</a> = atan2(y - cy, x - cx);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <a class="code" href="regdef_8h.html#aa3fd046b2956875cf908d73a51a96b42">a2</a> = atan2(y - cy + <a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>-&gt;y, x - cx + <a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>-&gt;x);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="vf__palettegen_8c.html#a0fa5abf62b01f8a592bca729cb14390b">diff</a> = <a class="code" href="regdef_8h.html#aa3fd046b2956875cf908d73a51a96b42">a2</a> - <a class="code" href="regdef_8h.html#ab89a77e63a7226fffaecb2e2c2ab5219">a1</a>;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="vf__palettegen_8c.html#a0fa5abf62b01f8a592bca729cb14390b">diff</a> &gt; <a class="code" href="mathematics_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>)  ? <a class="code" href="vf__palettegen_8c.html#a0fa5abf62b01f8a592bca729cb14390b">diff</a> - 2 * <a class="code" href="mathematics_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> :</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;           (<a class="code" href="vf__palettegen_8c.html#a0fa5abf62b01f8a592bca729cb14390b">diff</a> &lt; -<a class="code" href="mathematics_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>) ? <a class="code" href="vf__palettegen_8c.html#a0fa5abf62b01f8a592bca729cb14390b">diff</a> + 2 * <a class="code" href="mathematics_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> :</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;           <a class="code" href="vf__palettegen_8c.html#a0fa5abf62b01f8a592bca729cb14390b">diff</a>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;}</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno"><a class="line" href="vf__deshake_8c.html#ae2332ccfbd43fd6b49ae6c5ba8095b20">  235</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="vf__deshake_8c.html#ae2332ccfbd43fd6b49ae6c5ba8095b20">find_motion</a>(<a class="code" href="struct_deshake_context.html">DeshakeContext</a> *deshake, <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *<a class="code" href="tests_2checkasm_2h264pred_8c.html#a631c6befc8ec221896734437f964a631">src1</a>, <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *src2,</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                        <span class="keywordtype">int</span> <a class="code" href="tests_2snowenc_8c.html#a667b04d7fb6ef46db4da4af554c5b6f7">width</a>, <span class="keywordtype">int</span> <a class="code" href="tests_2snowenc_8c.html#a64f9f90ece96c7bab4aee3deacf170e0">height</a>, <span class="keywordtype">int</span> <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <a class="code" href="struct_transform.html">Transform</a> *t)</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;{</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordtype">int</span> x, y;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <a class="code" href="struct_int_motion_vector.html">IntMotionVector</a> <a class="code" href="libavcodec_24xm_8c.html#a19c59215a57cc549287f6d8481937b12">mv</a> = {0, 0};</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordtype">int</span> count_max_value = 0;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordtype">int</span> contrast;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="spdifenc_8c.html#addcb93d939ffa259ff1d9247bdd590fd">pos</a>;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordtype">int</span> center_x = 0, center_y = 0;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordtype">double</span> p_x, p_y;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="group__lavu__mem__funcs.html#ga29d0252b981f157e713a68ffca52f003">av_fast_malloc</a>(&amp;deshake-&gt;<a class="code" href="struct_deshake_context.html#a39cf8679c55ae0d64be2772a8dcc3931">angles</a>, &amp;deshake-&gt;<a class="code" href="struct_deshake_context.html#a8e577f2fe633ed2454362438ad5a6d84">angles_size</a>, <a class="code" href="tests_2snowenc_8c.html#a667b04d7fb6ef46db4da4af554c5b6f7">width</a> * <a class="code" href="tests_2snowenc_8c.html#a64f9f90ece96c7bab4aee3deacf170e0">height</a> / (16 * deshake-&gt;<a class="code" href="struct_deshake_context.html#a9484b0ef1ba673ffdb2ebc437aaf4c04">blocksize</a>) * <span class="keyword">sizeof</span>(*deshake-&gt;<a class="code" href="struct_deshake_context.html#a39cf8679c55ae0d64be2772a8dcc3931">angles</a>));</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">// Reset counts to zero</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">for</span> (x = 0; x &lt; deshake-&gt;<a class="code" href="struct_deshake_context.html#aad54a481fde4715adc86c3ba4be8a02b">rx</a> * 2 + 1; x++) {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keywordflow">for</span> (y = 0; y &lt; deshake-&gt;<a class="code" href="struct_deshake_context.html#abdb580132fa6a0e8412667fa7c285bce">ry</a> * 2 + 1; y++) {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            deshake-&gt;<a class="code" href="struct_deshake_context.html#abd5ea6e330026e31b16a5183ebaf9543">counts</a>[x][y] = 0;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <a class="code" href="spdifenc_8c.html#addcb93d939ffa259ff1d9247bdd590fd">pos</a> = 0;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="comment">// Find motion for every block and store the motion vector in the counts</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordflow">for</span> (y = deshake-&gt;<a class="code" href="struct_deshake_context.html#abdb580132fa6a0e8412667fa7c285bce">ry</a>; y &lt; height - deshake-&gt;ry - (deshake-&gt;<a class="code" href="struct_deshake_context.html#a9484b0ef1ba673ffdb2ebc437aaf4c04">blocksize</a> * 2); y += deshake-&gt;<a class="code" href="struct_deshake_context.html#a9484b0ef1ba673ffdb2ebc437aaf4c04">blocksize</a> * 2) {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="comment">// We use a width of 16 here to match the sad function</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="keywordflow">for</span> (x = deshake-&gt;<a class="code" href="struct_deshake_context.html#aad54a481fde4715adc86c3ba4be8a02b">rx</a>; x &lt; width - deshake-&gt;rx - 16; x += 16) {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <span class="comment">// If the contrast is too low, just skip this block as it probably</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <span class="comment">// won&#39;t be very useful to us.</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            contrast = <a class="code" href="vf__deshake_8c.html#aecfebc764eb913f6445cc9fffd51948f">block_contrast</a>(src2, x, y, <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, deshake-&gt;<a class="code" href="struct_deshake_context.html#a9484b0ef1ba673ffdb2ebc437aaf4c04">blocksize</a>);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            <span class="keywordflow">if</span> (contrast &gt; deshake-&gt;<a class="code" href="struct_deshake_context.html#af2743a76120cd89fe70274050c969848">contrast</a>) {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                <span class="comment">//av_log(NULL, AV_LOG_ERROR, &quot;%d\n&quot;, contrast);</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                <a class="code" href="vf__deshake_8c.html#adc52044925d04f6334b3b436c454f793">find_block_motion</a>(deshake, <a class="code" href="tests_2checkasm_2h264pred_8c.html#a631c6befc8ec221896734437f964a631">src1</a>, src2, x, y, <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, &amp;<a class="code" href="libavcodec_24xm_8c.html#a19c59215a57cc549287f6d8481937b12">mv</a>);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="libavcodec_24xm_8c.html#a19c59215a57cc549287f6d8481937b12">mv</a>.x != -1 &amp;&amp; <a class="code" href="libavcodec_24xm_8c.html#a19c59215a57cc549287f6d8481937b12">mv</a>.y != -1) {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                    deshake-&gt;<a class="code" href="struct_deshake_context.html#abd5ea6e330026e31b16a5183ebaf9543">counts</a>[<a class="code" href="libavcodec_24xm_8c.html#a19c59215a57cc549287f6d8481937b12">mv</a>.x + deshake-&gt;<a class="code" href="struct_deshake_context.html#aad54a481fde4715adc86c3ba4be8a02b">rx</a>][<a class="code" href="libavcodec_24xm_8c.html#a19c59215a57cc549287f6d8481937b12">mv</a>.y + deshake-&gt;<a class="code" href="struct_deshake_context.html#abdb580132fa6a0e8412667fa7c285bce">ry</a>] += 1;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                    <span class="keywordflow">if</span> (x &gt; deshake-&gt;<a class="code" href="struct_deshake_context.html#aad54a481fde4715adc86c3ba4be8a02b">rx</a> &amp;&amp; y &gt; deshake-&gt;<a class="code" href="struct_deshake_context.html#abdb580132fa6a0e8412667fa7c285bce">ry</a>)</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                        deshake-&gt;<a class="code" href="struct_deshake_context.html#a39cf8679c55ae0d64be2772a8dcc3931">angles</a>[<a class="code" href="spdifenc_8c.html#addcb93d939ffa259ff1d9247bdd590fd">pos</a>++] = <a class="code" href="vf__deshake_8c.html#aa24bf614ee38d45bcf498a6ab95d5bec">block_angle</a>(x, y, 0, 0, &amp;<a class="code" href="libavcodec_24xm_8c.html#a19c59215a57cc549287f6d8481937b12">mv</a>);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                    center_x += <a class="code" href="libavcodec_24xm_8c.html#a19c59215a57cc549287f6d8481937b12">mv</a>.x;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                    center_y += <a class="code" href="libavcodec_24xm_8c.html#a19c59215a57cc549287f6d8481937b12">mv</a>.y;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="spdifenc_8c.html#addcb93d939ffa259ff1d9247bdd590fd">pos</a>) {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;         center_x /= <a class="code" href="spdifenc_8c.html#addcb93d939ffa259ff1d9247bdd590fd">pos</a>;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;         center_y /= <a class="code" href="spdifenc_8c.html#addcb93d939ffa259ff1d9247bdd590fd">pos</a>;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;         t-&gt;<a class="code" href="struct_transform.html#a476a0c4f5ca9d7928241a69130090820">angle</a> = <a class="code" href="vf__deshake_8c.html#a3e236414798d891d2ffed620dc2d3dba">clean_mean</a>(deshake-&gt;<a class="code" href="struct_deshake_context.html#a39cf8679c55ae0d64be2772a8dcc3931">angles</a>, <a class="code" href="spdifenc_8c.html#addcb93d939ffa259ff1d9247bdd590fd">pos</a>);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;         <span class="keywordflow">if</span> (t-&gt;<a class="code" href="struct_transform.html#a476a0c4f5ca9d7928241a69130090820">angle</a> &lt; 0.001)</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;              t-&gt;<a class="code" href="struct_transform.html#a476a0c4f5ca9d7928241a69130090820">angle</a> = 0;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;         t-&gt;<a class="code" href="struct_transform.html#a476a0c4f5ca9d7928241a69130090820">angle</a> = 0;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    }</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">// Find the most common motion vector in the frame and use it as the gmv</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">for</span> (y = deshake-&gt;<a class="code" href="struct_deshake_context.html#abdb580132fa6a0e8412667fa7c285bce">ry</a> * 2; y &gt;= 0; y--) {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="keywordflow">for</span> (x = 0; x &lt; deshake-&gt;<a class="code" href="struct_deshake_context.html#aad54a481fde4715adc86c3ba4be8a02b">rx</a> * 2 + 1; x++) {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            <span class="comment">//av_log(NULL, AV_LOG_ERROR, &quot;%5d &quot;, deshake-&gt;counts[x][y]);</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            <span class="keywordflow">if</span> (deshake-&gt;<a class="code" href="struct_deshake_context.html#abd5ea6e330026e31b16a5183ebaf9543">counts</a>[x][y] &gt; count_max_value) {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                t-&gt;<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#a925fd96d0d9fe4920a2c788633e161d3">x</a> = x - deshake-&gt;<a class="code" href="struct_deshake_context.html#aad54a481fde4715adc86c3ba4be8a02b">rx</a>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                t-&gt;<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#ac6abeed7e7362852e8b9b5b2dd0d7eac">y</a> = y - deshake-&gt;<a class="code" href="struct_deshake_context.html#abdb580132fa6a0e8412667fa7c285bce">ry</a>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                count_max_value = deshake-&gt;<a class="code" href="struct_deshake_context.html#abd5ea6e330026e31b16a5183ebaf9543">counts</a>[x][y];</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        }</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="comment">//av_log(NULL, AV_LOG_ERROR, &quot;\n&quot;);</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    p_x = (center_x - <a class="code" href="tests_2snowenc_8c.html#a667b04d7fb6ef46db4da4af554c5b6f7">width</a> / 2.0);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    p_y = (center_y - <a class="code" href="tests_2snowenc_8c.html#a64f9f90ece96c7bab4aee3deacf170e0">height</a> / 2.0);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    t-&gt;<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#a925fd96d0d9fe4920a2c788633e161d3">x</a> += (cos(t-&gt;<a class="code" href="struct_transform.html#a476a0c4f5ca9d7928241a69130090820">angle</a>)-1)*p_x  - sin(t-&gt;<a class="code" href="struct_transform.html#a476a0c4f5ca9d7928241a69130090820">angle</a>)*p_y;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    t-&gt;<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#ac6abeed7e7362852e8b9b5b2dd0d7eac">y</a> += sin(t-&gt;<a class="code" href="struct_transform.html#a476a0c4f5ca9d7928241a69130090820">angle</a>)*p_x  + (cos(t-&gt;<a class="code" href="struct_transform.html#a476a0c4f5ca9d7928241a69130090820">angle</a>)-1)*p_y;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="comment">// Clamp max shift &amp; rotation?</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    t-&gt;<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#a925fd96d0d9fe4920a2c788633e161d3">x</a> = av_clipf(t-&gt;<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#a925fd96d0d9fe4920a2c788633e161d3">x</a>, -deshake-&gt;<a class="code" href="struct_deshake_context.html#aad54a481fde4715adc86c3ba4be8a02b">rx</a> * 2, deshake-&gt;<a class="code" href="struct_deshake_context.html#aad54a481fde4715adc86c3ba4be8a02b">rx</a> * 2);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    t-&gt;<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#ac6abeed7e7362852e8b9b5b2dd0d7eac">y</a> = av_clipf(t-&gt;<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#ac6abeed7e7362852e8b9b5b2dd0d7eac">y</a>, -deshake-&gt;<a class="code" href="struct_deshake_context.html#abdb580132fa6a0e8412667fa7c285bce">ry</a> * 2, deshake-&gt;<a class="code" href="struct_deshake_context.html#abdb580132fa6a0e8412667fa7c285bce">ry</a> * 2);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    t-&gt;<a class="code" href="struct_transform.html#a476a0c4f5ca9d7928241a69130090820">angle</a> = av_clipf(t-&gt;<a class="code" href="struct_transform.html#a476a0c4f5ca9d7928241a69130090820">angle</a>, -0.1, 0.1);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">//av_log(NULL, AV_LOG_ERROR, &quot;%d x %d\n&quot;, avg-&gt;x, avg-&gt;y);</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;}</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno"><a class="line" href="vf__deshake_8c.html#a11ba010a44de95305c0b0d7cc30cebe4">  315</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="vf__deshake_8c.html#a11ba010a44de95305c0b0d7cc30cebe4">deshake_transform_c</a>(<a class="code" href="struct_a_v_filter_context.html">AVFilterContext</a> *<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>,</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                                    <span class="keywordtype">int</span> <a class="code" href="tests_2snowenc_8c.html#a667b04d7fb6ef46db4da4af554c5b6f7">width</a>, <span class="keywordtype">int</span> <a class="code" href="tests_2snowenc_8c.html#a64f9f90ece96c7bab4aee3deacf170e0">height</a>, <span class="keywordtype">int</span> cw, <span class="keywordtype">int</span> ch,</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">float</span> *matrix_y, <span class="keyword">const</span> <span class="keywordtype">float</span> *matrix_uv,</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                                    <span class="keyword">enum</span> <a class="code" href="transform_8h.html#a242ace442acd0d243c565f62f422c13e">InterpolateMethod</a> <a class="code" href="twinvq_8c.html#ab0bd3e2f6305dfc9119c47f412993f92">interpolate</a>,</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                                    <span class="keyword">enum</span> <a class="code" href="transform_8h.html#af4d5243b6d8328548c892fc886768392">FillMethod</a> fill, <a class="code" href="struct_a_v_frame.html">AVFrame</a> *<a class="code" href="audio__convert_8c.html#ab92ad91055387e15b43ff5f6f60f2895">in</a>, <a class="code" href="struct_a_v_frame.html">AVFrame</a> *<a class="code" href="tests_2movenc_8c.html#a1277960b5f2b37137fe9b0b5a1ea0beb">out</a>)</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;{</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = 0;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> *matrixs[3];</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordtype">int</span> plane_w[3], plane_h[3];</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    matrixs[0] = matrix_y;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    matrixs[1] =  matrixs[2] = matrix_uv;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    plane_w[0] = <a class="code" href="tests_2snowenc_8c.html#a667b04d7fb6ef46db4da4af554c5b6f7">width</a>;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    plane_w[1] = plane_w[2] = cw;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    plane_h[0] = <a class="code" href="tests_2snowenc_8c.html#a64f9f90ece96c7bab4aee3deacf170e0">height</a>;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    plane_h[1] = plane_h[2] = ch;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 3; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="comment">// Transform the luma and chroma planes</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = <a class="code" href="transform_8c.html#a9a8feed22ff382abfee7b1a21e132f90">avfilter_transform</a>(<a class="code" href="audio__convert_8c.html#ab92ad91055387e15b43ff5f6f60f2895">in</a>-&gt;data[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>], <a class="code" href="tests_2movenc_8c.html#a1277960b5f2b37137fe9b0b5a1ea0beb">out</a>-&gt;data[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>], <a class="code" href="audio__convert_8c.html#ab92ad91055387e15b43ff5f6f60f2895">in</a>-&gt;linesize[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>], <a class="code" href="tests_2movenc_8c.html#a1277960b5f2b37137fe9b0b5a1ea0beb">out</a>-&gt;linesize[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>],</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                                 plane_w[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>], plane_h[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>], matrixs[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>], <a class="code" href="twinvq_8c.html#ab0bd3e2f6305dfc9119c47f412993f92">interpolate</a>, fill);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> &lt; 0)</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    }</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;}</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno"><a class="line" href="vf__deshake_8c.html#ab7cd5b404747a481115ce1d090fd11b8">  341</a></span>&#160;<span class="keyword">static</span> <a class="code" href="attributes_8h.html#abeeb324fff79a5335d36774704e2475c">av_cold</a> <span class="keywordtype">int</span> <a class="code" href="vf__deshake_8c.html#ab7cd5b404747a481115ce1d090fd11b8">init</a>(<a class="code" href="struct_a_v_filter_context.html">AVFilterContext</a> *<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>)</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;{</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <a class="code" href="struct_deshake_context.html">DeshakeContext</a> *deshake = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;priv;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    deshake-&gt;<a class="code" href="struct_deshake_context.html#aed2e1801e9b077c1c4bf1016513e8a14">refcount</a> = 20; <span class="comment">// XXX: add to options?</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    deshake-&gt;<a class="code" href="struct_deshake_context.html#a9484b0ef1ba673ffdb2ebc437aaf4c04">blocksize</a> /= 2;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    deshake-&gt;<a class="code" href="struct_deshake_context.html#a9484b0ef1ba673ffdb2ebc437aaf4c04">blocksize</a> = av_clip(deshake-&gt;<a class="code" href="struct_deshake_context.html#a9484b0ef1ba673ffdb2ebc437aaf4c04">blocksize</a>, 4, 128);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keywordflow">if</span> (deshake-&gt;<a class="code" href="struct_deshake_context.html#aad54a481fde4715adc86c3ba4be8a02b">rx</a> % 16) {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;rx must be a multiple of 16\n&quot;</span>);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__lavu__error.html#ga67a27567a9e5b7037fee072fbcc34dbf">AVERROR_PATCHWELCOME</a>;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordflow">if</span> (deshake-&gt;<a class="code" href="struct_deshake_context.html#ac00c0833eb48d7a062dc599400acd4c1">filename</a>)</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        deshake-&gt;<a class="code" href="struct_deshake_context.html#a40de303d95ecd35d7210de190a0ad73d">fp</a> = fopen(deshake-&gt;<a class="code" href="struct_deshake_context.html#ac00c0833eb48d7a062dc599400acd4c1">filename</a>, <span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordflow">if</span> (deshake-&gt;<a class="code" href="struct_deshake_context.html#a40de303d95ecd35d7210de190a0ad73d">fp</a>)</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        fwrite(<span class="stringliteral">&quot;Ori x, Avg x, Fin x, Ori y, Avg y, Fin y, Ori angle, Avg angle, Fin angle, Ori zoom, Avg zoom, Fin zoom\n&quot;</span>, 1, 104, deshake-&gt;<a class="code" href="struct_deshake_context.html#a40de303d95ecd35d7210de190a0ad73d">fp</a>);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">// Quadword align left edge of box for MMX code, adjust width if necessary</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="comment">// to keep right margin</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordflow">if</span> (deshake-&gt;<a class="code" href="struct_deshake_context.html#aaaf79f33599d26f511c835b30f18d02a">cx</a> &gt; 0) {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        deshake-&gt;<a class="code" href="struct_deshake_context.html#a502b5256842d4ed130aa346fa1bd97c9">cw</a> += deshake-&gt;<a class="code" href="struct_deshake_context.html#aaaf79f33599d26f511c835b30f18d02a">cx</a> - (deshake-&gt;<a class="code" href="struct_deshake_context.html#aaaf79f33599d26f511c835b30f18d02a">cx</a> &amp; ~15);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        deshake-&gt;<a class="code" href="struct_deshake_context.html#aaaf79f33599d26f511c835b30f18d02a">cx</a> &amp;= ~15;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    }</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    deshake-&gt;<a class="code" href="struct_deshake_context.html#a7e72609c15783f245c66ba8005691735">transform</a> = <a class="code" href="vf__deshake_8c.html#a11ba010a44de95305c0b0d7cc30cebe4">deshake_transform_c</a>;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>, <span class="stringliteral">&quot;cx: %d, cy: %d, cw: %d, ch: %d, rx: %d, ry: %d, edge: %d blocksize: %d contrast: %d search: %d\n&quot;</span>,</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;           deshake-&gt;<a class="code" href="struct_deshake_context.html#aaaf79f33599d26f511c835b30f18d02a">cx</a>, deshake-&gt;<a class="code" href="struct_deshake_context.html#a6cb3bf3f9849589388dfe656e6ff6dfd">cy</a>, deshake-&gt;<a class="code" href="struct_deshake_context.html#a502b5256842d4ed130aa346fa1bd97c9">cw</a>, deshake-&gt;<a class="code" href="struct_deshake_context.html#a0e535db0bddddadba65f43d9d608b33f">ch</a>,</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;           deshake-&gt;<a class="code" href="struct_deshake_context.html#aad54a481fde4715adc86c3ba4be8a02b">rx</a>, deshake-&gt;<a class="code" href="struct_deshake_context.html#abdb580132fa6a0e8412667fa7c285bce">ry</a>, deshake-&gt;<a class="code" href="struct_deshake_context.html#a94439e164a0389ca657bfb66ff303120">edge</a>, deshake-&gt;<a class="code" href="struct_deshake_context.html#a9484b0ef1ba673ffdb2ebc437aaf4c04">blocksize</a> * 2, deshake-&gt;<a class="code" href="struct_deshake_context.html#af2743a76120cd89fe70274050c969848">contrast</a>, deshake-&gt;<a class="code" href="struct_deshake_context.html#ac1204397baeebe361b27575bb7bcd941">search</a>);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;}</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno"><a class="line" href="vf__deshake_8c.html#a5b4e302dfe4b2ee5369f0278621acd5f">  374</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="vf__deshake_8c.html#a5b4e302dfe4b2ee5369f0278621acd5f">query_formats</a>(<a class="code" href="struct_a_v_filter_context.html">AVFilterContext</a> *<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>)</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;{</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">enum</span> <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5">AVPixelFormat</a> <a class="code" href="libkvazaar_8c.html#aa1219ee396a270ba57fd4f2306b64c6e">pix_fmts</a>[] = {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a1aa7677092740d8def31655b5d7f0cc2">AV_PIX_FMT_YUV420P</a>,  <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a332444d991855c9667b786f6f7bb6051">AV_PIX_FMT_YUV422P</a>,  <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a82034006e681cddbb7b1d5cb7045626a">AV_PIX_FMT_YUV444P</a>,  <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a60dd6b14fd159176a59e20be30e355c5">AV_PIX_FMT_YUV410P</a>,</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a69f441408075b0c5fea6e82439d74b06">AV_PIX_FMT_YUV411P</a>,  <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a1afff2f2eecd8629e6136d2e044ed66b">AV_PIX_FMT_YUV440P</a>,  <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5aef61d7a65003ef618420f618294107b0">AV_PIX_FMT_YUVJ420P</a>, <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5ab2e2ccfaeec66c0a5f58ffdbe2e850f9">AV_PIX_FMT_YUVJ422P</a>,</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5ae21031dcb2dd7bc75c83ec1ac2c26157">AV_PIX_FMT_YUVJ444P</a>, <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a5f176d02770e3012fc799bf28a07f345">AV_PIX_FMT_YUVJ440P</a>, <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a0e08f8a5d0fa21c3e258816a9dcce7c3">AV_PIX_FMT_NONE</a></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    };</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <a class="code" href="struct_a_v_filter_formats.html">AVFilterFormats</a> *fmts_list = <a class="code" href="formats_8c.html#a43e709e9689273a94a5edc40d1cb5aed">ff_make_format_list</a>(<a class="code" href="libkvazaar_8c.html#aa1219ee396a270ba57fd4f2306b64c6e">pix_fmts</a>);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">if</span> (!fmts_list)</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="formats_8c.html#a3ea436a8d465066eecdfb2ff513ff504">ff_set_common_formats</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, fmts_list);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;}</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno"><a class="line" href="vf__deshake_8c.html#af262c9da984a791ad141afe836421a49">  387</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="vf__deshake_8c.html#af262c9da984a791ad141afe836421a49">config_props</a>(<a class="code" href="struct_a_v_filter_link.html">AVFilterLink</a> *<a class="code" href="filter__design_8txt.html#a11a6a594845d2b9bf51b9ccc8a83c83d">link</a>)</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;{</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <a class="code" href="struct_deshake_context.html">DeshakeContext</a> *deshake = <a class="code" href="filter__design_8txt.html#a11a6a594845d2b9bf51b9ccc8a83c83d">link</a>-&gt;dst-&gt;priv;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    deshake-&gt;<a class="code" href="struct_deshake_context.html#a61799657cdab45ec28f580b9e3f0fd23">ref</a> = <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    deshake-&gt;<a class="code" href="struct_deshake_context.html#a70c6d07a34c6dbade46c855778848068">last</a>.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#a925fd96d0d9fe4920a2c788633e161d3">x</a> = 0;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    deshake-&gt;<a class="code" href="struct_deshake_context.html#a70c6d07a34c6dbade46c855778848068">last</a>.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#ac6abeed7e7362852e8b9b5b2dd0d7eac">y</a> = 0;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    deshake-&gt;<a class="code" href="struct_deshake_context.html#a70c6d07a34c6dbade46c855778848068">last</a>.<a class="code" href="struct_transform.html#a476a0c4f5ca9d7928241a69130090820">angle</a> = 0;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    deshake-&gt;<a class="code" href="struct_deshake_context.html#a70c6d07a34c6dbade46c855778848068">last</a>.<a class="code" href="struct_transform.html#ab0daacd3347b74d36c4f7549abe45bcd">zoom</a> = 0;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;}</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno"><a class="line" href="vf__deshake_8c.html#abbead6cde1da3e72ce200578c426f1e6">  400</a></span>&#160;<span class="keyword">static</span> <a class="code" href="attributes_8h.html#abeeb324fff79a5335d36774704e2475c">av_cold</a> <span class="keywordtype">void</span> <a class="code" href="vf__deshake_8c.html#abbead6cde1da3e72ce200578c426f1e6">uninit</a>(<a class="code" href="struct_a_v_filter_context.html">AVFilterContext</a> *<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>)</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;{</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <a class="code" href="struct_deshake_context.html">DeshakeContext</a> *deshake = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;priv;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <a class="code" href="group__lavu__frame.html#ga979d73f3228814aee56aeca0636e37cc">av_frame_free</a>(&amp;deshake-&gt;<a class="code" href="struct_deshake_context.html#a61799657cdab45ec28f580b9e3f0fd23">ref</a>);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#adba82e1bcd02de510a858fcbedf79ef1">av_freep</a>(&amp;deshake-&gt;<a class="code" href="struct_deshake_context.html#a39cf8679c55ae0d64be2772a8dcc3931">angles</a>);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    deshake-&gt;<a class="code" href="struct_deshake_context.html#a8e577f2fe633ed2454362438ad5a6d84">angles_size</a> = 0;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordflow">if</span> (deshake-&gt;<a class="code" href="struct_deshake_context.html#a40de303d95ecd35d7210de190a0ad73d">fp</a>)</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        fclose(deshake-&gt;<a class="code" href="struct_deshake_context.html#a40de303d95ecd35d7210de190a0ad73d">fp</a>);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;}</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno"><a class="line" href="vf__deshake_8c.html#a507c820aa4475d788435b7c8204df912">  410</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="vf__deshake_8c.html#a507c820aa4475d788435b7c8204df912">filter_frame</a>(<a class="code" href="struct_a_v_filter_link.html">AVFilterLink</a> *<a class="code" href="filter__design_8txt.html#a11a6a594845d2b9bf51b9ccc8a83c83d">link</a>, <a class="code" href="struct_a_v_frame.html">AVFrame</a> *<a class="code" href="audio__convert_8c.html#ab92ad91055387e15b43ff5f6f60f2895">in</a>)</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;{</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <a class="code" href="struct_deshake_context.html">DeshakeContext</a> *deshake = <a class="code" href="filter__design_8txt.html#a11a6a594845d2b9bf51b9ccc8a83c83d">link</a>-&gt;dst-&gt;priv;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <a class="code" href="struct_a_v_filter_link.html">AVFilterLink</a> *outlink = <a class="code" href="filter__design_8txt.html#a11a6a594845d2b9bf51b9ccc8a83c83d">link</a>-&gt;dst-&gt;outputs[0];</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <a class="code" href="struct_a_v_frame.html">AVFrame</a> *<a class="code" href="tests_2movenc_8c.html#a1277960b5f2b37137fe9b0b5a1ea0beb">out</a>;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <a class="code" href="struct_transform.html">Transform</a> t = {{0},0}, orig = {{0},0};</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordtype">float</span> matrix_y[9], matrix_uv[9];</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="ilbcdata_8h.html#a545b8c1c045fcc34b81d3ca822620277">alpha</a> = 2.0 / deshake-&gt;<a class="code" href="struct_deshake_context.html#aed2e1801e9b077c1c4bf1016513e8a14">refcount</a>;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordtype">char</span> tmp[256];</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = 0;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keyword">const</span> <a class="code" href="struct_a_v_pix_fmt_descriptor.html">AVPixFmtDescriptor</a> *<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a> = <a class="code" href="pixdesc_8c.html#afe0c3e8aef5173de28bbdaea4298f5f0">av_pix_fmt_desc_get</a>(<a class="code" href="filter__design_8txt.html#a11a6a594845d2b9bf51b9ccc8a83c83d">link</a>-&gt;<a class="code" href="struct_a_v_frame.html#aed14fa772ce46881020fd1545c86432c">format</a>);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> chroma_width  = <a class="code" href="common_8h.html#a5d13452b0fac0d41b08ea2e49ea6eaa5">AV_CEIL_RSHIFT</a>(<a class="code" href="filter__design_8txt.html#a11a6a594845d2b9bf51b9ccc8a83c83d">link</a>-&gt;w, <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;log2_chroma_w);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> chroma_height = <a class="code" href="common_8h.html#a5d13452b0fac0d41b08ea2e49ea6eaa5">AV_CEIL_RSHIFT</a>(<a class="code" href="filter__design_8txt.html#a11a6a594845d2b9bf51b9ccc8a83c83d">link</a>-&gt;h, <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;log2_chroma_h);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="dashdec_8c.html#a5b00ec1b903e9eba63fd2a01b96e4aa6">aligned</a>;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordtype">float</span> transform_zoom;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <a class="code" href="tests_2movenc_8c.html#a1277960b5f2b37137fe9b0b5a1ea0beb">out</a> = <a class="code" href="video_8c.html#a7f0f699d7689ef551622672dcd39a96a">ff_get_video_buffer</a>(outlink, outlink-&gt;<a class="code" href="struct_a_v_filter_link.html#a08e3e25929bb29d5f6ef768343ff7f57">w</a>, outlink-&gt;<a class="code" href="struct_a_v_filter_link.html#a1efd10db9d097b6d27054da46e06e133">h</a>);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="tests_2movenc_8c.html#a1277960b5f2b37137fe9b0b5a1ea0beb">out</a>) {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <a class="code" href="group__lavu__frame.html#ga979d73f3228814aee56aeca0636e37cc">av_frame_free</a>(&amp;<a class="code" href="audio__convert_8c.html#ab92ad91055387e15b43ff5f6f60f2895">in</a>);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <a class="code" href="group__lavu__frame.html#gab9b275b114ace0db95c5796bc71f3012">av_frame_copy_props</a>(<a class="code" href="tests_2movenc_8c.html#a1277960b5f2b37137fe9b0b5a1ea0beb">out</a>, <a class="code" href="audio__convert_8c.html#ab92ad91055387e15b43ff5f6f60f2895">in</a>);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <a class="code" href="dashdec_8c.html#a5b00ec1b903e9eba63fd2a01b96e4aa6">aligned</a> = !((intptr_t)<a class="code" href="audio__convert_8c.html#ab92ad91055387e15b43ff5f6f60f2895">in</a>-&gt;data[0] &amp; 15 | <a class="code" href="audio__convert_8c.html#ab92ad91055387e15b43ff5f6f60f2895">in</a>-&gt;linesize[0] &amp; 15);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    deshake-&gt;<a class="code" href="struct_deshake_context.html#a1ff6b67c812f624a4fb63bf11c3e36f4">sad</a> = <a class="code" href="pixelutils_8c.html#ace06a5d0938728661c6416babe1ee0a9">av_pixelutils_get_sad_fn</a>(4, 4, <a class="code" href="dashdec_8c.html#a5b00ec1b903e9eba63fd2a01b96e4aa6">aligned</a>, deshake); <span class="comment">// 16x16, 2nd source unaligned</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordflow">if</span> (!deshake-&gt;<a class="code" href="struct_deshake_context.html#a1ff6b67c812f624a4fb63bf11c3e36f4">sad</a>)</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordflow">if</span> (deshake-&gt;<a class="code" href="struct_deshake_context.html#aaaf79f33599d26f511c835b30f18d02a">cx</a> &lt; 0 || deshake-&gt;<a class="code" href="struct_deshake_context.html#a6cb3bf3f9849589388dfe656e6ff6dfd">cy</a> &lt; 0 || deshake-&gt;<a class="code" href="struct_deshake_context.html#a502b5256842d4ed130aa346fa1bd97c9">cw</a> &lt; 0 || deshake-&gt;<a class="code" href="struct_deshake_context.html#a0e535db0bddddadba65f43d9d608b33f">ch</a> &lt; 0) {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="comment">// Find the most likely global motion for the current frame</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <a class="code" href="vf__deshake_8c.html#ae2332ccfbd43fd6b49ae6c5ba8095b20">find_motion</a>(deshake, (deshake-&gt;<a class="code" href="struct_deshake_context.html#a61799657cdab45ec28f580b9e3f0fd23">ref</a> == <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) ? <a class="code" href="audio__convert_8c.html#ab92ad91055387e15b43ff5f6f60f2895">in</a>-&gt;data[0] : deshake-&gt;<a class="code" href="struct_deshake_context.html#a61799657cdab45ec28f580b9e3f0fd23">ref</a>-&gt;<a class="code" href="struct_a_v_frame.html#a1d0f65014a8d1bf78cec8cbed2304992">data</a>[0], <a class="code" href="audio__convert_8c.html#ab92ad91055387e15b43ff5f6f60f2895">in</a>-&gt;data[0], <a class="code" href="filter__design_8txt.html#a11a6a594845d2b9bf51b9ccc8a83c83d">link</a>-&gt;w, <a class="code" href="filter__design_8txt.html#a11a6a594845d2b9bf51b9ccc8a83c83d">link</a>-&gt;h, <a class="code" href="audio__convert_8c.html#ab92ad91055387e15b43ff5f6f60f2895">in</a>-&gt;linesize[0], &amp;t);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *<a class="code" href="tests_2checkasm_2h264pred_8c.html#a631c6befc8ec221896734437f964a631">src1</a> = (deshake-&gt;<a class="code" href="struct_deshake_context.html#a61799657cdab45ec28f580b9e3f0fd23">ref</a> == <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) ? <a class="code" href="audio__convert_8c.html#ab92ad91055387e15b43ff5f6f60f2895">in</a>-&gt;data[0] : deshake-&gt;<a class="code" href="struct_deshake_context.html#a61799657cdab45ec28f580b9e3f0fd23">ref</a>-&gt;<a class="code" href="struct_a_v_frame.html#a1d0f65014a8d1bf78cec8cbed2304992">data</a>[0];</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *src2 = <a class="code" href="audio__convert_8c.html#ab92ad91055387e15b43ff5f6f60f2895">in</a>-&gt;data[0];</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        deshake-&gt;<a class="code" href="struct_deshake_context.html#aaaf79f33599d26f511c835b30f18d02a">cx</a> = <a class="code" href="common_8h.html#a0f84cbd7fd810cd678157c98cbfad4b0">FFMIN</a>(deshake-&gt;<a class="code" href="struct_deshake_context.html#aaaf79f33599d26f511c835b30f18d02a">cx</a>, <a class="code" href="filter__design_8txt.html#a11a6a594845d2b9bf51b9ccc8a83c83d">link</a>-&gt;w);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        deshake-&gt;<a class="code" href="struct_deshake_context.html#a6cb3bf3f9849589388dfe656e6ff6dfd">cy</a> = <a class="code" href="common_8h.html#a0f84cbd7fd810cd678157c98cbfad4b0">FFMIN</a>(deshake-&gt;<a class="code" href="struct_deshake_context.html#a6cb3bf3f9849589388dfe656e6ff6dfd">cy</a>, <a class="code" href="filter__design_8txt.html#a11a6a594845d2b9bf51b9ccc8a83c83d">link</a>-&gt;h);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <span class="keywordflow">if</span> ((<span class="keywordtype">unsigned</span>)deshake-&gt;<a class="code" href="struct_deshake_context.html#aaaf79f33599d26f511c835b30f18d02a">cx</a> + (<span class="keywordtype">unsigned</span>)deshake-&gt;<a class="code" href="struct_deshake_context.html#a502b5256842d4ed130aa346fa1bd97c9">cw</a> &gt; <a class="code" href="filter__design_8txt.html#a11a6a594845d2b9bf51b9ccc8a83c83d">link</a>-&gt;w) deshake-&gt;<a class="code" href="struct_deshake_context.html#a502b5256842d4ed130aa346fa1bd97c9">cw</a> = <a class="code" href="filter__design_8txt.html#a11a6a594845d2b9bf51b9ccc8a83c83d">link</a>-&gt;w - deshake-&gt;<a class="code" href="struct_deshake_context.html#aaaf79f33599d26f511c835b30f18d02a">cx</a>;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="keywordflow">if</span> ((<span class="keywordtype">unsigned</span>)deshake-&gt;<a class="code" href="struct_deshake_context.html#a6cb3bf3f9849589388dfe656e6ff6dfd">cy</a> + (<span class="keywordtype">unsigned</span>)deshake-&gt;<a class="code" href="struct_deshake_context.html#a0e535db0bddddadba65f43d9d608b33f">ch</a> &gt; <a class="code" href="filter__design_8txt.html#a11a6a594845d2b9bf51b9ccc8a83c83d">link</a>-&gt;h) deshake-&gt;<a class="code" href="struct_deshake_context.html#a0e535db0bddddadba65f43d9d608b33f">ch</a> = <a class="code" href="filter__design_8txt.html#a11a6a594845d2b9bf51b9ccc8a83c83d">link</a>-&gt;h - deshake-&gt;<a class="code" href="struct_deshake_context.html#a6cb3bf3f9849589388dfe656e6ff6dfd">cy</a>;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="comment">// Quadword align right margin</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        deshake-&gt;<a class="code" href="struct_deshake_context.html#a502b5256842d4ed130aa346fa1bd97c9">cw</a> &amp;= ~15;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <a class="code" href="tests_2checkasm_2h264pred_8c.html#a631c6befc8ec221896734437f964a631">src1</a> += deshake-&gt;<a class="code" href="struct_deshake_context.html#a6cb3bf3f9849589388dfe656e6ff6dfd">cy</a> * <a class="code" href="audio__convert_8c.html#ab92ad91055387e15b43ff5f6f60f2895">in</a>-&gt;linesize[0] + deshake-&gt;<a class="code" href="struct_deshake_context.html#aaaf79f33599d26f511c835b30f18d02a">cx</a>;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        src2 += deshake-&gt;<a class="code" href="struct_deshake_context.html#a6cb3bf3f9849589388dfe656e6ff6dfd">cy</a> * <a class="code" href="audio__convert_8c.html#ab92ad91055387e15b43ff5f6f60f2895">in</a>-&gt;linesize[0] + deshake-&gt;<a class="code" href="struct_deshake_context.html#aaaf79f33599d26f511c835b30f18d02a">cx</a>;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <a class="code" href="vf__deshake_8c.html#ae2332ccfbd43fd6b49ae6c5ba8095b20">find_motion</a>(deshake, <a class="code" href="tests_2checkasm_2h264pred_8c.html#a631c6befc8ec221896734437f964a631">src1</a>, src2, deshake-&gt;<a class="code" href="struct_deshake_context.html#a502b5256842d4ed130aa346fa1bd97c9">cw</a>, deshake-&gt;<a class="code" href="struct_deshake_context.html#a0e535db0bddddadba65f43d9d608b33f">ch</a>, <a class="code" href="audio__convert_8c.html#ab92ad91055387e15b43ff5f6f60f2895">in</a>-&gt;linesize[0], &amp;t);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    }</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="comment">// Copy transform so we can output it later to compare to the smoothed value</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    orig.vec.x = t.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#a925fd96d0d9fe4920a2c788633e161d3">x</a>;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    orig.vec.y = t.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#ac6abeed7e7362852e8b9b5b2dd0d7eac">y</a>;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    orig.angle = t.<a class="code" href="struct_transform.html#a476a0c4f5ca9d7928241a69130090820">angle</a>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    orig.zoom = t.<a class="code" href="struct_transform.html#ab0daacd3347b74d36c4f7549abe45bcd">zoom</a>;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="comment">// Generate a one-sided moving exponential average</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    deshake-&gt;<a class="code" href="struct_deshake_context.html#a1a63ead8e0e9dc5750cd064b1c45b9b3">avg</a>.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#a925fd96d0d9fe4920a2c788633e161d3">x</a> = <a class="code" href="ilbcdata_8h.html#a545b8c1c045fcc34b81d3ca822620277">alpha</a> * t.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#a925fd96d0d9fe4920a2c788633e161d3">x</a> + (1.0 - <a class="code" href="ilbcdata_8h.html#a545b8c1c045fcc34b81d3ca822620277">alpha</a>) * deshake-&gt;<a class="code" href="struct_deshake_context.html#a1a63ead8e0e9dc5750cd064b1c45b9b3">avg</a>.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#a925fd96d0d9fe4920a2c788633e161d3">x</a>;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    deshake-&gt;<a class="code" href="struct_deshake_context.html#a1a63ead8e0e9dc5750cd064b1c45b9b3">avg</a>.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#ac6abeed7e7362852e8b9b5b2dd0d7eac">y</a> = <a class="code" href="ilbcdata_8h.html#a545b8c1c045fcc34b81d3ca822620277">alpha</a> * t.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#ac6abeed7e7362852e8b9b5b2dd0d7eac">y</a> + (1.0 - <a class="code" href="ilbcdata_8h.html#a545b8c1c045fcc34b81d3ca822620277">alpha</a>) * deshake-&gt;<a class="code" href="struct_deshake_context.html#a1a63ead8e0e9dc5750cd064b1c45b9b3">avg</a>.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#ac6abeed7e7362852e8b9b5b2dd0d7eac">y</a>;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    deshake-&gt;<a class="code" href="struct_deshake_context.html#a1a63ead8e0e9dc5750cd064b1c45b9b3">avg</a>.<a class="code" href="struct_transform.html#a476a0c4f5ca9d7928241a69130090820">angle</a> = <a class="code" href="ilbcdata_8h.html#a545b8c1c045fcc34b81d3ca822620277">alpha</a> * t.<a class="code" href="struct_transform.html#a476a0c4f5ca9d7928241a69130090820">angle</a> + (1.0 - <a class="code" href="ilbcdata_8h.html#a545b8c1c045fcc34b81d3ca822620277">alpha</a>) * deshake-&gt;<a class="code" href="struct_deshake_context.html#a1a63ead8e0e9dc5750cd064b1c45b9b3">avg</a>.<a class="code" href="struct_transform.html#a476a0c4f5ca9d7928241a69130090820">angle</a>;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    deshake-&gt;<a class="code" href="struct_deshake_context.html#a1a63ead8e0e9dc5750cd064b1c45b9b3">avg</a>.<a class="code" href="struct_transform.html#ab0daacd3347b74d36c4f7549abe45bcd">zoom</a> = <a class="code" href="ilbcdata_8h.html#a545b8c1c045fcc34b81d3ca822620277">alpha</a> * t.<a class="code" href="struct_transform.html#ab0daacd3347b74d36c4f7549abe45bcd">zoom</a> + (1.0 - <a class="code" href="ilbcdata_8h.html#a545b8c1c045fcc34b81d3ca822620277">alpha</a>) * deshake-&gt;<a class="code" href="struct_deshake_context.html#a1a63ead8e0e9dc5750cd064b1c45b9b3">avg</a>.<a class="code" href="struct_transform.html#ab0daacd3347b74d36c4f7549abe45bcd">zoom</a>;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="comment">// Remove the average from the current motion to detect the motion that</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="comment">// is not on purpose, just as jitter from bumping the camera</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    t.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#a925fd96d0d9fe4920a2c788633e161d3">x</a> -= deshake-&gt;<a class="code" href="struct_deshake_context.html#a1a63ead8e0e9dc5750cd064b1c45b9b3">avg</a>.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#a925fd96d0d9fe4920a2c788633e161d3">x</a>;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    t.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#ac6abeed7e7362852e8b9b5b2dd0d7eac">y</a> -= deshake-&gt;<a class="code" href="struct_deshake_context.html#a1a63ead8e0e9dc5750cd064b1c45b9b3">avg</a>.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#ac6abeed7e7362852e8b9b5b2dd0d7eac">y</a>;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    t.<a class="code" href="struct_transform.html#a476a0c4f5ca9d7928241a69130090820">angle</a> -= deshake-&gt;<a class="code" href="struct_deshake_context.html#a1a63ead8e0e9dc5750cd064b1c45b9b3">avg</a>.<a class="code" href="struct_transform.html#a476a0c4f5ca9d7928241a69130090820">angle</a>;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    t.<a class="code" href="struct_transform.html#ab0daacd3347b74d36c4f7549abe45bcd">zoom</a> -= deshake-&gt;<a class="code" href="struct_deshake_context.html#a1a63ead8e0e9dc5750cd064b1c45b9b3">avg</a>.<a class="code" href="struct_transform.html#ab0daacd3347b74d36c4f7549abe45bcd">zoom</a>;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="comment">// Invert the motion to undo it</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    t.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#a925fd96d0d9fe4920a2c788633e161d3">x</a> *= -1;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    t.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#ac6abeed7e7362852e8b9b5b2dd0d7eac">y</a> *= -1;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    t.<a class="code" href="struct_transform.html#a476a0c4f5ca9d7928241a69130090820">angle</a> *= -1;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="comment">// Write statistics to file</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordflow">if</span> (deshake-&gt;<a class="code" href="struct_deshake_context.html#a40de303d95ecd35d7210de190a0ad73d">fp</a>) {</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <a class="code" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(tmp, 256, <span class="stringliteral">&quot;%f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f\n&quot;</span>, orig.vec.x, deshake-&gt;<a class="code" href="struct_deshake_context.html#a1a63ead8e0e9dc5750cd064b1c45b9b3">avg</a>.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#a925fd96d0d9fe4920a2c788633e161d3">x</a>, t.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#a925fd96d0d9fe4920a2c788633e161d3">x</a>, orig.vec.y, deshake-&gt;<a class="code" href="struct_deshake_context.html#a1a63ead8e0e9dc5750cd064b1c45b9b3">avg</a>.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#ac6abeed7e7362852e8b9b5b2dd0d7eac">y</a>, t.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#ac6abeed7e7362852e8b9b5b2dd0d7eac">y</a>, orig.angle, deshake-&gt;<a class="code" href="struct_deshake_context.html#a1a63ead8e0e9dc5750cd064b1c45b9b3">avg</a>.<a class="code" href="struct_transform.html#a476a0c4f5ca9d7928241a69130090820">angle</a>, t.<a class="code" href="struct_transform.html#a476a0c4f5ca9d7928241a69130090820">angle</a>, orig.zoom, deshake-&gt;<a class="code" href="struct_deshake_context.html#a1a63ead8e0e9dc5750cd064b1c45b9b3">avg</a>.<a class="code" href="struct_transform.html#ab0daacd3347b74d36c4f7549abe45bcd">zoom</a>, t.<a class="code" href="struct_transform.html#ab0daacd3347b74d36c4f7549abe45bcd">zoom</a>);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        fwrite(tmp, 1, strlen(tmp), deshake-&gt;<a class="code" href="struct_deshake_context.html#a40de303d95ecd35d7210de190a0ad73d">fp</a>);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    }</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="comment">// Turn relative current frame motion into absolute by adding it to the</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="comment">// last absolute motion</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    t.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#a925fd96d0d9fe4920a2c788633e161d3">x</a> += deshake-&gt;<a class="code" href="struct_deshake_context.html#a70c6d07a34c6dbade46c855778848068">last</a>.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#a925fd96d0d9fe4920a2c788633e161d3">x</a>;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    t.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#ac6abeed7e7362852e8b9b5b2dd0d7eac">y</a> += deshake-&gt;<a class="code" href="struct_deshake_context.html#a70c6d07a34c6dbade46c855778848068">last</a>.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#ac6abeed7e7362852e8b9b5b2dd0d7eac">y</a>;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    t.<a class="code" href="struct_transform.html#a476a0c4f5ca9d7928241a69130090820">angle</a> += deshake-&gt;<a class="code" href="struct_deshake_context.html#a70c6d07a34c6dbade46c855778848068">last</a>.<a class="code" href="struct_transform.html#a476a0c4f5ca9d7928241a69130090820">angle</a>;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    t.<a class="code" href="struct_transform.html#ab0daacd3347b74d36c4f7549abe45bcd">zoom</a> += deshake-&gt;<a class="code" href="struct_deshake_context.html#a70c6d07a34c6dbade46c855778848068">last</a>.<a class="code" href="struct_transform.html#ab0daacd3347b74d36c4f7549abe45bcd">zoom</a>;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="comment">// Shrink motion by 10% to keep things centered in the camera frame</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    t.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#a925fd96d0d9fe4920a2c788633e161d3">x</a> *= 0.9;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    t.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#ac6abeed7e7362852e8b9b5b2dd0d7eac">y</a> *= 0.9;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    t.<a class="code" href="struct_transform.html#a476a0c4f5ca9d7928241a69130090820">angle</a> *= 0.9;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="comment">// Store the last absolute motion information</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    deshake-&gt;<a class="code" href="struct_deshake_context.html#a70c6d07a34c6dbade46c855778848068">last</a>.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#a925fd96d0d9fe4920a2c788633e161d3">x</a> = t.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#a925fd96d0d9fe4920a2c788633e161d3">x</a>;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    deshake-&gt;<a class="code" href="struct_deshake_context.html#a70c6d07a34c6dbade46c855778848068">last</a>.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#ac6abeed7e7362852e8b9b5b2dd0d7eac">y</a> = t.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#ac6abeed7e7362852e8b9b5b2dd0d7eac">y</a>;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    deshake-&gt;<a class="code" href="struct_deshake_context.html#a70c6d07a34c6dbade46c855778848068">last</a>.<a class="code" href="struct_transform.html#a476a0c4f5ca9d7928241a69130090820">angle</a> = t.<a class="code" href="struct_transform.html#a476a0c4f5ca9d7928241a69130090820">angle</a>;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    deshake-&gt;<a class="code" href="struct_deshake_context.html#a70c6d07a34c6dbade46c855778848068">last</a>.<a class="code" href="struct_transform.html#ab0daacd3347b74d36c4f7549abe45bcd">zoom</a> = t.<a class="code" href="struct_transform.html#ab0daacd3347b74d36c4f7549abe45bcd">zoom</a>;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160; </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    transform_zoom = 1.0 + t.<a class="code" href="struct_transform.html#ab0daacd3347b74d36c4f7549abe45bcd">zoom</a> / 100.0;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="comment">// Generate a luma transformation matrix</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <a class="code" href="transform_8c.html#a33249c4342a334d41b1c124ef28031cb">ff_get_matrix</a>(t.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#a925fd96d0d9fe4920a2c788633e161d3">x</a>, t.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#ac6abeed7e7362852e8b9b5b2dd0d7eac">y</a>, t.<a class="code" href="struct_transform.html#a476a0c4f5ca9d7928241a69130090820">angle</a>, transform_zoom, transform_zoom, matrix_y);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="comment">// Generate a chroma transformation matrix</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <a class="code" href="transform_8c.html#a33249c4342a334d41b1c124ef28031cb">ff_get_matrix</a>(t.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#a925fd96d0d9fe4920a2c788633e161d3">x</a> / (<a class="code" href="filter__design_8txt.html#a11a6a594845d2b9bf51b9ccc8a83c83d">link</a>-&gt;w / chroma_width), t.<a class="code" href="struct_transform.html#ae065025ee0e628935faaace023464170">vec</a>.<a class="code" href="struct_motion_vector.html#ac6abeed7e7362852e8b9b5b2dd0d7eac">y</a> / (<a class="code" href="filter__design_8txt.html#a11a6a594845d2b9bf51b9ccc8a83c83d">link</a>-&gt;h / chroma_height), t.<a class="code" href="struct_transform.html#a476a0c4f5ca9d7928241a69130090820">angle</a>, transform_zoom, transform_zoom, matrix_uv);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="comment">// Transform the luma and chroma planes</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = deshake-&gt;<a class="code" href="struct_deshake_context.html#a7e72609c15783f245c66ba8005691735">transform</a>(<a class="code" href="filter__design_8txt.html#a11a6a594845d2b9bf51b9ccc8a83c83d">link</a>-&gt;dst, <a class="code" href="filter__design_8txt.html#a11a6a594845d2b9bf51b9ccc8a83c83d">link</a>-&gt;w, <a class="code" href="filter__design_8txt.html#a11a6a594845d2b9bf51b9ccc8a83c83d">link</a>-&gt;h, chroma_width, chroma_height,</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                             matrix_y, matrix_uv, <a class="code" href="transform_8h.html#a242ace442acd0d243c565f62f422c13ea9b90d08e3d5ac2ba46255c82274c85f3">INTERPOLATE_BILINEAR</a>, deshake-&gt;<a class="code" href="struct_deshake_context.html#a94439e164a0389ca657bfb66ff303120">edge</a>, <a class="code" href="audio__convert_8c.html#ab92ad91055387e15b43ff5f6f60f2895">in</a>, <a class="code" href="tests_2movenc_8c.html#a1277960b5f2b37137fe9b0b5a1ea0beb">out</a>);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160; </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="comment">// Cleanup the old reference frame</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <a class="code" href="group__lavu__frame.html#ga979d73f3228814aee56aeca0636e37cc">av_frame_free</a>(&amp;deshake-&gt;<a class="code" href="struct_deshake_context.html#a61799657cdab45ec28f580b9e3f0fd23">ref</a>);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> &lt; 0)</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="comment">// Store the current frame as the reference frame for calculating the</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="comment">// motion of the next frame</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    deshake-&gt;<a class="code" href="struct_deshake_context.html#a61799657cdab45ec28f580b9e3f0fd23">ref</a> = <a class="code" href="audio__convert_8c.html#ab92ad91055387e15b43ff5f6f60f2895">in</a>;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="avfilter_8c.html#a65d6e9755eadf69367843dfc738143b4">ff_filter_frame</a>(outlink, <a class="code" href="tests_2movenc_8c.html#a1277960b5f2b37137fe9b0b5a1ea0beb">out</a>);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>:</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <a class="code" href="group__lavu__frame.html#ga979d73f3228814aee56aeca0636e37cc">av_frame_free</a>(&amp;<a class="code" href="tests_2movenc_8c.html#a1277960b5f2b37137fe9b0b5a1ea0beb">out</a>);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;}</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno"><a class="line" href="vf__deshake_8c.html#a6f7118896fe6949408f13e1d575dac14">  535</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="struct_a_v_filter_pad.html">AVFilterPad</a> <a class="code" href="vf__deshake_8c.html#a6f7118896fe6949408f13e1d575dac14">deshake_inputs</a>[] = {</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        .<a class="code" href="struct_a_v_filter_pad.html#afc112061a6035639934e0135aab7d425">name</a>         = <span class="stringliteral">&quot;default&quot;</span>,</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        .type         = <a class="code" href="group__lavu__misc.html#gga9a84bba4713dfced21a1a56163be1f48ac1a46f59be5c6c2d3412ab172d6b8cf5">AVMEDIA_TYPE_VIDEO</a>,</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        .filter_frame = <a class="code" href="vf__deshake_8c.html#a507c820aa4475d788435b7c8204df912">filter_frame</a>,</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        .config_props = <a class="code" href="vf__deshake_8c.html#af262c9da984a791ad141afe836421a49">config_props</a>,</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    },</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    { <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> }</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;};</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160; </div>
<div class="line"><a name="l00545"></a><span class="lineno"><a class="line" href="vf__deshake_8c.html#a05acb496d67139b31b7e00d7a3195c22">  545</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="struct_a_v_filter_pad.html">AVFilterPad</a> <a class="code" href="vf__deshake_8c.html#a05acb496d67139b31b7e00d7a3195c22">deshake_outputs</a>[] = {</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    {</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        .<a class="code" href="struct_a_v_filter_pad.html#afc112061a6035639934e0135aab7d425">name</a> = <span class="stringliteral">&quot;default&quot;</span>,</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        .type = <a class="code" href="group__lavu__misc.html#gga9a84bba4713dfced21a1a56163be1f48ac1a46f59be5c6c2d3412ab172d6b8cf5">AVMEDIA_TYPE_VIDEO</a>,</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    },</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    { <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> }</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;};</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; </div>
<div class="line"><a name="l00553"></a><span class="lineno"><a class="line" href="vf__deshake_8c.html#ae24c6e964564d6ea161b28f66a1dd8fa">  553</a></span>&#160;<a class="code" href="struct_a_v_filter.html">AVFilter</a> <a class="code" href="vf__deshake_8c.html#ae24c6e964564d6ea161b28f66a1dd8fa">ff_vf_deshake</a> = {</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    .<a class="code" href="struct_a_v_filter.html#a28a4776f344f91055f42a4c2a1b15c0c">name</a>          = <span class="stringliteral">&quot;deshake&quot;</span>,</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    .description   = <a class="code" href="libavutil_2internal_8h.html#a3c0fa12fafe59c44d4b16e60d8385637">NULL_IF_CONFIG_SMALL</a>(<span class="stringliteral">&quot;Stabilize shaky video.&quot;</span>),</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    .priv_size     = <span class="keyword">sizeof</span>(<a class="code" href="deshake_8h.html#a20743e1f7cb23b285cf53e3cfec40253">DeshakeContext</a>),</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    .<a class="code" href="vf__deshake_8c.html#ab7cd5b404747a481115ce1d090fd11b8">init</a>          = <a class="code" href="vf__deshake_8c.html#ab7cd5b404747a481115ce1d090fd11b8">init</a>,</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    .<a class="code" href="vf__deshake_8c.html#abbead6cde1da3e72ce200578c426f1e6">uninit</a>        = <a class="code" href="vf__deshake_8c.html#abbead6cde1da3e72ce200578c426f1e6">uninit</a>,</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    .<a class="code" href="vf__deshake_8c.html#a5b4e302dfe4b2ee5369f0278621acd5f">query_formats</a> = <a class="code" href="vf__deshake_8c.html#a5b4e302dfe4b2ee5369f0278621acd5f">query_formats</a>,</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    .<a class="code" href="filter__design_8txt.html#a45917ba5e6c8b798c6e2ba6ca7301a5d">inputs</a>        = <a class="code" href="vf__deshake_8c.html#a6f7118896fe6949408f13e1d575dac14">deshake_inputs</a>,</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    .<a class="code" href="af__acontrast_8c.html#a7ddb0b5ac76101c5bee71e9840bf1698">outputs</a>       = <a class="code" href="vf__deshake_8c.html#a05acb496d67139b31b7e00d7a3195c22">deshake_outputs</a>,</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    .priv_class    = &amp;deshake_class,</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;};</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="astruct_transform_html_ab0daacd3347b74d36c4f7549abe45bcd"><div class="ttname"><a href="struct_transform.html#ab0daacd3347b74d36c4f7549abe45bcd">Transform::zoom</a></div><div class="ttdeci">double zoom</div><div class="ttdoc">Zoom percentage.</div><div class="ttdef"><b>Definition:</b> <a href="deshake_8h_source.html#l00050">deshake.h:50</a></div></div>
<div class="ttc" id="avideo_8c_html_a7f0f699d7689ef551622672dcd39a96a"><div class="ttname"><a href="video_8c.html#a7f0f699d7689ef551622672dcd39a96a">ff_get_video_buffer</a></div><div class="ttdeci">AVFrame * ff_get_video_buffer(AVFilterLink *link, int w, int h)</div><div class="ttdef"><b>Definition:</b> <a href="video_8c_source.html#l00099">video.c:99</a></div></div>
<div class="ttc" id="amace_8c_html_a08f66a6870d87afcd5dc1b60d1019692"><div class="ttname"><a href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a></div><div class="ttdeci">int stride</div><div class="ttdef"><b>Definition:</b> <a href="mace_8c_source.html#l00144">mace.c:144</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5">AVPixelFormat</a></div><div class="ttdeci">AVPixelFormat</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00064">pixfmt.h:64</a></div></div>
<div class="ttc" id="adeshake_8h_html_aebc02c5400ecf25b185fb5804e8ca88a"><div class="ttname"><a href="deshake_8h.html#aebc02c5400ecf25b185fb5804e8ca88a">MAX_R</a></div><div class="ttdeci">#define MAX_R</div><div class="ttdef"><b>Definition:</b> <a href="deshake_8h_source.html#l00053">deshake.h:53</a></div></div>
<div class="ttc" id="afilter__design_8txt_html_adf2fb515710d47541f7150ecd2950e76"><div class="ttname"><a href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a></div><div class="ttdeci">Filter the word “frame” indicates either a video frame or a group of audio as stored in an AVFrame structure Format for each input and each output the list of supported formats For video that means pixel format For audio that means channel sample they are references to shared objects When the negotiation mechanism computes the intersection of the formats supported at each end of a all references to both lists are replaced with a reference to the intersection And when a single format is eventually chosen for a link amongst the remaining all references to the list are updated That means that if a filter requires that its input and output have the same format amongst a supported all it has to do is use a reference to the same list of formats query_formats can leave some formats unset and return AVERROR(EAGAIN) to cause the negotiation mechanism toagain later. That can be used by filters with complex requirements to use the format negotiated on one link to set the formats supported on another. Frame references ownership and permissions</div></div>
<div class="ttc" id="aopt_8h_html"><div class="ttname"><a href="opt_8h.html">opt.h</a></div></div>
<div class="ttc" id="adeshake_8h_html_abd60910b52e9fd2a0b8f4b030183f02ca26c5472355765851213d23cd291e4af7"><div class="ttname"><a href="deshake_8h.html#abd60910b52e9fd2a0b8f4b030183f02ca26c5472355765851213d23cd291e4af7">SMART_EXHAUSTIVE</a></div><div class="ttdeci">@ SMART_EXHAUSTIVE</div><div class="ttdoc">Search most possible positions (faster)</div><div class="ttdef"><b>Definition:</b> <a href="deshake_8h_source.html#l00033">deshake.h:33</a></div></div>
<div class="ttc" id="aformats_8c_html_a43e709e9689273a94a5edc40d1cb5aed"><div class="ttname"><a href="formats_8c.html#a43e709e9689273a94a5edc40d1cb5aed">ff_make_format_list</a></div><div class="ttdeci">AVFilterFormats * ff_make_format_list(const int *fmts)</div><div class="ttdef"><b>Definition:</b> <a href="formats_8c_source.html#l00286">formats.c:286</a></div></div>
<div class="ttc" id="astruct_deshake_context_html_ac1204397baeebe361b27575bb7bcd941"><div class="ttname"><a href="struct_deshake_context.html#ac1204397baeebe361b27575bb7bcd941">DeshakeContext::search</a></div><div class="ttdeci">int search</div><div class="ttdoc">Motion search method.</div><div class="ttdef"><b>Definition:</b> <a href="deshake_8h_source.html#l00066">deshake.h:66</a></div></div>
<div class="ttc" id="astruct_a_v_filter_link_html"><div class="ttname"><a href="struct_a_v_filter_link.html">AVFilterLink</a></div><div class="ttdef"><b>Definition:</b> <a href="avfilter_8h_source.html#l00471">avfilter.h:471</a></div></div>
<div class="ttc" id="astruct_deshake_context_html_aed2e1801e9b077c1c4bf1016513e8a14"><div class="ttname"><a href="struct_deshake_context.html#aed2e1801e9b077c1c4bf1016513e8a14">DeshakeContext::refcount</a></div><div class="ttdeci">int refcount</div><div class="ttdoc">Number of reference frames (defines averaging window)</div><div class="ttdef"><b>Definition:</b> <a href="deshake_8h_source.html#l00069">deshake.h:69</a></div></div>
<div class="ttc" id="atests_2movenc_8c_html_a1277960b5f2b37137fe9b0b5a1ea0beb"><div class="ttname"><a href="tests_2movenc_8c.html#a1277960b5f2b37137fe9b0b5a1ea0beb">out</a></div><div class="ttdeci">FILE * out</div><div class="ttdef"><b>Definition:</b> <a href="tests_2movenc_8c_source.html#l00054">movenc.c:54</a></div></div>
<div class="ttc" id="astruct_a_v_filter_context_html"><div class="ttname"><a href="struct_a_v_filter_context.html">AVFilterContext</a></div><div class="ttdef"><b>Definition:</b> <a href="avfilter_8h_source.html#l00341">avfilter.h:341</a></div></div>
<div class="ttc" id="aavfilter_8c_html_a65d6e9755eadf69367843dfc738143b4"><div class="ttname"><a href="avfilter_8c.html#a65d6e9755eadf69367843dfc738143b4">ff_filter_frame</a></div><div class="ttdeci">int ff_filter_frame(AVFilterLink *link, AVFrame *frame)</div><div class="ttdef"><b>Definition:</b> <a href="avfilter_8c_source.html#l01091">avfilter.c:1091</a></div></div>
<div class="ttc" id="apixdesc_8c_html_afe0c3e8aef5173de28bbdaea4298f5f0"><div class="ttname"><a href="pixdesc_8c.html#afe0c3e8aef5173de28bbdaea4298f5f0">av_pix_fmt_desc_get</a></div><div class="ttdeci">const AVPixFmtDescriptor * av_pix_fmt_desc_get(enum AVPixelFormat pix_fmt)</div><div class="ttdef"><b>Definition:</b> <a href="pixdesc_8c_source.html#l02573">pixdesc.c:2573</a></div></div>
<div class="ttc" id="atransform_8h_html_af4d5243b6d8328548c892fc886768392aae9f7b288c817d8ef959d090fd0e9dbb"><div class="ttname"><a href="transform_8h.html#af4d5243b6d8328548c892fc886768392aae9f7b288c817d8ef959d090fd0e9dbb">FILL_CLAMP</a></div><div class="ttdeci">@ FILL_CLAMP</div><div class="ttdef"><b>Definition:</b> <a href="transform_8h_source.html#l00054">transform.h:54</a></div></div>
<div class="ttc" id="alibavcodec_24xm_8c_html_a19c59215a57cc549287f6d8481937b12"><div class="ttname"><a href="libavcodec_24xm_8c.html#a19c59215a57cc549287f6d8481937b12">mv</a></div><div class="ttdeci">static const int8_t mv[256][2]</div><div class="ttdef"><b>Definition:</b> <a href="libavcodec_24xm_8c_source.html#l00077">4xm.c:77</a></div></div>
<div class="ttc" id="agroup__lavu__frame_html_ga979d73f3228814aee56aeca0636e37cc"><div class="ttname"><a href="group__lavu__frame.html#ga979d73f3228814aee56aeca0636e37cc">av_frame_free</a></div><div class="ttdeci">void av_frame_free(AVFrame **frame)</div><div class="ttdef"><b>Definition:</b> <a href="frame_8c_source.html#l00203">frame.c:203</a></div></div>
<div class="ttc" id="apixdesc_8h_html"><div class="ttname"><a href="pixdesc_8h.html">pixdesc.h</a></div></div>
<div class="ttc" id="astruct_deshake_context_html_a1ff6b67c812f624a4fb63bf11c3e36f4"><div class="ttname"><a href="struct_deshake_context.html#a1ff6b67c812f624a4fb63bf11c3e36f4">DeshakeContext::sad</a></div><div class="ttdeci">av_pixelutils_sad_fn sad</div><div class="ttdoc">Sum of the absolute difference function.</div><div class="ttdef"><b>Definition:</b> <a href="deshake_8h_source.html#l00067">deshake.h:67</a></div></div>
<div class="ttc" id="avf__deshake_8c_html_a0b5a799705df7848bf12916293611edb"><div class="ttname"><a href="vf__deshake_8c.html#a0b5a799705df7848bf12916293611edb">deshake_options</a></div><div class="ttdeci">static const AVOption deshake_options[]</div><div class="ttdef"><b>Definition:</b> <a href="vf__deshake_8c_source.html#l00067">vf_deshake.c:67</a></div></div>
<div class="ttc" id="ainput_8c_html_ad6cdb6a14abe3eab42eaaadc93409aec"><div class="ttname"><a href="input_8c.html#ad6cdb6a14abe3eab42eaaadc93409aec">b</a></div><div class="ttdeci">#define b</div><div class="ttdef"><b>Definition:</b> <a href="input_8c_source.html#l00041">input.c:41</a></div></div>
<div class="ttc" id="astruct_deshake_context_html_a39cf8679c55ae0d64be2772a8dcc3931"><div class="ttname"><a href="struct_deshake_context.html#a39cf8679c55ae0d64be2772a8dcc3931">DeshakeContext::angles</a></div><div class="ttdeci">double * angles</div><div class="ttdoc">&lt; Scratch buffer for motion search</div><div class="ttdef"><b>Definition:</b> <a href="deshake_8h_source.html#l00058">deshake.h:58</a></div></div>
<div class="ttc" id="astruct_a_v_filter_pad_html"><div class="ttname"><a href="struct_a_v_filter_pad.html">AVFilterPad</a></div><div class="ttdef"><b>Definition:</b> <a href="libavfilter_2internal_8h_source.html#l00054">internal.h:54</a></div></div>
<div class="ttc" id="agroup__lavu__log__constants_html_ga9b58b28e2d429b930b69db19877f76a8"><div class="ttname"><a href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a></div><div class="ttdeci">#define AV_LOG_VERBOSE</div><div class="ttdef"><b>Definition:</b> <a href="log_8h_source.html#l00210">log.h:210</a></div></div>
<div class="ttc" id="avf__deshake_8c_html_a5b4e302dfe4b2ee5369f0278621acd5f"><div class="ttname"><a href="vf__deshake_8c.html#a5b4e302dfe4b2ee5369f0278621acd5f">query_formats</a></div><div class="ttdeci">static int query_formats(AVFilterContext *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="vf__deshake_8c_source.html#l00374">vf_deshake.c:374</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5a1afff2f2eecd8629e6136d2e044ed66b"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a1afff2f2eecd8629e6136d2e044ed66b">AV_PIX_FMT_YUV440P</a></div><div class="ttdeci">@ AV_PIX_FMT_YUV440P</div><div class="ttdoc">planar YUV 4:4:0 (1 Cr &amp; Cb sample per 1x2 Y samples)</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00099">pixfmt.h:99</a></div></div>
<div class="ttc" id="avf__deshake_8c_html_a6f7118896fe6949408f13e1d575dac14"><div class="ttname"><a href="vf__deshake_8c.html#a6f7118896fe6949408f13e1d575dac14">deshake_inputs</a></div><div class="ttdeci">static const AVFilterPad deshake_inputs[]</div><div class="ttdef"><b>Definition:</b> <a href="vf__deshake_8c_source.html#l00535">vf_deshake.c:535</a></div></div>
<div class="ttc" id="atransform_8h_html_a242ace442acd0d243c565f62f422c13e"><div class="ttname"><a href="transform_8h.html#a242ace442acd0d243c565f62f422c13e">InterpolateMethod</a></div><div class="ttdeci">InterpolateMethod</div><div class="ttdef"><b>Definition:</b> <a href="transform_8h_source.html#l00039">transform.h:39</a></div></div>
<div class="ttc" id="astruct_a_v_filter_link_html_a1efd10db9d097b6d27054da46e06e133"><div class="ttname"><a href="struct_a_v_filter_link.html#a1efd10db9d097b6d27054da46e06e133">AVFilterLink::h</a></div><div class="ttdeci">int h</div><div class="ttdoc">agreed upon image height</div><div class="ttdef"><b>Definition:</b> <a href="avfilter_8h_source.html#l00482">avfilter.h:482</a></div></div>
<div class="ttc" id="astruct_deshake_context_html_a94439e164a0389ca657bfb66ff303120"><div class="ttname"><a href="struct_deshake_context.html#a94439e164a0389ca657bfb66ff303120">DeshakeContext::edge</a></div><div class="ttdeci">int edge</div><div class="ttdoc">Edge fill method.</div><div class="ttdef"><b>Definition:</b> <a href="deshake_8h_source.html#l00063">deshake.h:63</a></div></div>
<div class="ttc" id="avf__deshake_8c_html_a6ccad09b4a2a06ae178418fdccf5940d"><div class="ttname"><a href="vf__deshake_8c.html#a6ccad09b4a2a06ae178418fdccf5940d">FLAGS</a></div><div class="ttdeci">#define FLAGS</div><div class="ttdef"><b>Definition:</b> <a href="vf__deshake_8c_source.html#l00065">vf_deshake.c:65</a></div></div>
<div class="ttc" id="avideo_8h_html"><div class="ttname"><a href="video_8h.html">video.h</a></div></div>
<div class="ttc" id="avf__deshake_8c_html_aecfebc764eb913f6445cc9fffd51948f"><div class="ttname"><a href="vf__deshake_8c.html#aecfebc764eb913f6445cc9fffd51948f">block_contrast</a></div><div class="ttdeci">static int block_contrast(uint8_t *src, int x, int y, int stride, int blocksize)</div><div class="ttdef"><b>Definition:</b> <a href="vf__deshake_8c_source.html#l00190">vf_deshake.c:190</a></div></div>
<div class="ttc" id="atransform_8h_html_af4d5243b6d8328548c892fc886768392ae0120c83a90c5d1cb3f3dce4a71cb249"><div class="ttname"><a href="transform_8h.html#af4d5243b6d8328548c892fc886768392ae0120c83a90c5d1cb3f3dce4a71cb249">FILL_ORIGINAL</a></div><div class="ttdeci">@ FILL_ORIGINAL</div><div class="ttdef"><b>Definition:</b> <a href="transform_8h_source.html#l00053">transform.h:53</a></div></div>
<div class="ttc" id="astruct_transform_html_a476a0c4f5ca9d7928241a69130090820"><div class="ttname"><a href="struct_transform.html#a476a0c4f5ca9d7928241a69130090820">Transform::angle</a></div><div class="ttdeci">double angle</div><div class="ttdoc">Angle of rotation.</div><div class="ttdef"><b>Definition:</b> <a href="deshake_8h_source.html#l00049">deshake.h:49</a></div></div>
<div class="ttc" id="aformats_8h_html"><div class="ttname"><a href="formats_8h.html">formats.h</a></div></div>
<div class="ttc" id="atransform_8h_html_af4d5243b6d8328548c892fc886768392a50856ca498d2adde2a521ba661d5cd1c"><div class="ttname"><a href="transform_8h.html#af4d5243b6d8328548c892fc886768392a50856ca498d2adde2a521ba661d5cd1c">FILL_BLANK</a></div><div class="ttdeci">@ FILL_BLANK</div><div class="ttdef"><b>Definition:</b> <a href="transform_8h_source.html#l00052">transform.h:52</a></div></div>
<div class="ttc" id="astruct_deshake_context_html_abdb580132fa6a0e8412667fa7c285bce"><div class="ttname"><a href="struct_deshake_context.html#abdb580132fa6a0e8412667fa7c285bce">DeshakeContext::ry</a></div><div class="ttdeci">int ry</div><div class="ttdoc">Maximum vertical shift.</div><div class="ttdef"><b>Definition:</b> <a href="deshake_8h_source.html#l00062">deshake.h:62</a></div></div>
<div class="ttc" id="astruct_deshake_context_html_abd5ea6e330026e31b16a5183ebaf9543"><div class="ttname"><a href="struct_deshake_context.html#abd5ea6e330026e31b16a5183ebaf9543">DeshakeContext::counts</a></div><div class="ttdeci">int counts[2 *MAX_R+1][2 *MAX_R+1]</div><div class="ttdef"><b>Definition:</b> <a href="deshake_8h_source.html#l00057">deshake.h:57</a></div></div>
<div class="ttc" id="avf__deshake_8c_html_aab22bd58952aaae386b1e791eb38bcfd"><div class="ttname"><a href="vf__deshake_8c.html#aab22bd58952aaae386b1e791eb38bcfd">AVFILTER_DEFINE_CLASS</a></div><div class="ttdeci">AVFILTER_DEFINE_CLASS(deshake)</div></div>
<div class="ttc" id="astruct_deshake_context_html_a70c6d07a34c6dbade46c855778848068"><div class="ttname"><a href="struct_deshake_context.html#a70c6d07a34c6dbade46c855778848068">DeshakeContext::last</a></div><div class="ttdeci">Transform last</div><div class="ttdoc">Transform from last frame.</div><div class="ttdef"><b>Definition:</b> <a href="deshake_8h_source.html#l00068">deshake.h:68</a></div></div>
<div class="ttc" id="acheckasm_8h_html_a73a3b169ac8c3419cbe15327e75ffcfd"><div class="ttname"><a href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a></div><div class="ttdeci">#define fail()</div><div class="ttdef"><b>Definition:</b> <a href="checkasm_8h_source.html#l00123">checkasm.h:123</a></div></div>
<div class="ttc" id="avf__deshake_8c_html_ab7cd5b404747a481115ce1d090fd11b8"><div class="ttname"><a href="vf__deshake_8c.html#ab7cd5b404747a481115ce1d090fd11b8">init</a></div><div class="ttdeci">static av_cold int init(AVFilterContext *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="vf__deshake_8c_source.html#l00341">vf_deshake.c:341</a></div></div>
<div class="ttc" id="avf__deshake_8c_html_a6f91b4cd1af5dc277444c465e2ca3ab6"><div class="ttname"><a href="vf__deshake_8c.html#a6f91b4cd1af5dc277444c465e2ca3ab6">cmp</a></div><div class="ttdeci">static int cmp(const void *a, const void *b)</div><div class="ttdef"><b>Definition:</b> <a href="vf__deshake_8c_source.html#l00091">vf_deshake.c:91</a></div></div>
<div class="ttc" id="avf__deshake_8c_html_aaf5d3ea2fc8c31e0b02d3dd6fd96fc7e"><div class="ttname"><a href="vf__deshake_8c.html#aaf5d3ea2fc8c31e0b02d3dd6fd96fc7e">CMP</a></div><div class="ttdeci">#define CMP(i, j)</div></div>
<div class="ttc" id="avf__deshake_8c_html_ae24c6e964564d6ea161b28f66a1dd8fa"><div class="ttname"><a href="vf__deshake_8c.html#ae24c6e964564d6ea161b28f66a1dd8fa">ff_vf_deshake</a></div><div class="ttdeci">AVFilter ff_vf_deshake</div><div class="ttdef"><b>Definition:</b> <a href="vf__deshake_8c_source.html#l00553">vf_deshake.c:553</a></div></div>
<div class="ttc" id="aregdef_8h_html_ab89a77e63a7226fffaecb2e2c2ab5219"><div class="ttname"><a href="regdef_8h.html#ab89a77e63a7226fffaecb2e2c2ab5219">a1</a></div><div class="ttdeci">#define a1</div><div class="ttdef"><b>Definition:</b> <a href="regdef_8h_source.html#l00047">regdef.h:47</a></div></div>
<div class="ttc" id="adashdec_8c_html_a5b00ec1b903e9eba63fd2a01b96e4aa6"><div class="ttname"><a href="dashdec_8c.html#a5b00ec1b903e9eba63fd2a01b96e4aa6">aligned</a></div><div class="ttdeci">static int aligned(int val)</div><div class="ttdef"><b>Definition:</b> <a href="dashdec_8c_source.html#l00167">dashdec.c:167</a></div></div>
<div class="ttc" id="agroup__lavu__log__constants_html_gaffe151ff4cd8a24b2e77ac8d9616c85c"><div class="ttname"><a href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a></div><div class="ttdeci">#define AV_LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="log_8h_source.html#l00194">log.h:194</a></div></div>
<div class="ttc" id="aattributes_8h_html_abeeb324fff79a5335d36774704e2475c"><div class="ttname"><a href="attributes_8h.html#abeeb324fff79a5335d36774704e2475c">av_cold</a></div><div class="ttdeci">#define av_cold</div><div class="ttdef"><b>Definition:</b> <a href="attributes_8h_source.html#l00090">attributes.h:90</a></div></div>
<div class="ttc" id="aformats_8c_html_a3ea436a8d465066eecdfb2ff513ff504"><div class="ttname"><a href="formats_8c.html#a3ea436a8d465066eecdfb2ff513ff504">ff_set_common_formats</a></div><div class="ttdeci">int ff_set_common_formats(AVFilterContext *ctx, AVFilterFormats *formats)</div><div class="ttdef"><b>Definition:</b> <a href="formats_8c_source.html#l00587">formats.c:587</a></div></div>
<div class="ttc" id="avf__deshake_8c_html_ad12dce0a7bf9d908b172a28155b3d261"><div class="ttname"><a href="vf__deshake_8c.html#ad12dce0a7bf9d908b172a28155b3d261">OFFSET</a></div><div class="ttdeci">#define OFFSET(x)</div><div class="ttdef"><b>Definition:</b> <a href="vf__deshake_8c_source.html#l00064">vf_deshake.c:64</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5ab2e2ccfaeec66c0a5f58ffdbe2e850f9"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5ab2e2ccfaeec66c0a5f58ffdbe2e850f9">AV_PIX_FMT_YUVJ422P</a></div><div class="ttdeci">@ AV_PIX_FMT_YUVJ422P</div><div class="ttdoc">planar YUV 4:2:2, 16bpp, full scale (JPEG), deprecated in favor of AV_PIX_FMT_YUV422P and setting col...</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00079">pixfmt.h:79</a></div></div>
<div class="ttc" id="atransform_8h_html_af4d5243b6d8328548c892fc886768392a9b94f4ae4a71614bc55bbf53fccf7fe9"><div class="ttname"><a href="transform_8h.html#af4d5243b6d8328548c892fc886768392a9b94f4ae4a71614bc55bbf53fccf7fe9">FILL_COUNT</a></div><div class="ttdeci">@ FILL_COUNT</div><div class="ttdef"><b>Definition:</b> <a href="transform_8h_source.html#l00056">transform.h:56</a></div></div>
<div class="ttc" id="atests_2snowenc_8c_html_a667b04d7fb6ef46db4da4af554c5b6f7"><div class="ttname"><a href="tests_2snowenc_8c.html#a667b04d7fb6ef46db4da4af554c5b6f7">width</a></div><div class="ttdeci">#define width</div></div>
<div class="ttc" id="alibavutil_2internal_8h_html_ae59bb66df9495df417c2632403e23aa7"><div class="ttname"><a href="libavutil_2internal_8h.html#ae59bb66df9495df417c2632403e23aa7">emms_c</a></div><div class="ttdeci">#define emms_c()</div><div class="ttdef"><b>Definition:</b> <a href="libavutil_2internal_8h_source.html#l00055">internal.h:55</a></div></div>
<div class="ttc" id="astruct_deshake_context_html_aad54a481fde4715adc86c3ba4be8a02b"><div class="ttname"><a href="struct_deshake_context.html#aad54a481fde4715adc86c3ba4be8a02b">DeshakeContext::rx</a></div><div class="ttdeci">int rx</div><div class="ttdoc">Maximum horizontal shift.</div><div class="ttdef"><b>Definition:</b> <a href="deshake_8h_source.html#l00061">deshake.h:61</a></div></div>
<div class="ttc" id="acommon_8h_html_a5d13452b0fac0d41b08ea2e49ea6eaa5"><div class="ttname"><a href="common_8h.html#a5d13452b0fac0d41b08ea2e49ea6eaa5">AV_CEIL_RSHIFT</a></div><div class="ttdeci">#define AV_CEIL_RSHIFT(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00058">common.h:58</a></div></div>
<div class="ttc" id="astruct_transform_html_ae065025ee0e628935faaace023464170"><div class="ttname"><a href="struct_transform.html#ae065025ee0e628935faaace023464170">Transform::vec</a></div><div class="ttdeci">MotionVector vec</div><div class="ttdoc">Motion vector.</div><div class="ttdef"><b>Definition:</b> <a href="deshake_8h_source.html#l00048">deshake.h:48</a></div></div>
<div class="ttc" id="astruct_deshake_context_html"><div class="ttname"><a href="struct_deshake_context.html">DeshakeContext</a></div><div class="ttdef"><b>Definition:</b> <a href="deshake_8h_source.html#l00055">deshake.h:55</a></div></div>
<div class="ttc" id="astruct_int_motion_vector_html"><div class="ttname"><a href="struct_int_motion_vector.html">IntMotionVector</a></div><div class="ttdef"><b>Definition:</b> <a href="deshake_8h_source.html#l00037">deshake.h:37</a></div></div>
<div class="ttc" id="astruct_motion_vector_html_a925fd96d0d9fe4920a2c788633e161d3"><div class="ttname"><a href="struct_motion_vector.html#a925fd96d0d9fe4920a2c788633e161d3">MotionVector::x</a></div><div class="ttdeci">int16_t x</div><div class="ttdef"><b>Definition:</b> <a href="agm_8c_source.html#l00055">agm.c:55</a></div></div>
<div class="ttc" id="astruct_deshake_context_html_aaaf79f33599d26f511c835b30f18d02a"><div class="ttname"><a href="struct_deshake_context.html#aaaf79f33599d26f511c835b30f18d02a">DeshakeContext::cx</a></div><div class="ttdeci">int cx</div><div class="ttdef"><b>Definition:</b> <a href="deshake_8h_source.html#l00074">deshake.h:74</a></div></div>
<div class="ttc" id="aaf__acontrast_8c_html_a7ddb0b5ac76101c5bee71e9840bf1698"><div class="ttname"><a href="af__acontrast_8c.html#a7ddb0b5ac76101c5bee71e9840bf1698">outputs</a></div><div class="ttdeci">static const AVFilterPad outputs[]</div><div class="ttdef"><b>Definition:</b> <a href="af__acontrast_8c_source.html#l00203">af_acontrast.c:203</a></div></div>
<div class="ttc" id="alibkvazaar_8c_html_aa1219ee396a270ba57fd4f2306b64c6e"><div class="ttname"><a href="libkvazaar_8c.html#aa1219ee396a270ba57fd4f2306b64c6e">pix_fmts</a></div><div class="ttdeci">static enum AVPixelFormat pix_fmts[]</div><div class="ttdef"><b>Definition:</b> <a href="libkvazaar_8c_source.html#l00162">libkvazaar.c:300</a></div></div>
<div class="ttc" id="astruct_a_v_option_html"><div class="ttname"><a href="struct_a_v_option.html">AVOption</a></div><div class="ttdef"><b>Definition:</b> <a href="opt_8h_source.html#l00248">opt.h:248</a></div></div>
<div class="ttc" id="atests_2movenc_8c_html_a93cc7296f13f507c1fd7abd0db36b898"><div class="ttname"><a href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a></div><div class="ttdeci">AVFormatContext * ctx</div><div class="ttdef"><b>Definition:</b> <a href="tests_2movenc_8c_source.html#l00048">movenc.c:48</a></div></div>
<div class="ttc" id="astruct_deshake_context_html_a502b5256842d4ed130aa346fa1bd97c9"><div class="ttname"><a href="struct_deshake_context.html#a502b5256842d4ed130aa346fa1bd97c9">DeshakeContext::cw</a></div><div class="ttdeci">int cw</div><div class="ttdoc">Crop motion search to this box.</div><div class="ttdef"><b>Definition:</b> <a href="deshake_8h_source.html#l00072">deshake.h:72</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5a1aa7677092740d8def31655b5d7f0cc2"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a1aa7677092740d8def31655b5d7f0cc2">AV_PIX_FMT_YUV420P</a></div><div class="ttdeci">@ AV_PIX_FMT_YUV420P</div><div class="ttdoc">planar YUV 4:2:0, 12bpp, (1 Cr &amp; Cb sample per 2x2 Y samples)</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00066">pixfmt.h:66</a></div></div>
<div class="ttc" id="afilter__design_8txt_html_a11a6a594845d2b9bf51b9ccc8a83c83d"><div class="ttname"><a href="filter__design_8txt.html#a11a6a594845d2b9bf51b9ccc8a83c83d">link</a></div><div class="ttdeci">Filter the word “frame” indicates either a video frame or a group of audio as stored in an AVFrame structure Format for each input and each output the list of supported formats For video that means pixel format For audio that means channel sample they are references to shared objects When the negotiation mechanism computes the intersection of the formats supported at each end of a link</div><div class="ttdef"><b>Definition:</b> <a href="filter__design_8txt_source.html#l00023">filter_design.txt:23</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5ae21031dcb2dd7bc75c83ec1ac2c26157"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5ae21031dcb2dd7bc75c83ec1ac2c26157">AV_PIX_FMT_YUVJ444P</a></div><div class="ttdeci">@ AV_PIX_FMT_YUVJ444P</div><div class="ttdoc">planar YUV 4:4:4, 24bpp, full scale (JPEG), deprecated in favor of AV_PIX_FMT_YUV444P and setting col...</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00080">pixfmt.h:80</a></div></div>
<div class="ttc" id="acoverity_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="coverity_8c_source.html#l00032">coverity.c:32</a></div></div>
<div class="ttc" id="agroup__lavu__error_html_ga67a27567a9e5b7037fee072fbcc34dbf"><div class="ttname"><a href="group__lavu__error.html#ga67a27567a9e5b7037fee072fbcc34dbf">AVERROR_PATCHWELCOME</a></div><div class="ttdeci">#define AVERROR_PATCHWELCOME</div><div class="ttdoc">Not yet implemented in FFmpeg, patches welcome.</div><div class="ttdef"><b>Definition:</b> <a href="error_8h_source.html#l00062">error.h:62</a></div></div>
<div class="ttc" id="agroup__lavu__frame_html_gab9b275b114ace0db95c5796bc71f3012"><div class="ttname"><a href="group__lavu__frame.html#gab9b275b114ace0db95c5796bc71f3012">av_frame_copy_props</a></div><div class="ttdeci">int av_frame_copy_props(AVFrame *dst, const AVFrame *src)</div><div class="ttdef"><b>Definition:</b> <a href="frame_8c_source.html#l00658">frame.c:658</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5aef61d7a65003ef618420f618294107b0"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5aef61d7a65003ef618420f618294107b0">AV_PIX_FMT_YUVJ420P</a></div><div class="ttdeci">@ AV_PIX_FMT_YUVJ420P</div><div class="ttdoc">planar YUV 4:2:0, 12bpp, full scale (JPEG), deprecated in favor of AV_PIX_FMT_YUV420P and setting col...</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00078">pixfmt.h:78</a></div></div>
<div class="ttc" id="atests_2checkasm_2vp8dsp_8c_html_a858376c0918f93e656c8c0d76c63dbe8"><div class="ttname"><a href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a></div><div class="ttdeci">#define src</div><div class="ttdef"><b>Definition:</b> <a href="tests_2checkasm_2vp8dsp_8c_source.html#l00254">vp8dsp.c:254</a></div></div>
<div class="ttc" id="astruct_deshake_context_html_a40de303d95ecd35d7210de190a0ad73d"><div class="ttname"><a href="struct_deshake_context.html#a40de303d95ecd35d7210de190a0ad73d">DeshakeContext::fp</a></div><div class="ttdeci">FILE * fp</div><div class="ttdef"><b>Definition:</b> <a href="deshake_8h_source.html#l00070">deshake.h:70</a></div></div>
<div class="ttc" id="astruct_deshake_context_html_af2743a76120cd89fe70274050c969848"><div class="ttname"><a href="struct_deshake_context.html#af2743a76120cd89fe70274050c969848">DeshakeContext::contrast</a></div><div class="ttdeci">int contrast</div><div class="ttdoc">Contrast threshold.</div><div class="ttdef"><b>Definition:</b> <a href="deshake_8h_source.html#l00065">deshake.h:65</a></div></div>
<div class="ttc" id="avf__deshake_8c_html_aa24bf614ee38d45bcf498a6ab95d5bec"><div class="ttname"><a href="vf__deshake_8c.html#aa24bf614ee38d45bcf498a6ab95d5bec">block_angle</a></div><div class="ttdeci">static double block_angle(int x, int y, int cx, int cy, IntMotionVector *shift)</div><div class="ttdef"><b>Definition:</b> <a href="vf__deshake_8c_source.html#l00214">vf_deshake.c:214</a></div></div>
<div class="ttc" id="astruct_a_v_pix_fmt_descriptor_html"><div class="ttname"><a href="struct_a_v_pix_fmt_descriptor.html">AVPixFmtDescriptor</a></div><div class="ttdef"><b>Definition:</b> <a href="pixdesc_8h_source.html#l00081">pixdesc.h:81</a></div></div>
<div class="ttc" id="afilter__design_8txt_html_a45917ba5e6c8b798c6e2ba6ca7301a5d"><div class="ttname"><a href="filter__design_8txt.html#a45917ba5e6c8b798c6e2ba6ca7301a5d">inputs</a></div><div class="ttdeci">these buffered frames must be flushed immediately if a new input produces new the filter must not call request_frame to get more It must just process the frame or queue it The task of requesting more frames is left to the filter s request_frame method or the application If a filter has several inputs</div><div class="ttdef"><b>Definition:</b> <a href="filter__design_8txt_source.html#l00243">filter_design.txt:243</a></div></div>
<div class="ttc" id="astruct_deshake_context_html_a6cb3bf3f9849589388dfe656e6ff6dfd"><div class="ttname"><a href="struct_deshake_context.html#a6cb3bf3f9849589388dfe656e6ff6dfd">DeshakeContext::cy</a></div><div class="ttdeci">int cy</div><div class="ttdef"><b>Definition:</b> <a href="deshake_8h_source.html#l00075">deshake.h:75</a></div></div>
<div class="ttc" id="astruct_deshake_context_html_a61799657cdab45ec28f580b9e3f0fd23"><div class="ttname"><a href="struct_deshake_context.html#a61799657cdab45ec28f580b9e3f0fd23">DeshakeContext::ref</a></div><div class="ttdeci">AVFrame * ref</div><div class="ttdoc">Previous frame.</div><div class="ttdef"><b>Definition:</b> <a href="deshake_8h_source.html#l00060">deshake.h:60</a></div></div>
<div class="ttc" id="astruct_deshake_context_html_a8e577f2fe633ed2454362438ad5a6d84"><div class="ttname"><a href="struct_deshake_context.html#a8e577f2fe633ed2454362438ad5a6d84">DeshakeContext::angles_size</a></div><div class="ttdeci">unsigned angles_size</div><div class="ttdef"><b>Definition:</b> <a href="deshake_8h_source.html#l00059">deshake.h:59</a></div></div>
<div class="ttc" id="astruct_a_v_filter_pad_html_afc112061a6035639934e0135aab7d425"><div class="ttname"><a href="struct_a_v_filter_pad.html#afc112061a6035639934e0135aab7d425">AVFilterPad::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="libavfilter_2internal_8h_source.html#l00060">internal.h:60</a></div></div>
<div class="ttc" id="avf__deshake_8c_html_ae2332ccfbd43fd6b49ae6c5ba8095b20"><div class="ttname"><a href="vf__deshake_8c.html#ae2332ccfbd43fd6b49ae6c5ba8095b20">find_motion</a></div><div class="ttdeci">static void find_motion(DeshakeContext *deshake, uint8_t *src1, uint8_t *src2, int width, int height, int stride, Transform *t)</div><div class="ttdef"><b>Definition:</b> <a href="vf__deshake_8c_source.html#l00235">vf_deshake.c:235</a></div></div>
<div class="ttc" id="aqsort_8h_html"><div class="ttname"><a href="qsort_8h.html">qsort.h</a></div></div>
<div class="ttc" id="avf__deshake_8c_html_a3e236414798d891d2ffed620dc2d3dba"><div class="ttname"><a href="vf__deshake_8c.html#a3e236414798d891d2ffed620dc2d3dba">clean_mean</a></div><div class="ttdeci">static double clean_mean(double *values, int count)</div><div class="ttdef"><b>Definition:</b> <a href="vf__deshake_8c_source.html#l00099">vf_deshake.c:99</a></div></div>
<div class="ttc" id="avf__deshake_8c_html_adc52044925d04f6334b3b436c454f793"><div class="ttname"><a href="vf__deshake_8c.html#adc52044925d04f6334b3b436c454f793">find_block_motion</a></div><div class="ttdeci">static void find_block_motion(DeshakeContext *deshake, uint8_t *src1, uint8_t *src2, int cx, int cy, int stride, IntMotionVector *mv)</div><div class="ttdef"><b>Definition:</b> <a href="vf__deshake_8c_source.html#l00120">vf_deshake.c:120</a></div></div>
<div class="ttc" id="astruct_motion_vector_html_ac6abeed7e7362852e8b9b5b2dd0d7eac"><div class="ttname"><a href="struct_motion_vector.html#ac6abeed7e7362852e8b9b5b2dd0d7eac">MotionVector::y</a></div><div class="ttdeci">int16_t y</div><div class="ttdef"><b>Definition:</b> <a href="agm_8c_source.html#l00055">agm.c:55</a></div></div>
<div class="ttc" id="alibavutil_2internal_8h_html_a3c0fa12fafe59c44d4b16e60d8385637"><div class="ttname"><a href="libavutil_2internal_8h.html#a3c0fa12fafe59c44d4b16e60d8385637">NULL_IF_CONFIG_SMALL</a></div><div class="ttdeci">#define NULL_IF_CONFIG_SMALL(x)</div><div class="ttdef"><b>Definition:</b> <a href="libavutil_2internal_8h_source.html#l00153">internal.h:153</a></div></div>
<div class="ttc" id="astruct_transform_html"><div class="ttname"><a href="struct_transform.html">Transform</a></div><div class="ttdef"><b>Definition:</b> <a href="deshake_8h_source.html#l00047">deshake.h:47</a></div></div>
<div class="ttc" id="astruct_deshake_context_html_a0e535db0bddddadba65f43d9d608b33f"><div class="ttname"><a href="struct_deshake_context.html#a0e535db0bddddadba65f43d9d608b33f">DeshakeContext::ch</a></div><div class="ttdeci">int ch</div><div class="ttdef"><b>Definition:</b> <a href="deshake_8h_source.html#l00073">deshake.h:73</a></div></div>
<div class="ttc" id="atransform_8h_html_af4d5243b6d8328548c892fc886768392a6a25bf8b2724eb544a2dbd84fff34b45"><div class="ttname"><a href="transform_8h.html#af4d5243b6d8328548c892fc886768392a6a25bf8b2724eb544a2dbd84fff34b45">FILL_MIRROR</a></div><div class="ttdeci">@ FILL_MIRROR</div><div class="ttdef"><b>Definition:</b> <a href="transform_8h_source.html#l00055">transform.h:55</a></div></div>
<div class="ttc" id="acommon_8h_html_add8913a6f8e5714b6174eeaad5751006"><div class="ttname"><a href="common_8h.html#add8913a6f8e5714b6174eeaad5751006">FFDIFFSIGN</a></div><div class="ttdeci">#define FFDIFFSIGN(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00092">common.h:92</a></div></div>
<div class="ttc" id="atests_2snowenc_8c_html_a64f9f90ece96c7bab4aee3deacf170e0"><div class="ttname"><a href="tests_2snowenc_8c.html#a64f9f90ece96c7bab4aee3deacf170e0">height</a></div><div class="ttdeci">#define height</div></div>
<div class="ttc" id="acommon_8h_html_a0f84cbd7fd810cd678157c98cbfad4b0"><div class="ttname"><a href="common_8h.html#a0f84cbd7fd810cd678157c98cbfad4b0">FFMIN</a></div><div class="ttdeci">#define FFMIN(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00096">common.h:96</a></div></div>
<div class="ttc" id="aundefined_8txt_html_ad99f336d4c117c453fef82993434eb4d"><div class="ttname"><a href="undefined_8txt.html#ad99f336d4c117c453fef82993434eb4d">a</a></div><div class="ttdeci">The reader does not expect b to be semantically here and if the code is changed by maybe adding a a division or other the signedness will almost certainly be mistaken To avoid this confusion a new type was SUINT is the C unsigned type but it holds a signed int to use the same example SUINT a</div><div class="ttdef"><b>Definition:</b> <a href="undefined_8txt_source.html#l00041">undefined.txt:41</a></div></div>
<div class="ttc" id="atransform_8h_html_a242ace442acd0d243c565f62f422c13ea9b90d08e3d5ac2ba46255c82274c85f3"><div class="ttname"><a href="transform_8h.html#a242ace442acd0d243c565f62f422c13ea9b90d08e3d5ac2ba46255c82274c85f3">INTERPOLATE_BILINEAR</a></div><div class="ttdeci">@ INTERPOLATE_BILINEAR</div><div class="ttdef"><b>Definition:</b> <a href="transform_8h_source.html#l00041">transform.h:41</a></div></div>
<div class="ttc" id="astruct_deshake_context_html_a9484b0ef1ba673ffdb2ebc437aaf4c04"><div class="ttname"><a href="struct_deshake_context.html#a9484b0ef1ba673ffdb2ebc437aaf4c04">DeshakeContext::blocksize</a></div><div class="ttdeci">int blocksize</div><div class="ttdoc">Size of blocks to compare.</div><div class="ttdef"><b>Definition:</b> <a href="deshake_8h_source.html#l00064">deshake.h:64</a></div></div>
<div class="ttc" id="atwinvq_8c_html_ab0bd3e2f6305dfc9119c47f412993f92"><div class="ttname"><a href="twinvq_8c.html#ab0bd3e2f6305dfc9119c47f412993f92">interpolate</a></div><div class="ttdeci">static void interpolate(float *out, float v1, float v2, int size)</div><div class="ttdef"><b>Definition:</b> <a href="twinvq_8c_source.html#l00084">twinvq.c:84</a></div></div>
<div class="ttc" id="amathematics_8h_html_ae71449b1cc6e6250b91f539153a7a0d3"><div class="ttname"><a href="mathematics_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a></div><div class="ttdeci">#define M_PI</div><div class="ttdef"><b>Definition:</b> <a href="mathematics_8h_source.html#l00052">mathematics.h:52</a></div></div>
<div class="ttc" id="atests_2checkasm_2h264pred_8c_html_a631c6befc8ec221896734437f964a631"><div class="ttname"><a href="tests_2checkasm_2h264pred_8c.html#a631c6befc8ec221896734437f964a631">src1</a></div><div class="ttdeci">#define src1</div><div class="ttdef"><b>Definition:</b> <a href="tests_2checkasm_2h264pred_8c_source.html#l00139">h264pred.c:139</a></div></div>
<div class="ttc" id="aaudio__convert_8c_html_ab92ad91055387e15b43ff5f6f60f2895"><div class="ttname"><a href="audio__convert_8c.html#ab92ad91055387e15b43ff5f6f60f2895">in</a></div><div class="ttdeci">uint8_t pi&lt;&lt; 24) CONV_FUNC_GROUP(AV_SAMPLE_FMT_FLT, float, AV_SAMPLE_FMT_U8, uint8_t,(*(const uint8_t *) pi - 0x80) *(1.0f/(1&lt;&lt; 7))) CONV_FUNC_GROUP(AV_SAMPLE_FMT_DBL, double, AV_SAMPLE_FMT_U8, uint8_t,(*(const uint8_t *) pi - 0x80) *(1.0/(1&lt;&lt; 7))) CONV_FUNC_GROUP(AV_SAMPLE_FMT_U8, uint8_t, AV_SAMPLE_FMT_S16, int16_t,(*(const int16_t *) pi &gt;&gt; 8)+0x80) CONV_FUNC_GROUP(AV_SAMPLE_FMT_FLT, float, AV_SAMPLE_FMT_S16, int16_t, *(const int16_t *) pi *(1.0f/(1&lt;&lt; 15))) CONV_FUNC_GROUP(AV_SAMPLE_FMT_DBL, double, AV_SAMPLE_FMT_S16, int16_t, *(const int16_t *) pi *(1.0/(1&lt;&lt; 15))) CONV_FUNC_GROUP(AV_SAMPLE_FMT_U8, uint8_t, AV_SAMPLE_FMT_S32, int32_t,(*(const int32_t *) pi &gt;&gt; 24)+0x80) CONV_FUNC_GROUP(AV_SAMPLE_FMT_FLT, float, AV_SAMPLE_FMT_S32, int32_t, *(const int32_t *) pi *(1.0f/(1U&lt;&lt; 31))) CONV_FUNC_GROUP(AV_SAMPLE_FMT_DBL, double, AV_SAMPLE_FMT_S32, int32_t, *(const int32_t *) pi *(1.0/(1U&lt;&lt; 31))) CONV_FUNC_GROUP(AV_SAMPLE_FMT_U8, uint8_t, AV_SAMPLE_FMT_FLT, float, av_clip_uint8(lrintf(*(const float *) pi *(1&lt;&lt; 7))+0x80)) CONV_FUNC_GROUP(AV_SAMPLE_FMT_S16, int16_t, AV_SAMPLE_FMT_FLT, float, av_clip_int16(lrintf(*(const float *) pi *(1&lt;&lt; 15)))) CONV_FUNC_GROUP(AV_SAMPLE_FMT_S32, int32_t, AV_SAMPLE_FMT_FLT, float, av_clipl_int32(llrintf(*(const float *) pi *(1U&lt;&lt; 31)))) CONV_FUNC_GROUP(AV_SAMPLE_FMT_U8, uint8_t, AV_SAMPLE_FMT_DBL, double, av_clip_uint8(lrint(*(const double *) pi *(1&lt;&lt; 7))+0x80)) CONV_FUNC_GROUP(AV_SAMPLE_FMT_S16, int16_t, AV_SAMPLE_FMT_DBL, double, av_clip_int16(lrint(*(const double *) pi *(1&lt;&lt; 15)))) CONV_FUNC_GROUP(AV_SAMPLE_FMT_S32, int32_t, AV_SAMPLE_FMT_DBL, double, av_clipl_int32(llrint(*(const double *) pi *(1U&lt;&lt; 31)))) #define SET_CONV_FUNC_GROUP(ofmt, ifmt) static void set_generic_function(AudioConvert *ac) { } void ff_audio_convert_free(AudioConvert **ac) { if(! *ac) return;ff_dither_free(&amp;(*ac) -&gt;dc);av_freep(ac);} AudioConvert *ff_audio_convert_alloc(AVAudioResampleContext *avr, enum AVSampleFormat out_fmt, enum AVSampleFormat in_fmt, int channels, int sample_rate, int apply_map) { AudioConvert *ac;int in_planar, out_planar;ac=av_mallocz(sizeof(*ac));if(!ac) return NULL;ac-&gt;avr=avr;ac-&gt;out_fmt=out_fmt;ac-&gt;in_fmt=in_fmt;ac-&gt;channels=channels;ac-&gt;apply_map=apply_map;if(avr-&gt;dither_method !=AV_RESAMPLE_DITHER_NONE &amp;&amp;av_get_packed_sample_fmt(out_fmt)==AV_SAMPLE_FMT_S16 &amp;&amp;av_get_bytes_per_sample(in_fmt) &gt; 2) { ac-&gt;dc=ff_dither_alloc(avr, out_fmt, in_fmt, channels, sample_rate, apply_map);if(!ac-&gt;dc) { av_free(ac);return NULL;} return ac;} in_planar=ff_sample_fmt_is_planar(in_fmt, channels);out_planar=ff_sample_fmt_is_planar(out_fmt, channels);if(in_planar==out_planar) { ac-&gt;func_type=CONV_FUNC_TYPE_FLAT;ac-&gt;planes=in_planar ? ac-&gt;channels :1;} else if(in_planar) ac-&gt;func_type=CONV_FUNC_TYPE_INTERLEAVE;else ac-&gt;func_type=CONV_FUNC_TYPE_DEINTERLEAVE;set_generic_function(ac);if(ARCH_AARCH64) ff_audio_convert_init_aarch64(ac);if(ARCH_ARM) ff_audio_convert_init_arm(ac);if(ARCH_X86) ff_audio_convert_init_x86(ac);return ac;} int ff_audio_convert(AudioConvert *ac, AudioData *out, AudioData *in) { int use_generic=1;int len=in-&gt;nb_samples;int p;if(ac-&gt;dc) { av_log(ac-&gt;avr, AV_LOG_TRACE, &quot;%d samples - audio_convert: %s to %s (dithered)\n&quot;, len, av_get_sample_fmt_name(ac-&gt;in_fmt), av_get_sample_fmt_name(ac-&gt;out_fmt));return ff_convert_dither(ac-&gt; in</div><div class="ttdef"><b>Definition:</b> <a href="audio__convert_8c_source.html#l00326">audio_convert.c:326</a></div></div>
<div class="ttc" id="ainput_8c_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="input_8c_source.html#l00407">input.c:407</a></div></div>
<div class="ttc" id="avf__deshake_8c_html_a507c820aa4475d788435b7c8204df912"><div class="ttname"><a href="vf__deshake_8c.html#a507c820aa4475d788435b7c8204df912">filter_frame</a></div><div class="ttdeci">static int filter_frame(AVFilterLink *link, AVFrame *in)</div><div class="ttdef"><b>Definition:</b> <a href="vf__deshake_8c_source.html#l00410">vf_deshake.c:410</a></div></div>
<div class="ttc" id="atransform_8c_html_a33249c4342a334d41b1c124ef28031cb"><div class="ttname"><a href="transform_8c.html#a33249c4342a334d41b1c124ef28031cb">ff_get_matrix</a></div><div class="ttdeci">void ff_get_matrix(float x_shift, float y_shift, float angle, float scale_x, float scale_y, float *matrix)</div><div class="ttdef"><b>Definition:</b> <a href="transform_8c_source.html#l00106">transform.c:106</a></div></div>
<div class="ttc" id="avf__deshake_8c_html_af262c9da984a791ad141afe836421a49"><div class="ttname"><a href="vf__deshake_8c.html#af262c9da984a791ad141afe836421a49">config_props</a></div><div class="ttdeci">static int config_props(AVFilterLink *link)</div><div class="ttdef"><b>Definition:</b> <a href="vf__deshake_8c_source.html#l00387">vf_deshake.c:387</a></div></div>
<div class="ttc" id="aqsort_8h_html_a5a4ed81988ea43d4cca5bfe9a18147f6"><div class="ttname"><a href="qsort_8h.html#a5a4ed81988ea43d4cca5bfe9a18147f6">AV_QSORT</a></div><div class="ttdeci">#define AV_QSORT(p, num, type, cmp)</div><div class="ttdef"><b>Definition:</b> <a href="qsort_8h_source.html#l00033">qsort.h:33</a></div></div>
<div class="ttc" id="alibavutil_2internal_8h_html"><div class="ttname"><a href="libavutil_2internal_8h.html">internal.h</a></div></div>
<div class="ttc" id="adeshake_8h_html_abd60910b52e9fd2a0b8f4b030183f02ca1d1c0640efc4301d2e764b00b0ab2763"><div class="ttname"><a href="deshake_8h.html#abd60910b52e9fd2a0b8f4b030183f02ca1d1c0640efc4301d2e764b00b0ab2763">SEARCH_COUNT</a></div><div class="ttdeci">@ SEARCH_COUNT</div><div class="ttdef"><b>Definition:</b> <a href="deshake_8h_source.html#l00035">deshake.h:34</a></div></div>
<div class="ttc" id="aregdef_8h_html_aa3fd046b2956875cf908d73a51a96b42"><div class="ttname"><a href="regdef_8h.html#aa3fd046b2956875cf908d73a51a96b42">a2</a></div><div class="ttdeci">#define a2</div><div class="ttdef"><b>Definition:</b> <a href="regdef_8h_source.html#l00048">regdef.h:48</a></div></div>
<div class="ttc" id="acommon_8h_html"><div class="ttname"><a href="common_8h.html">common.h</a></div></div>
<div class="ttc" id="astruct_deshake_context_html_a7e72609c15783f245c66ba8005691735"><div class="ttname"><a href="struct_deshake_context.html#a7e72609c15783f245c66ba8005691735">DeshakeContext::transform</a></div><div class="ttdeci">int(* transform)(AVFilterContext *ctx, int width, int height, int cw, int ch, const float *matrix_y, const float *matrix_uv, enum InterpolateMethod interpolate, enum FillMethod fill, AVFrame *in, AVFrame *out)</div><div class="ttdef"><b>Definition:</b> <a href="deshake_8h_source.html#l00078">deshake.h:78</a></div></div>
<div class="ttc" id="adeshake_8h_html_a20743e1f7cb23b285cf53e3cfec40253"><div class="ttname"><a href="deshake_8h.html#a20743e1f7cb23b285cf53e3cfec40253">DeshakeContext</a></div><div class="ttdeci">struct DeshakeContext DeshakeContext</div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5a5f176d02770e3012fc799bf28a07f345"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a5f176d02770e3012fc799bf28a07f345">AV_PIX_FMT_YUVJ440P</a></div><div class="ttdeci">@ AV_PIX_FMT_YUVJ440P</div><div class="ttdoc">planar YUV 4:4:0 full scale (JPEG), deprecated in favor of AV_PIX_FMT_YUV440P and setting color_range</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00100">pixfmt.h:100</a></div></div>
<div class="ttc" id="aaudio__convert_8c_html_ae1affc9ca37cfb624959c866a73f83c2"><div class="ttname"><a href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a></div><div class="ttdeci">uint8_t</div><div class="ttdef"><b>Definition:</b> <a href="audio__convert_8c_source.html#l00194">audio_convert.c:194</a></div></div>
<div class="ttc" id="astruct_a_v_filter_formats_html"><div class="ttname"><a href="struct_a_v_filter_formats.html">AVFilterFormats</a></div><div class="ttdef"><b>Definition:</b> <a href="formats_8h_source.html#l00065">formats.h:65</a></div></div>
<div class="ttc" id="astruct_deshake_context_html_ac00c0833eb48d7a062dc599400acd4c1"><div class="ttname"><a href="struct_deshake_context.html#ac00c0833eb48d7a062dc599400acd4c1">DeshakeContext::filename</a></div><div class="ttdeci">char * filename</div><div class="ttdoc">Motion search detailed log filename.</div><div class="ttdef"><b>Definition:</b> <a href="deshake_8h_source.html#l00076">deshake.h:76</a></div></div>
<div class="ttc" id="afilter__design_8txt_html_af1ec77bdca1b30e8153fc5da88f603db"><div class="ttname"><a href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a></div><div class="ttdeci">ret</div><div class="ttdef"><b>Definition:</b> <a href="filter__design_8txt_source.html#l00187">filter_design.txt:187</a></div></div>
<div class="ttc" id="avf__find__rect_8c_html_af87d9de85f8aed850024a07b377fe315"><div class="ttname"><a href="vf__find__rect_8c.html#af87d9de85f8aed850024a07b377fe315">search</a></div><div class="ttdeci">static float search(FOCContext *foc, int pass, int maxpass, int xmin, int xmax, int ymin, int ymax, int *best_x, int *best_y, float best_score)</div><div class="ttdef"><b>Definition:</b> <a href="vf__find__rect_8c_source.html#l00155">vf_find_rect.c:155</a></div></div>
<div class="ttc" id="astruct_deshake_context_html_a1a63ead8e0e9dc5750cd064b1c45b9b3"><div class="ttname"><a href="struct_deshake_context.html#a1a63ead8e0e9dc5750cd064b1c45b9b3">DeshakeContext::avg</a></div><div class="ttdeci">Transform avg</div><div class="ttdef"><b>Definition:</b> <a href="deshake_8h_source.html#l00071">deshake.h:71</a></div></div>
<div class="ttc" id="adeshake_8h_html_abd60910b52e9fd2a0b8f4b030183f02ca7fc6856beca4e0f17a909d5445fcda71"><div class="ttname"><a href="deshake_8h.html#abd60910b52e9fd2a0b8f4b030183f02ca7fc6856beca4e0f17a909d5445fcda71">EXHAUSTIVE</a></div><div class="ttdeci">@ EXHAUSTIVE</div><div class="ttdoc">Search all possible positions.</div><div class="ttdef"><b>Definition:</b> <a href="deshake_8h_source.html#l00032">deshake.h:32</a></div></div>
<div class="ttc" id="aspdifenc_8c_html_addcb93d939ffa259ff1d9247bdd590fd"><div class="ttname"><a href="spdifenc_8c.html#addcb93d939ffa259ff1d9247bdd590fd">pos</a></div><div class="ttdeci">unsigned int pos</div><div class="ttdef"><b>Definition:</b> <a href="spdifenc_8c_source.html#l00410">spdifenc.c:410</a></div></div>
<div class="ttc" id="avf__deshake_8c_html_a11ba010a44de95305c0b0d7cc30cebe4"><div class="ttname"><a href="vf__deshake_8c.html#a11ba010a44de95305c0b0d7cc30cebe4">deshake_transform_c</a></div><div class="ttdeci">static int deshake_transform_c(AVFilterContext *ctx, int width, int height, int cw, int ch, const float *matrix_y, const float *matrix_uv, enum InterpolateMethod interpolate, enum FillMethod fill, AVFrame *in, AVFrame *out)</div><div class="ttdef"><b>Definition:</b> <a href="vf__deshake_8c_source.html#l00315">vf_deshake.c:315</a></div></div>
<div class="ttc" id="astruct_a_v_frame_html_a1d0f65014a8d1bf78cec8cbed2304992"><div class="ttname"><a href="struct_a_v_frame.html#a1d0f65014a8d1bf78cec8cbed2304992">AVFrame::data</a></div><div class="ttdeci">uint8_t * data[AV_NUM_DATA_POINTERS]</div><div class="ttdef"><b>Definition:</b> <a href="frame_8h_source.html#l00322">frame.h:322</a></div></div>
<div class="ttc" id="avf__deshake_8c_html_abbead6cde1da3e72ce200578c426f1e6"><div class="ttname"><a href="vf__deshake_8c.html#abbead6cde1da3e72ce200578c426f1e6">uninit</a></div><div class="ttdeci">static av_cold void uninit(AVFilterContext *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="vf__deshake_8c_source.html#l00400">vf_deshake.c:400</a></div></div>
<div class="ttc" id="astruct_a_v_frame_html_aed14fa772ce46881020fd1545c86432c"><div class="ttname"><a href="struct_a_v_frame.html#aed14fa772ce46881020fd1545c86432c">AVFrame::format</a></div><div class="ttdeci">int format</div><div class="ttdef"><b>Definition:</b> <a href="frame_8h_source.html#l00381">frame.h:381</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5a0e08f8a5d0fa21c3e258816a9dcce7c3"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a0e08f8a5d0fa21c3e258816a9dcce7c3">AV_PIX_FMT_NONE</a></div><div class="ttdeci">@ AV_PIX_FMT_NONE</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00065">pixfmt.h:65</a></div></div>
<div class="ttc" id="agroup__avoptions_html_ggabd75aa30eb8ad6387672df9a1fa79444ac068b8f6afeeb293a13aeabb5d702411"><div class="ttname"><a href="group__avoptions.html#ggabd75aa30eb8ad6387672df9a1fa79444ac068b8f6afeeb293a13aeabb5d702411">AV_OPT_TYPE_INT</a></div><div class="ttdeci">@ AV_OPT_TYPE_INT</div><div class="ttdef"><b>Definition:</b> <a href="opt_8h_source.html#l00225">opt.h:225</a></div></div>
<div class="ttc" id="aavfilter_8h_html"><div class="ttname"><a href="avfilter_8h.html">avfilter.h</a></div></div>
<div class="ttc" id="adeshake_8h_html"><div class="ttname"><a href="deshake_8h.html">deshake.h</a></div></div>
<div class="ttc" id="apixelutils_8c_html_ace06a5d0938728661c6416babe1ee0a9"><div class="ttname"><a href="pixelutils_8c.html#ace06a5d0938728661c6416babe1ee0a9">av_pixelutils_get_sad_fn</a></div><div class="ttdeci">av_pixelutils_sad_fn av_pixelutils_get_sad_fn(int w_bits, int h_bits, int aligned, void *log_ctx)</div><div class="ttdef"><b>Definition:</b> <a href="pixelutils_8c_source.html#l00066">pixelutils.c:66</a></div></div>
<div class="ttc" id="afilter__design_8txt_html_ad283c679febe22c5a4d36e3764daf32b"><div class="ttname"><a href="filter__design_8txt.html#ad283c679febe22c5a4d36e3764daf32b">values</a></div><div class="ttdeci">these buffered frames must be flushed immediately if a new input produces new the filter must not call request_frame to get more It must just process the frame or queue it The task of requesting more frames is left to the filter s request_frame method or the application If a filter has several the filter must be ready for frames arriving randomly on any input any filter with several inputs will most likely require some kind of queuing mechanism It is perfectly acceptable to have a limited queue and to drop frames when the inputs are too unbalanced request_frame For filters that do not use the this method is called when a frame is wanted on an output For a it should directly call filter_frame on the corresponding output For a if there are queued frames already one of these frames should be pushed If the filter should request a frame on one of its repeatedly until at least one frame has been pushed Return values</div><div class="ttdef"><b>Definition:</b> <a href="filter__design_8txt_source.html#l00262">filter_design.txt:263</a></div></div>
<div class="ttc" id="atransform_8c_html_a9a8feed22ff382abfee7b1a21e132f90"><div class="ttname"><a href="transform_8c.html#a9a8feed22ff382abfee7b1a21e132f90">avfilter_transform</a></div><div class="ttdeci">int avfilter_transform(const uint8_t *src, uint8_t *dst, int src_stride, int dst_stride, int width, int height, const float *matrix, enum InterpolateMethod interpolate, enum FillMethod fill)</div><div class="ttdef"><b>Definition:</b> <a href="transform_8c_source.html#l00146">transform.c:146</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5a82034006e681cddbb7b1d5cb7045626a"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a82034006e681cddbb7b1d5cb7045626a">AV_PIX_FMT_YUV444P</a></div><div class="ttdeci">@ AV_PIX_FMT_YUV444P</div><div class="ttdoc">planar YUV 4:4:4, 24bpp, (1 Cr &amp; Cb sample per 1x1 Y samples)</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00071">pixfmt.h:71</a></div></div>
<div class="ttc" id="asonic_8c_html_aee201839e95f7edeff51ad9c8e072bda"><div class="ttname"><a href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a></div><div class="ttdeci">static int shift(int a, int b)</div><div class="ttdef"><b>Definition:</b> <a href="sonic_8c_source.html#l00082">sonic.c:82</a></div></div>
<div class="ttc" id="avf__deshake_8c_html_a05acb496d67139b31b7e00d7a3195c22"><div class="ttname"><a href="vf__deshake_8c.html#a05acb496d67139b31b7e00d7a3195c22">deshake_outputs</a></div><div class="ttdeci">static const AVFilterPad deshake_outputs[]</div><div class="ttdef"><b>Definition:</b> <a href="vf__deshake_8c_source.html#l00545">vf_deshake.c:545</a></div></div>
<div class="ttc" id="alibsvtav1_8c_html_a710bce51374aba96ab04912897666c35"><div class="ttname"><a href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a></div><div class="ttdeci">const char * desc</div><div class="ttdef"><b>Definition:</b> <a href="libsvtav1_8c_source.html#l00079">libsvtav1.c:79</a></div></div>
<div class="ttc" id="agroup__lavu__misc_html_gga9a84bba4713dfced21a1a56163be1f48ac1a46f59be5c6c2d3412ab172d6b8cf5"><div class="ttname"><a href="group__lavu__misc.html#gga9a84bba4713dfced21a1a56163be1f48ac1a46f59be5c6c2d3412ab172d6b8cf5">AVMEDIA_TYPE_VIDEO</a></div><div class="ttdeci">@ AVMEDIA_TYPE_VIDEO</div><div class="ttdef"><b>Definition:</b> <a href="avutil_8h_source.html#l00201">avutil.h:201</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5a332444d991855c9667b786f6f7bb6051"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a332444d991855c9667b786f6f7bb6051">AV_PIX_FMT_YUV422P</a></div><div class="ttdeci">@ AV_PIX_FMT_YUV422P</div><div class="ttdoc">planar YUV 4:2:2, 16bpp, (1 Cr &amp; Cb sample per 2x1 Y samples)</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00070">pixfmt.h:70</a></div></div>
<div class="ttc" id="amem_8h_html"><div class="ttname"><a href="mem_8h.html">mem.h</a></div></div>
<div class="ttc" id="astruct_a_v_filter_html"><div class="ttname"><a href="struct_a_v_filter.html">AVFilter</a></div><div class="ttdef"><b>Definition:</b> <a href="avfilter_8h_source.html#l00145">avfilter.h:145</a></div></div>
<div class="ttc" id="avf__palettegen_8c_html_a0fa5abf62b01f8a592bca729cb14390b"><div class="ttname"><a href="vf__palettegen_8c.html#a0fa5abf62b01f8a592bca729cb14390b">diff</a></div><div class="ttdeci">static av_always_inline int diff(const uint32_t a, const uint32_t b)</div><div class="ttdef"><b>Definition:</b> <a href="vf__palettegen_8c_source.html#l00136">vf_palettegen.c:136</a></div></div>
<div class="ttc" id="ailbcdata_8h_html_a545b8c1c045fcc34b81d3ca822620277"><div class="ttname"><a href="ilbcdata_8h.html#a545b8c1c045fcc34b81d3ca822620277">alpha</a></div><div class="ttdeci">static const int16_t alpha[]</div><div class="ttdef"><b>Definition:</b> <a href="ilbcdata_8h_source.html#l00055">ilbcdata.h:55</a></div></div>
<div class="ttc" id="agroup__avoptions_html_ggabd75aa30eb8ad6387672df9a1fa79444af3898696f46dc79b74b708d8fa4b52a7"><div class="ttname"><a href="group__avoptions.html#ggabd75aa30eb8ad6387672df9a1fa79444af3898696f46dc79b74b708d8fa4b52a7">AV_OPT_TYPE_BOOL</a></div><div class="ttdeci">@ AV_OPT_TYPE_BOOL</div><div class="ttdef"><b>Definition:</b> <a href="opt_8h_source.html#l00242">opt.h:242</a></div></div>
<div class="ttc" id="atableprint__vlc_8h_html_adba82e1bcd02de510a858fcbedf79ef1"><div class="ttname"><a href="tableprint__vlc_8h.html#adba82e1bcd02de510a858fcbedf79ef1">av_freep</a></div><div class="ttdeci">#define av_freep(p)</div><div class="ttdef"><b>Definition:</b> <a href="tableprint__vlc_8h_source.html#l00035">tableprint_vlc.h:35</a></div></div>
<div class="ttc" id="agroup__lavu__mem__funcs_html_ga29d0252b981f157e713a68ffca52f003"><div class="ttname"><a href="group__lavu__mem__funcs.html#ga29d0252b981f157e713a68ffca52f003">av_fast_malloc</a></div><div class="ttdeci">void av_fast_malloc(void *ptr, unsigned int *size, size_t min_size)</div><div class="ttdef"><b>Definition:</b> <a href="mem_8c_source.html#l00502">mem.c:502</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5a69f441408075b0c5fea6e82439d74b06"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a69f441408075b0c5fea6e82439d74b06">AV_PIX_FMT_YUV411P</a></div><div class="ttdeci">@ AV_PIX_FMT_YUV411P</div><div class="ttdoc">planar YUV 4:1:1, 12bpp, (1 Cr &amp; Cb sample per 4x1 Y samples)</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00073">pixfmt.h:73</a></div></div>
<div class="ttc" id="atransform_8h_html_af4d5243b6d8328548c892fc886768392"><div class="ttname"><a href="transform_8h.html#af4d5243b6d8328548c892fc886768392">FillMethod</a></div><div class="ttdeci">FillMethod</div><div class="ttdef"><b>Definition:</b> <a href="transform_8h_source.html#l00051">transform.h:51</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5a60dd6b14fd159176a59e20be30e355c5"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a60dd6b14fd159176a59e20be30e355c5">AV_PIX_FMT_YUV410P</a></div><div class="ttdeci">@ AV_PIX_FMT_YUV410P</div><div class="ttdoc">planar YUV 4:1:0, 9bpp, (1 Cr &amp; Cb sample per 4x4 Y samples)</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00072">pixfmt.h:72</a></div></div>
<div class="ttc" id="atableprint__vlc_8h_html_af38b91523053c244564a94f1ef862c2c"><div class="ttname"><a href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a></div><div class="ttdeci">#define av_log(a,...)</div><div class="ttdef"><b>Definition:</b> <a href="tableprint__vlc_8h_source.html#l00028">tableprint_vlc.h:28</a></div></div>
<div class="ttc" id="astruct_a_v_filter_html_a28a4776f344f91055f42a4c2a1b15c0c"><div class="ttname"><a href="struct_a_v_filter.html#a28a4776f344f91055f42a4c2a1b15c0c">AVFilter::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="avfilter_8h_source.html#l00149">avfilter.h:149</a></div></div>
<div class="ttc" id="agroup__avoptions_html_ggabd75aa30eb8ad6387672df9a1fa79444afadddce95ad3b690dd38644b458b96c4"><div class="ttname"><a href="group__avoptions.html#ggabd75aa30eb8ad6387672df9a1fa79444afadddce95ad3b690dd38644b458b96c4">AV_OPT_TYPE_STRING</a></div><div class="ttdeci">@ AV_OPT_TYPE_STRING</div><div class="ttdef"><b>Definition:</b> <a href="opt_8h_source.html#l00229">opt.h:229</a></div></div>
<div class="ttc" id="astruct_a_v_frame_html"><div class="ttname"><a href="struct_a_v_frame.html">AVFrame</a></div><div class="ttdef"><b>Definition:</b> <a href="frame_8h_source.html#l00308">frame.h:308</a></div></div>
<div class="ttc" id="astruct_a_v_filter_link_html_a08e3e25929bb29d5f6ef768343ff7f57"><div class="ttname"><a href="struct_a_v_filter_link.html#a08e3e25929bb29d5f6ef768343ff7f57">AVFilterLink::w</a></div><div class="ttdeci">int w</div><div class="ttdoc">agreed upon image width</div><div class="ttdef"><b>Definition:</b> <a href="avfilter_8h_source.html#l00481">avfilter.h:481</a></div></div>
<div class="ttc" id="agroup__avoptions_html_ggabd75aa30eb8ad6387672df9a1fa79444a0fa9f07d428bdc32495fe55c365c5329"><div class="ttname"><a href="group__avoptions.html#ggabd75aa30eb8ad6387672df9a1fa79444a0fa9f07d428bdc32495fe55c365c5329">AV_OPT_TYPE_CONST</a></div><div class="ttdeci">@ AV_OPT_TYPE_CONST</div><div class="ttdef"><b>Definition:</b> <a href="opt_8h_source.html#l00234">opt.h:234</a></div></div>
<div class="ttc" id="asnprintf_8h_html_aa367b75c5aed883fef5befbdf04835a4"><div class="ttname"><a href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a></div><div class="ttdeci">#define snprintf</div><div class="ttdef"><b>Definition:</b> <a href="snprintf_8h_source.html#l00034">snprintf.h:34</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
