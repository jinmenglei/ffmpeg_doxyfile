<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: E:/github/ffmpeg/libavutil/hwcontext_opencl.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_737c44b861ba7ee498141742fb455fa8.html">ffmpeg</a></li><li class="navelem"><a class="el" href="dir_d766145af7397866e2c8608f9b7b90ce.html">libavutil</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">hwcontext_opencl.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="hwcontext__opencl_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * This file is part of FFmpeg.</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * FFmpeg is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * FFmpeg is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * License along with FFmpeg; if not, write to the Free Software</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#a16605039b395344c0b68b435e197b8bd">   19</a></span>&#160;<span class="preprocessor">#define CL_USE_DEPRECATED_OPENCL_1_2_APIS</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;config.h&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="avassert_8h.html">avassert.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="avstring_8h.html">avstring.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="common_8h.html">common.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hwcontext_8h.html">hwcontext.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hwcontext__internal_8h.html">hwcontext_internal.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hwcontext__opencl_8h.html">hwcontext_opencl.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mem_8h.html">mem.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="pixdesc_8h.html">pixdesc.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_VAAPI_BEIGNET</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &lt;unistd.h&gt;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &lt;va/va.h&gt;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &lt;va/va_drmcommon.h&gt;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &lt;CL/cl_intel.h&gt;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hwcontext__vaapi_8h.html">hwcontext_vaapi.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_DRM_BEIGNET</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &lt;unistd.h&gt;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &lt;CL/cl_intel.h&gt;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hwcontext__drm_8h.html">hwcontext_drm.h</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_VAAPI_INTEL_MEDIA</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#if CONFIG_LIBMFX</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &lt;mfx/mfxstructures.h&gt;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &lt;va/va.h&gt;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &lt;CL/cl_va_api_media_sharing_intel.h&gt;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hwcontext__vaapi_8h.html">hwcontext_vaapi.h</a>&quot;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_DXVA2</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#define COBJMACROS</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &lt;CL/cl_dx9_media_sharing.h&gt;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &lt;dxva2api.h&gt;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hwcontext__dxva2_8h.html">hwcontext_dxva2.h</a>&quot;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_D3D11</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#include &lt;CL/cl_d3d11.h&gt;</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hwcontext__d3d11va_8h.html">hwcontext_d3d11va.h</a>&quot;</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_DRM_ARM</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#include &lt;CL/cl_ext.h&gt;</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#include &lt;drm_fourcc.h&gt;</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hwcontext__drm_8h.html">hwcontext_drm.h</a>&quot;</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="struct_open_c_l_device_context.html">   76</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct_open_c_l_device_context.html">OpenCLDeviceContext</a> {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="comment">// Default command queue to use for transfer/mapping operations on</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">// the device.  If the user supplies one, this is a reference to it.</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">// Otherwise, it is newly-created.</span></div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="struct_open_c_l_device_context.html#ae29e4d0d149bedcd5d69ee60d79d549d">   80</a></span>&#160;    cl_command_queue <a class="code" href="struct_open_c_l_device_context.html#ae29e4d0d149bedcd5d69ee60d79d549d">command_queue</a>;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">// The platform the context exists on.  This is needed to query and</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">// retrieve extension functions.</span></div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="struct_open_c_l_device_context.html#a84479dc9efcf125d62c0a431b301b588">   84</a></span>&#160;    cl_platform_id <a class="code" href="struct_open_c_l_device_context.html#a84479dc9efcf125d62c0a431b301b588">platform_id</a>;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// Platform/device-specific functions.</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_DRM_BEIGNET</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordtype">int</span> beignet_drm_mapping_usable;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    clCreateImageFromFdINTEL_fn clCreateImageFromFdINTEL;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_VAAPI_INTEL_MEDIA</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordtype">int</span> qsv_mapping_usable;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    clCreateFromVA_APIMediaSurfaceINTEL_fn</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        clCreateFromVA_APIMediaSurfaceINTEL;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    clEnqueueAcquireVA_APIMediaSurfacesINTEL_fn</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        clEnqueueAcquireVA_APIMediaSurfacesINTEL;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    clEnqueueReleaseVA_APIMediaSurfacesINTEL_fn</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        clEnqueueReleaseVA_APIMediaSurfacesINTEL;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_DXVA2</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordtype">int</span> dxva2_mapping_usable;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    cl_dx9_media_adapter_type_khr dx9_media_adapter_type;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    clCreateFromDX9MediaSurfaceKHR_fn</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        clCreateFromDX9MediaSurfaceKHR;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    clEnqueueAcquireDX9MediaSurfacesKHR_fn</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        clEnqueueAcquireDX9MediaSurfacesKHR;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    clEnqueueReleaseDX9MediaSurfacesKHR_fn</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        clEnqueueReleaseDX9MediaSurfacesKHR;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_D3D11</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordtype">int</span> d3d11_mapping_usable;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    clCreateFromD3D11Texture2DKHR_fn</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        clCreateFromD3D11Texture2DKHR;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    clEnqueueAcquireD3D11ObjectsKHR_fn</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        clEnqueueAcquireD3D11ObjectsKHR;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    clEnqueueReleaseD3D11ObjectsKHR_fn</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        clEnqueueReleaseD3D11ObjectsKHR;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_DRM_ARM</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordtype">int</span> drm_arm_mapping_usable;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#a9764b26a9d3a958cb23c49535ef72b06">  127</a></span>&#160;} <a class="code" href="hwcontext__opencl_8c.html#a9764b26a9d3a958cb23c49535ef72b06">OpenCLDeviceContext</a>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="struct_open_c_l_frames_context.html">  129</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct_open_c_l_frames_context.html">OpenCLFramesContext</a> {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">// Command queue used for transfer/mapping operations on this frames</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">// context.  If the user supplies one, this is a reference to it.</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">// Otherwise, it is a reference to the default command queue for the</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">// device.</span></div>
<div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="struct_open_c_l_frames_context.html#aebaf993c59ba7717dc4dbff4a2e57668">  134</a></span>&#160;    cl_command_queue <a class="code" href="struct_open_c_l_frames_context.html#aebaf993c59ba7717dc4dbff4a2e57668">command_queue</a>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_DXVA2 || HAVE_OPENCL_D3D11</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">// For mapping APIs which have separate creation and acquire/release</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">// steps, this stores the OpenCL memory objects corresponding to each</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">// frame.</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordtype">int</span>                   nb_mapped_frames;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <a class="code" href="struct_a_v_open_c_l_frame_descriptor.html">AVOpenCLFrameDescriptor</a> *mapped_frames;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#a12846156848aad117b3fe7314b2ec8f5">  143</a></span>&#160;} <a class="code" href="hwcontext__opencl_8c.html#a12846156848aad117b3fe7314b2ec8f5">OpenCLFramesContext</a>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#ae157d33541bb39200a86f40e9868572e">  146</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> CL_CALLBACK <a class="code" href="hwcontext__opencl_8c.html#ae157d33541bb39200a86f40e9868572e">opencl_error_callback</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *errinfo,</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                                              <span class="keyword">const</span> <span class="keywordtype">void</span> *private_info,</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                                              <span class="keywordtype">size_t</span> <a class="code" href="vf__geq_8c.html#afc61272a374024bcd86d8859783d3d52">cb</a>,</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                                              <span class="keywordtype">void</span> *<a class="code" href="cbs__mpeg2__syntax__template_8c.html#a1782c46926cfea213509f4fc0f7fd555">user_data</a>)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;{</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a> = <a class="code" href="cbs__mpeg2__syntax__template_8c.html#a1782c46926cfea213509f4fc0f7fd555">user_data</a>;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;OpenCL error: %s\n&quot;</span>, errinfo);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;}</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#a1b604f01d7cd8967f384e0a8a8675a82">  155</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="hwcontext__opencl_8c.html#a1b604f01d7cd8967f384e0a8a8675a82">opencl_device_free</a>(<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *hwdev)</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;{</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <a class="code" href="struct_a_v_open_c_l_device_context.html">AVOpenCLDeviceContext</a> *hwctx = hwdev-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a46055b48d1a40445d775b4ae24f77f20">hwctx</a>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    cle = clReleaseContext(hwctx-&gt;<a class="code" href="struct_a_v_open_c_l_device_context.html#a5152eb3c345fd6ead8ffa9e602293d20">context</a>);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to release OpenCL &quot;</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;               <span class="stringliteral">&quot;context: %d.\n&quot;</span>, cle);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;}</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#acd3d88da3c0e0313c3645ff34f62f542">  168</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="hwcontext__opencl_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a>;</div>
<div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#a6087c755c95064e4547b2b629d483e41">  169</a></span>&#160;    cl_platform_info <a class="code" href="hwcontext__opencl_8c.html#a6087c755c95064e4547b2b629d483e41">name</a>;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;} <a class="code" href="hwcontext__opencl_8c.html#a18d0b7232f5d120a4794ddde564afc40">opencl_platform_params</a>[] = {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    { <span class="stringliteral">&quot;platform_profile&quot;</span>,    CL_PLATFORM_PROFILE    },</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    { <span class="stringliteral">&quot;platform_version&quot;</span>,    CL_PLATFORM_VERSION    },</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    { <span class="stringliteral">&quot;platform_name&quot;</span>,       CL_PLATFORM_NAME       },</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    { <span class="stringliteral">&quot;platform_vendor&quot;</span>,     CL_PLATFORM_VENDOR     },</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    { <span class="stringliteral">&quot;platform_extensions&quot;</span>, CL_PLATFORM_EXTENSIONS },</div>
<div class="line"><a name="l00176"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#a18d0b7232f5d120a4794ddde564afc40">  176</a></span>&#160;};</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="hwcontext__opencl_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a>;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    cl_device_info <a class="code" href="hwcontext__opencl_8c.html#a6087c755c95064e4547b2b629d483e41">name</a>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;} <a class="code" href="hwcontext__opencl_8c.html#a30b944479847b738d5b8bf5236f79108">opencl_device_params</a>[] = {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    { <span class="stringliteral">&quot;device_name&quot;</span>,         CL_DEVICE_NAME         },</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    { <span class="stringliteral">&quot;device_vendor&quot;</span>,       CL_DEVICE_VENDOR       },</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    { <span class="stringliteral">&quot;driver_version&quot;</span>,      CL_DRIVER_VERSION      },</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    { <span class="stringliteral">&quot;device_version&quot;</span>,      CL_DEVICE_VERSION      },</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    { <span class="stringliteral">&quot;device_profile&quot;</span>,      CL_DEVICE_PROFILE      },</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    { <span class="stringliteral">&quot;device_extensions&quot;</span>,   CL_DEVICE_EXTENSIONS   },</div>
<div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#a30b944479847b738d5b8bf5236f79108">  188</a></span>&#160;};</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="hwcontext__opencl_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a>;</div>
<div class="line"><a name="l00192"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#a4d9b3683895581878fa3eb0669e56d4f">  192</a></span>&#160;    cl_device_type <a class="code" href="hwcontext__opencl_8c.html#a4d9b3683895581878fa3eb0669e56d4f">type</a>;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;} <a class="code" href="hwcontext__opencl_8c.html#a76a0f6d26efbde213a0475628a01b4d2">opencl_device_types</a>[] = {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    { <span class="stringliteral">&quot;cpu&quot;</span>,         CL_DEVICE_TYPE_CPU         },</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    { <span class="stringliteral">&quot;gpu&quot;</span>,         CL_DEVICE_TYPE_GPU         },</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    { <span class="stringliteral">&quot;accelerator&quot;</span>, CL_DEVICE_TYPE_ACCELERATOR },</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    { <span class="stringliteral">&quot;custom&quot;</span>,      CL_DEVICE_TYPE_CUSTOM      },</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    { <span class="stringliteral">&quot;default&quot;</span>,     CL_DEVICE_TYPE_DEFAULT     },</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    { <span class="stringliteral">&quot;all&quot;</span>,         CL_DEVICE_TYPE_ALL         },</div>
<div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#a76a0f6d26efbde213a0475628a01b4d2">  200</a></span>&#160;};</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#aea176891f9371176bff6dee38f8390ab">  202</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="hwcontext__opencl_8c.html#aea176891f9371176bff6dee38f8390ab">opencl_get_platform_string</a>(cl_platform_id platform_id,</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                                        cl_platform_info <a class="code" href="hwcontext__opencl_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a>)</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;{</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a>;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    cle = clGetPlatformInfo(platform_id, <a class="code" href="hwcontext__opencl_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a>, 0, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;<a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordflow">if</span> (cle != CL_SUCCESS)</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a> = <a class="code" href="tableprint__vlc_8h.html#ae97db1f58b6b1515ed57a83bea3dd572">av_malloc</a>(<a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a>)</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    cle = clGetPlatformInfo(platform_id, <a class="code" href="hwcontext__opencl_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a>, <a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>, <a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a>, &amp;<a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#a079eab092887563f2bef9106c6120089">av_free</a>(<a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a>);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <a class="code" href="avassert_8h.html#aae204192396f78cc8c5cd7ad5c57c23f">av_assert0</a>(strlen(<a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a>) + 1 == <a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a>;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;}</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#a00f2a3fb884b6012b6427d7d9e8b717a">  223</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="hwcontext__opencl_8c.html#a00f2a3fb884b6012b6427d7d9e8b717a">opencl_get_device_string</a>(cl_device_id device_id,</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                                      cl_device_info <a class="code" href="hwcontext__opencl_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a>)</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;{</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    cle = clGetDeviceInfo(device_id, <a class="code" href="hwcontext__opencl_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a>, 0, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;<a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordflow">if</span> (cle != CL_SUCCESS)</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a> = <a class="code" href="tableprint__vlc_8h.html#ae97db1f58b6b1515ed57a83bea3dd572">av_malloc</a>(<a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a>)</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    cle = clGetDeviceInfo(device_id, <a class="code" href="hwcontext__opencl_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a>, <a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>, <a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a>, &amp;<a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#a079eab092887563f2bef9106c6120089">av_free</a>(<a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a>);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <a class="code" href="avassert_8h.html#aae204192396f78cc8c5cd7ad5c57c23f">av_assert0</a>(strlen(<a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a>) + 1== <a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a>;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;}</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#afe78af15c378fc40f3d89399d83d8ad2">  244</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__opencl_8c.html#afe78af15c378fc40f3d89399d83d8ad2">opencl_check_platform_extension</a>(cl_platform_id platform_id,</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="hwcontext__opencl_8c.html#a6087c755c95064e4547b2b629d483e41">name</a>)</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;{</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a>;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordtype">int</span> found = 0;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a> = <a class="code" href="hwcontext__opencl_8c.html#aea176891f9371176bff6dee38f8390ab">opencl_get_platform_string</a>(platform_id,</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                                     CL_PLATFORM_EXTENSIONS);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a> &amp;&amp; strstr(<a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a>, <a class="code" href="hwcontext__opencl_8c.html#a6087c755c95064e4547b2b629d483e41">name</a>))</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        found = 1;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#a079eab092887563f2bef9106c6120089">av_free</a>(<a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a>);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordflow">return</span> found;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;}</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#a377664ee715aeee2c8d3f042a365f471">  257</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__opencl_8c.html#a377664ee715aeee2c8d3f042a365f471">opencl_check_device_extension</a>(cl_device_id device_id,</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                                         <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="hwcontext__opencl_8c.html#a6087c755c95064e4547b2b629d483e41">name</a>)</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;{</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordtype">int</span> found = 0;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a> = <a class="code" href="hwcontext__opencl_8c.html#a00f2a3fb884b6012b6427d7d9e8b717a">opencl_get_device_string</a>(device_id,</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                                   CL_DEVICE_EXTENSIONS);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a> &amp;&amp; strstr(<a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a>, <a class="code" href="hwcontext__opencl_8c.html#a6087c755c95064e4547b2b629d483e41">name</a>))</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        found = 1;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#a079eab092887563f2bef9106c6120089">av_free</a>(<a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a>);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordflow">return</span> found;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;}</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#a680d1dfa2b7b327438e68094b925c587">  270</a></span>&#160;<span class="keyword">static</span> <a class="code" href="attributes_8h.html#a7ca8a3900269f92fcc7b68235dea7787">av_unused</a> <span class="keywordtype">int</span> <a class="code" href="hwcontext__opencl_8c.html#a680d1dfa2b7b327438e68094b925c587">opencl_check_extension</a>(<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *hwdev,</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="hwcontext__opencl_8c.html#a6087c755c95064e4547b2b629d483e41">name</a>)</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;{</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <a class="code" href="struct_a_v_open_c_l_device_context.html">AVOpenCLDeviceContext</a> *hwctx = hwdev-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a46055b48d1a40445d775b4ae24f77f20">hwctx</a>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="struct_open_c_l_device_context.html">OpenCLDeviceContext</a>    *priv = hwdev-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a9c3758c73b0f29925ccb2f60b5c1a803">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_device_internal.html#ae7425663cca9541964518c66974a20bf">priv</a>;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="hwcontext__opencl_8c.html#afe78af15c378fc40f3d89399d83d8ad2">opencl_check_platform_extension</a>(priv-&gt;<a class="code" href="struct_open_c_l_device_context.html#a84479dc9efcf125d62c0a431b301b588">platform_id</a>, <a class="code" href="hwcontext__opencl_8c.html#a6087c755c95064e4547b2b629d483e41">name</a>)) {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga5b7221c3afd06848486776bd834a58a5">AV_LOG_DEBUG</a>,</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;               <span class="stringliteral">&quot;%s found as platform extension.\n&quot;</span>, <a class="code" href="hwcontext__opencl_8c.html#a6087c755c95064e4547b2b629d483e41">name</a>);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="hwcontext__opencl_8c.html#a377664ee715aeee2c8d3f042a365f471">opencl_check_device_extension</a>(hwctx-&gt;<a class="code" href="struct_a_v_open_c_l_device_context.html#a221b6ee3b0538276cc28367ed0dccec2">device_id</a>, <a class="code" href="hwcontext__opencl_8c.html#a6087c755c95064e4547b2b629d483e41">name</a>)) {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga5b7221c3afd06848486776bd834a58a5">AV_LOG_DEBUG</a>,</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;               <span class="stringliteral">&quot;%s found as device extension.\n&quot;</span>, <a class="code" href="hwcontext__opencl_8c.html#a6087c755c95064e4547b2b629d483e41">name</a>);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;}</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#aa446a057be8040d8f3d091d52e67ed47">  291</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__opencl_8c.html#aa446a057be8040d8f3d091d52e67ed47">opencl_enumerate_platforms</a>(<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *hwdev,</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                                      cl_uint *nb_platforms,</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                                      cl_platform_id **platforms,</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                                      <span class="keywordtype">void</span> *<a class="code" href="writing__filters_8txt.html#a5b5446e1f47af0c85ac6b45210d45117">context</a>)</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;{</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    cle = clGetPlatformIDs(0, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, nb_platforms);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to get number of &quot;</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;               <span class="stringliteral">&quot;OpenCL platforms: %d.\n&quot;</span>, cle);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENODEV);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga5b7221c3afd06848486776bd834a58a5">AV_LOG_DEBUG</a>, <span class="stringliteral">&quot;%u OpenCL platforms found.\n&quot;</span>,</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;           *nb_platforms);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    *platforms = <a class="code" href="mem_8c.html#a254f3455439c15a2c8a75b8f0235fdbd">av_malloc_array</a>(*nb_platforms, <span class="keyword">sizeof</span>(**platforms));</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">if</span> (!*platforms)</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    cle = clGetPlatformIDs(*nb_platforms, *platforms, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to get list of OpenCL &quot;</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;               <span class="stringliteral">&quot;platforms: %d.\n&quot;</span>, cle);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#adba82e1bcd02de510a858fcbedf79ef1">av_freep</a>(platforms);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENODEV);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;}</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#af73f72120f21c6a98aca9ef43f51ef48">  322</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__opencl_8c.html#af73f72120f21c6a98aca9ef43f51ef48">opencl_filter_platform</a>(<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *hwdev,</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                                  cl_platform_id platform_id,</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">char</span> *platform_name,</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                                  <span class="keywordtype">void</span> *<a class="code" href="writing__filters_8txt.html#a5b5446e1f47af0c85ac6b45210d45117">context</a>)</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;{</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <a class="code" href="struct_a_v_dictionary.html">AVDictionary</a> *<a class="code" href="tests_2movenc_8c.html#af540b728145b614e34c4e10930354b93">opts</a> = <a class="code" href="writing__filters_8txt.html#a5b5446e1f47af0c85ac6b45210d45117">context</a>;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keyword">const</span> <a class="code" href="struct_a_v_dictionary_entry.html">AVDictionaryEntry</a> *param;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a>;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = 0;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="sinewin__tablegen__template_8c.html#a3508a98d3ee7e2c9a4841fe264cf70f7">FF_ARRAY_ELEMS</a>(<a class="code" href="hwcontext__opencl_8c.html#a18d0b7232f5d120a4794ddde564afc40">opencl_platform_params</a>); <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        param = <a class="code" href="group__lavu__dict.html#gae67f143237b2cb2936c9b147aa6dfde3">av_dict_get</a>(<a class="code" href="tests_2movenc_8c.html#af540b728145b614e34c4e10930354b93">opts</a>, <a class="code" href="hwcontext__opencl_8c.html#a18d0b7232f5d120a4794ddde564afc40">opencl_platform_params</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="hwcontext__opencl_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a>,</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                            <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="keywordflow">if</span> (!param)</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a> = <a class="code" href="hwcontext__opencl_8c.html#aea176891f9371176bff6dee38f8390ab">opencl_get_platform_string</a>(platform_id,</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                                         <a class="code" href="hwcontext__opencl_8c.html#a18d0b7232f5d120a4794ddde564afc40">opencl_platform_params</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="hwcontext__opencl_8c.html#a6087c755c95064e4547b2b629d483e41">name</a>);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a>) {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to query %s &quot;</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                   <span class="stringliteral">&quot;of platform \&quot;%s\&quot;.\n&quot;</span>,</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                   <a class="code" href="hwcontext__opencl_8c.html#a18d0b7232f5d120a4794ddde564afc40">opencl_platform_params</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="hwcontext__opencl_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a>, platform_name);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="group__lavu__error.html#ga4ebaa288c7684a26a591c501208910e4">AVERROR_UNKNOWN</a>;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="group__lavu__string.html#ga47e14424edfb96d3f6bf0fca96a76fe5">av_stristr</a>(<a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a>, param-&gt;<a class="code" href="struct_a_v_dictionary_entry.html#aa38678f2cad36f120d42e56449c5edb4">value</a>)) {</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga5b7221c3afd06848486776bd834a58a5">AV_LOG_DEBUG</a>, <span class="stringliteral">&quot;%s does not match (\&quot;%s\&quot;).\n&quot;</span>,</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                   param-&gt;<a class="code" href="struct_a_v_dictionary_entry.html#a38fc80176f8f839282bb61c03392e194">key</a>, <a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a>);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = 1;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        }</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#a079eab092887563f2bef9106c6120089">av_free</a>(<a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a>);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;}</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#ae6f10ee0c7f06ca57f7f37c7d7575086">  357</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__opencl_8c.html#ae6f10ee0c7f06ca57f7f37c7d7575086">opencl_enumerate_devices</a>(<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *hwdev,</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                                    cl_platform_id platform_id,</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">char</span> *platform_name,</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                                    cl_uint *nb_devices,</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                                    cl_device_id **devices,</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                                    <span class="keywordtype">void</span> *<a class="code" href="writing__filters_8txt.html#a5b5446e1f47af0c85ac6b45210d45117">context</a>)</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;{</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    cle = clGetDeviceIDs(platform_id, CL_DEVICE_TYPE_ALL,</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                         0, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, nb_devices);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">if</span> (cle == CL_DEVICE_NOT_FOUND) {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga5b7221c3afd06848486776bd834a58a5">AV_LOG_DEBUG</a>, <span class="stringliteral">&quot;No devices found &quot;</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;               <span class="stringliteral">&quot;on platform \&quot;%s\&quot;.\n&quot;</span>, platform_name);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        *nb_devices = 0;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to get number of devices &quot;</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;               <span class="stringliteral">&quot;on platform \&quot;%s\&quot;: %d.\n&quot;</span>, platform_name, cle);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENODEV);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga5b7221c3afd06848486776bd834a58a5">AV_LOG_DEBUG</a>, <span class="stringliteral">&quot;%u OpenCL devices found on &quot;</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;           <span class="stringliteral">&quot;platform \&quot;%s\&quot;.\n&quot;</span>, *nb_devices, platform_name);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    *devices = <a class="code" href="mem_8c.html#a254f3455439c15a2c8a75b8f0235fdbd">av_malloc_array</a>(*nb_devices, <span class="keyword">sizeof</span>(**devices));</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">if</span> (!*devices)</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    cle = clGetDeviceIDs(platform_id, CL_DEVICE_TYPE_ALL,</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                         *nb_devices, *devices, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to get list of devices &quot;</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;               <span class="stringliteral">&quot;on platform \&quot;%s\&quot;: %d.\n&quot;</span>, platform_name, cle);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#adba82e1bcd02de510a858fcbedf79ef1">av_freep</a>(devices);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENODEV);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    }</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;}</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#af92fcebe33b9d2f8af5d8796e2b33846">  397</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__opencl_8c.html#af92fcebe33b9d2f8af5d8796e2b33846">opencl_filter_device</a>(<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *hwdev,</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                                cl_device_id device_id,</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                                <span class="keyword">const</span> <span class="keywordtype">char</span> *device_name,</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                                <span class="keywordtype">void</span> *<a class="code" href="writing__filters_8txt.html#a5b5446e1f47af0c85ac6b45210d45117">context</a>)</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;{</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <a class="code" href="struct_a_v_dictionary.html">AVDictionary</a> *<a class="code" href="tests_2movenc_8c.html#af540b728145b614e34c4e10930354b93">opts</a> = <a class="code" href="writing__filters_8txt.html#a5b5446e1f47af0c85ac6b45210d45117">context</a>;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keyword">const</span> <a class="code" href="struct_a_v_dictionary_entry.html">AVDictionaryEntry</a> *param;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a>;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = 0;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    param = <a class="code" href="group__lavu__dict.html#gae67f143237b2cb2936c9b147aa6dfde3">av_dict_get</a>(<a class="code" href="tests_2movenc_8c.html#af540b728145b614e34c4e10930354b93">opts</a>, <span class="stringliteral">&quot;device_type&quot;</span>, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">if</span> (param) {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        cl_device_type match_type = 0, <a class="code" href="hwcontext__qsv_8c.html#a7898416aa2fa2f5d58aa4b6f35135205">device_type</a>;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        cl_int cle;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="sinewin__tablegen__template_8c.html#a3508a98d3ee7e2c9a4841fe264cf70f7">FF_ARRAY_ELEMS</a>(<a class="code" href="hwcontext__opencl_8c.html#a76a0f6d26efbde213a0475628a01b4d2">opencl_device_types</a>); <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            <span class="keywordflow">if</span> (!strcmp(<a class="code" href="hwcontext__opencl_8c.html#a76a0f6d26efbde213a0475628a01b4d2">opencl_device_types</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="hwcontext__opencl_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a>, param-&gt;<a class="code" href="struct_a_v_dictionary_entry.html#aa38678f2cad36f120d42e56449c5edb4">value</a>)) {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                match_type = <a class="code" href="hwcontext__opencl_8c.html#a76a0f6d26efbde213a0475628a01b4d2">opencl_device_types</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].type;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        }</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <span class="keywordflow">if</span> (!match_type) {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Unknown device type %s.\n&quot;</span>,</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                   param-&gt;<a class="code" href="struct_a_v_dictionary_entry.html#aa38678f2cad36f120d42e56449c5edb4">value</a>);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        }</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        cle = clGetDeviceInfo(device_id, CL_DEVICE_TYPE,</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                              <span class="keyword">sizeof</span>(<a class="code" href="hwcontext__qsv_8c.html#a7898416aa2fa2f5d58aa4b6f35135205">device_type</a>), &amp;<a class="code" href="hwcontext__qsv_8c.html#a7898416aa2fa2f5d58aa4b6f35135205">device_type</a>, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to query device type &quot;</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                   <span class="stringliteral">&quot;of device \&quot;%s\&quot;.\n&quot;</span>, device_name);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="group__lavu__error.html#ga4ebaa288c7684a26a591c501208910e4">AVERROR_UNKNOWN</a>;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="keywordflow">if</span> (!(<a class="code" href="hwcontext__qsv_8c.html#a7898416aa2fa2f5d58aa4b6f35135205">device_type</a> &amp; match_type)) {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga5b7221c3afd06848486776bd834a58a5">AV_LOG_DEBUG</a>, <span class="stringliteral">&quot;device_type does not match.\n&quot;</span>);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="sinewin__tablegen__template_8c.html#a3508a98d3ee7e2c9a4841fe264cf70f7">FF_ARRAY_ELEMS</a>(<a class="code" href="hwcontext__opencl_8c.html#a30b944479847b738d5b8bf5236f79108">opencl_device_params</a>); <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        param = <a class="code" href="group__lavu__dict.html#gae67f143237b2cb2936c9b147aa6dfde3">av_dict_get</a>(<a class="code" href="tests_2movenc_8c.html#af540b728145b614e34c4e10930354b93">opts</a>, <a class="code" href="hwcontext__opencl_8c.html#a30b944479847b738d5b8bf5236f79108">opencl_device_params</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="hwcontext__opencl_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a>,</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                            <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="keywordflow">if</span> (!param)</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a> = <a class="code" href="hwcontext__opencl_8c.html#a00f2a3fb884b6012b6427d7d9e8b717a">opencl_get_device_string</a>(device_id,</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                                       <a class="code" href="hwcontext__opencl_8c.html#a30b944479847b738d5b8bf5236f79108">opencl_device_params</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="hwcontext__opencl_8c.html#a6087c755c95064e4547b2b629d483e41">name</a>);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a>) {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to query %s &quot;</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                   <span class="stringliteral">&quot;of device \&quot;%s\&quot;.\n&quot;</span>,</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                   <a class="code" href="hwcontext__opencl_8c.html#a30b944479847b738d5b8bf5236f79108">opencl_device_params</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="hwcontext__opencl_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a>, device_name);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="group__lavu__error.html#ga4ebaa288c7684a26a591c501208910e4">AVERROR_UNKNOWN</a>;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        }</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="group__lavu__string.html#ga47e14424edfb96d3f6bf0fca96a76fe5">av_stristr</a>(<a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a>, param-&gt;<a class="code" href="struct_a_v_dictionary_entry.html#aa38678f2cad36f120d42e56449c5edb4">value</a>)) {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga5b7221c3afd06848486776bd834a58a5">AV_LOG_DEBUG</a>, <span class="stringliteral">&quot;%s does not match (\&quot;%s\&quot;).\n&quot;</span>,</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                   param-&gt;<a class="code" href="struct_a_v_dictionary_entry.html#a38fc80176f8f839282bb61c03392e194">key</a>, <a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a>);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = 1;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        }</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#a079eab092887563f2bef9106c6120089">av_free</a>(<a class="code" href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">str</a>);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    }</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;}</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno"><a class="line" href="struct_open_c_l_device_selector.html">  463</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct_open_c_l_device_selector.html">OpenCLDeviceSelector</a> {</div>
<div class="line"><a name="l00464"></a><span class="lineno"><a class="line" href="struct_open_c_l_device_selector.html#aedc0c87598ef24a88481f4fa3388f2cf">  464</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="struct_open_c_l_device_selector.html#aedc0c87598ef24a88481f4fa3388f2cf">platform_index</a>;</div>
<div class="line"><a name="l00465"></a><span class="lineno"><a class="line" href="struct_open_c_l_device_selector.html#abae4e2d0e0e331d619ec3722d117bf3d">  465</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="struct_open_c_l_device_selector.html#abae4e2d0e0e331d619ec3722d117bf3d">device_index</a>;</div>
<div class="line"><a name="l00466"></a><span class="lineno"><a class="line" href="struct_open_c_l_device_selector.html#a70747e251dd97e499282089b6145951e">  466</a></span>&#160;    <span class="keywordtype">void</span> *<a class="code" href="struct_open_c_l_device_selector.html#a70747e251dd97e499282089b6145951e">context</a>;</div>
<div class="line"><a name="l00467"></a><span class="lineno"><a class="line" href="struct_open_c_l_device_selector.html#a1a03a7f88025b3b7dc8f85c1070f569a">  467</a></span>&#160;    <a class="code" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> (*<a class="code" href="struct_open_c_l_device_selector.html#a1a03a7f88025b3b7dc8f85c1070f569a">enumerate_platforms</a>)(<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *hwdev,</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                               cl_uint *nb_platforms,</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                               cl_platform_id **platforms,</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                               <span class="keywordtype">void</span> *<a class="code" href="struct_open_c_l_device_selector.html#a70747e251dd97e499282089b6145951e">context</a>);</div>
<div class="line"><a name="l00471"></a><span class="lineno"><a class="line" href="struct_open_c_l_device_selector.html#a0b67aed3fdb1ba2841c301f77eae44cb">  471</a></span>&#160;    <a class="code" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> (*<a class="code" href="struct_open_c_l_device_selector.html#a0b67aed3fdb1ba2841c301f77eae44cb">filter_platform</a>)    (<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *hwdev,</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                               cl_platform_id platform_id,</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">char</span> *platform_name,</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                               <span class="keywordtype">void</span> *<a class="code" href="struct_open_c_l_device_selector.html#a70747e251dd97e499282089b6145951e">context</a>);</div>
<div class="line"><a name="l00475"></a><span class="lineno"><a class="line" href="struct_open_c_l_device_selector.html#a87ae43f099630aff046d6d039349f12d">  475</a></span>&#160;    <a class="code" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> (*<a class="code" href="struct_open_c_l_device_selector.html#a87ae43f099630aff046d6d039349f12d">enumerate_devices</a>)  (<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *hwdev,</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                               cl_platform_id platform_id,</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">char</span> *platform_name,</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                               cl_uint *nb_devices,</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                               cl_device_id **devices,</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                               <span class="keywordtype">void</span> *<a class="code" href="struct_open_c_l_device_selector.html#a70747e251dd97e499282089b6145951e">context</a>);</div>
<div class="line"><a name="l00481"></a><span class="lineno"><a class="line" href="struct_open_c_l_device_selector.html#ab678e3e7946a9d3dd1bacdc67e3d6976">  481</a></span>&#160;    <a class="code" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> (*<a class="code" href="struct_open_c_l_device_selector.html#ab678e3e7946a9d3dd1bacdc67e3d6976">filter_device</a>)      (<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *hwdev,</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                               cl_device_id device_id,</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">char</span> *device_name,</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                               <span class="keywordtype">void</span> *<a class="code" href="struct_open_c_l_device_selector.html#a70747e251dd97e499282089b6145951e">context</a>);</div>
<div class="line"><a name="l00485"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#abcf959ddcc0991a6681aa36d6e32b248">  485</a></span>&#160;} <a class="code" href="hwcontext__opencl_8c.html#abcf959ddcc0991a6681aa36d6e32b248">OpenCLDeviceSelector</a>;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#ad933f1f898a2be64f81d92fa4024e52c">  487</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__opencl_8c.html#ad933f1f898a2be64f81d92fa4024e52c">opencl_device_create_internal</a>(<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *hwdev,</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                                         <span class="keyword">const</span> <a class="code" href="struct_open_c_l_device_selector.html">OpenCLDeviceSelector</a> *selector,</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                                         cl_context_properties *props)</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;{</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    cl_uint      nb_platforms;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    cl_platform_id *platforms = <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    cl_platform_id  platform_id;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    cl_uint      nb_devices;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    cl_device_id   *devices = <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <a class="code" href="struct_a_v_open_c_l_device_context.html">AVOpenCLDeviceContext</a> *hwctx = hwdev-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a46055b48d1a40445d775b4ae24f77f20">hwctx</a>;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    cl_context_properties default_props[3];</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordtype">char</span> *platform_name_src = <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;         *device_name_src   = <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordtype">int</span> err, found, p, d;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <a class="code" href="avassert_8h.html#aae204192396f78cc8c5cd7ad5c57c23f">av_assert0</a>(selector-&gt;<a class="code" href="struct_open_c_l_device_selector.html#a1a03a7f88025b3b7dc8f85c1070f569a">enumerate_platforms</a> &amp;&amp;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;               selector-&gt;<a class="code" href="struct_open_c_l_device_selector.html#a87ae43f099630aff046d6d039349f12d">enumerate_devices</a>);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    err = selector-&gt;<a class="code" href="struct_open_c_l_device_selector.html#a1a03a7f88025b3b7dc8f85c1070f569a">enumerate_platforms</a>(hwdev, &amp;nb_platforms, &amp;platforms,</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                                        selector-&gt;<a class="code" href="struct_open_c_l_device_selector.html#a70747e251dd97e499282089b6145951e">context</a>);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordflow">if</span> (err)</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    found = 0;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">for</span> (p = 0; p &lt; nb_platforms; p++) {</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *platform_name;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160; </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="keywordflow">if</span> (selector-&gt;<a class="code" href="struct_open_c_l_device_selector.html#aedc0c87598ef24a88481f4fa3388f2cf">platform_index</a> &gt;= 0 &amp;&amp;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            selector-&gt;<a class="code" href="struct_open_c_l_device_selector.html#aedc0c87598ef24a88481f4fa3388f2cf">platform_index</a> != p)</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160; </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#adba82e1bcd02de510a858fcbedf79ef1">av_freep</a>(&amp;platform_name_src);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        platform_name_src = <a class="code" href="hwcontext__opencl_8c.html#aea176891f9371176bff6dee38f8390ab">opencl_get_platform_string</a>(platforms[p],</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                                                           CL_PLATFORM_NAME);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="keywordflow">if</span> (platform_name_src)</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            platform_name = platform_name_src;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            platform_name = <span class="stringliteral">&quot;Unknown Platform&quot;</span>;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160; </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <span class="keywordflow">if</span> (selector-&gt;<a class="code" href="struct_open_c_l_device_selector.html#a0b67aed3fdb1ba2841c301f77eae44cb">filter_platform</a>) {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            err = selector-&gt;<a class="code" href="struct_open_c_l_device_selector.html#a0b67aed3fdb1ba2841c301f77eae44cb">filter_platform</a>(hwdev, platforms[p],</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                                            platform_name,</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                                            selector-&gt;<a class="code" href="struct_open_c_l_device_selector.html#a70747e251dd97e499282089b6145951e">context</a>);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            <span class="keywordflow">if</span> (err &lt; 0)</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            <span class="keywordflow">if</span> (err &gt; 0)</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        }</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        err = selector-&gt;<a class="code" href="struct_open_c_l_device_selector.html#a87ae43f099630aff046d6d039349f12d">enumerate_devices</a>(hwdev, platforms[p], platform_name,</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                                          &amp;nb_devices, &amp;devices,</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                                          selector-&gt;<a class="code" href="struct_open_c_l_device_selector.html#a70747e251dd97e499282089b6145951e">context</a>);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="keywordflow">if</span> (err &lt; 0)</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160; </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <span class="keywordflow">for</span> (d = 0; d &lt; nb_devices; d++) {</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> *device_name;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            <span class="keywordflow">if</span> (selector-&gt;<a class="code" href="struct_open_c_l_device_selector.html#abae4e2d0e0e331d619ec3722d117bf3d">device_index</a> &gt;= 0 &amp;&amp;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                selector-&gt;<a class="code" href="struct_open_c_l_device_selector.html#abae4e2d0e0e331d619ec3722d117bf3d">device_index</a> != d)</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160; </div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#adba82e1bcd02de510a858fcbedf79ef1">av_freep</a>(&amp;device_name_src);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            device_name_src = <a class="code" href="hwcontext__opencl_8c.html#a00f2a3fb884b6012b6427d7d9e8b717a">opencl_get_device_string</a>(devices[d],</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                                                           CL_DEVICE_NAME);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            <span class="keywordflow">if</span> (device_name_src)</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                device_name = device_name_src;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                device_name = <span class="stringliteral">&quot;Unknown Device&quot;</span>;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            <span class="keywordflow">if</span> (selector-&gt;<a class="code" href="struct_open_c_l_device_selector.html#ab678e3e7946a9d3dd1bacdc67e3d6976">filter_device</a>) {</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                err = selector-&gt;<a class="code" href="struct_open_c_l_device_selector.html#ab678e3e7946a9d3dd1bacdc67e3d6976">filter_device</a>(hwdev, devices[d],</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                                              device_name,</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                                              selector-&gt;<a class="code" href="struct_open_c_l_device_selector.html#a70747e251dd97e499282089b6145951e">context</a>);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                <span class="keywordflow">if</span> (err &lt; 0)</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                    <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                <span class="keywordflow">if</span> (err &gt; 0)</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            }</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>, <span class="stringliteral">&quot;%d.%d: %s / %s\n&quot;</span>, p, d,</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                   platform_name, device_name);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160; </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            ++found;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            platform_id      = platforms[p];</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            hwctx-&gt;<a class="code" href="struct_a_v_open_c_l_device_context.html#a221b6ee3b0538276cc28367ed0dccec2">device_id</a> = devices[d];</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        }</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#adba82e1bcd02de510a858fcbedf79ef1">av_freep</a>(&amp;devices);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    }</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keywordflow">if</span> (found == 0) {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;No matching devices found.\n&quot;</span>);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        err = <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENODEV);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    }</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="keywordflow">if</span> (found &gt; 1) {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;More than one matching device found.\n&quot;</span>);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        err = <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENODEV);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    }</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="keywordflow">if</span> (!props) {</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        props = default_props;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        default_props[0] = CL_CONTEXT_PLATFORM;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        default_props[1] = (intptr_t)platform_id;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        default_props[2] = 0;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <span class="keywordflow">if</span> (props[0] == CL_CONTEXT_PLATFORM &amp;&amp; props[1] == 0)</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            props[1] = (intptr_t)platform_id;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    }</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160; </div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    hwctx-&gt;<a class="code" href="struct_a_v_open_c_l_device_context.html#a5152eb3c345fd6ead8ffa9e602293d20">context</a> = clCreateContext(props, 1, &amp;hwctx-&gt;<a class="code" href="struct_a_v_open_c_l_device_context.html#a221b6ee3b0538276cc28367ed0dccec2">device_id</a>,</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                                     &amp;<a class="code" href="hwcontext__opencl_8c.html#ae157d33541bb39200a86f40e9868572e">opencl_error_callback</a>, hwdev, &amp;cle);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keywordflow">if</span> (!hwctx-&gt;<a class="code" href="struct_a_v_open_c_l_device_context.html#a5152eb3c345fd6ead8ffa9e602293d20">context</a>) {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to create OpenCL context: &quot;</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;               <span class="stringliteral">&quot;%d.\n&quot;</span>, cle);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        err = <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENODEV);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    }</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    hwdev-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a8c9a379fa6b08bacadf6af8ea8b84ff5">free</a> = &amp;<a class="code" href="hwcontext__opencl_8c.html#a1b604f01d7cd8967f384e0a8a8675a82">opencl_device_free</a>;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    err = 0;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>:</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#adba82e1bcd02de510a858fcbedf79ef1">av_freep</a>(&amp;platform_name_src);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#adba82e1bcd02de510a858fcbedf79ef1">av_freep</a>(&amp;device_name_src);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#adba82e1bcd02de510a858fcbedf79ef1">av_freep</a>(&amp;platforms);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#adba82e1bcd02de510a858fcbedf79ef1">av_freep</a>(&amp;devices);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;}</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160; </div>
<div class="line"><a name="l00620"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#a70f211250033119734a586d936c078dd">  620</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__opencl_8c.html#a70f211250033119734a586d936c078dd">opencl_device_create</a>(<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *hwdev, <span class="keyword">const</span> <span class="keywordtype">char</span> *device,</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                                <a class="code" href="struct_a_v_dictionary.html">AVDictionary</a> *<a class="code" href="tests_2movenc_8c.html#af540b728145b614e34c4e10930354b93">opts</a>, <span class="keywordtype">int</span> <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>)</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;{</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <a class="code" href="struct_open_c_l_device_selector.html">OpenCLDeviceSelector</a> selector = {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        .<a class="code" href="struct_open_c_l_device_selector.html#a70747e251dd97e499282089b6145951e">context</a> = <a class="code" href="tests_2movenc_8c.html#af540b728145b614e34c4e10930354b93">opts</a>,</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        .enumerate_platforms = &amp;<a class="code" href="hwcontext__opencl_8c.html#aa446a057be8040d8f3d091d52e67ed47">opencl_enumerate_platforms</a>,</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        .filter_platform     = &amp;<a class="code" href="hwcontext__opencl_8c.html#af73f72120f21c6a98aca9ef43f51ef48">opencl_filter_platform</a>,</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        .enumerate_devices   = &amp;<a class="code" href="hwcontext__opencl_8c.html#ae6f10ee0c7f06ca57f7f37c7d7575086">opencl_enumerate_devices</a>,</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        .filter_device       = &amp;<a class="code" href="hwcontext__opencl_8c.html#af92fcebe33b9d2f8af5d8796e2b33846">opencl_filter_device</a>,</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    };</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160; </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="keywordflow">if</span> (device &amp;&amp; device[0]) {</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="comment">// Match one or both indices for platform and device.</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <span class="keywordtype">int</span> d = -1, p = -1, <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        <span class="keywordflow">if</span> (device[0] == <span class="charliteral">&#39;.&#39;</span>)</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = sscanf(device, <span class="stringliteral">&quot;.%d&quot;</span>, &amp;d);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = sscanf(device, <span class="stringliteral">&quot;%d.%d&quot;</span>, &amp;p, &amp;d);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> &lt; 1) {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Invalid OpenCL platform/device &quot;</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                   <span class="stringliteral">&quot;index specification \&quot;%s\&quot;.\n&quot;</span>, device);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        }</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        selector.<a class="code" href="struct_open_c_l_device_selector.html#aedc0c87598ef24a88481f4fa3388f2cf">platform_index</a> = p;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        selector.<a class="code" href="struct_open_c_l_device_selector.html#abae4e2d0e0e331d619ec3722d117bf3d">device_index</a>   = d;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        selector.<a class="code" href="struct_open_c_l_device_selector.html#aedc0c87598ef24a88481f4fa3388f2cf">platform_index</a> = -1;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        selector.<a class="code" href="struct_open_c_l_device_selector.html#abae4e2d0e0e331d619ec3722d117bf3d">device_index</a>   = -1;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    }</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="hwcontext__opencl_8c.html#ad933f1f898a2be64f81d92fa4024e52c">opencl_device_create_internal</a>(hwdev, &amp;selector, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;}</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160; </div>
<div class="line"><a name="l00653"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#a7e5c0b39632f505525b31f45bd28804d">  653</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__opencl_8c.html#a7e5c0b39632f505525b31f45bd28804d">opencl_device_init</a>(<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *hwdev)</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;{</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <a class="code" href="struct_a_v_open_c_l_device_context.html">AVOpenCLDeviceContext</a> *hwctx = hwdev-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a46055b48d1a40445d775b4ae24f77f20">hwctx</a>;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <a class="code" href="struct_open_c_l_device_context.html">OpenCLDeviceContext</a>    *priv = hwdev-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a9c3758c73b0f29925ccb2f60b5c1a803">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_device_internal.html#ae7425663cca9541964518c66974a20bf">priv</a>;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="keywordflow">if</span> (hwctx-&gt;<a class="code" href="struct_a_v_open_c_l_device_context.html#a469263dac579e9693e1bafb8d0b3d5ca">command_queue</a>) {</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        cle = clRetainCommandQueue(hwctx-&gt;<a class="code" href="struct_a_v_open_c_l_device_context.html#a469263dac579e9693e1bafb8d0b3d5ca">command_queue</a>);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to retain external &quot;</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                   <span class="stringliteral">&quot;command queue: %d.\n&quot;</span>, cle);</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EIO);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        }</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        priv-&gt;<a class="code" href="struct_open_c_l_device_context.html#ae29e4d0d149bedcd5d69ee60d79d549d">command_queue</a> = hwctx-&gt;<a class="code" href="struct_a_v_open_c_l_device_context.html#a469263dac579e9693e1bafb8d0b3d5ca">command_queue</a>;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        priv-&gt;<a class="code" href="struct_open_c_l_device_context.html#ae29e4d0d149bedcd5d69ee60d79d549d">command_queue</a> = clCreateCommandQueue(hwctx-&gt;<a class="code" href="struct_a_v_open_c_l_device_context.html#a5152eb3c345fd6ead8ffa9e602293d20">context</a>,</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                                                   hwctx-&gt;<a class="code" href="struct_a_v_open_c_l_device_context.html#a221b6ee3b0538276cc28367ed0dccec2">device_id</a>,</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                                                   0, &amp;cle);</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <span class="keywordflow">if</span> (!priv-&gt;<a class="code" href="struct_open_c_l_device_context.html#ae29e4d0d149bedcd5d69ee60d79d549d">command_queue</a>) {</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to create internal &quot;</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                   <span class="stringliteral">&quot;command queue: %d.\n&quot;</span>, cle);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EIO);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        }</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    }</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    cle = clGetDeviceInfo(hwctx-&gt;<a class="code" href="struct_a_v_open_c_l_device_context.html#a221b6ee3b0538276cc28367ed0dccec2">device_id</a>, CL_DEVICE_PLATFORM,</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                          <span class="keyword">sizeof</span>(priv-&gt;<a class="code" href="struct_open_c_l_device_context.html#a84479dc9efcf125d62c0a431b301b588">platform_id</a>), &amp;priv-&gt;<a class="code" href="struct_open_c_l_device_context.html#a84479dc9efcf125d62c0a431b301b588">platform_id</a>,</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                          <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to determine the OpenCL &quot;</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;               <span class="stringliteral">&quot;platform containing the device.\n&quot;</span>);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EIO);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    }</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160; </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="preprocessor">#define CL_FUNC(name, desc) do {                                \</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="preprocessor">        if (fail)                                               \</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="preprocessor">            break;                                              \</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="preprocessor">        priv-&gt;name = clGetExtensionFunctionAddressForPlatform(  \</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="preprocessor">            priv-&gt;platform_id, #name);                          \</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="preprocessor">        if (!priv-&gt;name) {                                      \</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="preprocessor">            av_log(hwdev, AV_LOG_VERBOSE,                       \</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="preprocessor">                   desc &quot; function not found (%s).\n&quot;, #name);  \</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="preprocessor">            fail = 1;                                           \</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="preprocessor">        } else {                                                \</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="preprocessor">            av_log(hwdev, AV_LOG_VERBOSE,                       \</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="preprocessor">                   desc &quot; function found (%s).\n&quot;, #name);      \</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="preprocessor">        }                                                       \</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="preprocessor">    } while (0)</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160; </div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_DRM_BEIGNET</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    {</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a> = 0;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160; </div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        <a class="code" href="hwcontext__opencl_8c.html#acb5fdd8e42701ef8385fbcec868dc6c4">CL_FUNC</a>(clCreateImageFromFdINTEL,</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                <span class="stringliteral">&quot;Beignet DRM to OpenCL image mapping&quot;</span>);</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160; </div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>) {</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga85b57516ca703cc47d9bbe5f4658c716">AV_LOG_WARNING</a>, <span class="stringliteral">&quot;Beignet DRM to OpenCL &quot;</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                   <span class="stringliteral">&quot;mapping not usable.\n&quot;</span>);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;            priv-&gt;beignet_drm_mapping_usable = 0;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;            priv-&gt;beignet_drm_mapping_usable = 1;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        }</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    }</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_VAAPI_INTEL_MEDIA</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    {</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <span class="keywordtype">size_t</span> props_size;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        cl_context_properties *props = <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        VADisplay va_display;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *va_ext = <span class="stringliteral">&quot;cl_intel_va_api_media_sharing&quot;</span>;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a> = 0;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160; </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="hwcontext__opencl_8c.html#a680d1dfa2b7b327438e68094b925c587">opencl_check_extension</a>(hwdev, va_ext)) {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>, <span class="stringliteral">&quot;The %s extension is &quot;</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                   <span class="stringliteral">&quot;required for QSV to OpenCL mapping.\n&quot;</span>, va_ext);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            <span class="keywordflow">goto</span> no_qsv;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        }</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; </div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        cle = clGetContextInfo(hwctx-&gt;<a class="code" href="struct_a_v_open_c_l_device_context.html#a5152eb3c345fd6ead8ffa9e602293d20">context</a>, CL_CONTEXT_PROPERTIES,</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                               0, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;props_size);</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>, <span class="stringliteral">&quot;Failed to get context &quot;</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                   <span class="stringliteral">&quot;properties: %d.\n&quot;</span>, cle);</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            <span class="keywordflow">goto</span> no_qsv;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        }</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        <span class="keywordflow">if</span> (props_size == 0) {</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>, <span class="stringliteral">&quot;Media sharing must be &quot;</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                   <span class="stringliteral">&quot;enabled on context creation to use QSV to &quot;</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                   <span class="stringliteral">&quot;OpenCL mapping.\n&quot;</span>);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            <span class="keywordflow">goto</span> no_qsv;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        }</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160; </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        props = <a class="code" href="tableprint__vlc_8h.html#ae97db1f58b6b1515ed57a83bea3dd572">av_malloc</a>(props_size);</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        <span class="keywordflow">if</span> (!props)</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        cle = clGetContextInfo(hwctx-&gt;<a class="code" href="struct_a_v_open_c_l_device_context.html#a5152eb3c345fd6ead8ffa9e602293d20">context</a>, CL_CONTEXT_PROPERTIES,</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                               props_size, props, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>, <span class="stringliteral">&quot;Failed to get context &quot;</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                   <span class="stringliteral">&quot;properties: %d.\n&quot;</span>, cle);</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            <span class="keywordflow">goto</span> no_qsv;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        }</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160; </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        va_display = <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; (props_size / <span class="keyword">sizeof</span>(*props) - 1); <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            <span class="keywordflow">if</span> (props[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>] == CL_CONTEXT_VA_API_DISPLAY_INTEL) {</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                va_display = (VADisplay)(intptr_t)props[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>+1];</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            }</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        }</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        <span class="keywordflow">if</span> (!va_display) {</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>, <span class="stringliteral">&quot;Media sharing must be &quot;</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                   <span class="stringliteral">&quot;enabled on context creation to use QSV to &quot;</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                   <span class="stringliteral">&quot;OpenCL mapping.\n&quot;</span>);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            <span class="keywordflow">goto</span> no_qsv;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        }</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <span class="keywordflow">if</span> (!vaDisplayIsValid(va_display)) {</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>, <span class="stringliteral">&quot;A valid VADisplay is &quot;</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                   <span class="stringliteral">&quot;required on context creation to use QSV to &quot;</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                   <span class="stringliteral">&quot;OpenCL mapping.\n&quot;</span>);</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            <span class="keywordflow">goto</span> no_qsv;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        }</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        <a class="code" href="hwcontext__opencl_8c.html#acb5fdd8e42701ef8385fbcec868dc6c4">CL_FUNC</a>(clCreateFromVA_APIMediaSurfaceINTEL,</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                <span class="stringliteral">&quot;Intel QSV to OpenCL mapping&quot;</span>);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        <a class="code" href="hwcontext__opencl_8c.html#acb5fdd8e42701ef8385fbcec868dc6c4">CL_FUNC</a>(clEnqueueAcquireVA_APIMediaSurfacesINTEL,</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                <span class="stringliteral">&quot;Intel QSV in OpenCL acquire&quot;</span>);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        <a class="code" href="hwcontext__opencl_8c.html#acb5fdd8e42701ef8385fbcec868dc6c4">CL_FUNC</a>(clEnqueueReleaseVA_APIMediaSurfacesINTEL,</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                <span class="stringliteral">&quot;Intel QSV in OpenCL release&quot;</span>);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>) {</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        no_qsv:</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga85b57516ca703cc47d9bbe5f4658c716">AV_LOG_WARNING</a>, <span class="stringliteral">&quot;QSV to OpenCL mapping &quot;</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                   <span class="stringliteral">&quot;not usable.\n&quot;</span>);</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            priv-&gt;qsv_mapping_usable = 0;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            priv-&gt;qsv_mapping_usable = 1;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        }</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#a079eab092887563f2bef9106c6120089">av_free</a>(props);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    }</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_DXVA2</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a> = 0;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160; </div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        <a class="code" href="hwcontext__opencl_8c.html#acb5fdd8e42701ef8385fbcec868dc6c4">CL_FUNC</a>(clCreateFromDX9MediaSurfaceKHR,</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                <span class="stringliteral">&quot;DXVA2 to OpenCL mapping&quot;</span>);</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        <a class="code" href="hwcontext__opencl_8c.html#acb5fdd8e42701ef8385fbcec868dc6c4">CL_FUNC</a>(clEnqueueAcquireDX9MediaSurfacesKHR,</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                <span class="stringliteral">&quot;DXVA2 in OpenCL acquire&quot;</span>);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        <a class="code" href="hwcontext__opencl_8c.html#acb5fdd8e42701ef8385fbcec868dc6c4">CL_FUNC</a>(clEnqueueReleaseDX9MediaSurfacesKHR,</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                <span class="stringliteral">&quot;DXVA2 in OpenCL release&quot;</span>);</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160; </div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>) {</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga85b57516ca703cc47d9bbe5f4658c716">AV_LOG_WARNING</a>, <span class="stringliteral">&quot;DXVA2 to OpenCL mapping &quot;</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                   <span class="stringliteral">&quot;not usable.\n&quot;</span>);</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;            priv-&gt;dxva2_mapping_usable = 0;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            priv-&gt;dx9_media_adapter_type = CL_ADAPTER_D3D9EX_KHR;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            priv-&gt;dxva2_mapping_usable = 1;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        }</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    }</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160; </div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_D3D11</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    {</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *d3d11_ext = <span class="stringliteral">&quot;cl_khr_d3d11_sharing&quot;</span>;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *nv12_ext  = <span class="stringliteral">&quot;cl_intel_d3d11_nv12_media_sharing&quot;</span>;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a> = 0;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160; </div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="hwcontext__opencl_8c.html#a680d1dfa2b7b327438e68094b925c587">opencl_check_extension</a>(hwdev, d3d11_ext)) {</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>, <span class="stringliteral">&quot;The %s extension is &quot;</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                   <span class="stringliteral">&quot;required for D3D11 to OpenCL mapping.\n&quot;</span>, d3d11_ext);</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a> = 1;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="hwcontext__opencl_8c.html#a680d1dfa2b7b327438e68094b925c587">opencl_check_extension</a>(hwdev, nv12_ext)) {</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>, <span class="stringliteral">&quot;The %s extension may be &quot;</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                   <span class="stringliteral">&quot;required for D3D11 to OpenCL mapping.\n&quot;</span>, nv12_ext);</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            <span class="comment">// Not fatal.</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        }</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160; </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        <a class="code" href="hwcontext__opencl_8c.html#acb5fdd8e42701ef8385fbcec868dc6c4">CL_FUNC</a>(clCreateFromD3D11Texture2DKHR,</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                <span class="stringliteral">&quot;D3D11 to OpenCL mapping&quot;</span>);</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        <a class="code" href="hwcontext__opencl_8c.html#acb5fdd8e42701ef8385fbcec868dc6c4">CL_FUNC</a>(clEnqueueAcquireD3D11ObjectsKHR,</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                <span class="stringliteral">&quot;D3D11 in OpenCL acquire&quot;</span>);</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        <a class="code" href="hwcontext__opencl_8c.html#acb5fdd8e42701ef8385fbcec868dc6c4">CL_FUNC</a>(clEnqueueReleaseD3D11ObjectsKHR,</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                <span class="stringliteral">&quot;D3D11 in OpenCL release&quot;</span>);</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160; </div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>) {</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga85b57516ca703cc47d9bbe5f4658c716">AV_LOG_WARNING</a>, <span class="stringliteral">&quot;D3D11 to OpenCL mapping &quot;</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                   <span class="stringliteral">&quot;not usable.\n&quot;</span>);</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            priv-&gt;d3d11_mapping_usable = 0;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;            priv-&gt;d3d11_mapping_usable = 1;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        }</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    }</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160; </div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_DRM_ARM</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    {</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *drm_arm_ext = <span class="stringliteral">&quot;cl_arm_import_memory&quot;</span>;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *image_ext   = <span class="stringliteral">&quot;cl_khr_image2d_from_buffer&quot;</span>;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a> = 0;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160; </div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="hwcontext__opencl_8c.html#a680d1dfa2b7b327438e68094b925c587">opencl_check_extension</a>(hwdev, drm_arm_ext)) {</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>, <span class="stringliteral">&quot;The %s extension is &quot;</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                   <span class="stringliteral">&quot;required for DRM to OpenCL mapping on ARM.\n&quot;</span>,</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                   drm_arm_ext);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;            <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a> = 1;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        }</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="hwcontext__opencl_8c.html#a680d1dfa2b7b327438e68094b925c587">opencl_check_extension</a>(hwdev, image_ext)) {</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>, <span class="stringliteral">&quot;The %s extension is &quot;</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                   <span class="stringliteral">&quot;required for DRM to OpenCL mapping on ARM.\n&quot;</span>,</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                   image_ext);</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;            <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a> = 1;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        }</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160; </div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <span class="comment">// clImportMemoryARM() is linked statically.</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160; </div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>) {</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga85b57516ca703cc47d9bbe5f4658c716">AV_LOG_WARNING</a>, <span class="stringliteral">&quot;DRM to OpenCL mapping on ARM &quot;</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                   <span class="stringliteral">&quot;not usable.\n&quot;</span>);</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;            priv-&gt;drm_arm_mapping_usable = 0;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;            priv-&gt;drm_arm_mapping_usable = 1;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        }</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    }</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160; </div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="preprocessor">#undef CL_FUNC</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160; </div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;}</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160; </div>
<div class="line"><a name="l00889"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#ac80722ea1b3deb660be44b3d4fc2e44e">  889</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="hwcontext__opencl_8c.html#ac80722ea1b3deb660be44b3d4fc2e44e">opencl_device_uninit</a>(<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *hwdev)</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;{</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <a class="code" href="struct_open_c_l_device_context.html">OpenCLDeviceContext</a> *priv = hwdev-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a9c3758c73b0f29925ccb2f60b5c1a803">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_device_internal.html#ae7425663cca9541964518c66974a20bf">priv</a>;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160; </div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="keywordflow">if</span> (priv-&gt;<a class="code" href="struct_open_c_l_device_context.html#ae29e4d0d149bedcd5d69ee60d79d549d">command_queue</a>) {</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        cle = clReleaseCommandQueue(priv-&gt;<a class="code" href="struct_open_c_l_device_context.html#ae29e4d0d149bedcd5d69ee60d79d549d">command_queue</a>);</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to release internal &quot;</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                   <span class="stringliteral">&quot;command queue reference: %d.\n&quot;</span>, cle);</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        }</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        priv-&gt;<a class="code" href="struct_open_c_l_device_context.html#ae29e4d0d149bedcd5d69ee60d79d549d">command_queue</a> = <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    }</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;}</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160; </div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_VAAPI_INTEL_MEDIA</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> opencl_filter_intel_media_vaapi_platform(<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *hwdev,</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                                                    cl_platform_id platform_id,</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                                                    <span class="keyword">const</span> <span class="keywordtype">char</span> *platform_name,</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                                                    <span class="keywordtype">void</span> *<a class="code" href="writing__filters_8txt.html#a5b5446e1f47af0c85ac6b45210d45117">context</a>)</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;{</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="comment">// This doesn&#39;t exist as a platform extension, so just test whether</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="comment">// the function we will use for device enumeration exists.</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160; </div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="keywordflow">if</span> (!clGetExtensionFunctionAddressForPlatform(platform_id,</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;            <span class="stringliteral">&quot;clGetDeviceIDsFromVA_APIMediaAdapterINTEL&quot;</span>)) {</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga5b7221c3afd06848486776bd834a58a5">AV_LOG_DEBUG</a>, <span class="stringliteral">&quot;Platform %s does not export the &quot;</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;               <span class="stringliteral">&quot;VAAPI device enumeration function.\n&quot;</span>, platform_name);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    }</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;}</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160; </div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> opencl_enumerate_intel_media_vaapi_devices(<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *hwdev,</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                                                      cl_platform_id platform_id,</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                                                      <span class="keyword">const</span> <span class="keywordtype">char</span> *platform_name,</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                                                      cl_uint *nb_devices,</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                                                      cl_device_id **devices,</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                                                      <span class="keywordtype">void</span> *<a class="code" href="writing__filters_8txt.html#a5b5446e1f47af0c85ac6b45210d45117">context</a>)</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;{</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    VADisplay va_display = <a class="code" href="writing__filters_8txt.html#a5b5446e1f47af0c85ac6b45210d45117">context</a>;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    clGetDeviceIDsFromVA_APIMediaAdapterINTEL_fn</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        clGetDeviceIDsFromVA_APIMediaAdapterINTEL;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160; </div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    clGetDeviceIDsFromVA_APIMediaAdapterINTEL =</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        clGetExtensionFunctionAddressForPlatform(platform_id,</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;            <span class="stringliteral">&quot;clGetDeviceIDsFromVA_APIMediaAdapterINTEL&quot;</span>);</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="keywordflow">if</span> (!clGetDeviceIDsFromVA_APIMediaAdapterINTEL) {</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to get address of &quot;</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;               <span class="stringliteral">&quot;clGetDeviceIDsFromVA_APIMediaAdapterINTEL().\n&quot;</span>);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__lavu__error.html#ga4ebaa288c7684a26a591c501208910e4">AVERROR_UNKNOWN</a>;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    }</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160; </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    cle = clGetDeviceIDsFromVA_APIMediaAdapterINTEL(</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        platform_id, CL_VA_API_DISPLAY_INTEL, va_display,</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        CL_PREFERRED_DEVICES_FOR_VA_API_INTEL, 0, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, nb_devices);</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="keywordflow">if</span> (cle == CL_DEVICE_NOT_FOUND) {</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga5b7221c3afd06848486776bd834a58a5">AV_LOG_DEBUG</a>, <span class="stringliteral">&quot;No VAAPI-supporting devices found &quot;</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;               <span class="stringliteral">&quot;on platform \&quot;%s\&quot;.\n&quot;</span>, platform_name);</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        *nb_devices = 0;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to get number of devices &quot;</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;               <span class="stringliteral">&quot;on platform \&quot;%s\&quot;: %d.\n&quot;</span>, platform_name, cle);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__lavu__error.html#ga4ebaa288c7684a26a591c501208910e4">AVERROR_UNKNOWN</a>;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    }</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    *devices = <a class="code" href="mem_8c.html#a254f3455439c15a2c8a75b8f0235fdbd">av_malloc_array</a>(*nb_devices, <span class="keyword">sizeof</span>(**devices));</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <span class="keywordflow">if</span> (!*devices)</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160; </div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    cle = clGetDeviceIDsFromVA_APIMediaAdapterINTEL(</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        platform_id, CL_VA_API_DISPLAY_INTEL, va_display,</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        CL_PREFERRED_DEVICES_FOR_VA_API_INTEL, *nb_devices, *devices, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to get list of VAAPI-supporting &quot;</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;               <span class="stringliteral">&quot;devices on platform \&quot;%s\&quot;: %d.\n&quot;</span>, platform_name, cle);</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#adba82e1bcd02de510a858fcbedf79ef1">av_freep</a>(devices);</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__lavu__error.html#ga4ebaa288c7684a26a591c501208910e4">AVERROR_UNKNOWN</a>;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    }</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160; </div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;}</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160; </div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> opencl_filter_intel_media_vaapi_device(<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *hwdev,</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                                                  cl_device_id device_id,</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                                                  <span class="keyword">const</span> <span class="keywordtype">char</span> *device_name,</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                                                  <span class="keywordtype">void</span> *<a class="code" href="writing__filters_8txt.html#a5b5446e1f47af0c85ac6b45210d45117">context</a>)</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;{</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *va_ext = <span class="stringliteral">&quot;cl_intel_va_api_media_sharing&quot;</span>;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160; </div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="hwcontext__opencl_8c.html#a377664ee715aeee2c8d3f042a365f471">opencl_check_device_extension</a>(device_id, va_ext)) {</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga5b7221c3afd06848486776bd834a58a5">AV_LOG_DEBUG</a>, <span class="stringliteral">&quot;Device %s does not support the &quot;</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;               <span class="stringliteral">&quot;%s extension.\n&quot;</span>, device_name, va_ext);</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    }</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;}</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160; </div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_DXVA2</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> opencl_filter_dxva2_platform(<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *hwdev,</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                                        cl_platform_id platform_id,</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                                        <span class="keyword">const</span> <span class="keywordtype">char</span> *platform_name,</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                                        <span class="keywordtype">void</span> *<a class="code" href="writing__filters_8txt.html#a5b5446e1f47af0c85ac6b45210d45117">context</a>)</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;{</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *dx9_ext = <span class="stringliteral">&quot;cl_khr_dx9_media_sharing&quot;</span>;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160; </div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="hwcontext__opencl_8c.html#afe78af15c378fc40f3d89399d83d8ad2">opencl_check_platform_extension</a>(platform_id, dx9_ext)) {</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga5b7221c3afd06848486776bd834a58a5">AV_LOG_DEBUG</a>, <span class="stringliteral">&quot;Platform %s does not support the &quot;</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;               <span class="stringliteral">&quot;%s extension.\n&quot;</span>, platform_name, dx9_ext);</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    }</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;}</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160; </div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> opencl_enumerate_dxva2_devices(<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *hwdev,</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                                          cl_platform_id platform_id,</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                                          <span class="keyword">const</span> <span class="keywordtype">char</span> *platform_name,</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                                          cl_uint *nb_devices,</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                                          cl_device_id **devices,</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                                          <span class="keywordtype">void</span> *<a class="code" href="writing__filters_8txt.html#a5b5446e1f47af0c85ac6b45210d45117">context</a>)</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;{</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    IDirect3DDevice9 *device = <a class="code" href="writing__filters_8txt.html#a5b5446e1f47af0c85ac6b45210d45117">context</a>;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    clGetDeviceIDsFromDX9MediaAdapterKHR_fn</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        clGetDeviceIDsFromDX9MediaAdapterKHR;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    cl_dx9_media_adapter_type_khr media_adapter_type = CL_ADAPTER_D3D9EX_KHR;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160; </div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    clGetDeviceIDsFromDX9MediaAdapterKHR =</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        clGetExtensionFunctionAddressForPlatform(platform_id,</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;            <span class="stringliteral">&quot;clGetDeviceIDsFromDX9MediaAdapterKHR&quot;</span>);</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="keywordflow">if</span> (!clGetDeviceIDsFromDX9MediaAdapterKHR) {</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to get address of &quot;</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;               <span class="stringliteral">&quot;clGetDeviceIDsFromDX9MediaAdapterKHR().\n&quot;</span>);</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__lavu__error.html#ga4ebaa288c7684a26a591c501208910e4">AVERROR_UNKNOWN</a>;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    }</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160; </div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    cle = clGetDeviceIDsFromDX9MediaAdapterKHR(</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;        platform_id, 1, &amp;media_adapter_type, (<span class="keywordtype">void</span>**)&amp;device,</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;        CL_PREFERRED_DEVICES_FOR_DX9_MEDIA_ADAPTER_KHR,</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        0, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, nb_devices);</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <span class="keywordflow">if</span> (cle == CL_DEVICE_NOT_FOUND) {</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga5b7221c3afd06848486776bd834a58a5">AV_LOG_DEBUG</a>, <span class="stringliteral">&quot;No DXVA2-supporting devices found &quot;</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;               <span class="stringliteral">&quot;on platform \&quot;%s\&quot;.\n&quot;</span>, platform_name);</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        *nb_devices = 0;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to get number of devices &quot;</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;               <span class="stringliteral">&quot;on platform \&quot;%s\&quot;: %d.\n&quot;</span>, platform_name, cle);</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__lavu__error.html#ga4ebaa288c7684a26a591c501208910e4">AVERROR_UNKNOWN</a>;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    }</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160; </div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    *devices = <a class="code" href="mem_8c.html#a254f3455439c15a2c8a75b8f0235fdbd">av_malloc_array</a>(*nb_devices, <span class="keyword">sizeof</span>(**devices));</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <span class="keywordflow">if</span> (!*devices)</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160; </div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    cle = clGetDeviceIDsFromDX9MediaAdapterKHR(</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        platform_id, 1, &amp;media_adapter_type, (<span class="keywordtype">void</span>**)&amp;device,</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        CL_PREFERRED_DEVICES_FOR_DX9_MEDIA_ADAPTER_KHR,</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        *nb_devices, *devices, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to get list of DXVA2-supporting &quot;</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;               <span class="stringliteral">&quot;devices on platform \&quot;%s\&quot;: %d.\n&quot;</span>, platform_name, cle);</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#adba82e1bcd02de510a858fcbedf79ef1">av_freep</a>(devices);</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__lavu__error.html#ga4ebaa288c7684a26a591c501208910e4">AVERROR_UNKNOWN</a>;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    }</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160; </div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;}</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160; </div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_D3D11</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> opencl_filter_d3d11_platform(<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *hwdev,</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                                        cl_platform_id platform_id,</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                                        <span class="keyword">const</span> <span class="keywordtype">char</span> *platform_name,</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                                        <span class="keywordtype">void</span> *<a class="code" href="writing__filters_8txt.html#a5b5446e1f47af0c85ac6b45210d45117">context</a>)</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;{</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *d3d11_ext = <span class="stringliteral">&quot;cl_khr_d3d11_sharing&quot;</span>;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160; </div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="hwcontext__opencl_8c.html#afe78af15c378fc40f3d89399d83d8ad2">opencl_check_platform_extension</a>(platform_id, d3d11_ext)) {</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga5b7221c3afd06848486776bd834a58a5">AV_LOG_DEBUG</a>, <span class="stringliteral">&quot;Platform %s does not support the &quot;</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;               <span class="stringliteral">&quot;%s extension.\n&quot;</span>, platform_name, d3d11_ext);</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    }</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;}</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160; </div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> opencl_enumerate_d3d11_devices(<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *hwdev,</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                                          cl_platform_id platform_id,</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                                          <span class="keyword">const</span> <span class="keywordtype">char</span> *platform_name,</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                                          cl_uint *nb_devices,</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                                          cl_device_id **devices,</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                                          <span class="keywordtype">void</span> *<a class="code" href="writing__filters_8txt.html#a5b5446e1f47af0c85ac6b45210d45117">context</a>)</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;{</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <a class="code" href="nvenc_8h.html#a6e9da08b1a3e1791361224730077b542">ID3D11Device</a> *device = <a class="code" href="writing__filters_8txt.html#a5b5446e1f47af0c85ac6b45210d45117">context</a>;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    clGetDeviceIDsFromD3D11KHR_fn clGetDeviceIDsFromD3D11KHR;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160; </div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    clGetDeviceIDsFromD3D11KHR =</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        clGetExtensionFunctionAddressForPlatform(platform_id,</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;            <span class="stringliteral">&quot;clGetDeviceIDsFromD3D11KHR&quot;</span>);</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <span class="keywordflow">if</span> (!clGetDeviceIDsFromD3D11KHR) {</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to get address of &quot;</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;               <span class="stringliteral">&quot;clGetDeviceIDsFromD3D11KHR().\n&quot;</span>);</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__lavu__error.html#ga4ebaa288c7684a26a591c501208910e4">AVERROR_UNKNOWN</a>;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    }</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160; </div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    cle = clGetDeviceIDsFromD3D11KHR(platform_id,</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                                     CL_D3D11_DEVICE_KHR, device,</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                                     CL_PREFERRED_DEVICES_FOR_D3D11_KHR,</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                                     0, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, nb_devices);</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="keywordflow">if</span> (cle == CL_DEVICE_NOT_FOUND) {</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga5b7221c3afd06848486776bd834a58a5">AV_LOG_DEBUG</a>, <span class="stringliteral">&quot;No D3D11-supporting devices found &quot;</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;               <span class="stringliteral">&quot;on platform \&quot;%s\&quot;.\n&quot;</span>, platform_name);</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        *nb_devices = 0;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to get number of devices &quot;</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;               <span class="stringliteral">&quot;on platform \&quot;%s\&quot;: %d.\n&quot;</span>, platform_name, cle);</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__lavu__error.html#ga4ebaa288c7684a26a591c501208910e4">AVERROR_UNKNOWN</a>;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    }</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160; </div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    *devices = <a class="code" href="mem_8c.html#a254f3455439c15a2c8a75b8f0235fdbd">av_malloc_array</a>(*nb_devices, <span class="keyword">sizeof</span>(**devices));</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <span class="keywordflow">if</span> (!*devices)</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160; </div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    cle = clGetDeviceIDsFromD3D11KHR(platform_id,</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                                     CL_D3D11_DEVICE_KHR, device,</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                                     CL_PREFERRED_DEVICES_FOR_D3D11_KHR,</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                                     *nb_devices, *devices, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to get list of D3D11-supporting &quot;</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;               <span class="stringliteral">&quot;devices on platform \&quot;%s\&quot;: %d.\n&quot;</span>, platform_name, cle);</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#adba82e1bcd02de510a858fcbedf79ef1">av_freep</a>(devices);</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__lavu__error.html#ga4ebaa288c7684a26a591c501208910e4">AVERROR_UNKNOWN</a>;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    }</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160; </div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;}</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160; </div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_DXVA2 || HAVE_OPENCL_D3D11</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> opencl_filter_gpu_device(<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *hwdev,</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                                    cl_device_id device_id,</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">char</span> *device_name,</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                                    <span class="keywordtype">void</span> *<a class="code" href="writing__filters_8txt.html#a5b5446e1f47af0c85ac6b45210d45117">context</a>)</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;{</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    cl_device_type <a class="code" href="hwcontext__qsv_8c.html#a7898416aa2fa2f5d58aa4b6f35135205">device_type</a>;</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160; </div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    cle = clGetDeviceInfo(device_id, CL_DEVICE_TYPE,</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                          <span class="keyword">sizeof</span>(<a class="code" href="hwcontext__qsv_8c.html#a7898416aa2fa2f5d58aa4b6f35135205">device_type</a>), &amp;<a class="code" href="hwcontext__qsv_8c.html#a7898416aa2fa2f5d58aa4b6f35135205">device_type</a>, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to query device type &quot;</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;               <span class="stringliteral">&quot;of device \&quot;%s\&quot;.\n&quot;</span>, device_name);</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__lavu__error.html#ga4ebaa288c7684a26a591c501208910e4">AVERROR_UNKNOWN</a>;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    }</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <span class="keywordflow">if</span> (!(<a class="code" href="hwcontext__qsv_8c.html#a7898416aa2fa2f5d58aa4b6f35135205">device_type</a> &amp; CL_DEVICE_TYPE_GPU)) {</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga5b7221c3afd06848486776bd834a58a5">AV_LOG_DEBUG</a>, <span class="stringliteral">&quot;Device %s skipped (not GPU).\n&quot;</span>,</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;               device_name);</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    }</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160; </div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;}</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160; </div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_DRM_ARM</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> opencl_filter_drm_arm_platform(<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *hwdev,</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                                          cl_platform_id platform_id,</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                                          <span class="keyword">const</span> <span class="keywordtype">char</span> *platform_name,</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                                          <span class="keywordtype">void</span> *<a class="code" href="writing__filters_8txt.html#a5b5446e1f47af0c85ac6b45210d45117">context</a>)</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;{</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *drm_arm_ext = <span class="stringliteral">&quot;cl_arm_import_memory&quot;</span>;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160; </div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="hwcontext__opencl_8c.html#afe78af15c378fc40f3d89399d83d8ad2">opencl_check_platform_extension</a>(platform_id, drm_arm_ext)) {</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga5b7221c3afd06848486776bd834a58a5">AV_LOG_DEBUG</a>, <span class="stringliteral">&quot;Platform %s does not support the &quot;</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;               <span class="stringliteral">&quot;%s extension.\n&quot;</span>, platform_name, drm_arm_ext);</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    }</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;}</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160; </div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> opencl_filter_drm_arm_device(<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *hwdev,</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                                        cl_device_id device_id,</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                                        <span class="keyword">const</span> <span class="keywordtype">char</span> *device_name,</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                                        <span class="keywordtype">void</span> *<a class="code" href="writing__filters_8txt.html#a5b5446e1f47af0c85ac6b45210d45117">context</a>)</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;{</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *drm_arm_ext = <span class="stringliteral">&quot;cl_arm_import_memory&quot;</span>;</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160; </div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="hwcontext__opencl_8c.html#a377664ee715aeee2c8d3f042a365f471">opencl_check_device_extension</a>(device_id, drm_arm_ext)) {</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga5b7221c3afd06848486776bd834a58a5">AV_LOG_DEBUG</a>, <span class="stringliteral">&quot;Device %s does not support the &quot;</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;               <span class="stringliteral">&quot;%s extension.\n&quot;</span>, device_name, drm_arm_ext);</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    }</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;}</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160; </div>
<div class="line"><a name="l01196"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#af42f65b808f46810f0b04b7f93f38eaf"> 1196</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__opencl_8c.html#af42f65b808f46810f0b04b7f93f38eaf">opencl_device_derive</a>(<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *hwdev,</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                                <a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *src_ctx, <a class="code" href="struct_a_v_dictionary.html">AVDictionary</a> *<a class="code" href="tests_2movenc_8c.html#af540b728145b614e34c4e10930354b93">opts</a>,</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                                <span class="keywordtype">int</span> <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>)</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;{</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <span class="keywordtype">int</span> err;</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    <span class="keywordflow">switch</span> (src_ctx-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#abc92603a11768828ef3aea1f9d089308">type</a>) {</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160; </div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_DRM_BEIGNET</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34aa04ac36fb964a5c191566a8e809de743">AV_HWDEVICE_TYPE_DRM</a>:</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34af5dfa6181a3a6efb0f4a0c5f38d76b95">AV_HWDEVICE_TYPE_VAAPI</a>:</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;        {</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;            <span class="comment">// Surface mapping works via DRM PRIME fds with no special</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;            <span class="comment">// initialisation required in advance.  This just finds the</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;            <span class="comment">// Beignet ICD by name.</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;            <a class="code" href="struct_a_v_dictionary.html">AVDictionary</a> *selector_opts = <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160; </div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;            err = <a class="code" href="group__lavu__dict.html#ga8d9c2de72b310cef8e6a28c9cd3acbbe">av_dict_set</a>(&amp;selector_opts, <span class="stringliteral">&quot;platform_vendor&quot;</span>, <span class="stringliteral">&quot;Intel&quot;</span>, 0);</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;            <span class="keywordflow">if</span> (err &gt;= 0)</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                err = <a class="code" href="group__lavu__dict.html#ga8d9c2de72b310cef8e6a28c9cd3acbbe">av_dict_set</a>(&amp;selector_opts, <span class="stringliteral">&quot;platform_version&quot;</span>, <span class="stringliteral">&quot;beignet&quot;</span>, 0);</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;            <span class="keywordflow">if</span> (err &gt;= 0) {</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                <a class="code" href="struct_open_c_l_device_selector.html">OpenCLDeviceSelector</a> selector = {</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                    .<a class="code" href="struct_open_c_l_device_selector.html#aedc0c87598ef24a88481f4fa3388f2cf">platform_index</a>      = -1,</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                    .device_index        = 0,</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                    .context             = selector_opts,</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                    .enumerate_platforms = &amp;<a class="code" href="hwcontext__opencl_8c.html#aa446a057be8040d8f3d091d52e67ed47">opencl_enumerate_platforms</a>,</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                    .filter_platform     = &amp;<a class="code" href="hwcontext__opencl_8c.html#af73f72120f21c6a98aca9ef43f51ef48">opencl_filter_platform</a>,</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                    .enumerate_devices   = &amp;<a class="code" href="hwcontext__opencl_8c.html#ae6f10ee0c7f06ca57f7f37c7d7575086">opencl_enumerate_devices</a>,</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                    .filter_device       = <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                };</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                err = <a class="code" href="hwcontext__opencl_8c.html#ad933f1f898a2be64f81d92fa4024e52c">opencl_device_create_internal</a>(hwdev, &amp;selector, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;            }</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;            <a class="code" href="group__lavu__dict.html#ga1bafd682b1fbb90e48a4cc3814b820f7">av_dict_free</a>(&amp;selector_opts);</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        }</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160; </div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_VAAPI_INTEL_MEDIA</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        <span class="comment">// The generic code automatically attempts to derive from all</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        <span class="comment">// ancestors of the given device, so we can ignore QSV devices here</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;        <span class="comment">// and just consider the inner VAAPI device it was derived from.</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34af5dfa6181a3a6efb0f4a0c5f38d76b95">AV_HWDEVICE_TYPE_VAAPI</a>:</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        {</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;            <a class="code" href="struct_a_v_v_a_a_p_i_device_context.html">AVVAAPIDeviceContext</a> *src_hwctx = src_ctx-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a46055b48d1a40445d775b4ae24f77f20">hwctx</a>;</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;            cl_context_properties props[7] = {</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                CL_CONTEXT_PLATFORM,</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                0,</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                CL_CONTEXT_VA_API_DISPLAY_INTEL,</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                (intptr_t)src_hwctx-&gt;<a class="code" href="struct_a_v_v_a_a_p_i_device_context.html#a89951d5ccfad53ce81444773ea9f774e">display</a>,</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                CL_CONTEXT_INTEROP_USER_SYNC,</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                CL_FALSE,</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                0,</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;            };</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;            <a class="code" href="struct_open_c_l_device_selector.html">OpenCLDeviceSelector</a> selector = {</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                .<a class="code" href="struct_open_c_l_device_selector.html#aedc0c87598ef24a88481f4fa3388f2cf">platform_index</a>      = -1,</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                .device_index        = -1,</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                .context             = src_hwctx-&gt;<a class="code" href="struct_a_v_v_a_a_p_i_device_context.html#a89951d5ccfad53ce81444773ea9f774e">display</a>,</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                .enumerate_platforms = &amp;<a class="code" href="hwcontext__opencl_8c.html#aa446a057be8040d8f3d091d52e67ed47">opencl_enumerate_platforms</a>,</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                .filter_platform     = &amp;opencl_filter_intel_media_vaapi_platform,</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                .enumerate_devices   = &amp;opencl_enumerate_intel_media_vaapi_devices,</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                .filter_device       = &amp;opencl_filter_intel_media_vaapi_device,</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;            };</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160; </div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;            err = <a class="code" href="hwcontext__opencl_8c.html#ad933f1f898a2be64f81d92fa4024e52c">opencl_device_create_internal</a>(hwdev, &amp;selector, props);</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        }</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160; </div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_DXVA2</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34acc6f1868dad1c636d4747cc91ce71d10">AV_HWDEVICE_TYPE_DXVA2</a>:</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        {</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;            <a class="code" href="struct_a_v_d_x_v_a2_device_context.html">AVDXVA2DeviceContext</a> *src_hwctx = src_ctx-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a46055b48d1a40445d775b4ae24f77f20">hwctx</a>;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;            IDirect3DDevice9 *device;</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;            HANDLE device_handle;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;            HRESULT hr;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160; </div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;            hr = IDirect3DDeviceManager9_OpenDeviceHandle(src_hwctx-&gt;<a class="code" href="struct_a_v_d_x_v_a2_device_context.html#a3baea98a35192cc661f903198d7196ab">devmgr</a>,</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                                                          &amp;device_handle);</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;            <span class="keywordflow">if</span> (FAILED(hr)) {</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to open device handle &quot;</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                       <span class="stringliteral">&quot;for Direct3D9 device: %lx.\n&quot;</span>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)hr);</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                err = <a class="code" href="group__lavu__error.html#ga4ebaa288c7684a26a591c501208910e4">AVERROR_UNKNOWN</a>;</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;            }</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160; </div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;            hr = IDirect3DDeviceManager9_LockDevice(src_hwctx-&gt;<a class="code" href="struct_a_v_d_x_v_a2_device_context.html#a3baea98a35192cc661f903198d7196ab">devmgr</a>,</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                                                    device_handle,</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                                                    &amp;device, FALSE);</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;            <span class="keywordflow">if</span> (SUCCEEDED(hr)) {</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;                cl_context_properties props[5] = {</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                    CL_CONTEXT_PLATFORM,</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                    0,</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                    CL_CONTEXT_ADAPTER_D3D9EX_KHR,</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                    (intptr_t)device,</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                    0,</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                };</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                <a class="code" href="struct_open_c_l_device_selector.html">OpenCLDeviceSelector</a> selector = {</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;                    .<a class="code" href="struct_open_c_l_device_selector.html#aedc0c87598ef24a88481f4fa3388f2cf">platform_index</a>      = -1,</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;                    .device_index        = -1,</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;                    .context             = device,</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                    .enumerate_platforms = &amp;<a class="code" href="hwcontext__opencl_8c.html#aa446a057be8040d8f3d091d52e67ed47">opencl_enumerate_platforms</a>,</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                    .filter_platform     = &amp;opencl_filter_dxva2_platform,</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                    .enumerate_devices   = &amp;opencl_enumerate_dxva2_devices,</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                    .filter_device       = &amp;opencl_filter_gpu_device,</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                };</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160; </div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                err = <a class="code" href="hwcontext__opencl_8c.html#ad933f1f898a2be64f81d92fa4024e52c">opencl_device_create_internal</a>(hwdev, &amp;selector, props);</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160; </div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                IDirect3DDeviceManager9_UnlockDevice(src_hwctx-&gt;<a class="code" href="struct_a_v_d_x_v_a2_device_context.html#a3baea98a35192cc661f903198d7196ab">devmgr</a>,</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                                                     device_handle, FALSE);</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to lock device handle &quot;</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                       <span class="stringliteral">&quot;for Direct3D9 device: %lx.\n&quot;</span>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)hr);</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                err = <a class="code" href="group__lavu__error.html#ga4ebaa288c7684a26a591c501208910e4">AVERROR_UNKNOWN</a>;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;            }</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160; </div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;            IDirect3DDeviceManager9_CloseDeviceHandle(src_hwctx-&gt;<a class="code" href="struct_a_v_d_x_v_a2_device_context.html#a3baea98a35192cc661f903198d7196ab">devmgr</a>,</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                                                      device_handle);</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        }</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160; </div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_D3D11</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34a1823a64d48c796978b892dd669659c4c">AV_HWDEVICE_TYPE_D3D11VA</a>:</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        {</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;            <a class="code" href="struct_a_v_d3_d11_v_a_device_context.html">AVD3D11VADeviceContext</a> *src_hwctx = src_ctx-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a46055b48d1a40445d775b4ae24f77f20">hwctx</a>;</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;            cl_context_properties props[5] = {</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;                CL_CONTEXT_PLATFORM,</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                0,</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                CL_CONTEXT_D3D11_DEVICE_KHR,</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                (intptr_t)src_hwctx-&gt;<a class="code" href="struct_a_v_d3_d11_v_a_device_context.html#a846ae4cb1f91302845776cc843dc2808">device</a>,</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                0,</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;            };</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;            <a class="code" href="struct_open_c_l_device_selector.html">OpenCLDeviceSelector</a> selector = {</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                .<a class="code" href="struct_open_c_l_device_selector.html#aedc0c87598ef24a88481f4fa3388f2cf">platform_index</a>      = -1,</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                .device_index        = -1,</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                .context             = src_hwctx-&gt;<a class="code" href="struct_a_v_d3_d11_v_a_device_context.html#a846ae4cb1f91302845776cc843dc2808">device</a>,</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                .enumerate_platforms = &amp;<a class="code" href="hwcontext__opencl_8c.html#aa446a057be8040d8f3d091d52e67ed47">opencl_enumerate_platforms</a>,</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                .filter_platform     = &amp;opencl_filter_d3d11_platform,</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                .enumerate_devices   = &amp;opencl_enumerate_d3d11_devices,</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                .filter_device       = &amp;opencl_filter_gpu_device,</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;            };</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160; </div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;            err = <a class="code" href="hwcontext__opencl_8c.html#ad933f1f898a2be64f81d92fa4024e52c">opencl_device_create_internal</a>(hwdev, &amp;selector, props);</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;        }</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160; </div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_DRM_ARM</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34aa04ac36fb964a5c191566a8e809de743">AV_HWDEVICE_TYPE_DRM</a>:</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;        {</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;            <a class="code" href="struct_open_c_l_device_selector.html">OpenCLDeviceSelector</a> selector = {</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                .<a class="code" href="struct_open_c_l_device_selector.html#aedc0c87598ef24a88481f4fa3388f2cf">platform_index</a>      = -1,</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                .device_index        = -1,</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                .context             = <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                .enumerate_platforms = &amp;<a class="code" href="hwcontext__opencl_8c.html#aa446a057be8040d8f3d091d52e67ed47">opencl_enumerate_platforms</a>,</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                .filter_platform     = &amp;opencl_filter_drm_arm_platform,</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                .enumerate_devices   = &amp;<a class="code" href="hwcontext__opencl_8c.html#ae6f10ee0c7f06ca57f7f37c7d7575086">opencl_enumerate_devices</a>,</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                .filter_device       = &amp;opencl_filter_drm_arm_device,</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;            };</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160; </div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;            err = <a class="code" href="hwcontext__opencl_8c.html#ad933f1f898a2be64f81d92fa4024e52c">opencl_device_create_internal</a>(hwdev, &amp;selector, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;        }</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160; </div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;        err = <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOSYS);</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    }</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160; </div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;}</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160; </div>
<div class="line"><a name="l01369"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#af2c66952db60f2cdd30b7c6c00b80a64"> 1369</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__opencl_8c.html#af2c66952db60f2cdd30b7c6c00b80a64">opencl_get_plane_format</a>(<span class="keyword">enum</span> <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5">AVPixelFormat</a> <a class="code" href="kmsgrab_8c.html#ab482f514ab017799e2ac45d666537564">pixfmt</a>,</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                                   <span class="keywordtype">int</span> plane, <span class="keywordtype">int</span> <a class="code" href="tests_2snowenc_8c.html#a667b04d7fb6ef46db4da4af554c5b6f7">width</a>, <span class="keywordtype">int</span> <a class="code" href="tests_2snowenc_8c.html#a64f9f90ece96c7bab4aee3deacf170e0">height</a>,</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;                                   cl_image_format *image_format,</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                                   cl_image_desc *image_desc)</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;{</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    <span class="keyword">const</span> <a class="code" href="struct_a_v_pix_fmt_descriptor.html">AVPixFmtDescriptor</a> *<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>;</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    <span class="keyword">const</span> <a class="code" href="struct_a_v_component_descriptor.html">AVComponentDescriptor</a> *<a class="code" href="eamad_8c.html#a1bd38494185c28133622c86bcc95d650">comp</a>;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="aptx_8h.html#ac9da8d7a4bd192b8a7dccbc024542709">channels</a> = 0, order = 0, depth = 0, <a class="code" href="rate__distortion_8txt.html#a0e018beb061c7ac6d1f9121683a6f2c2">step</a> = 0;</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    <span class="keywordtype">int</span> wsub, <a class="code" href="vf__median_8c.html#ac1b69496bb6a841ecafe6876734708c3">hsub</a>, <a class="code" href="ilbcdata_8h.html#a545b8c1c045fcc34b81d3ca822620277">alpha</a>;</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>;</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160; </div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    <span class="keywordflow">if</span> (plane &gt;= <a class="code" href="frame_8h.html#add80189702cf0f5ea82718576fb43201">AV_NUM_DATA_POINTERS</a>)</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOENT);</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160; </div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a> = <a class="code" href="pixdesc_8c.html#afe0c3e8aef5173de28bbdaea4298f5f0">av_pix_fmt_desc_get</a>(<a class="code" href="kmsgrab_8c.html#ab482f514ab017799e2ac45d666537564">pixfmt</a>);</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160; </div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <span class="comment">// Only normal images are allowed.</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;flags &amp; (<a class="code" href="pixdesc_8h.html#a0c6b423a11928d3ec5d2cd3f3b64ee81">AV_PIX_FMT_FLAG_BITSTREAM</a> |</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                       <a class="code" href="pixdesc_8h.html#a76f6211b2404231bd7d206ebf4ae46f6">AV_PIX_FMT_FLAG_HWACCEL</a>   |</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                       <a class="code" href="pixdesc_8h.html#af30af160970132a3a31c4738629e4495">AV_PIX_FMT_FLAG_PAL</a>))</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160; </div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    wsub = 1 &lt;&lt; <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;log2_chroma_w;</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    <a class="code" href="vf__median_8c.html#ac1b69496bb6a841ecafe6876734708c3">hsub</a> = 1 &lt;&lt; <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;log2_chroma_h;</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    <span class="comment">// Subsampled components must be exact.</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="tests_2snowenc_8c.html#a667b04d7fb6ef46db4da4af554c5b6f7">width</a> &amp; wsub - 1 || <a class="code" href="tests_2snowenc_8c.html#a64f9f90ece96c7bab4aee3deacf170e0">height</a> &amp; <a class="code" href="vf__median_8c.html#ac1b69496bb6a841ecafe6876734708c3">hsub</a> - 1)</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160; </div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a> = 0; <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a> &lt; <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;nb_components; <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>++) {</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;        <a class="code" href="eamad_8c.html#a1bd38494185c28133622c86bcc95d650">comp</a> = &amp;<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;comp[<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>];</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="eamad_8c.html#a1bd38494185c28133622c86bcc95d650">comp</a>-&gt;plane != plane)</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;        <span class="comment">// The step size must be a power of two.</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="eamad_8c.html#a1bd38494185c28133622c86bcc95d650">comp</a>-&gt;step != 1 &amp;&amp; <a class="code" href="eamad_8c.html#a1bd38494185c28133622c86bcc95d650">comp</a>-&gt;step != 2 &amp;&amp;</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;            <a class="code" href="eamad_8c.html#a1bd38494185c28133622c86bcc95d650">comp</a>-&gt;step != 4 &amp;&amp; <a class="code" href="eamad_8c.html#a1bd38494185c28133622c86bcc95d650">comp</a>-&gt;step != 8)</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;        <span class="comment">// The bits in each component must be packed in the</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;        <span class="comment">// most-significant-bits of the relevant bytes.</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="eamad_8c.html#a1bd38494185c28133622c86bcc95d650">comp</a>-&gt;shift + <a class="code" href="eamad_8c.html#a1bd38494185c28133622c86bcc95d650">comp</a>-&gt;depth != 8 &amp;&amp;</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;            <a class="code" href="eamad_8c.html#a1bd38494185c28133622c86bcc95d650">comp</a>-&gt;shift + <a class="code" href="eamad_8c.html#a1bd38494185c28133622c86bcc95d650">comp</a>-&gt;depth != 16)</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;        <span class="comment">// The depth must not vary between components.</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;        <span class="keywordflow">if</span> (depth &amp;&amp; <a class="code" href="eamad_8c.html#a1bd38494185c28133622c86bcc95d650">comp</a>-&gt;depth != depth)</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;        <span class="comment">// If a single data element crosses multiple bytes then</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;        <span class="comment">// it must match the native endianness.</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="eamad_8c.html#a1bd38494185c28133622c86bcc95d650">comp</a>-&gt;depth &gt; 8 &amp;&amp;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;            HAVE_BIGENDIAN == !(<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;flags &amp; <a class="code" href="pixdesc_8h.html#ac7c7d0be16fb9b6f05b3e0d463cd037b">AV_PIX_FMT_FLAG_BE</a>))</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;        <span class="comment">// A single data element must not contain multiple samples</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;        <span class="comment">// from the same component.</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="rate__distortion_8txt.html#a0e018beb061c7ac6d1f9121683a6f2c2">step</a> &amp;&amp; <a class="code" href="eamad_8c.html#a1bd38494185c28133622c86bcc95d650">comp</a>-&gt;step != <a class="code" href="rate__distortion_8txt.html#a0e018beb061c7ac6d1f9121683a6f2c2">step</a>)</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160; </div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;        depth = <a class="code" href="eamad_8c.html#a1bd38494185c28133622c86bcc95d650">comp</a>-&gt;depth;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;        order = order * 10 + <a class="code" href="eamad_8c.html#a1bd38494185c28133622c86bcc95d650">comp</a>-&gt;offset / ((depth + 7) / 8) + 1;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;        <a class="code" href="rate__distortion_8txt.html#a0e018beb061c7ac6d1f9121683a6f2c2">step</a>  = <a class="code" href="eamad_8c.html#a1bd38494185c28133622c86bcc95d650">comp</a>-&gt;step;</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        <a class="code" href="ilbcdata_8h.html#a545b8c1c045fcc34b81d3ca822620277">alpha</a> = (<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;flags &amp; <a class="code" href="pixdesc_8h.html#a06924ef0ebf07d8742ff8994e3a948bf">AV_PIX_FMT_FLAG_ALPHA</a> &amp;&amp;</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;                 <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a> == <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;nb_components - 1);</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;        ++<a class="code" href="aptx_8h.html#ac9da8d7a4bd192b8a7dccbc024542709">channels</a>;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    }</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="aptx_8h.html#ac9da8d7a4bd192b8a7dccbc024542709">channels</a> == 0)</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOENT);</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160; </div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    memset(image_format, 0, <span class="keyword">sizeof</span>(*image_format));</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    memset(image_desc,   0, <span class="keyword">sizeof</span>(*image_desc));</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    image_desc-&gt;image_type = CL_MEM_OBJECT_IMAGE2D;</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160; </div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    <span class="keywordflow">if</span> (plane == 0 || <a class="code" href="ilbcdata_8h.html#a545b8c1c045fcc34b81d3ca822620277">alpha</a>) {</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;        image_desc-&gt;image_width     = <a class="code" href="tests_2snowenc_8c.html#a667b04d7fb6ef46db4da4af554c5b6f7">width</a>;</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;        image_desc-&gt;image_height    = <a class="code" href="tests_2snowenc_8c.html#a64f9f90ece96c7bab4aee3deacf170e0">height</a>;</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;        image_desc-&gt;image_row_pitch = <a class="code" href="rate__distortion_8txt.html#a0e018beb061c7ac6d1f9121683a6f2c2">step</a> * <a class="code" href="tests_2snowenc_8c.html#a667b04d7fb6ef46db4da4af554c5b6f7">width</a>;</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;        image_desc-&gt;image_width     = <a class="code" href="tests_2snowenc_8c.html#a667b04d7fb6ef46db4da4af554c5b6f7">width</a>  / wsub;</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;        image_desc-&gt;image_height    = <a class="code" href="tests_2snowenc_8c.html#a64f9f90ece96c7bab4aee3deacf170e0">height</a> / <a class="code" href="vf__median_8c.html#ac1b69496bb6a841ecafe6876734708c3">hsub</a>;</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;        image_desc-&gt;image_row_pitch = <a class="code" href="rate__distortion_8txt.html#a0e018beb061c7ac6d1f9121683a6f2c2">step</a> * <a class="code" href="tests_2snowenc_8c.html#a667b04d7fb6ef46db4da4af554c5b6f7">width</a> / wsub;</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    }</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160; </div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <span class="keywordflow">if</span> (depth &lt;= 8) {</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;        image_format-&gt;image_channel_data_type = CL_UNORM_INT8;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;        <span class="keywordflow">if</span> (depth &lt;= 16)</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;            image_format-&gt;image_channel_data_type = CL_UNORM_INT16;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    }</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160; </div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;<span class="preprocessor">#define CHANNEL_ORDER(order, type) \</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="preprocessor">    case order: image_format-&gt;image_channel_order = type; break;</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    <span class="keywordflow">switch</span> (order) {</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;        <a class="code" href="hwcontext__opencl_8c.html#a09499e0a4ce56a9a3642e7e3b27f7e86">CHANNEL_ORDER</a>(1,    CL_R);</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;        <a class="code" href="hwcontext__opencl_8c.html#a09499e0a4ce56a9a3642e7e3b27f7e86">CHANNEL_ORDER</a>(12,   CL_RG);</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;        <a class="code" href="hwcontext__opencl_8c.html#a09499e0a4ce56a9a3642e7e3b27f7e86">CHANNEL_ORDER</a>(1234, CL_RGBA);</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;        <a class="code" href="hwcontext__opencl_8c.html#a09499e0a4ce56a9a3642e7e3b27f7e86">CHANNEL_ORDER</a>(2341, CL_ARGB);</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;        <a class="code" href="hwcontext__opencl_8c.html#a09499e0a4ce56a9a3642e7e3b27f7e86">CHANNEL_ORDER</a>(3214, CL_BGRA);</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;<span class="preprocessor">#ifdef CL_ABGR</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        <a class="code" href="hwcontext__opencl_8c.html#a09499e0a4ce56a9a3642e7e3b27f7e86">CHANNEL_ORDER</a>(4321, CL_ABGR);</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    }</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;<span class="preprocessor">#undef CHANNEL_ORDER</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160; </div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;}</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160; </div>
<div class="line"><a name="l01475"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#a0a9234d6a5cca399a1ea034d9f360ba4"> 1475</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__opencl_8c.html#a0a9234d6a5cca399a1ea034d9f360ba4">opencl_frames_get_constraints</a>(<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *hwdev,</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;                                         <span class="keyword">const</span> <span class="keywordtype">void</span> *hwconfig,</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;                                         <a class="code" href="struct_a_v_h_w_frames_constraints.html">AVHWFramesConstraints</a> *constraints)</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;{</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    <a class="code" href="struct_a_v_open_c_l_device_context.html">AVOpenCLDeviceContext</a> *hwctx = hwdev-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a46055b48d1a40445d775b4ae24f77f20">hwctx</a>;</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    cl_uint nb_image_formats;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    cl_image_format *image_formats = <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <span class="keyword">enum</span> <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5">AVPixelFormat</a> <a class="code" href="demuxing__decoding_8c.html#a7331e302ea7bb48e0b605a069576e135">pix_fmt</a>;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="keywordtype">int</span> err, pix_fmts_found;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    <span class="keywordtype">size_t</span> max_width, max_height;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160; </div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    cle = clGetDeviceInfo(hwctx-&gt;<a class="code" href="struct_a_v_open_c_l_device_context.html#a221b6ee3b0538276cc28367ed0dccec2">device_id</a>, CL_DEVICE_IMAGE2D_MAX_WIDTH,</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;                          <span class="keyword">sizeof</span>(max_width), &amp;max_width, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to query maximum &quot;</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;               <span class="stringliteral">&quot;supported image width: %d.\n&quot;</span>, cle);</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;        constraints-&gt;<a class="code" href="struct_a_v_h_w_frames_constraints.html#a34e06e3397af2b83de9d78f893bf4168">max_width</a> = max_width;</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    }</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    cle = clGetDeviceInfo(hwctx-&gt;<a class="code" href="struct_a_v_open_c_l_device_context.html#a221b6ee3b0538276cc28367ed0dccec2">device_id</a>, CL_DEVICE_IMAGE2D_MAX_HEIGHT,</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                          <span class="keyword">sizeof</span>(max_height), &amp;max_height, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to query maximum &quot;</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;               <span class="stringliteral">&quot;supported image height: %d.\n&quot;</span>, cle);</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;        constraints-&gt;<a class="code" href="struct_a_v_h_w_frames_constraints.html#af5d3a683727f7b92abca7b7114d4e15c">max_height</a> = max_height;</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    }</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga5b7221c3afd06848486776bd834a58a5">AV_LOG_DEBUG</a>, <span class="stringliteral">&quot;Maximum supported image size %dx%d.\n&quot;</span>,</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;           constraints-&gt;<a class="code" href="struct_a_v_h_w_frames_constraints.html#a34e06e3397af2b83de9d78f893bf4168">max_width</a>, constraints-&gt;<a class="code" href="struct_a_v_h_w_frames_constraints.html#af5d3a683727f7b92abca7b7114d4e15c">max_height</a>);</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160; </div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    cle = clGetSupportedImageFormats(hwctx-&gt;<a class="code" href="struct_a_v_open_c_l_device_context.html#a5152eb3c345fd6ead8ffa9e602293d20">context</a>,</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                                     CL_MEM_READ_WRITE,</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                                     CL_MEM_OBJECT_IMAGE2D,</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                                     0, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;nb_image_formats);</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to query supported &quot;</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;               <span class="stringliteral">&quot;image formats: %d.\n&quot;</span>, cle);</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;        err = <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOSYS);</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    }</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    <span class="keywordflow">if</span> (nb_image_formats == 0) {</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;No image support in OpenCL &quot;</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;               <span class="stringliteral">&quot;driver (zero supported image formats).\n&quot;</span>);</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;        err = <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOSYS);</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    }</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160; </div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    image_formats =</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        <a class="code" href="mem_8c.html#a254f3455439c15a2c8a75b8f0235fdbd">av_malloc_array</a>(nb_image_formats, <span class="keyword">sizeof</span>(*image_formats));</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    <span class="keywordflow">if</span> (!image_formats) {</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        err = <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    }</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160; </div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    cle = clGetSupportedImageFormats(hwctx-&gt;<a class="code" href="struct_a_v_open_c_l_device_context.html#a5152eb3c345fd6ead8ffa9e602293d20">context</a>,</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                                     CL_MEM_READ_WRITE,</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                                     CL_MEM_OBJECT_IMAGE2D,</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;                                     nb_image_formats,</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;                                     image_formats, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to query supported &quot;</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;               <span class="stringliteral">&quot;image formats: %d.\n&quot;</span>, cle);</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;        err = <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOSYS);</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    }</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160; </div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    pix_fmts_found = 0;</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="demuxing__decoding_8c.html#a7331e302ea7bb48e0b605a069576e135">pix_fmt</a> = 0; <a class="code" href="demuxing__decoding_8c.html#a7331e302ea7bb48e0b605a069576e135">pix_fmt</a> &lt; <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a28369916d5c0317168b7d1b6c22e3ba6">AV_PIX_FMT_NB</a>; <a class="code" href="demuxing__decoding_8c.html#a7331e302ea7bb48e0b605a069576e135">pix_fmt</a>++) {</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;        cl_image_format image_format;</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;        cl_image_desc   image_desc;</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;        <span class="keywordtype">int</span> plane, <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160; </div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;        <span class="keywordflow">for</span> (plane = 0;; plane++) {</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;            err = <a class="code" href="hwcontext__opencl_8c.html#af2c66952db60f2cdd30b7c6c00b80a64">opencl_get_plane_format</a>(<a class="code" href="demuxing__decoding_8c.html#a7331e302ea7bb48e0b605a069576e135">pix_fmt</a>, plane, 0, 0,</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;                                          &amp;image_format,</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;                                          &amp;image_desc);</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;            <span class="keywordflow">if</span> (err &lt; 0)</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160; </div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nb_image_formats; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;                <span class="keywordflow">if</span> (image_formats[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].image_channel_order ==</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;                    image_format.image_channel_order &amp;&amp;</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                    image_formats[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].image_channel_data_type ==</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;                    image_format.image_channel_data_type)</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;            }</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> == nb_image_formats) {</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;                err = <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;            }</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;        }</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;        <span class="keywordflow">if</span> (err != <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOENT))</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160; </div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwdev, <a class="code" href="group__lavu__log__constants.html#ga5b7221c3afd06848486776bd834a58a5">AV_LOG_DEBUG</a>, <span class="stringliteral">&quot;Format %s supported.\n&quot;</span>,</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;               <a class="code" href="pixdesc_8c.html#ab92e2a8a9b58c982560c49df9f01e47e">av_get_pix_fmt_name</a>(<a class="code" href="demuxing__decoding_8c.html#a7331e302ea7bb48e0b605a069576e135">pix_fmt</a>));</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160; </div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        err = <a class="code" href="group__lavu__mem__funcs.html#gad8fde0c159ac905909339e082a049cde">av_reallocp_array</a>(&amp;constraints-&gt;<a class="code" href="struct_a_v_h_w_frames_constraints.html#aabea88093c6f85d6185ffb0852a2217f">valid_sw_formats</a>,</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                                pix_fmts_found + 2,</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;                                <span class="keyword">sizeof</span>(*constraints-&gt;<a class="code" href="struct_a_v_h_w_frames_constraints.html#aabea88093c6f85d6185ffb0852a2217f">valid_sw_formats</a>));</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;        <span class="keywordflow">if</span> (err &lt; 0)</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;            <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;        constraints-&gt;<a class="code" href="struct_a_v_h_w_frames_constraints.html#aabea88093c6f85d6185ffb0852a2217f">valid_sw_formats</a>[pix_fmts_found] = <a class="code" href="demuxing__decoding_8c.html#a7331e302ea7bb48e0b605a069576e135">pix_fmt</a>;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;        constraints-&gt;<a class="code" href="struct_a_v_h_w_frames_constraints.html#aabea88093c6f85d6185ffb0852a2217f">valid_sw_formats</a>[pix_fmts_found + 1] =</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;            <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a0e08f8a5d0fa21c3e258816a9dcce7c3">AV_PIX_FMT_NONE</a>;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        ++pix_fmts_found;</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    }</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160; </div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#adba82e1bcd02de510a858fcbedf79ef1">av_freep</a>(&amp;image_formats);</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160; </div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    constraints-&gt;<a class="code" href="struct_a_v_h_w_frames_constraints.html#a4258bbe81f927b76b7ca5af44ba7ef6b">valid_hw_formats</a> =</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;        <a class="code" href="mem_8c.html#a254f3455439c15a2c8a75b8f0235fdbd">av_malloc_array</a>(2, <span class="keyword">sizeof</span>(*constraints-&gt;<a class="code" href="struct_a_v_h_w_frames_constraints.html#a4258bbe81f927b76b7ca5af44ba7ef6b">valid_hw_formats</a>));</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    <span class="keywordflow">if</span> (!constraints-&gt;<a class="code" href="struct_a_v_h_w_frames_constraints.html#a4258bbe81f927b76b7ca5af44ba7ef6b">valid_hw_formats</a>) {</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;        err = <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    }</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    constraints-&gt;<a class="code" href="struct_a_v_h_w_frames_constraints.html#a4258bbe81f927b76b7ca5af44ba7ef6b">valid_hw_formats</a>[0] = <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a9033468a02331a128ba10d84f55f253d">AV_PIX_FMT_OPENCL</a>;</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    constraints-&gt;<a class="code" href="struct_a_v_h_w_frames_constraints.html#a4258bbe81f927b76b7ca5af44ba7ef6b">valid_hw_formats</a>[1] = <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a0e08f8a5d0fa21c3e258816a9dcce7c3">AV_PIX_FMT_NONE</a>;</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160; </div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160; </div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;<a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>:</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#adba82e1bcd02de510a858fcbedf79ef1">av_freep</a>(&amp;image_formats);</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;}</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160; </div>
<div class="line"><a name="l01602"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#a9d1855e39e517bac4a9e9499028eb595"> 1602</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="hwcontext__opencl_8c.html#a9d1855e39e517bac4a9e9499028eb595">opencl_pool_free</a>(<span class="keywordtype">void</span> *opaque, <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *<a class="code" href="mxf_8c.html#a084824fc871e38157790c99ae1240842">data</a>)</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;{</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    <a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a>       *hwfc = opaque;</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    <a class="code" href="struct_a_v_open_c_l_frame_descriptor.html">AVOpenCLFrameDescriptor</a> *<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a> = (<a class="code" href="struct_a_v_open_c_l_frame_descriptor.html">AVOpenCLFrameDescriptor</a>*)<a class="code" href="mxf_8c.html#a084824fc871e38157790c99ae1240842">data</a>;</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    <span class="keywordtype">int</span> p;</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160; </div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    <span class="keywordflow">for</span> (p = 0; p &lt; <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;nb_planes; p++) {</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;        cle = clReleaseMemObject(<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;planes[p]);</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;        <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwfc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to release plane %d: &quot;</span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;                   <span class="stringliteral">&quot;%d.\n&quot;</span>, p, cle);</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;        }</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    }</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160; </div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#a079eab092887563f2bef9106c6120089">av_free</a>(<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>);</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;}</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160; </div>
<div class="line"><a name="l01620"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#a2365bbe035484ade150e495024dce3e6"> 1620</a></span>&#160;<span class="keyword">static</span> <a class="code" href="struct_a_v_buffer_ref.html">AVBufferRef</a> *<a class="code" href="hwcontext__opencl_8c.html#a2365bbe035484ade150e495024dce3e6">opencl_pool_alloc</a>(<span class="keywordtype">void</span> *opaque, <span class="keywordtype">int</span> <a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>)</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;{</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    <a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a>      *hwfc = opaque;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    <a class="code" href="struct_a_v_open_c_l_device_context.html">AVOpenCLDeviceContext</a> *hwctx = hwfc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#ac9a7dbd0cbfcabc0b1529cb34cf53b6d">device_ctx</a>-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a46055b48d1a40445d775b4ae24f77f20">hwctx</a>;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <a class="code" href="struct_a_v_open_c_l_frame_descriptor.html">AVOpenCLFrameDescriptor</a> *<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    cl_mem image;</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    cl_image_format image_format;</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    cl_image_desc   image_desc;</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    <span class="keywordtype">int</span> err, p;</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    <a class="code" href="struct_a_v_buffer_ref.html">AVBufferRef</a> *<a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>;</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160; </div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a> = <a class="code" href="group__lavu__mem__funcs.html#gaf143ecab33a3868b57345466c39de7c1">av_mallocz</a>(<span class="keyword">sizeof</span>(*<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>));</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>)</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160; </div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    <span class="keywordflow">for</span> (p = 0;; p++) {</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;        err = <a class="code" href="hwcontext__opencl_8c.html#af2c66952db60f2cdd30b7c6c00b80a64">opencl_get_plane_format</a>(hwfc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a663a9aceca97aa7b2426c9aba6543e4a">sw_format</a>, p,</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;                                      hwfc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a9e6f29d0f744930cdd0e8bdff8771520">width</a>, hwfc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#ae61bbe1d8645a0c573085e29f1d0a58f">height</a>,</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;                                      &amp;image_format, &amp;image_desc);</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;        <span class="keywordflow">if</span> (err == <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOENT))</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;        <span class="keywordflow">if</span> (err &lt; 0)</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;            <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160; </div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;        <span class="comment">// For generic image objects, the pitch is determined by the</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;        <span class="comment">// implementation.</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;        image_desc.image_row_pitch = 0;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160; </div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;        image = clCreateImage(hwctx-&gt;<a class="code" href="struct_a_v_open_c_l_device_context.html#a5152eb3c345fd6ead8ffa9e602293d20">context</a>, CL_MEM_READ_WRITE,</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;                              &amp;image_format, &amp;image_desc, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;cle);</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;        <span class="keywordflow">if</span> (!image) {</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwfc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to create image for &quot;</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                   <span class="stringliteral">&quot;plane %d: %d.\n&quot;</span>, p, cle);</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;            <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;        }</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160; </div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;        <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;planes[p] = image;</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    }</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160; </div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;nb_planes = p;</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160; </div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a> = <a class="code" href="group__lavu__buffer.html#ga3e7f4c92db85ccba0b2a16dd0069842a">av_buffer_create</a>((<a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a>*)<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>, <span class="keyword">sizeof</span>(*<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>),</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;                           &amp;<a class="code" href="hwcontext__opencl_8c.html#a9d1855e39e517bac4a9e9499028eb595">opencl_pool_free</a>, hwfc, 0);</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>)</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160; </div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>;</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160; </div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;<a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>:</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    <span class="keywordflow">for</span> (p = 0; <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;planes[p]; p++)</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;        clReleaseMemObject(<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;planes[p]);</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#a079eab092887563f2bef9106c6120089">av_free</a>(<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>);</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;}</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160; </div>
<div class="line"><a name="l01676"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#a3004c1b68dc75e1be574fafb61f44cfb"> 1676</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__opencl_8c.html#a3004c1b68dc75e1be574fafb61f44cfb">opencl_frames_init_command_queue</a>(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *hwfc)</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;{</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    <a class="code" href="struct_a_v_open_c_l_frames_context.html">AVOpenCLFramesContext</a> *hwctx = hwfc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a54e38c3e4355321e23e0f4c7411cb8ee">hwctx</a>;</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    <a class="code" href="struct_open_c_l_device_context.html">OpenCLDeviceContext</a> *devpriv = hwfc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#ac9a7dbd0cbfcabc0b1529cb34cf53b6d">device_ctx</a>-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a9c3758c73b0f29925ccb2f60b5c1a803">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_device_internal.html#ae7425663cca9541964518c66974a20bf">priv</a>;</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    <a class="code" href="struct_open_c_l_frames_context.html">OpenCLFramesContext</a>    *priv = hwfc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a69e956e8d2d73d65d015c4ed895ec642">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_frames_internal.html#a503cfeb391ed69856344768fd641a489">priv</a>;</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160; </div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    priv-&gt;<a class="code" href="struct_open_c_l_frames_context.html#aebaf993c59ba7717dc4dbff4a2e57668">command_queue</a> = hwctx-&gt;<a class="code" href="struct_a_v_open_c_l_frames_context.html#ac5ab8f934a1ba6fabedea8df2a71abb6">command_queue</a> ? hwctx-&gt;<a class="code" href="struct_a_v_open_c_l_frames_context.html#ac5ab8f934a1ba6fabedea8df2a71abb6">command_queue</a></div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;                                               : devpriv-&gt;<a class="code" href="struct_open_c_l_device_context.html#ae29e4d0d149bedcd5d69ee60d79d549d">command_queue</a>;</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    cle = clRetainCommandQueue(priv-&gt;<a class="code" href="struct_open_c_l_frames_context.html#aebaf993c59ba7717dc4dbff4a2e57668">command_queue</a>);</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwfc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to retain frame &quot;</span></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;               <span class="stringliteral">&quot;command queue: %d.\n&quot;</span>, cle);</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EIO);</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    }</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160; </div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;}</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160; </div>
<div class="line"><a name="l01695"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#a5644eb404ac92daf899141490b2f83d8"> 1695</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__opencl_8c.html#a5644eb404ac92daf899141490b2f83d8">opencl_frames_init</a>(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *hwfc)</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;{</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    <span class="keywordflow">if</span> (!hwfc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#ad67ff3a5828a611d1b1cddd64fc1de71">pool</a>) {</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;        hwfc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a69e956e8d2d73d65d015c4ed895ec642">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_frames_internal.html#a2858e1cd83082cc8bcbbf581283e7af2">pool_internal</a> =</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;            <a class="code" href="group__lavu__bufferpool.html#ga615151c8889d5be39d17bce4d8c65117">av_buffer_pool_init2</a>(<span class="keyword">sizeof</span>(cl_mem), hwfc,</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;                                 &amp;<a class="code" href="hwcontext__opencl_8c.html#a2365bbe035484ade150e495024dce3e6">opencl_pool_alloc</a>, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;        <span class="keywordflow">if</span> (!hwfc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a69e956e8d2d73d65d015c4ed895ec642">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_frames_internal.html#a2858e1cd83082cc8bcbbf581283e7af2">pool_internal</a>)</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    }</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160; </div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="hwcontext__opencl_8c.html#a3004c1b68dc75e1be574fafb61f44cfb">opencl_frames_init_command_queue</a>(hwfc);</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;}</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160; </div>
<div class="line"><a name="l01708"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#ae0fd7381d69c6c5aff42004d71bb217f"> 1708</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="hwcontext__opencl_8c.html#ae0fd7381d69c6c5aff42004d71bb217f">opencl_frames_uninit</a>(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *hwfc)</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;{</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    <a class="code" href="struct_open_c_l_frames_context.html">OpenCLFramesContext</a> *priv = hwfc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a69e956e8d2d73d65d015c4ed895ec642">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_frames_internal.html#a503cfeb391ed69856344768fd641a489">priv</a>;</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160; </div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_DXVA2 || HAVE_OPENCL_D3D11</span></div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, p;</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; priv-&gt;nb_mapped_frames; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;        <a class="code" href="struct_a_v_open_c_l_frame_descriptor.html">AVOpenCLFrameDescriptor</a> *<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a> = &amp;priv-&gt;mapped_frames[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;        <span class="keywordflow">for</span> (p = 0; p &lt; <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;nb_planes; p++) {</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;            cle = clReleaseMemObject(<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;planes[p]);</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;            <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;                <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwfc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to release mapped &quot;</span></div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;                       <span class="stringliteral">&quot;frame object (frame %d plane %d): %d.\n&quot;</span>,</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;                       <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, p, cle);</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;            }</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        }</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    }</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#adba82e1bcd02de510a858fcbedf79ef1">av_freep</a>(&amp;priv-&gt;mapped_frames);</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160; </div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    <span class="keywordflow">if</span> (priv-&gt;<a class="code" href="struct_open_c_l_frames_context.html#aebaf993c59ba7717dc4dbff4a2e57668">command_queue</a>) {</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;        cle = clReleaseCommandQueue(priv-&gt;<a class="code" href="struct_open_c_l_frames_context.html#aebaf993c59ba7717dc4dbff4a2e57668">command_queue</a>);</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;        <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwfc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to release frame &quot;</span></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;                   <span class="stringliteral">&quot;command queue: %d.\n&quot;</span>, cle);</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;        }</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;        priv-&gt;<a class="code" href="struct_open_c_l_frames_context.html#aebaf993c59ba7717dc4dbff4a2e57668">command_queue</a> = <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    }</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;}</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160; </div>
<div class="line"><a name="l01739"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#ae0c00627f713c461d5f449c5f8ef27d9"> 1739</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__opencl_8c.html#ae0c00627f713c461d5f449c5f8ef27d9">opencl_get_buffer</a>(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *hwfc, <a class="code" href="struct_a_v_frame.html">AVFrame</a> *<a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>)</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;{</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    <a class="code" href="struct_a_v_open_c_l_frame_descriptor.html">AVOpenCLFrameDescriptor</a> *<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>;</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <span class="keywordtype">int</span> p;</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160; </div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;buf[0] = <a class="code" href="group__lavu__bufferpool.html#ga2c745ecb4001452423e775b06b20fb7c">av_buffer_pool_get</a>(hwfc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#ad67ff3a5828a611d1b1cddd64fc1de71">pool</a>);</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;buf[0])</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160; </div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a> = (<a class="code" href="struct_a_v_open_c_l_frame_descriptor.html">AVOpenCLFrameDescriptor</a>*)<a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;buf[0]-&gt;data;</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160; </div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    <a class="code" href="h264pred__template_8c.html#a93cca9adbbca82ea00bf3250781f6dce">for</a> (p = 0; p &lt; <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;nb_planes; p++)</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;        <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;data[p] = (<a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a>*)<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;planes[p];</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160; </div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;format  = <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a9033468a02331a128ba10d84f55f253d">AV_PIX_FMT_OPENCL</a>;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;width   = hwfc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a9e6f29d0f744930cdd0e8bdff8771520">width</a>;</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;height  = hwfc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#ae61bbe1d8645a0c573085e29f1d0a58f">height</a>;</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160; </div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;}</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160; </div>
<div class="line"><a name="l01760"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#af1e17c9169a69d720eac8ba83d756f0f"> 1760</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__opencl_8c.html#af1e17c9169a69d720eac8ba83d756f0f">opencl_transfer_get_formats</a>(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *hwfc,</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;                                       <span class="keyword">enum</span> <a class="code" href="hwcontext_8h.html#aba8d70ed754b2536ca497d7d50ec7b1e">AVHWFrameTransferDirection</a> dir,</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;                                       <span class="keyword">enum</span> <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5">AVPixelFormat</a> **<a class="code" href="signature_8h.html#a12f58149bb2cdab504621ba5b390ef64">formats</a>)</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;{</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    <span class="keyword">enum</span> <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5">AVPixelFormat</a> *fmts;</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160; </div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    fmts = <a class="code" href="mem_8c.html#a254f3455439c15a2c8a75b8f0235fdbd">av_malloc_array</a>(2, <span class="keyword">sizeof</span>(*fmts));</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    <span class="keywordflow">if</span> (!fmts)</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160; </div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    fmts[0] = hwfc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a663a9aceca97aa7b2426c9aba6543e4a">sw_format</a>;</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    fmts[1] = <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a0e08f8a5d0fa21c3e258816a9dcce7c3">AV_PIX_FMT_NONE</a>;</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160; </div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    *<a class="code" href="signature_8h.html#a12f58149bb2cdab504621ba5b390ef64">formats</a> = fmts;</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;}</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160; </div>
<div class="line"><a name="l01777"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#a0e35d0e2185a2bf214bf4249af3731d7"> 1777</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__opencl_8c.html#a0e35d0e2185a2bf214bf4249af3731d7">opencl_wait_events</a>(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *hwfc,</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;                              cl_event *events, <span class="keywordtype">int</span> nb_events)</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;{</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160; </div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    cle = clWaitForEvents(nb_events, events);</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwfc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to wait for event &quot;</span></div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;               <span class="stringliteral">&quot;completion: %d.\n&quot;</span>, cle);</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EIO);</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    }</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160; </div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nb_events; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;        cle = clReleaseEvent(events[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;        <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwfc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to release &quot;</span></div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;                   <span class="stringliteral">&quot;event: %d.\n&quot;</span>, cle);</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;        }</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    }</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160; </div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;}</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160; </div>
<div class="line"><a name="l01801"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#a348344b15f15878dc1077cda3655be1e"> 1801</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__opencl_8c.html#a348344b15f15878dc1077cda3655be1e">opencl_transfer_data_from</a>(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *hwfc,</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;                                     <a class="code" href="struct_a_v_frame.html">AVFrame</a> *dst, <span class="keyword">const</span> <a class="code" href="struct_a_v_frame.html">AVFrame</a> *<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>)</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;{</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    <a class="code" href="struct_open_c_l_frames_context.html">OpenCLFramesContext</a> *priv = hwfc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a69e956e8d2d73d65d015c4ed895ec642">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_frames_internal.html#a503cfeb391ed69856344768fd641a489">priv</a>;</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;    cl_image_format image_format;</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    cl_image_desc image_desc;</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    <span class="keywordtype">size_t</span> origin[3] = { 0, 0, 0 };</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    <span class="keywordtype">size_t</span> region[3];</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    cl_event events[<a class="code" href="frame_8h.html#add80189702cf0f5ea82718576fb43201">AV_NUM_DATA_POINTERS</a>];</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    <span class="keywordtype">int</span> err, p;</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160; </div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    <span class="keywordflow">if</span> (dst-&gt;<a class="code" href="struct_a_v_frame.html#aed14fa772ce46881020fd1545c86432c">format</a> != hwfc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a663a9aceca97aa7b2426c9aba6543e4a">sw_format</a>)</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160; </div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    <span class="keywordflow">for</span> (p = 0;; p++) {</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;        err = <a class="code" href="hwcontext__opencl_8c.html#af2c66952db60f2cdd30b7c6c00b80a64">opencl_get_plane_format</a>(hwfc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a663a9aceca97aa7b2426c9aba6543e4a">sw_format</a>, p,</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;                                      <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;width, <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;height,</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;                                      &amp;image_format, &amp;image_desc);</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;        <span class="keywordflow">if</span> (err &lt; 0) {</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;            <span class="keywordflow">if</span> (err == <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOENT))</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;                err = 0;</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;        }</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160; </div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;        <span class="keywordflow">if</span> (!dst-&gt;<a class="code" href="struct_a_v_frame.html#a1d0f65014a8d1bf78cec8cbed2304992">data</a>[p]) {</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwfc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Plane %d missing on &quot;</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;                   <span class="stringliteral">&quot;destination frame for transfer.\n&quot;</span>, p);</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;            err = <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;        }</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160; </div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;        region[0] = image_desc.image_width;</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;        region[1] = image_desc.image_height;</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;        region[2] = 1;</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160; </div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;        cle = clEnqueueReadImage(priv-&gt;<a class="code" href="struct_open_c_l_frames_context.html#aebaf993c59ba7717dc4dbff4a2e57668">command_queue</a>,</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;                                 (cl_mem)<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;data[p],</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;                                 CL_FALSE, origin, region,</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;                                 dst-&gt;<a class="code" href="struct_a_v_frame.html#aa52bfc6605f6a3059a0c3226cc0f6567">linesize</a>[p], 0,</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;                                 dst-&gt;<a class="code" href="struct_a_v_frame.html#a1d0f65014a8d1bf78cec8cbed2304992">data</a>[p],</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;                                 0, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;events[p]);</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;        <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwfc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to enqueue read of &quot;</span></div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;                   <span class="stringliteral">&quot;OpenCL image plane %d: %d.\n&quot;</span>, p, cle);</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;            err = <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EIO);</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;        }</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    }</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160; </div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    <a class="code" href="hwcontext__opencl_8c.html#a0e35d0e2185a2bf214bf4249af3731d7">opencl_wait_events</a>(hwfc, events, p);</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160; </div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;}</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160; </div>
<div class="line"><a name="l01856"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#aefb87273677351fb6486f45b7ac05a3b"> 1856</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__opencl_8c.html#aefb87273677351fb6486f45b7ac05a3b">opencl_transfer_data_to</a>(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *hwfc,</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;                                   <a class="code" href="struct_a_v_frame.html">AVFrame</a> *dst, <span class="keyword">const</span> <a class="code" href="struct_a_v_frame.html">AVFrame</a> *<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>)</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;{</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    <a class="code" href="struct_open_c_l_frames_context.html">OpenCLFramesContext</a> *priv = hwfc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a69e956e8d2d73d65d015c4ed895ec642">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_frames_internal.html#a503cfeb391ed69856344768fd641a489">priv</a>;</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    cl_image_format image_format;</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    cl_image_desc image_desc;</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    <span class="keywordtype">size_t</span> origin[3] = { 0, 0, 0 };</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    <span class="keywordtype">size_t</span> region[3];</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;    cl_event events[<a class="code" href="frame_8h.html#add80189702cf0f5ea82718576fb43201">AV_NUM_DATA_POINTERS</a>];</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;    <span class="keywordtype">int</span> err, p;</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160; </div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;format != hwfc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a663a9aceca97aa7b2426c9aba6543e4a">sw_format</a>)</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160; </div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    <span class="keywordflow">for</span> (p = 0;; p++) {</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;        err = <a class="code" href="hwcontext__opencl_8c.html#af2c66952db60f2cdd30b7c6c00b80a64">opencl_get_plane_format</a>(hwfc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a663a9aceca97aa7b2426c9aba6543e4a">sw_format</a>, p,</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;                                      <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;width, <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;height,</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;                                      &amp;image_format, &amp;image_desc);</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;        <span class="keywordflow">if</span> (err &lt; 0) {</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;            <span class="keywordflow">if</span> (err == <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOENT))</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;                err = 0;</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;        }</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160; </div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;data[p]) {</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwfc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Plane %d missing on &quot;</span></div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;                   <span class="stringliteral">&quot;source frame for transfer.\n&quot;</span>, p);</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;            err = <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;        }</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160; </div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;        region[0] = image_desc.image_width;</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;        region[1] = image_desc.image_height;</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;        region[2] = 1;</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160; </div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;        cle = clEnqueueWriteImage(priv-&gt;<a class="code" href="struct_open_c_l_frames_context.html#aebaf993c59ba7717dc4dbff4a2e57668">command_queue</a>,</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;                                  (cl_mem)dst-&gt;<a class="code" href="struct_a_v_frame.html#a1d0f65014a8d1bf78cec8cbed2304992">data</a>[p],</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;                                  CL_FALSE, origin, region,</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;                                  <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;linesize[p], 0,</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;                                  <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;data[p],</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;                                  0, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;events[p]);</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;        <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwfc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to enqueue write of &quot;</span></div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;                   <span class="stringliteral">&quot;OpenCL image plane %d: %d.\n&quot;</span>, p, cle);</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;            err = <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EIO);</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;        }</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;    }</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160; </div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    <a class="code" href="hwcontext__opencl_8c.html#a0e35d0e2185a2bf214bf4249af3731d7">opencl_wait_events</a>(hwfc, events, p);</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160; </div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;}</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160; </div>
<div class="line"><a name="l01911"></a><span class="lineno"><a class="line" href="struct_open_c_l_mapping.html"> 1911</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct_open_c_l_mapping.html">OpenCLMapping</a> {</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    <span class="comment">// The mapped addresses for each plane.</span></div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    <span class="comment">// The destination frame is not available when we unmap, so these</span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    <span class="comment">// need to be stored separately.</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"><a class="line" href="struct_open_c_l_mapping.html#a78b07d8a8f382df5e5b3f650e21506b6"> 1915</a></span>&#160;    <span class="keywordtype">void</span> *<a class="code" href="struct_open_c_l_mapping.html#a78b07d8a8f382df5e5b3f650e21506b6">address</a>[<a class="code" href="frame_8h.html#add80189702cf0f5ea82718576fb43201">AV_NUM_DATA_POINTERS</a>];</div>
<div class="line"><a name="l01916"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#a3319ca8d01f0235b06fa3fa57cf4f7af"> 1916</a></span>&#160;} <a class="code" href="hwcontext__opencl_8c.html#a3319ca8d01f0235b06fa3fa57cf4f7af">OpenCLMapping</a>;</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160; </div>
<div class="line"><a name="l01918"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#a6931437dd20e2a1ba2f22b62941f7ae4"> 1918</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="hwcontext__opencl_8c.html#a6931437dd20e2a1ba2f22b62941f7ae4">opencl_unmap_frame</a>(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *hwfc,</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;                               <a class="code" href="struct_h_w_map_descriptor.html">HWMapDescriptor</a> *hwmap)</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;{</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    <a class="code" href="struct_open_c_l_frames_context.html">OpenCLFramesContext</a> *priv = hwfc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a69e956e8d2d73d65d015c4ed895ec642">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_frames_internal.html#a503cfeb391ed69856344768fd641a489">priv</a>;</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;    <a class="code" href="struct_open_c_l_mapping.html">OpenCLMapping</a> *<a class="code" href="hwcontext__vdpau_8c.html#a2996cc16b36e13c9010705bad768e866">map</a> = hwmap-&gt;<a class="code" href="struct_h_w_map_descriptor.html#a7ecea93e498181196f2121b85c07411d">priv</a>;</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    cl_event events[<a class="code" href="frame_8h.html#add80189702cf0f5ea82718576fb43201">AV_NUM_DATA_POINTERS</a>];</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    <span class="keywordtype">int</span> p, e;</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160; </div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    <span class="keywordflow">for</span> (p = e = 0; p &lt; <a class="code" href="sinewin__tablegen__template_8c.html#a3508a98d3ee7e2c9a4841fe264cf70f7">FF_ARRAY_ELEMS</a>(<a class="code" href="hwcontext__vdpau_8c.html#a2996cc16b36e13c9010705bad768e866">map</a>-&gt;address); p++) {</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="hwcontext__vdpau_8c.html#a2996cc16b36e13c9010705bad768e866">map</a>-&gt;address[p])</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160; </div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;        cle = clEnqueueUnmapMemObject(priv-&gt;<a class="code" href="struct_open_c_l_frames_context.html#aebaf993c59ba7717dc4dbff4a2e57668">command_queue</a>,</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;                                      (cl_mem)hwmap-&gt;<a class="code" href="struct_h_w_map_descriptor.html#aac9a3c77af4a936a326770ee5973e261">source</a>-&gt;<a class="code" href="struct_a_v_frame.html#a1d0f65014a8d1bf78cec8cbed2304992">data</a>[p],</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;                                      <a class="code" href="hwcontext__vdpau_8c.html#a2996cc16b36e13c9010705bad768e866">map</a>-&gt;address[p],</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;                                      0, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;events[e]);</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;        <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwfc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to unmap OpenCL &quot;</span></div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;                   <span class="stringliteral">&quot;image plane %d: %d.\n&quot;</span>, p, cle);</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;        }</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;        ++e;</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    }</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160; </div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;    <a class="code" href="hwcontext__opencl_8c.html#a0e35d0e2185a2bf214bf4249af3731d7">opencl_wait_events</a>(hwfc, events, e);</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160; </div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#a079eab092887563f2bef9106c6120089">av_free</a>(<a class="code" href="hwcontext__vdpau_8c.html#a2996cc16b36e13c9010705bad768e866">map</a>);</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;}</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160; </div>
<div class="line"><a name="l01947"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#af79e4113dba0b404fdeacca66238957a"> 1947</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__opencl_8c.html#af79e4113dba0b404fdeacca66238957a">opencl_map_frame</a>(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *hwfc, <a class="code" href="struct_a_v_frame.html">AVFrame</a> *dst,</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;                            <span class="keyword">const</span> <a class="code" href="struct_a_v_frame.html">AVFrame</a> *<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>, <span class="keywordtype">int</span> <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>)</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;{</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    <a class="code" href="struct_open_c_l_frames_context.html">OpenCLFramesContext</a> *priv = hwfc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a69e956e8d2d73d65d015c4ed895ec642">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_frames_internal.html#a503cfeb391ed69856344768fd641a489">priv</a>;</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    cl_map_flags map_flags;</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    cl_image_format image_format;</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    cl_image_desc image_desc;</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    <a class="code" href="struct_open_c_l_mapping.html">OpenCLMapping</a> *<a class="code" href="hwcontext__vdpau_8c.html#a2996cc16b36e13c9010705bad768e866">map</a>;</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    <span class="keywordtype">size_t</span> origin[3] = { 0, 0, 0 };</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    <span class="keywordtype">size_t</span> region[3];</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    <span class="keywordtype">size_t</span> row_pitch;</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    cl_event events[<a class="code" href="frame_8h.html#add80189702cf0f5ea82718576fb43201">AV_NUM_DATA_POINTERS</a>];</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    <span class="keywordtype">int</span> err, p;</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160; </div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    <a class="code" href="avassert_8h.html#aae204192396f78cc8c5cd7ad5c57c23f">av_assert0</a>(hwfc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a663a9aceca97aa7b2426c9aba6543e4a">sw_format</a> == dst-&gt;<a class="code" href="struct_a_v_frame.html#aed14fa772ce46881020fd1545c86432c">format</a>);</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160; </div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a> &amp; <a class="code" href="group__avoptions.html#gga06fc87d81c62e9abb8790b6e5713c55bac12b0a2a379fe4b4b00353aac56ed9f4">AV_HWFRAME_MAP_OVERWRITE</a> &amp;&amp;</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;        !(<a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a> &amp; <a class="code" href="group__avoptions.html#gga06fc87d81c62e9abb8790b6e5713c55ba236262031fe4c5503b2611c2c8fb520b">AV_HWFRAME_MAP_READ</a>)) {</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;        <span class="comment">// This is mutually exclusive with the read/write flags, so</span></div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;        <span class="comment">// there is no way to map with read here.</span></div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;        map_flags = CL_MAP_WRITE_INVALIDATE_REGION;</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;        map_flags = 0;</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a> &amp; <a class="code" href="group__avoptions.html#gga06fc87d81c62e9abb8790b6e5713c55ba236262031fe4c5503b2611c2c8fb520b">AV_HWFRAME_MAP_READ</a>)</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;            map_flags |= CL_MAP_READ;</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a> &amp; <a class="code" href="group__avoptions.html#gga06fc87d81c62e9abb8790b6e5713c55bab2e22cc927a3d88fe833b50bf3d71948">AV_HWFRAME_MAP_WRITE</a>)</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;            map_flags |= CL_MAP_WRITE;</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    }</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160; </div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    <a class="code" href="hwcontext__vdpau_8c.html#a2996cc16b36e13c9010705bad768e866">map</a> = <a class="code" href="group__lavu__mem__funcs.html#gaf143ecab33a3868b57345466c39de7c1">av_mallocz</a>(<span class="keyword">sizeof</span>(*<a class="code" href="hwcontext__vdpau_8c.html#a2996cc16b36e13c9010705bad768e866">map</a>));</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="hwcontext__vdpau_8c.html#a2996cc16b36e13c9010705bad768e866">map</a>)</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160; </div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;    <span class="keywordflow">for</span> (p = 0;; p++) {</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;        err = <a class="code" href="hwcontext__opencl_8c.html#af2c66952db60f2cdd30b7c6c00b80a64">opencl_get_plane_format</a>(hwfc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a663a9aceca97aa7b2426c9aba6543e4a">sw_format</a>, p,</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;                                      <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;width, <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;height,</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;                                      &amp;image_format, &amp;image_desc);</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;        <span class="keywordflow">if</span> (err == <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOENT))</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;        <span class="keywordflow">if</span> (err &lt; 0)</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;            <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160; </div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;        region[0] = image_desc.image_width;</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;        region[1] = image_desc.image_height;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;        region[2] = 1;</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160; </div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;        <a class="code" href="hwcontext__vdpau_8c.html#a2996cc16b36e13c9010705bad768e866">map</a>-&gt;address[p] =</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;            clEnqueueMapImage(priv-&gt;<a class="code" href="struct_open_c_l_frames_context.html#aebaf993c59ba7717dc4dbff4a2e57668">command_queue</a>,</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;                              (cl_mem)<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;data[p],</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;                              CL_FALSE, map_flags, origin, region,</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;                              &amp;row_pitch, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;                              &amp;events[p], &amp;cle);</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="hwcontext__vdpau_8c.html#a2996cc16b36e13c9010705bad768e866">map</a>-&gt;address[p]) {</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwfc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to map OpenCL &quot;</span></div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;                   <span class="stringliteral">&quot;image plane %d: %d.\n&quot;</span>, p, cle);</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;            err = <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EIO);</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;            <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;        }</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160; </div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;        dst-&gt;<a class="code" href="struct_a_v_frame.html#a1d0f65014a8d1bf78cec8cbed2304992">data</a>[p] = <a class="code" href="hwcontext__vdpau_8c.html#a2996cc16b36e13c9010705bad768e866">map</a>-&gt;address[p];</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160; </div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(hwfc, <a class="code" href="group__lavu__log__constants.html#ga5b7221c3afd06848486776bd834a58a5">AV_LOG_DEBUG</a>, <span class="stringliteral">&quot;Map plane %d (%p -&gt; %p).\n&quot;</span>,</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;               p, <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;data[p], dst-&gt;<a class="code" href="struct_a_v_frame.html#a1d0f65014a8d1bf78cec8cbed2304992">data</a>[p]);</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;    }</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160; </div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    err = <a class="code" href="hwcontext__opencl_8c.html#a0e35d0e2185a2bf214bf4249af3731d7">opencl_wait_events</a>(hwfc, events, p);</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    <span class="keywordflow">if</span> (err &lt; 0)</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160; </div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    err = <a class="code" href="hwcontext_8c.html#a76e0387f519b3f1bd1b162e91b54b182">ff_hwframe_map_create</a>(<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;hw_frames_ctx, dst, <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>,</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;                                &amp;<a class="code" href="hwcontext__opencl_8c.html#a6931437dd20e2a1ba2f22b62941f7ae4">opencl_unmap_frame</a>, <a class="code" href="hwcontext__vdpau_8c.html#a2996cc16b36e13c9010705bad768e866">map</a>);</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;    <span class="keywordflow">if</span> (err &lt; 0)</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160; </div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    dst-&gt;<a class="code" href="struct_a_v_frame.html#a1e71ce60cedd5f3b6811714a9f7f9e0a">width</a>  = <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;width;</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    dst-&gt;<a class="code" href="struct_a_v_frame.html#a3f89733f429c98ba5bc64373fb0a3f13">height</a> = <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;height;</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160; </div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160; </div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;<a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>:</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    <span class="keywordflow">for</span> (p = 0; p &lt; <a class="code" href="frame_8h.html#add80189702cf0f5ea82718576fb43201">AV_NUM_DATA_POINTERS</a>; p++) {</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="hwcontext__vdpau_8c.html#a2996cc16b36e13c9010705bad768e866">map</a>-&gt;address[p])</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;        clEnqueueUnmapMemObject(priv-&gt;<a class="code" href="struct_open_c_l_frames_context.html#aebaf993c59ba7717dc4dbff4a2e57668">command_queue</a>,</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;                                (cl_mem)<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;data[p],</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;                                <a class="code" href="hwcontext__vdpau_8c.html#a2996cc16b36e13c9010705bad768e866">map</a>-&gt;address[p],</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;                                0, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;events[p]);</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;    }</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    <span class="keywordflow">if</span> (p &gt; 0)</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;        <a class="code" href="hwcontext__opencl_8c.html#a0e35d0e2185a2bf214bf4249af3731d7">opencl_wait_events</a>(hwfc, events, p);</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#adba82e1bcd02de510a858fcbedf79ef1">av_freep</a>(&amp;<a class="code" href="hwcontext__vdpau_8c.html#a2996cc16b36e13c9010705bad768e866">map</a>);</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;    <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;}</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160; </div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_DRM_BEIGNET</span></div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160; </div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>DRMBeignetToOpenCLMapping {</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    <a class="code" href="struct_a_v_frame.html">AVFrame</a>              *drm_frame;</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;    <a class="code" href="struct_a_v_d_r_m_frame_descriptor.html">AVDRMFrameDescriptor</a> *drm_desc;</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160; </div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    <a class="code" href="struct_a_v_open_c_l_frame_descriptor.html">AVOpenCLFrameDescriptor</a> <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>;</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;} DRMBeignetToOpenCLMapping;</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160; </div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> opencl_unmap_from_drm_beignet(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *dst_fc,</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;                                          <a class="code" href="struct_h_w_map_descriptor.html">HWMapDescriptor</a> *hwmap)</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;{</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;    DRMBeignetToOpenCLMapping *mapping = hwmap-&gt;<a class="code" href="struct_h_w_map_descriptor.html#a7ecea93e498181196f2121b85c07411d">priv</a>;</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160; </div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; mapping-&gt;frame.nb_planes; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;        cle = clReleaseMemObject(mapping-&gt;frame.planes[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;        <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(dst_fc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to release CL image &quot;</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;                   <span class="stringliteral">&quot;of plane %d of DRM frame: %d.\n&quot;</span>, <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, cle);</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;        }</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    }</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160; </div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#a079eab092887563f2bef9106c6120089">av_free</a>(mapping);</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;}</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160; </div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> opencl_map_from_drm_beignet(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *dst_fc,</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;                                       <a class="code" href="struct_a_v_frame.html">AVFrame</a> *dst, <span class="keyword">const</span> <a class="code" href="struct_a_v_frame.html">AVFrame</a> *<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>,</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;                                       <span class="keywordtype">int</span> <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>)</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;{</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;    <a class="code" href="struct_a_v_open_c_l_device_context.html">AVOpenCLDeviceContext</a> *hwctx = dst_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#ac9a7dbd0cbfcabc0b1529cb34cf53b6d">device_ctx</a>-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a46055b48d1a40445d775b4ae24f77f20">hwctx</a>;</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    <a class="code" href="struct_open_c_l_device_context.html">OpenCLDeviceContext</a>    *priv = dst_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#ac9a7dbd0cbfcabc0b1529cb34cf53b6d">device_ctx</a>-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a9c3758c73b0f29925ccb2f60b5c1a803">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_device_internal.html#ae7425663cca9541964518c66974a20bf">priv</a>;</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;    DRMBeignetToOpenCLMapping *mapping;</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;    <span class="keyword">const</span> <a class="code" href="struct_a_v_d_r_m_frame_descriptor.html">AVDRMFrameDescriptor</a> *<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>;</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    <span class="keywordtype">int</span> err, <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, j, p;</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160; </div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;    <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a> = (<span class="keyword">const</span> <a class="code" href="struct_a_v_d_r_m_frame_descriptor.html">AVDRMFrameDescriptor</a>*)<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;data[0];</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160; </div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    mapping = <a class="code" href="group__lavu__mem__funcs.html#gaf143ecab33a3868b57345466c39de7c1">av_mallocz</a>(<span class="keyword">sizeof</span>(*mapping));</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;    <span class="keywordflow">if</span> (!mapping)</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160; </div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;    p = 0;</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;nb_layers; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;        <span class="keyword">const</span> <a class="code" href="struct_a_v_d_r_m_layer_descriptor.html">AVDRMLayerDescriptor</a> *layer = &amp;<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;layers[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; layer-&gt;<a class="code" href="struct_a_v_d_r_m_layer_descriptor.html#aa71ce914f53563be8207d8bc08fbfe92">nb_planes</a>; j++) {</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;            <span class="keyword">const</span> <a class="code" href="struct_a_v_d_r_m_plane_descriptor.html">AVDRMPlaneDescriptor</a> *plane = &amp;layer-&gt;<a class="code" href="struct_a_v_d_r_m_layer_descriptor.html#a7fbaf03f401c451e82021487fefef159">planes</a>[j];</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;            <span class="keyword">const</span> <a class="code" href="struct_a_v_d_r_m_object_descriptor.html">AVDRMObjectDescriptor</a> *<span class="keywordtype">object</span> =</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;                &amp;<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;objects[plane-&gt;<a class="code" href="struct_a_v_d_r_m_plane_descriptor.html#af07fe11d604e0a3b5fd934f9626c008b">object_index</a>];</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160; </div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;            cl_import_image_info_intel image_info = {</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;                .fd        = <span class="keywordtype">object</span>-&gt;fd,</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;                .size      = <span class="keywordtype">object</span>-&gt;size,</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;                .type      = CL_MEM_OBJECT_IMAGE2D,</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;                .offset    = plane-&gt;<a class="code" href="struct_a_v_d_r_m_plane_descriptor.html#af1a0839b02055445257d431d946d96a7">offset</a>,</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;                .row_pitch = plane-&gt;<a class="code" href="struct_a_v_d_r_m_plane_descriptor.html#aa4eaa5a37f40dd7301ce1b8194eefc0a">pitch</a>,</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;            };</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;            cl_image_desc image_desc;</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160; </div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;            err = <a class="code" href="hwcontext__opencl_8c.html#af2c66952db60f2cdd30b7c6c00b80a64">opencl_get_plane_format</a>(dst_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a663a9aceca97aa7b2426c9aba6543e4a">sw_format</a>, p,</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;                                          <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;width, <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;height,</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;                                          &amp;image_info.fmt,</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;                                          &amp;image_desc);</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;            <span class="keywordflow">if</span> (err &lt; 0) {</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;                <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(dst_fc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;DRM frame layer %d &quot;</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;                       <span class="stringliteral">&quot;plane %d is not representable in OpenCL: %d.\n&quot;</span>,</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;                       <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, j, err);</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;                <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;            }</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;            image_info.width  = image_desc.image_width;</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;            image_info.height = image_desc.image_height;</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160; </div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;            mapping-&gt;frame.planes[p] =</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;                priv-&gt;clCreateImageFromFdINTEL(hwctx-&gt;<a class="code" href="struct_a_v_open_c_l_device_context.html#a5152eb3c345fd6ead8ffa9e602293d20">context</a>,</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;                                               &amp;image_info, &amp;cle);</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;            <span class="keywordflow">if</span> (!mapping-&gt;frame.planes[p]) {</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;                <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(dst_fc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to create CL image &quot;</span></div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;                       <span class="stringliteral">&quot;from layer %d plane %d of DRM frame: %d.\n&quot;</span>,</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;                       <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, j, cle);</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;                err = <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EIO);</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;                <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;            }</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160; </div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;            dst-&gt;<a class="code" href="struct_a_v_frame.html#a1d0f65014a8d1bf78cec8cbed2304992">data</a>[p] = (<a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a>*)mapping-&gt;frame.planes[p];</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;            mapping-&gt;frame.nb_planes = ++p;</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;        }</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;    }</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160; </div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;    err = <a class="code" href="hwcontext_8c.html#a76e0387f519b3f1bd1b162e91b54b182">ff_hwframe_map_create</a>(dst-&gt;<a class="code" href="struct_a_v_frame.html#a29493fbfabaa21432c360a090426aa8e">hw_frames_ctx</a>, dst, <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>,</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;                                &amp;opencl_unmap_from_drm_beignet,</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;                                mapping);</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;    <span class="keywordflow">if</span> (err &lt; 0)</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160; </div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;    dst-&gt;<a class="code" href="struct_a_v_frame.html#a1e71ce60cedd5f3b6811714a9f7f9e0a">width</a>  = <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;width;</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;    dst-&gt;<a class="code" href="struct_a_v_frame.html#a3f89733f429c98ba5bc64373fb0a3f13">height</a> = <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;height;</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160; </div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160; </div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;<a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>:</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;    <span class="keywordflow">for</span> (p = 0; p &lt; mapping-&gt;frame.nb_planes; p++) {</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;        <span class="keywordflow">if</span> (mapping-&gt;frame.planes[p])</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;            clReleaseMemObject(mapping-&gt;frame.planes[p]);</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;    }</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#a079eab092887563f2bef9106c6120089">av_free</a>(mapping);</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;}</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160; </div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_VAAPI_BEIGNET</span></div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160; </div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> opencl_map_from_vaapi(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *dst_fc,</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;                                 <a class="code" href="struct_a_v_frame.html">AVFrame</a> *dst, <span class="keyword">const</span> <a class="code" href="struct_a_v_frame.html">AVFrame</a> *<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>,</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;                                 <span class="keywordtype">int</span> <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>)</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;{</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;    <a class="code" href="struct_a_v_frame.html">AVFrame</a> *tmp;</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;    <span class="keywordtype">int</span> err;</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160; </div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;    tmp = <a class="code" href="group__lavu__frame.html#gac700017c5270c79c1e1befdeeb008b2f">av_frame_alloc</a>();</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    <span class="keywordflow">if</span> (!tmp)</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160; </div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;    tmp-&gt;<a class="code" href="struct_a_v_frame.html#aed14fa772ce46881020fd1545c86432c">format</a> = <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a76a05fccc6f58f7ab655deefd794713e">AV_PIX_FMT_DRM_PRIME</a>;</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160; </div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    err = <a class="code" href="hwcontext_8c.html#a99e028453fba7e66483c2189439219d2">av_hwframe_map</a>(tmp, <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>, <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>);</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;    <span class="keywordflow">if</span> (err &lt; 0)</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160; </div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;    err = opencl_map_from_drm_beignet(dst_fc, dst, tmp, <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>);</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;    <span class="keywordflow">if</span> (err &lt; 0)</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160; </div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;    err = <a class="code" href="hwcontext_8c.html#af42d5b3b23a1d521e6457276e2cd0a53">ff_hwframe_map_replace</a>(dst, <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>);</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160; </div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;<a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>:</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;    <a class="code" href="group__lavu__frame.html#ga979d73f3228814aee56aeca0636e37cc">av_frame_free</a>(&amp;tmp);</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;    <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;}</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160; </div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* HAVE_OPENCL_VAAPI_BEIGNET */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* HAVE_OPENCL_DRM_BEIGNET */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160; </div>
<div class="line"><a name="l02185"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#aaddf3d74df38750199409c10a8bd9028"> 2185</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> cl_mem_flags <a class="code" href="hwcontext__opencl_8c.html#aaddf3d74df38750199409c10a8bd9028">opencl_mem_flags_for_mapping</a>(<span class="keywordtype">int</span> map_flags)</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;{</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    <span class="keywordflow">if</span> ((map_flags &amp; <a class="code" href="group__avoptions.html#gga06fc87d81c62e9abb8790b6e5713c55ba236262031fe4c5503b2611c2c8fb520b">AV_HWFRAME_MAP_READ</a>) &amp;&amp;</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;        (map_flags &amp; <a class="code" href="group__avoptions.html#gga06fc87d81c62e9abb8790b6e5713c55bab2e22cc927a3d88fe833b50bf3d71948">AV_HWFRAME_MAP_WRITE</a>))</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;        <span class="keywordflow">return</span> CL_MEM_READ_WRITE;</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (map_flags &amp; <a class="code" href="group__avoptions.html#gga06fc87d81c62e9abb8790b6e5713c55ba236262031fe4c5503b2611c2c8fb520b">AV_HWFRAME_MAP_READ</a>)</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;        <span class="keywordflow">return</span> CL_MEM_READ_ONLY;</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (map_flags &amp; <a class="code" href="group__avoptions.html#gga06fc87d81c62e9abb8790b6e5713c55bab2e22cc927a3d88fe833b50bf3d71948">AV_HWFRAME_MAP_WRITE</a>)</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;        <span class="keywordflow">return</span> CL_MEM_WRITE_ONLY;</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;}</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160; </div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_VAAPI_INTEL_MEDIA</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160; </div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> opencl_unmap_from_qsv(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *dst_fc,</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;                                  <a class="code" href="struct_h_w_map_descriptor.html">HWMapDescriptor</a> *hwmap)</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;{</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;    <a class="code" href="struct_a_v_open_c_l_frame_descriptor.html">AVOpenCLFrameDescriptor</a>    *<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a> = hwmap-&gt;<a class="code" href="struct_h_w_map_descriptor.html#a7ecea93e498181196f2121b85c07411d">priv</a>;</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;    <a class="code" href="struct_open_c_l_device_context.html">OpenCLDeviceContext</a> *device_priv = dst_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#ac9a7dbd0cbfcabc0b1529cb34cf53b6d">device_ctx</a>-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a9c3758c73b0f29925ccb2f60b5c1a803">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_device_internal.html#ae7425663cca9541964518c66974a20bf">priv</a>;</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    <a class="code" href="struct_open_c_l_frames_context.html">OpenCLFramesContext</a> *frames_priv = dst_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a69e956e8d2d73d65d015c4ed895ec642">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_frames_internal.html#a503cfeb391ed69856344768fd641a489">priv</a>;</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;    cl_event event;</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;    <span class="keywordtype">int</span> p;</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160; </div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(dst_fc, <a class="code" href="group__lavu__log__constants.html#ga5b7221c3afd06848486776bd834a58a5">AV_LOG_DEBUG</a>, <span class="stringliteral">&quot;Unmap QSV/VAAPI surface from OpenCL.\n&quot;</span>);</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160; </div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;    cle = device_priv-&gt;clEnqueueReleaseVA_APIMediaSurfacesINTEL(</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;        frames_priv-&gt;<a class="code" href="struct_open_c_l_frames_context.html#aebaf993c59ba7717dc4dbff4a2e57668">command_queue</a>, <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;nb_planes, <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;planes,</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;        0, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;event);</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;    <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(dst_fc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to release surface &quot;</span></div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;               <span class="stringliteral">&quot;handles: %d.\n&quot;</span>, cle);</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;    }</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160; </div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;    <a class="code" href="hwcontext__opencl_8c.html#a0e35d0e2185a2bf214bf4249af3731d7">opencl_wait_events</a>(dst_fc, &amp;event, 1);</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160; </div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;    <span class="keywordflow">for</span> (p = 0; p &lt; <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;nb_planes; p++) {</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;        cle = clReleaseMemObject(<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;planes[p]);</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;        <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(dst_fc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to release CL &quot;</span></div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;                   <span class="stringliteral">&quot;image of plane %d of QSV/VAAPI surface: %d\n&quot;</span>,</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;                   p, cle);</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;        }</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;    }</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160; </div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#a079eab092887563f2bef9106c6120089">av_free</a>(<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>);</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;}</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160; </div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> opencl_map_from_qsv(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *dst_fc, <a class="code" href="struct_a_v_frame.html">AVFrame</a> *dst,</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;                               <span class="keyword">const</span> <a class="code" href="struct_a_v_frame.html">AVFrame</a> *<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>, <span class="keywordtype">int</span> <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>)</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;{</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;    <a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *src_fc =</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;        (<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a>*)<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;hw_frames_ctx-&gt;data;</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;    <a class="code" href="struct_a_v_open_c_l_device_context.html">AVOpenCLDeviceContext</a>   *dst_dev = dst_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#ac9a7dbd0cbfcabc0b1529cb34cf53b6d">device_ctx</a>-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a46055b48d1a40445d775b4ae24f77f20">hwctx</a>;</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;    <a class="code" href="struct_open_c_l_device_context.html">OpenCLDeviceContext</a> *device_priv = dst_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#ac9a7dbd0cbfcabc0b1529cb34cf53b6d">device_ctx</a>-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a9c3758c73b0f29925ccb2f60b5c1a803">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_device_internal.html#ae7425663cca9541964518c66974a20bf">priv</a>;</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;    <a class="code" href="struct_open_c_l_frames_context.html">OpenCLFramesContext</a> *frames_priv = dst_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a69e956e8d2d73d65d015c4ed895ec642">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_frames_internal.html#a503cfeb391ed69856344768fd641a489">priv</a>;</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;    <a class="code" href="struct_a_v_open_c_l_frame_descriptor.html">AVOpenCLFrameDescriptor</a> *<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>;</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;    VASurfaceID va_surface;</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;    cl_mem_flags cl_flags;</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;    cl_event event;</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;    <span class="keywordtype">int</span> err, p;</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160; </div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;#<span class="keywordflow">if</span> CONFIG_LIBMFX</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    <a class="code" href="filter__design_8txt.html#a0e82f1088fdc24c14bf175d2ac77523f">if</a> (<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;format == <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5ac913414b6091ce30035b21b9c0bc1c8e">AV_PIX_FMT_QSV</a>) {</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;        mfxFrameSurface1 *mfx_surface = (mfxFrameSurface1*)<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;data[3];</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;        va_surface = *(VASurfaceID*)mfx_surface-&gt;Data.MemId;</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    } <span class="keywordflow">else</span></div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;format == <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5abb09cadf3b2d6b5ce5980401bcf638a8">AV_PIX_FMT_VAAPI</a>) {</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;        va_surface = (VASurfaceID)(uintptr_t)<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;data[3];</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOSYS);</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;    }</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160; </div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;    cl_flags = <a class="code" href="hwcontext__opencl_8c.html#aaddf3d74df38750199409c10a8bd9028">opencl_mem_flags_for_mapping</a>(<a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>);</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;    <span class="keywordflow">if</span> (!cl_flags)</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160; </div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(src_fc, <a class="code" href="group__lavu__log__constants.html#ga5b7221c3afd06848486776bd834a58a5">AV_LOG_DEBUG</a>, <span class="stringliteral">&quot;Map QSV/VAAPI surface %#x to &quot;</span></div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;           <span class="stringliteral">&quot;OpenCL.\n&quot;</span>, va_surface);</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160; </div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;    <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a> = <a class="code" href="group__lavu__mem__funcs.html#gaf143ecab33a3868b57345466c39de7c1">av_mallocz</a>(<span class="keyword">sizeof</span>(*<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>));</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>)</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160; </div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;    <span class="comment">// The cl_intel_va_api_media_sharing extension only supports NV12</span></div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;    <span class="comment">// surfaces, so for now there are always exactly two planes.</span></div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;    <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;nb_planes = 2;</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160; </div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;    <span class="keywordflow">for</span> (p = 0; p &lt; <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;nb_planes; p++) {</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;        <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;planes[p] =</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;            device_priv-&gt;clCreateFromVA_APIMediaSurfaceINTEL(</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;                dst_dev-&gt;context, cl_flags, &amp;va_surface, p, &amp;cle);</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;planes[p]) {</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(dst_fc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to create CL &quot;</span></div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;                   <span class="stringliteral">&quot;image from plane %d of QSV/VAAPI surface &quot;</span></div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;                   <span class="stringliteral">&quot;%#x: %d.\n&quot;</span>, p, va_surface, cle);</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;            err = <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EIO);</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;            <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;        }</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160; </div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;        dst-&gt;<a class="code" href="struct_a_v_frame.html#a1d0f65014a8d1bf78cec8cbed2304992">data</a>[p] = (<a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a>*)<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;planes[p];</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;    }</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160; </div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;    cle = device_priv-&gt;clEnqueueAcquireVA_APIMediaSurfacesINTEL(</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;        frames_priv-&gt;<a class="code" href="struct_open_c_l_frames_context.html#aebaf993c59ba7717dc4dbff4a2e57668">command_queue</a>, <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;nb_planes, <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;planes,</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;        0, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;event);</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;    <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(dst_fc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to acquire surface &quot;</span></div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;               <span class="stringliteral">&quot;handles: %d.\n&quot;</span>, cle);</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;        err = <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EIO);</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;    }</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160; </div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;    err = <a class="code" href="hwcontext__opencl_8c.html#a0e35d0e2185a2bf214bf4249af3731d7">opencl_wait_events</a>(dst_fc, &amp;event, 1);</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;    <span class="keywordflow">if</span> (err &lt; 0)</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160; </div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;    err = <a class="code" href="hwcontext_8c.html#a76e0387f519b3f1bd1b162e91b54b182">ff_hwframe_map_create</a>(dst-&gt;<a class="code" href="struct_a_v_frame.html#a29493fbfabaa21432c360a090426aa8e">hw_frames_ctx</a>, dst, <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>,</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;                                &amp;opencl_unmap_from_qsv, <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>);</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;    <span class="keywordflow">if</span> (err &lt; 0)</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160; </div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;    dst-&gt;<a class="code" href="struct_a_v_frame.html#a1e71ce60cedd5f3b6811714a9f7f9e0a">width</a>  = <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;width;</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;    dst-&gt;<a class="code" href="struct_a_v_frame.html#a3f89733f429c98ba5bc64373fb0a3f13">height</a> = <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;height;</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160; </div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160; </div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;<a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>:</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;    <span class="keywordflow">for</span> (p = 0; p &lt; <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;nb_planes; p++)</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;planes[p])</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;            clReleaseMemObject(<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;planes[p]);</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#adba82e1bcd02de510a858fcbedf79ef1">av_freep</a>(&amp;<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>);</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;    <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;}</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160; </div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160; </div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_DXVA2</span></div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160; </div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> opencl_unmap_from_dxva2(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *dst_fc,</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;                                    <a class="code" href="struct_h_w_map_descriptor.html">HWMapDescriptor</a> *hwmap)</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;{</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;    <a class="code" href="struct_a_v_open_c_l_frame_descriptor.html">AVOpenCLFrameDescriptor</a>    *<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a> = hwmap-&gt;<a class="code" href="struct_h_w_map_descriptor.html#a7ecea93e498181196f2121b85c07411d">priv</a>;</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;    <a class="code" href="struct_open_c_l_device_context.html">OpenCLDeviceContext</a> *device_priv = dst_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#ac9a7dbd0cbfcabc0b1529cb34cf53b6d">device_ctx</a>-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a9c3758c73b0f29925ccb2f60b5c1a803">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_device_internal.html#ae7425663cca9541964518c66974a20bf">priv</a>;</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;    <a class="code" href="struct_open_c_l_frames_context.html">OpenCLFramesContext</a> *frames_priv = dst_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#ac9a7dbd0cbfcabc0b1529cb34cf53b6d">device_ctx</a>-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a9c3758c73b0f29925ccb2f60b5c1a803">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_device_internal.html#ae7425663cca9541964518c66974a20bf">priv</a>;</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;    cl_event event;</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160; </div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(dst_fc, <a class="code" href="group__lavu__log__constants.html#ga5b7221c3afd06848486776bd834a58a5">AV_LOG_DEBUG</a>, <span class="stringliteral">&quot;Unmap DXVA2 surface from OpenCL.\n&quot;</span>);</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160; </div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    cle = device_priv-&gt;clEnqueueReleaseDX9MediaSurfacesKHR(</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;        frames_priv-&gt;<a class="code" href="struct_open_c_l_frames_context.html#aebaf993c59ba7717dc4dbff4a2e57668">command_queue</a>, <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;nb_planes, <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;planes,</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;        0, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;event);</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;    <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(dst_fc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to release surface &quot;</span></div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;               <span class="stringliteral">&quot;handle: %d.\n&quot;</span>, cle);</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;    }</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160; </div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;    <a class="code" href="hwcontext__opencl_8c.html#a0e35d0e2185a2bf214bf4249af3731d7">opencl_wait_events</a>(dst_fc, &amp;event, 1);</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;}</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160; </div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> opencl_map_from_dxva2(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *dst_fc, <a class="code" href="struct_a_v_frame.html">AVFrame</a> *dst,</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;                                 <span class="keyword">const</span> <a class="code" href="struct_a_v_frame.html">AVFrame</a> *<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>, <span class="keywordtype">int</span> <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>)</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;{</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;    <a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *src_fc =</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;        (<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a>*)<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;hw_frames_ctx-&gt;data;</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;    <a class="code" href="struct_a_v_d_x_v_a2_frames_context.html">AVDXVA2FramesContext</a>  *src_hwctx = src_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a54e38c3e4355321e23e0f4c7411cb8ee">hwctx</a>;</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;    <a class="code" href="struct_open_c_l_device_context.html">OpenCLDeviceContext</a> *device_priv = dst_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#ac9a7dbd0cbfcabc0b1529cb34cf53b6d">device_ctx</a>-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a9c3758c73b0f29925ccb2f60b5c1a803">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_device_internal.html#ae7425663cca9541964518c66974a20bf">priv</a>;</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;    <a class="code" href="struct_open_c_l_frames_context.html">OpenCLFramesContext</a> *frames_priv = dst_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a69e956e8d2d73d65d015c4ed895ec642">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_frames_internal.html#a503cfeb391ed69856344768fd641a489">priv</a>;</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;    <a class="code" href="struct_a_v_open_c_l_frame_descriptor.html">AVOpenCLFrameDescriptor</a> *<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>;</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;    cl_event event;</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;    <span class="keywordtype">int</span> err, <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160; </div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(dst_fc, <a class="code" href="group__lavu__log__constants.html#ga5b7221c3afd06848486776bd834a58a5">AV_LOG_DEBUG</a>, <span class="stringliteral">&quot;Map DXVA2 surface %p to &quot;</span></div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;           <span class="stringliteral">&quot;OpenCL.\n&quot;</span>, <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;data[3]);</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160; </div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; src_hwctx-&gt;nb_surfaces; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;        <span class="keywordflow">if</span> (src_hwctx-&gt;surfaces[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>] == (IDirect3DSurface9*)<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;data[3])</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;    }</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt;= src_hwctx-&gt;nb_surfaces) {</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(dst_fc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Trying to map from a surface which &quot;</span></div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;               <span class="stringliteral">&quot;is not in the mapped frames context.\n&quot;</span>);</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;    }</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160; </div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;    <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a> = &amp;frames_priv-&gt;mapped_frames[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160; </div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;    cle = device_priv-&gt;clEnqueueAcquireDX9MediaSurfacesKHR(</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;        frames_priv-&gt;<a class="code" href="struct_open_c_l_frames_context.html#aebaf993c59ba7717dc4dbff4a2e57668">command_queue</a>, <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;nb_planes, <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;planes,</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;        0, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;event);</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;    <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(dst_fc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to acquire surface &quot;</span></div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;               <span class="stringliteral">&quot;handle: %d.\n&quot;</span>, cle);</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EIO);</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;    }</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160; </div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;    err = <a class="code" href="hwcontext__opencl_8c.html#a0e35d0e2185a2bf214bf4249af3731d7">opencl_wait_events</a>(dst_fc, &amp;event, 1);</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;    <span class="keywordflow">if</span> (err &lt; 0)</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160; </div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;nb_planes; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;        dst-&gt;<a class="code" href="struct_a_v_frame.html#a1d0f65014a8d1bf78cec8cbed2304992">data</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>] = (<a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a>*)<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;planes[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160; </div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;    err = <a class="code" href="hwcontext_8c.html#a76e0387f519b3f1bd1b162e91b54b182">ff_hwframe_map_create</a>(dst-&gt;<a class="code" href="struct_a_v_frame.html#a29493fbfabaa21432c360a090426aa8e">hw_frames_ctx</a>, dst, <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>,</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;                                &amp;opencl_unmap_from_dxva2, <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>);</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;    <span class="keywordflow">if</span> (err &lt; 0)</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160; </div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;    dst-&gt;<a class="code" href="struct_a_v_frame.html#a1e71ce60cedd5f3b6811714a9f7f9e0a">width</a>  = <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;width;</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;    dst-&gt;<a class="code" href="struct_a_v_frame.html#a3f89733f429c98ba5bc64373fb0a3f13">height</a> = <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;height;</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160; </div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160; </div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;<a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>:</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;    cle = device_priv-&gt;clEnqueueReleaseDX9MediaSurfacesKHR(</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;        frames_priv-&gt;<a class="code" href="struct_open_c_l_frames_context.html#aebaf993c59ba7717dc4dbff4a2e57668">command_queue</a>, <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;nb_planes, <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;planes,</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;        0, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;event);</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;    <span class="keywordflow">if</span> (cle == CL_SUCCESS)</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;        <a class="code" href="hwcontext__opencl_8c.html#a0e35d0e2185a2bf214bf4249af3731d7">opencl_wait_events</a>(dst_fc, &amp;event, 1);</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;    <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;}</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160; </div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> opencl_frames_derive_from_dxva2(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *dst_fc,</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;                                           <a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *src_fc, <span class="keywordtype">int</span> <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>)</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;{</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;    <a class="code" href="struct_a_v_open_c_l_device_context.html">AVOpenCLDeviceContext</a>   *dst_dev = dst_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#ac9a7dbd0cbfcabc0b1529cb34cf53b6d">device_ctx</a>-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a46055b48d1a40445d775b4ae24f77f20">hwctx</a>;</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;    <a class="code" href="struct_a_v_d_x_v_a2_frames_context.html">AVDXVA2FramesContext</a>  *src_hwctx = src_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a54e38c3e4355321e23e0f4c7411cb8ee">hwctx</a>;</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;    <a class="code" href="struct_open_c_l_device_context.html">OpenCLDeviceContext</a> *device_priv = dst_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#ac9a7dbd0cbfcabc0b1529cb34cf53b6d">device_ctx</a>-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a9c3758c73b0f29925ccb2f60b5c1a803">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_device_internal.html#ae7425663cca9541964518c66974a20bf">priv</a>;</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;    <a class="code" href="struct_open_c_l_frames_context.html">OpenCLFramesContext</a> *frames_priv = dst_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a69e956e8d2d73d65d015c4ed895ec642">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_frames_internal.html#a503cfeb391ed69856344768fd641a489">priv</a>;</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;    cl_mem_flags cl_flags;</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;    <span class="keywordtype">int</span> err, <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, p, nb_planes;</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160; </div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;    <span class="keywordflow">if</span> (src_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a663a9aceca97aa7b2426c9aba6543e4a">sw_format</a> != <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a0b271df0acd125218c1e365a0f754022">AV_PIX_FMT_NV12</a>) {</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(dst_fc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Only NV12 textures are supported &quot;</span></div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;               <span class="stringliteral">&quot;for DXVA2 to OpenCL mapping.\n&quot;</span>);</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;    }</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;    nb_planes = 2;</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160; </div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;    <span class="keywordflow">if</span> (src_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a9c3a94dcd9c96e19059b56a6bae9c764">initial_pool_size</a> == 0) {</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(dst_fc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Only fixed-size pools are supported &quot;</span></div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;               <span class="stringliteral">&quot;for DXVA2 to OpenCL mapping.\n&quot;</span>);</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;    }</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160; </div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;    cl_flags = <a class="code" href="hwcontext__opencl_8c.html#aaddf3d74df38750199409c10a8bd9028">opencl_mem_flags_for_mapping</a>(<a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>);</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;    <span class="keywordflow">if</span> (!cl_flags)</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160; </div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;    frames_priv-&gt;nb_mapped_frames = src_hwctx-&gt;<a class="code" href="struct_a_v_d_x_v_a2_frames_context.html#a867fec347dd21aa778948df67cf00450">nb_surfaces</a>;</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160; </div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;    frames_priv-&gt;mapped_frames =</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;        <a class="code" href="mem_8c.html#aedc3761897b7e9ea8ae1222b3d013c94">av_mallocz_array</a>(frames_priv-&gt;nb_mapped_frames,</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;                         <span class="keyword">sizeof</span>(*frames_priv-&gt;mapped_frames));</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;    <span class="keywordflow">if</span> (!frames_priv-&gt;mapped_frames)</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160; </div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; frames_priv-&gt;nb_mapped_frames; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;        <a class="code" href="struct_a_v_open_c_l_frame_descriptor.html">AVOpenCLFrameDescriptor</a> *<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a> = &amp;frames_priv-&gt;mapped_frames[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;        cl_dx9_surface_info_khr surface_info = {</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;            .resource      = src_hwctx-&gt;<a class="code" href="struct_a_v_d_x_v_a2_frames_context.html#a2025b21fc7ec906713c525a702fd6eb7">surfaces</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>],</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;            .shared_handle = <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;        };</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;        <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;nb_planes = nb_planes;</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;        <span class="keywordflow">for</span> (p = 0; p &lt; nb_planes; p++) {</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;            <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;planes[p] =</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;                device_priv-&gt;clCreateFromDX9MediaSurfaceKHR(</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;                    dst_dev-&gt;<a class="code" href="struct_a_v_open_c_l_device_context.html#a5152eb3c345fd6ead8ffa9e602293d20">context</a>, cl_flags,</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;                    device_priv-&gt;dx9_media_adapter_type,</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;                    &amp;surface_info, p, &amp;cle);</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;planes[p]) {</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;                <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(dst_fc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to create CL &quot;</span></div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;                       <span class="stringliteral">&quot;image from plane %d of DXVA2 surface %d: %d.\n&quot;</span>,</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;                       p, <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, cle);</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;                err = <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EIO);</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;                <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;            }</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;        }</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;    }</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160; </div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160; </div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;<a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>:</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; frames_priv-&gt;nb_mapped_frames; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;        <a class="code" href="struct_a_v_open_c_l_frame_descriptor.html">AVOpenCLFrameDescriptor</a> *<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a> = &amp;frames_priv-&gt;mapped_frames[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;        <span class="keywordflow">for</span> (p = 0; p &lt; <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;nb_planes; p++) {</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;planes[p])</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;                clReleaseMemObject(<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;planes[p]);</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;        }</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;    }</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#adba82e1bcd02de510a858fcbedf79ef1">av_freep</a>(&amp;frames_priv-&gt;mapped_frames);</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;    frames_priv-&gt;nb_mapped_frames = 0;</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;    <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;}</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160; </div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160; </div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_D3D11</span></div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160; </div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> opencl_unmap_from_d3d11(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *dst_fc,</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;                                    <a class="code" href="struct_h_w_map_descriptor.html">HWMapDescriptor</a> *hwmap)</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;{</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;    <a class="code" href="struct_a_v_open_c_l_frame_descriptor.html">AVOpenCLFrameDescriptor</a>    *<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a> = hwmap-&gt;<a class="code" href="struct_h_w_map_descriptor.html#a7ecea93e498181196f2121b85c07411d">priv</a>;</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;    <a class="code" href="struct_open_c_l_device_context.html">OpenCLDeviceContext</a> *device_priv = dst_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#ac9a7dbd0cbfcabc0b1529cb34cf53b6d">device_ctx</a>-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a9c3758c73b0f29925ccb2f60b5c1a803">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_device_internal.html#ae7425663cca9541964518c66974a20bf">priv</a>;</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;    <a class="code" href="struct_open_c_l_frames_context.html">OpenCLFramesContext</a> *frames_priv = dst_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#ac9a7dbd0cbfcabc0b1529cb34cf53b6d">device_ctx</a>-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a9c3758c73b0f29925ccb2f60b5c1a803">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_device_internal.html#ae7425663cca9541964518c66974a20bf">priv</a>;</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;    cl_event event;</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160; </div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;    cle = device_priv-&gt;clEnqueueReleaseD3D11ObjectsKHR(</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;        frames_priv-&gt;<a class="code" href="struct_open_c_l_frames_context.html#aebaf993c59ba7717dc4dbff4a2e57668">command_queue</a>, <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;nb_planes, <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;planes,</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;        0, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;event);</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;    <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(dst_fc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to release surface &quot;</span></div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;               <span class="stringliteral">&quot;handle: %d.\n&quot;</span>, cle);</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;    }</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160; </div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;    <a class="code" href="hwcontext__opencl_8c.html#a0e35d0e2185a2bf214bf4249af3731d7">opencl_wait_events</a>(dst_fc, &amp;event, 1);</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;}</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160; </div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> opencl_map_from_d3d11(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *dst_fc, <a class="code" href="struct_a_v_frame.html">AVFrame</a> *dst,</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;                                 <span class="keyword">const</span> <a class="code" href="struct_a_v_frame.html">AVFrame</a> *<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>, <span class="keywordtype">int</span> <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>)</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;{</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;    <a class="code" href="struct_open_c_l_device_context.html">OpenCLDeviceContext</a>  *device_priv = dst_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#ac9a7dbd0cbfcabc0b1529cb34cf53b6d">device_ctx</a>-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a9c3758c73b0f29925ccb2f60b5c1a803">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_device_internal.html#ae7425663cca9541964518c66974a20bf">priv</a>;</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;    <a class="code" href="struct_open_c_l_frames_context.html">OpenCLFramesContext</a>  *frames_priv = dst_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a69e956e8d2d73d65d015c4ed895ec642">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_frames_internal.html#a503cfeb391ed69856344768fd641a489">priv</a>;</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;    <a class="code" href="struct_a_v_open_c_l_frame_descriptor.html">AVOpenCLFrameDescriptor</a> *<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>;</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;    cl_event event;</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;    <span class="keywordtype">int</span> err, <a class="code" href="gxfenc_8c.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>, <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160; </div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;    <a class="code" href="gxfenc_8c.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a> = (intptr_t)<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;data[1];</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;    <a class="code" href="filter__design_8txt.html#a0e82f1088fdc24c14bf175d2ac77523f">if</a> (<a class="code" href="gxfenc_8c.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a> &gt;= frames_priv-&gt;nb_mapped_frames) {</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(dst_fc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Texture array index out of range for &quot;</span></div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;               <span class="stringliteral">&quot;mapping: %d &gt;= %d.\n&quot;</span>, <a class="code" href="gxfenc_8c.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>, frames_priv-&gt;nb_mapped_frames);</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;    }</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160; </div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(dst_fc, <a class="code" href="group__lavu__log__constants.html#ga5b7221c3afd06848486776bd834a58a5">AV_LOG_DEBUG</a>, <span class="stringliteral">&quot;Map D3D11 texture %d to OpenCL.\n&quot;</span>,</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;           <a class="code" href="gxfenc_8c.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>);</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160; </div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;    <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a> = &amp;frames_priv-&gt;mapped_frames[<a class="code" href="gxfenc_8c.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>];</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160; </div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;    cle = device_priv-&gt;clEnqueueAcquireD3D11ObjectsKHR(</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;        frames_priv-&gt;<a class="code" href="struct_open_c_l_frames_context.html#aebaf993c59ba7717dc4dbff4a2e57668">command_queue</a>, <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;nb_planes, <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;planes,</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;        0, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;event);</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;    <span class="keywordflow">if</span> (cle != CL_SUCCESS) {</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(dst_fc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to acquire surface &quot;</span></div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;               <span class="stringliteral">&quot;handle: %d.\n&quot;</span>, cle);</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EIO);</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;    }</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160; </div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;    err = <a class="code" href="hwcontext__opencl_8c.html#a0e35d0e2185a2bf214bf4249af3731d7">opencl_wait_events</a>(dst_fc, &amp;event, 1);</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;    <span class="keywordflow">if</span> (err &lt; 0)</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160; </div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;nb_planes; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;        dst-&gt;<a class="code" href="struct_a_v_frame.html#a1d0f65014a8d1bf78cec8cbed2304992">data</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>] = (<a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a>*)<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;planes[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160; </div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;    err = <a class="code" href="hwcontext_8c.html#a76e0387f519b3f1bd1b162e91b54b182">ff_hwframe_map_create</a>(dst-&gt;<a class="code" href="struct_a_v_frame.html#a29493fbfabaa21432c360a090426aa8e">hw_frames_ctx</a>, dst, <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>,</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;                                &amp;opencl_unmap_from_d3d11, <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>);</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;    <span class="keywordflow">if</span> (err &lt; 0)</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160; </div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;    dst-&gt;<a class="code" href="struct_a_v_frame.html#a1e71ce60cedd5f3b6811714a9f7f9e0a">width</a>  = <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;width;</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;    dst-&gt;<a class="code" href="struct_a_v_frame.html#a3f89733f429c98ba5bc64373fb0a3f13">height</a> = <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;height;</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160; </div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160; </div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;<a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>:</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;    cle = device_priv-&gt;clEnqueueReleaseD3D11ObjectsKHR(</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;        frames_priv-&gt;<a class="code" href="struct_open_c_l_frames_context.html#aebaf993c59ba7717dc4dbff4a2e57668">command_queue</a>, <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;nb_planes, <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;planes,</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;        0, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;event);</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;    <span class="keywordflow">if</span> (cle == CL_SUCCESS)</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;        <a class="code" href="hwcontext__opencl_8c.html#a0e35d0e2185a2bf214bf4249af3731d7">opencl_wait_events</a>(dst_fc, &amp;event, 1);</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;    <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;}</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160; </div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> opencl_frames_derive_from_d3d11(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *dst_fc,</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;                                           <a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *src_fc, <span class="keywordtype">int</span> <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>)</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;{</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;    <a class="code" href="struct_a_v_open_c_l_device_context.html">AVOpenCLDeviceContext</a>    *dst_dev = dst_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#ac9a7dbd0cbfcabc0b1529cb34cf53b6d">device_ctx</a>-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a46055b48d1a40445d775b4ae24f77f20">hwctx</a>;</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;    <a class="code" href="struct_a_v_d3_d11_v_a_frames_context.html">AVD3D11VAFramesContext</a> *src_hwctx = src_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a54e38c3e4355321e23e0f4c7411cb8ee">hwctx</a>;</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;    <a class="code" href="struct_open_c_l_device_context.html">OpenCLDeviceContext</a>  *device_priv = dst_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#ac9a7dbd0cbfcabc0b1529cb34cf53b6d">device_ctx</a>-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a9c3758c73b0f29925ccb2f60b5c1a803">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_device_internal.html#ae7425663cca9541964518c66974a20bf">priv</a>;</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;    <a class="code" href="struct_open_c_l_frames_context.html">OpenCLFramesContext</a>  *frames_priv = dst_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a69e956e8d2d73d65d015c4ed895ec642">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_frames_internal.html#a503cfeb391ed69856344768fd641a489">priv</a>;</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;    cl_mem_flags cl_flags;</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;    <span class="keywordtype">int</span> err, <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, p, nb_planes;</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160; </div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;    <span class="keywordflow">if</span> (src_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a663a9aceca97aa7b2426c9aba6543e4a">sw_format</a> != <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a0b271df0acd125218c1e365a0f754022">AV_PIX_FMT_NV12</a>) {</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(dst_fc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Only NV12 textures are supported &quot;</span></div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;               <span class="stringliteral">&quot;for D3D11 to OpenCL mapping.\n&quot;</span>);</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;    }</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;    nb_planes = 2;</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160; </div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;    <span class="keywordflow">if</span> (src_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a9c3a94dcd9c96e19059b56a6bae9c764">initial_pool_size</a> == 0) {</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(dst_fc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Only fixed-size pools are supported &quot;</span></div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;               <span class="stringliteral">&quot;for D3D11 to OpenCL mapping.\n&quot;</span>);</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;    }</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160; </div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;    cl_flags = <a class="code" href="hwcontext__opencl_8c.html#aaddf3d74df38750199409c10a8bd9028">opencl_mem_flags_for_mapping</a>(<a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>);</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;    <span class="keywordflow">if</span> (!cl_flags)</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160; </div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;    frames_priv-&gt;nb_mapped_frames = src_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a9c3a94dcd9c96e19059b56a6bae9c764">initial_pool_size</a>;</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160; </div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;    frames_priv-&gt;mapped_frames =</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;        <a class="code" href="mem_8c.html#aedc3761897b7e9ea8ae1222b3d013c94">av_mallocz_array</a>(frames_priv-&gt;nb_mapped_frames,</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;                         <span class="keyword">sizeof</span>(*frames_priv-&gt;mapped_frames));</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;    <span class="keywordflow">if</span> (!frames_priv-&gt;mapped_frames)</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160; </div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; frames_priv-&gt;nb_mapped_frames; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;        <a class="code" href="struct_a_v_open_c_l_frame_descriptor.html">AVOpenCLFrameDescriptor</a> *<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a> = &amp;frames_priv-&gt;mapped_frames[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;        <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;nb_planes = nb_planes;</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;        <span class="keywordflow">for</span> (p = 0; p &lt; nb_planes; p++) {</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;            UINT subresource = 2 * <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> + p;</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160; </div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;            <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;planes[p] =</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;                device_priv-&gt;clCreateFromD3D11Texture2DKHR(</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;                    dst_dev-&gt;<a class="code" href="struct_a_v_open_c_l_device_context.html#a5152eb3c345fd6ead8ffa9e602293d20">context</a>, cl_flags, src_hwctx-&gt;<a class="code" href="struct_a_v_d3_d11_v_a_frames_context.html#a359e4ccfa46c05a225947aea7ce7ac17">texture</a>,</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;                    subresource, &amp;cle);</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;planes[p]) {</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;                <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(dst_fc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to create CL &quot;</span></div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;                       <span class="stringliteral">&quot;image from plane %d of D3D texture &quot;</span></div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;                       <span class="stringliteral">&quot;index %d (subresource %u): %d.\n&quot;</span>,</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;                       p, <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)subresource, cle);</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;                err = <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EIO);</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;                <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;            }</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;        }</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;    }</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160; </div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160; </div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;<a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>:</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; frames_priv-&gt;nb_mapped_frames; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;        <a class="code" href="struct_a_v_open_c_l_frame_descriptor.html">AVOpenCLFrameDescriptor</a> *<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a> = &amp;frames_priv-&gt;mapped_frames[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;        <span class="keywordflow">for</span> (p = 0; p &lt; <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;nb_planes; p++) {</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;planes[p])</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;                clReleaseMemObject(<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;planes[p]);</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;        }</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;    }</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#adba82e1bcd02de510a858fcbedf79ef1">av_freep</a>(&amp;frames_priv-&gt;mapped_frames);</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;    frames_priv-&gt;nb_mapped_frames = 0;</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;    <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;}</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160; </div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160; </div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_DRM_ARM</span></div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160; </div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>DRMARMtoOpenCLMapping {</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;    <span class="keywordtype">int</span> nb_objects;</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;    cl_mem object_buffers[<a class="code" href="group__avoptions.html#gga06fc87d81c62e9abb8790b6e5713c55ba8f29c39f016d0bf9a006b180b859ba4f">AV_DRM_MAX_PLANES</a>];</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;    <span class="keywordtype">int</span> nb_planes;</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;    cl_mem plane_images[<a class="code" href="group__avoptions.html#gga06fc87d81c62e9abb8790b6e5713c55ba8f29c39f016d0bf9a006b180b859ba4f">AV_DRM_MAX_PLANES</a>];</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;} DRMARMtoOpenCLMapping;</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160; </div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> opencl_unmap_from_drm_arm(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *dst_fc,</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;                                      <a class="code" href="struct_h_w_map_descriptor.html">HWMapDescriptor</a> *hwmap)</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;{</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;    DRMARMtoOpenCLMapping *mapping = hwmap-&gt;<a class="code" href="struct_h_w_map_descriptor.html#a7ecea93e498181196f2121b85c07411d">priv</a>;</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160; </div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; mapping-&gt;nb_planes; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;        clReleaseMemObject(mapping-&gt;plane_images[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160; </div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; mapping-&gt;nb_objects; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;        clReleaseMemObject(mapping-&gt;object_buffers[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160; </div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#a079eab092887563f2bef9106c6120089">av_free</a>(mapping);</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;}</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160; </div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> opencl_map_from_drm_arm(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *dst_fc, <a class="code" href="struct_a_v_frame.html">AVFrame</a> *dst,</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;                                   <span class="keyword">const</span> <a class="code" href="struct_a_v_frame.html">AVFrame</a> *<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>, <span class="keywordtype">int</span> <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>)</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;{</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;    <a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *src_fc =</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;        (<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a>*)<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;hw_frames_ctx-&gt;data;</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;    <a class="code" href="struct_a_v_open_c_l_device_context.html">AVOpenCLDeviceContext</a> *dst_dev = dst_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#ac9a7dbd0cbfcabc0b1529cb34cf53b6d">device_ctx</a>-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a46055b48d1a40445d775b4ae24f77f20">hwctx</a>;</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;    <span class="keyword">const</span> <a class="code" href="struct_a_v_d_r_m_frame_descriptor.html">AVDRMFrameDescriptor</a> *<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>;</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;    DRMARMtoOpenCLMapping *mapping = <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;    cl_mem_flags cl_flags;</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;    <span class="keyword">const</span> cl_import_properties_arm props[3] = {</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;        CL_IMPORT_TYPE_ARM, CL_IMPORT_TYPE_DMA_BUF_ARM, 0,</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;    };</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;    cl_int cle;</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;    <span class="keywordtype">int</span> err, <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, j;</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160; </div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;    <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a> = (<span class="keyword">const</span> <a class="code" href="struct_a_v_d_r_m_frame_descriptor.html">AVDRMFrameDescriptor</a>*)<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;data[0];</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160; </div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;    cl_flags = <a class="code" href="hwcontext__opencl_8c.html#aaddf3d74df38750199409c10a8bd9028">opencl_mem_flags_for_mapping</a>(<a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>);</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;    <span class="keywordflow">if</span> (!cl_flags)</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160; </div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;    mapping = <a class="code" href="group__lavu__mem__funcs.html#gaf143ecab33a3868b57345466c39de7c1">av_mallocz</a>(<span class="keyword">sizeof</span>(*mapping));</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;    <span class="keywordflow">if</span> (!mapping)</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160; </div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;    mapping-&gt;nb_objects = <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;nb_objects;</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;nb_objects; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;        <span class="keywordtype">int</span> fd = <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;objects[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].fd;</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160; </div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(dst_fc, <a class="code" href="group__lavu__log__constants.html#ga5b7221c3afd06848486776bd834a58a5">AV_LOG_DEBUG</a>, <span class="stringliteral">&quot;Map DRM PRIME fd %d to OpenCL.\n&quot;</span>, fd);</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160; </div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;objects[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].format_modifier) {</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(dst_fc, <a class="code" href="group__lavu__log__constants.html#ga5b7221c3afd06848486776bd834a58a5">AV_LOG_DEBUG</a>, <span class="stringliteral">&quot;Warning: object %d fd %d has &quot;</span></div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;                   <span class="stringliteral">&quot;nonzero format modifier %&quot;</span>PRId64<span class="stringliteral">&quot;, result may not &quot;</span></div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;                   <span class="stringliteral">&quot;be as expected.\n&quot;</span>, <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, fd,</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;                   <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;objects[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].format_modifier);</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;        }</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160; </div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;        mapping-&gt;object_buffers[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>] =</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;            clImportMemoryARM(dst_dev-&gt;<a class="code" href="struct_a_v_open_c_l_device_context.html#a5152eb3c345fd6ead8ffa9e602293d20">context</a>, cl_flags, props,</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;                              &amp;fd, <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;objects[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].size, &amp;cle);</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;        <span class="keywordflow">if</span> (!mapping-&gt;object_buffers[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>]) {</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(dst_fc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to create CL buffer &quot;</span></div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;                   <span class="stringliteral">&quot;from object %d (fd %d, size %&quot;</span><a class="code" href="libavutil_2internal_8h.html#a0e48151aa81e2949bf69aaf5e3fc2cc9">SIZE_SPECIFIER</a><span class="stringliteral">&quot;) of DRM frame: %d.\n&quot;</span>,</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;                   <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, fd, <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;objects[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].size, cle);</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;            err = <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EIO);</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;            <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;        }</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;    }</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160; </div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;    mapping-&gt;nb_planes = 0;</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;nb_layers; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;        <span class="keyword">const</span> <a class="code" href="struct_a_v_d_r_m_layer_descriptor.html">AVDRMLayerDescriptor</a> *layer = &amp;<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;layers[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160; </div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; layer-&gt;<a class="code" href="struct_a_v_d_r_m_layer_descriptor.html#aa71ce914f53563be8207d8bc08fbfe92">nb_planes</a>; j++) {</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;            <span class="keyword">const</span> <a class="code" href="struct_a_v_d_r_m_plane_descriptor.html">AVDRMPlaneDescriptor</a> *plane = &amp;layer-&gt;<a class="code" href="struct_a_v_d_r_m_layer_descriptor.html#a7fbaf03f401c451e82021487fefef159">planes</a>[j];</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;            cl_mem plane_buffer;</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;            cl_image_format image_format;</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;            cl_image_desc   image_desc;</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;            cl_buffer_region region;</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;            <span class="keywordtype">int</span> p = mapping-&gt;nb_planes;</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160; </div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;            err = <a class="code" href="hwcontext__opencl_8c.html#af2c66952db60f2cdd30b7c6c00b80a64">opencl_get_plane_format</a>(src_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a663a9aceca97aa7b2426c9aba6543e4a">sw_format</a>, p,</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;                                          src_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a9e6f29d0f744930cdd0e8bdff8771520">width</a>, src_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#ae61bbe1d8645a0c573085e29f1d0a58f">height</a>,</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;                                          &amp;image_format, &amp;image_desc);</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;            <span class="keywordflow">if</span> (err &lt; 0) {</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;                <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(dst_fc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Invalid plane %d (DRM &quot;</span></div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;                       <span class="stringliteral">&quot;layer %d plane %d): %d.\n&quot;</span>, p, <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, j, err);</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;                <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;            }</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160; </div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;            region.origin = plane-&gt;<a class="code" href="struct_a_v_d_r_m_plane_descriptor.html#af1a0839b02055445257d431d946d96a7">offset</a>;</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;            region.size   = image_desc.image_row_pitch *</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;                            image_desc.image_height;</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160; </div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;            plane_buffer =</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;                clCreateSubBuffer(mapping-&gt;object_buffers[plane-&gt;<a class="code" href="struct_a_v_d_r_m_plane_descriptor.html#af07fe11d604e0a3b5fd934f9626c008b">object_index</a>],</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;                                  cl_flags,</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;                                  CL_BUFFER_CREATE_TYPE_REGION,</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;                                  &amp;region, &amp;cle);</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;            <span class="keywordflow">if</span> (!plane_buffer) {</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;                <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(dst_fc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to create sub-buffer &quot;</span></div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;                       <span class="stringliteral">&quot;for plane %d: %d.\n&quot;</span>, p, cle);</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;                err = <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EIO);</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;                <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;            }</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160; </div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;            image_desc.buffer = plane_buffer;</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160; </div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;            mapping-&gt;plane_images[p] =</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;                clCreateImage(dst_dev-&gt;<a class="code" href="struct_a_v_open_c_l_device_context.html#a5152eb3c345fd6ead8ffa9e602293d20">context</a>, cl_flags,</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;                              &amp;image_format, &amp;image_desc, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;cle);</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160; </div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;            <span class="comment">// Unreference the sub-buffer immediately - we don&#39;t need it</span></div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;            <span class="comment">// directly and a reference is held by the image.</span></div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;            clReleaseMemObject(plane_buffer);</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160; </div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;            <span class="keywordflow">if</span> (!mapping-&gt;plane_images[p]) {</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;                <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(dst_fc, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to create image &quot;</span></div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;                       <span class="stringliteral">&quot;for plane %d: %d.\n&quot;</span>, p, cle);</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;                err = <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EIO);</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;                <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;            }</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160; </div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;            ++mapping-&gt;nb_planes;</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;        }</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;    }</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160; </div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; mapping-&gt;nb_planes; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;        dst-&gt;<a class="code" href="struct_a_v_frame.html#a1d0f65014a8d1bf78cec8cbed2304992">data</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>] = (<a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a>*)mapping-&gt;plane_images[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160; </div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;    err = <a class="code" href="hwcontext_8c.html#a76e0387f519b3f1bd1b162e91b54b182">ff_hwframe_map_create</a>(dst-&gt;<a class="code" href="struct_a_v_frame.html#a29493fbfabaa21432c360a090426aa8e">hw_frames_ctx</a>, dst, <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>,</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;                                &amp;opencl_unmap_from_drm_arm, mapping);</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;    <span class="keywordflow">if</span> (err &lt; 0)</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160; </div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;    dst-&gt;<a class="code" href="struct_a_v_frame.html#a1e71ce60cedd5f3b6811714a9f7f9e0a">width</a>  = <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;width;</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;    dst-&gt;<a class="code" href="struct_a_v_frame.html#a3f89733f429c98ba5bc64373fb0a3f13">height</a> = <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;height;</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160; </div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160; </div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;<a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>:</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; mapping-&gt;nb_planes; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;        clReleaseMemObject(mapping-&gt;plane_images[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;    }</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; mapping-&gt;nb_objects; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;        <span class="keywordflow">if</span> (mapping-&gt;object_buffers[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;            clReleaseMemObject(mapping-&gt;object_buffers[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;    }</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#a079eab092887563f2bef9106c6120089">av_free</a>(mapping);</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;    <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;}</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160; </div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160; </div>
<div class="line"><a name="l02801"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#ae48babfefabb13315734e94b1d367e94"> 2801</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__opencl_8c.html#ae48babfefabb13315734e94b1d367e94">opencl_map_from</a>(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *hwfc, <a class="code" href="struct_a_v_frame.html">AVFrame</a> *dst,</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;                           <span class="keyword">const</span> <a class="code" href="struct_a_v_frame.html">AVFrame</a> *<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>, <span class="keywordtype">int</span> <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>)</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;{</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;    <a class="code" href="avassert_8h.html#aae204192396f78cc8c5cd7ad5c57c23f">av_assert0</a>(<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;format == <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a9033468a02331a128ba10d84f55f253d">AV_PIX_FMT_OPENCL</a>);</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;    <span class="keywordflow">if</span> (hwfc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a663a9aceca97aa7b2426c9aba6543e4a">sw_format</a> != dst-&gt;<a class="code" href="struct_a_v_frame.html#aed14fa772ce46881020fd1545c86432c">format</a>)</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOSYS);</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="hwcontext__opencl_8c.html#af79e4113dba0b404fdeacca66238957a">opencl_map_frame</a>(hwfc, dst, <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>, <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>);</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;}</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160; </div>
<div class="line"><a name="l02810"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#a3d7e715051fd71f6792081b679794a32"> 2810</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__opencl_8c.html#a3d7e715051fd71f6792081b679794a32">opencl_map_to</a>(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *hwfc, <a class="code" href="struct_a_v_frame.html">AVFrame</a> *dst,</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;                         <span class="keyword">const</span> <a class="code" href="struct_a_v_frame.html">AVFrame</a> *<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>, <span class="keywordtype">int</span> <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>)</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;{</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;    <a class="code" href="attributes_8h.html#a7ca8a3900269f92fcc7b68235dea7787">av_unused</a> <a class="code" href="struct_open_c_l_device_context.html">OpenCLDeviceContext</a> *priv = hwfc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#ac9a7dbd0cbfcabc0b1529cb34cf53b6d">device_ctx</a>-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a9c3758c73b0f29925ccb2f60b5c1a803">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_device_internal.html#ae7425663cca9541964518c66974a20bf">priv</a>;</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;    <a class="code" href="avassert_8h.html#aae204192396f78cc8c5cd7ad5c57c23f">av_assert0</a>(dst-&gt;<a class="code" href="struct_a_v_frame.html#aed14fa772ce46881020fd1545c86432c">format</a> == <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a9033468a02331a128ba10d84f55f253d">AV_PIX_FMT_OPENCL</a>);</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;format) {</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_DRM_BEIGNET</span></div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a76a05fccc6f58f7ab655deefd794713e">AV_PIX_FMT_DRM_PRIME</a>:</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;        <span class="keywordflow">if</span> (priv-&gt;beignet_drm_mapping_usable)</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;            <span class="keywordflow">return</span> opencl_map_from_drm_beignet(hwfc, dst, <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>, <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>);</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_VAAPI_BEIGNET</span></div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5abb09cadf3b2d6b5ce5980401bcf638a8">AV_PIX_FMT_VAAPI</a>:</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;        <span class="keywordflow">if</span> (priv-&gt;beignet_drm_mapping_usable)</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;            <span class="keywordflow">return</span> opencl_map_from_vaapi(hwfc, dst, <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>, <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>);</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_VAAPI_INTEL_MEDIA</span></div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5ac913414b6091ce30035b21b9c0bc1c8e">AV_PIX_FMT_QSV</a>:</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5abb09cadf3b2d6b5ce5980401bcf638a8">AV_PIX_FMT_VAAPI</a>:</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;        <span class="keywordflow">if</span> (priv-&gt;qsv_mapping_usable)</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;            <span class="keywordflow">return</span> opencl_map_from_qsv(hwfc, dst, <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>, <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>);</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_DXVA2</span></div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a35e418d6581792c6daa3c0aaba601cb1">AV_PIX_FMT_DXVA2_VLD</a>:</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;        <span class="keywordflow">if</span> (priv-&gt;dxva2_mapping_usable)</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;            <span class="keywordflow">return</span> opencl_map_from_dxva2(hwfc, dst, <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>, <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>);</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_D3D11</span></div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a8cfd0b36308fa1ad3522ef8815ccbd0a">AV_PIX_FMT_D3D11</a>:</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;        <span class="keywordflow">if</span> (priv-&gt;d3d11_mapping_usable)</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;            <span class="keywordflow">return</span> opencl_map_from_d3d11(hwfc, dst, <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>, <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>);</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_DRM_ARM</span></div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a76a05fccc6f58f7ab655deefd794713e">AV_PIX_FMT_DRM_PRIME</a>:</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;        <span class="keywordflow">if</span> (priv-&gt;drm_arm_mapping_usable)</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;            <span class="keywordflow">return</span> opencl_map_from_drm_arm(hwfc, dst, <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>, <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>);</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;    }</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOSYS);</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;}</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160; </div>
<div class="line"><a name="l02851"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#a71dcf9f77e0ceec7f098a233fcec80f4"> 2851</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__opencl_8c.html#a71dcf9f77e0ceec7f098a233fcec80f4">opencl_frames_derive_to</a>(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *dst_fc,</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;                                   <a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *src_fc, <span class="keywordtype">int</span> <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>)</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;{</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;    <a class="code" href="attributes_8h.html#a7ca8a3900269f92fcc7b68235dea7787">av_unused</a> <a class="code" href="struct_open_c_l_device_context.html">OpenCLDeviceContext</a> *priv = dst_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#ac9a7dbd0cbfcabc0b1529cb34cf53b6d">device_ctx</a>-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a9c3758c73b0f29925ccb2f60b5c1a803">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_device_internal.html#ae7425663cca9541964518c66974a20bf">priv</a>;</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;    <span class="keywordflow">switch</span> (src_fc-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#ac9a7dbd0cbfcabc0b1529cb34cf53b6d">device_ctx</a>-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#abc92603a11768828ef3aea1f9d089308">type</a>) {</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_DRM_BEIGNET</span></div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34aa04ac36fb964a5c191566a8e809de743">AV_HWDEVICE_TYPE_DRM</a>:</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;        <span class="keywordflow">if</span> (!priv-&gt;beignet_drm_mapping_usable)</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOSYS);</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_VAAPI_BEIGNET</span></div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34af5dfa6181a3a6efb0f4a0c5f38d76b95">AV_HWDEVICE_TYPE_VAAPI</a>:</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;        <span class="keywordflow">if</span> (!priv-&gt;beignet_drm_mapping_usable)</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOSYS);</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_VAAPI_INTEL_MEDIA</span></div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34a7a74cd2f21d680a11aa8b321ddff1358">AV_HWDEVICE_TYPE_QSV</a>:</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34af5dfa6181a3a6efb0f4a0c5f38d76b95">AV_HWDEVICE_TYPE_VAAPI</a>:</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;        <span class="keywordflow">if</span> (!priv-&gt;qsv_mapping_usable)</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOSYS);</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_DXVA2</span></div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34acc6f1868dad1c636d4747cc91ce71d10">AV_HWDEVICE_TYPE_DXVA2</a>:</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;        <span class="keywordflow">if</span> (!priv-&gt;dxva2_mapping_usable)</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOSYS);</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;        {</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;            <span class="keywordtype">int</span> err;</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;            err = opencl_frames_derive_from_dxva2(dst_fc, src_fc, <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>);</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;            <span class="keywordflow">if</span> (err &lt; 0)</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;                <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;        }</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_D3D11</span></div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34a1823a64d48c796978b892dd669659c4c">AV_HWDEVICE_TYPE_D3D11VA</a>:</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;        <span class="keywordflow">if</span> (!priv-&gt;d3d11_mapping_usable)</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOSYS);</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;        {</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;            <span class="keywordtype">int</span> err;</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;            err = opencl_frames_derive_from_d3d11(dst_fc, src_fc, <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>);</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;            <span class="keywordflow">if</span> (err &lt; 0)</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;                <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;        }</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;<span class="preprocessor">#if HAVE_OPENCL_DRM_ARM</span></div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34aa04ac36fb964a5c191566a8e809de743">AV_HWDEVICE_TYPE_DRM</a>:</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;        <span class="keywordflow">if</span> (!priv-&gt;drm_arm_mapping_usable)</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOSYS);</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOSYS);</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;    }</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="hwcontext__opencl_8c.html#a3004c1b68dc75e1be574fafb61f44cfb">opencl_frames_init_command_queue</a>(dst_fc);</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;}</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160; </div>
<div class="line"><a name="l02911"></a><span class="lineno"><a class="line" href="hwcontext__opencl_8c.html#a02a7bb630be917db3ef61557306ad19e"> 2911</a></span>&#160;<span class="keyword">const</span> <a class="code" href="struct_h_w_context_type.html">HWContextType</a> <a class="code" href="hwcontext__opencl_8c.html#a02a7bb630be917db3ef61557306ad19e">ff_hwcontext_type_opencl</a> = {</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;    .<a class="code" href="struct_h_w_context_type.html#a5ddb5fc39d16ce3147a5640c8d040937">type</a>                   = <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34a6ba51b0079c626ee6d02991f078ecc98">AV_HWDEVICE_TYPE_OPENCL</a>,</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;    .name                   = <span class="stringliteral">&quot;OpenCL&quot;</span>,</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160; </div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;    .device_hwctx_size      = <span class="keyword">sizeof</span>(<a class="code" href="hwcontext__opencl_8h.html#a13abed95677347a50bf272bc7d1a7caf">AVOpenCLDeviceContext</a>),</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;    .device_priv_size       = <span class="keyword">sizeof</span>(<a class="code" href="struct_open_c_l_device_context.html">OpenCLDeviceContext</a>),</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;    .frames_hwctx_size      = <span class="keyword">sizeof</span>(<a class="code" href="hwcontext__opencl_8h.html#aaaea4767b6c6fca5cfdbb090f579c6b5">AVOpenCLFramesContext</a>),</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;    .frames_priv_size       = <span class="keyword">sizeof</span>(<a class="code" href="struct_open_c_l_frames_context.html">OpenCLFramesContext</a>),</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160; </div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;    .device_create          = &amp;<a class="code" href="hwcontext__opencl_8c.html#a70f211250033119734a586d936c078dd">opencl_device_create</a>,</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;    .device_derive          = &amp;<a class="code" href="hwcontext__opencl_8c.html#af42f65b808f46810f0b04b7f93f38eaf">opencl_device_derive</a>,</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;    .device_init            = &amp;<a class="code" href="hwcontext__opencl_8c.html#a7e5c0b39632f505525b31f45bd28804d">opencl_device_init</a>,</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;    .device_uninit          = &amp;<a class="code" href="hwcontext__opencl_8c.html#ac80722ea1b3deb660be44b3d4fc2e44e">opencl_device_uninit</a>,</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160; </div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;    .frames_get_constraints = &amp;<a class="code" href="hwcontext__opencl_8c.html#a0a9234d6a5cca399a1ea034d9f360ba4">opencl_frames_get_constraints</a>,</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;    .frames_init            = &amp;<a class="code" href="hwcontext__opencl_8c.html#a5644eb404ac92daf899141490b2f83d8">opencl_frames_init</a>,</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;    .frames_uninit          = &amp;<a class="code" href="hwcontext__opencl_8c.html#ae0fd7381d69c6c5aff42004d71bb217f">opencl_frames_uninit</a>,</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;    .frames_get_buffer      = &amp;<a class="code" href="hwcontext__opencl_8c.html#ae0c00627f713c461d5f449c5f8ef27d9">opencl_get_buffer</a>,</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160; </div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;    .transfer_get_formats   = &amp;<a class="code" href="hwcontext__opencl_8c.html#af1e17c9169a69d720eac8ba83d756f0f">opencl_transfer_get_formats</a>,</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;    .transfer_data_to       = &amp;<a class="code" href="hwcontext__opencl_8c.html#aefb87273677351fb6486f45b7ac05a3b">opencl_transfer_data_to</a>,</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;    .transfer_data_from     = &amp;<a class="code" href="hwcontext__opencl_8c.html#a348344b15f15878dc1077cda3655be1e">opencl_transfer_data_from</a>,</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160; </div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;    .map_from               = &amp;<a class="code" href="hwcontext__opencl_8c.html#ae48babfefabb13315734e94b1d367e94">opencl_map_from</a>,</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;    .map_to                 = &amp;<a class="code" href="hwcontext__opencl_8c.html#a3d7e715051fd71f6792081b679794a32">opencl_map_to</a>,</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;    .frames_derive_to       = &amp;<a class="code" href="hwcontext__opencl_8c.html#a71dcf9f77e0ceec7f098a233fcec80f4">opencl_frames_derive_to</a>,</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160; </div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;    .pix_fmts = (<span class="keyword">const</span> <span class="keyword">enum</span> <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5">AVPixelFormat</a>[]) {</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;        <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a9033468a02331a128ba10d84f55f253d">AV_PIX_FMT_OPENCL</a>,</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;        <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a0e08f8a5d0fa21c3e258816a9dcce7c3">AV_PIX_FMT_NONE</a></div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;    },</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;};</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="ahwcontext__opencl_8c_html_a00f2a3fb884b6012b6427d7d9e8b717a"><div class="ttname"><a href="hwcontext__opencl_8c.html#a00f2a3fb884b6012b6427d7d9e8b717a">opencl_get_device_string</a></div><div class="ttdeci">static char * opencl_get_device_string(cl_device_id device_id, cl_device_info key)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l00223">hwcontext_opencl.c:223</a></div></div>
<div class="ttc" id="asignature_8h_html_a12f58149bb2cdab504621ba5b390ef64"><div class="ttname"><a href="signature_8h.html#a12f58149bb2cdab504621ba5b390ef64">formats</a></div><div class="ttdeci">formats</div><div class="ttdef"><b>Definition:</b> <a href="signature_8h_source.html#l00048">signature.h:48</a></div></div>
<div class="ttc" id="astruct_a_v_open_c_l_device_context_html_a469263dac579e9693e1bafb8d0b3d5ca"><div class="ttname"><a href="struct_a_v_open_c_l_device_context.html#a469263dac579e9693e1bafb8d0b3d5ca">AVOpenCLDeviceContext::command_queue</a></div><div class="ttdeci">cl_command_queue command_queue</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8h_source.html#l00081">hwcontext_opencl.h:81</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_a02a7bb630be917db3ef61557306ad19e"><div class="ttname"><a href="hwcontext__opencl_8c.html#a02a7bb630be917db3ef61557306ad19e">ff_hwcontext_type_opencl</a></div><div class="ttdeci">const HWContextType ff_hwcontext_type_opencl</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l02911">hwcontext_opencl.c:2911</a></div></div>
<div class="ttc" id="agroup__lavu__log__constants_html_ga85b57516ca703cc47d9bbe5f4658c716"><div class="ttname"><a href="group__lavu__log__constants.html#ga85b57516ca703cc47d9bbe5f4658c716">AV_LOG_WARNING</a></div><div class="ttdeci">#define AV_LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="log_8h_source.html#l00200">log.h:200</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_a30b944479847b738d5b8bf5236f79108"><div class="ttname"><a href="hwcontext__opencl_8c.html#a30b944479847b738d5b8bf5236f79108">opencl_device_params</a></div><div class="ttdeci">static struct @1 opencl_device_params[]</div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5">AVPixelFormat</a></div><div class="ttdeci">AVPixelFormat</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00064">pixfmt.h:64</a></div></div>
<div class="ttc" id="afilter__design_8txt_html_adf2fb515710d47541f7150ecd2950e76"><div class="ttname"><a href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a></div><div class="ttdeci">Filter the word “frame” indicates either a video frame or a group of audio as stored in an AVFrame structure Format for each input and each output the list of supported formats For video that means pixel format For audio that means channel sample they are references to shared objects When the negotiation mechanism computes the intersection of the formats supported at each end of a all references to both lists are replaced with a reference to the intersection And when a single format is eventually chosen for a link amongst the remaining all references to the list are updated That means that if a filter requires that its input and output have the same format amongst a supported all it has to do is use a reference to the same list of formats query_formats can leave some formats unset and return AVERROR(EAGAIN) to cause the negotiation mechanism toagain later. That can be used by filters with complex requirements to use the format negotiated on one link to set the formats supported on another. Frame references ownership and permissions</div></div>
<div class="ttc" id="astruct_a_v_dictionary_html"><div class="ttname"><a href="struct_a_v_dictionary.html">AVDictionary</a></div><div class="ttdef"><b>Definition:</b> <a href="dict_8c_source.html#l00030">dict.c:30</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_frames_context_html_a9e6f29d0f744930cdd0e8bdff8771520"><div class="ttname"><a href="struct_a_v_h_w_frames_context.html#a9e6f29d0f744930cdd0e8bdff8771520">AVHWFramesContext::width</a></div><div class="ttdeci">int width</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00229">hwcontext.h:229</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_frames_constraints_html_a34e06e3397af2b83de9d78f893bf4168"><div class="ttname"><a href="struct_a_v_h_w_frames_constraints.html#a34e06e3397af2b83de9d78f893bf4168">AVHWFramesConstraints::max_width</a></div><div class="ttdeci">int max_width</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00478">hwcontext.h:478</a></div></div>
<div class="ttc" id="astruct_a_v_d_r_m_frame_descriptor_html"><div class="ttname"><a href="struct_a_v_d_r_m_frame_descriptor.html">AVDRMFrameDescriptor</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__drm_8h_source.html#l00133">hwcontext_drm.h:133</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_a7e5c0b39632f505525b31f45bd28804d"><div class="ttname"><a href="hwcontext__opencl_8c.html#a7e5c0b39632f505525b31f45bd28804d">opencl_device_init</a></div><div class="ttdeci">static int opencl_device_init(AVHWDeviceContext *hwdev)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l00653">hwcontext_opencl.c:653</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_device_context_html_abc92603a11768828ef3aea1f9d089308"><div class="ttname"><a href="struct_a_v_h_w_device_context.html#abc92603a11768828ef3aea1f9d089308">AVHWDeviceContext::type</a></div><div class="ttdeci">enum AVHWDeviceType type</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00071">hwcontext.h:79</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8h_html"><div class="ttname"><a href="hwcontext__opencl_8h.html">hwcontext_opencl.h</a></div></div>
<div class="ttc" id="avf__geq_8c_html_afc61272a374024bcd86d8859783d3d52"><div class="ttname"><a href="vf__geq_8c.html#afc61272a374024bcd86d8859783d3d52">cb</a></div><div class="ttdeci">static double cb(void *priv, double x, double y)</div><div class="ttdef"><b>Definition:</b> <a href="vf__geq_8c_source.html#l00215">vf_geq.c:215</a></div></div>
<div class="ttc" id="aeamad_8c_html_a1bd38494185c28133622c86bcc95d650"><div class="ttname"><a href="eamad_8c.html#a1bd38494185c28133622c86bcc95d650">comp</a></div><div class="ttdeci">static void comp(unsigned char *dst, ptrdiff_t dst_stride, unsigned char *src, ptrdiff_t src_stride, int add)</div><div class="ttdef"><b>Definition:</b> <a href="eamad_8c_source.html#l00083">eamad.c:83</a></div></div>
<div class="ttc" id="agroup__lavu__string_html_ga47e14424edfb96d3f6bf0fca96a76fe5"><div class="ttname"><a href="group__lavu__string.html#ga47e14424edfb96d3f6bf0fca96a76fe5">av_stristr</a></div><div class="ttdeci">char * av_stristr(const char *s1, const char *s2)</div><div class="ttdef"><b>Definition:</b> <a href="avstring_8c_source.html#l00056">avstring.c:56</a></div></div>
<div class="ttc" id="apixdesc_8c_html_afe0c3e8aef5173de28bbdaea4298f5f0"><div class="ttname"><a href="pixdesc_8c.html#afe0c3e8aef5173de28bbdaea4298f5f0">av_pix_fmt_desc_get</a></div><div class="ttdeci">const AVPixFmtDescriptor * av_pix_fmt_desc_get(enum AVPixelFormat pix_fmt)</div><div class="ttdef"><b>Definition:</b> <a href="pixdesc_8c_source.html#l02573">pixdesc.c:2573</a></div></div>
<div class="ttc" id="amem_8c_html_a254f3455439c15a2c8a75b8f0235fdbd"><div class="ttname"><a href="mem_8c.html#a254f3455439c15a2c8a75b8f0235fdbd">av_malloc_array</a></div><div class="ttdeci">void * av_malloc_array(size_t nmemb, size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="mem_8c_source.html#l00182">mem.c:182</a></div></div>
<div class="ttc" id="astruct_open_c_l_device_selector_html_abae4e2d0e0e331d619ec3722d117bf3d"><div class="ttname"><a href="struct_open_c_l_device_selector.html#abae4e2d0e0e331d619ec3722d117bf3d">OpenCLDeviceSelector::device_index</a></div><div class="ttdeci">int device_index</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l00465">hwcontext_opencl.c:465</a></div></div>
<div class="ttc" id="astruct_a_v_open_c_l_frames_context_html_ac5ab8f934a1ba6fabedea8df2a71abb6"><div class="ttname"><a href="struct_a_v_open_c_l_frames_context.html#ac5ab8f934a1ba6fabedea8df2a71abb6">AVOpenCLFramesContext::command_queue</a></div><div class="ttdeci">cl_command_queue command_queue</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8h_source.html#l00097">hwcontext_opencl.h:97</a></div></div>
<div class="ttc" id="aattributes_8h_html_a7ca8a3900269f92fcc7b68235dea7787"><div class="ttname"><a href="attributes_8h.html#a7ca8a3900269f92fcc7b68235dea7787">av_unused</a></div><div class="ttdeci">#define av_unused</div><div class="ttdef"><b>Definition:</b> <a href="attributes_8h_source.html#l00133">attributes.h:133</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_a2365bbe035484ade150e495024dce3e6"><div class="ttname"><a href="hwcontext__opencl_8c.html#a2365bbe035484ade150e495024dce3e6">opencl_pool_alloc</a></div><div class="ttdeci">static AVBufferRef * opencl_pool_alloc(void *opaque, int size)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l01620">hwcontext_opencl.c:1620</a></div></div>
<div class="ttc" id="agroup__lavu__frame_html_ga979d73f3228814aee56aeca0636e37cc"><div class="ttname"><a href="group__lavu__frame.html#ga979d73f3228814aee56aeca0636e37cc">av_frame_free</a></div><div class="ttdeci">void av_frame_free(AVFrame **frame)</div><div class="ttdef"><b>Definition:</b> <a href="frame_8c_source.html#l00203">frame.c:203</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_frames_context_html_a69e956e8d2d73d65d015c4ed895ec642"><div class="ttname"><a href="struct_a_v_h_w_frames_context.html#a69e956e8d2d73d65d015c4ed895ec642">AVHWFramesContext::internal</a></div><div class="ttdeci">AVHWFramesInternal * internal</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00134">hwcontext.h:134</a></div></div>
<div class="ttc" id="agroup__avoptions_html_gga06fc87d81c62e9abb8790b6e5713c55bac12b0a2a379fe4b4b00353aac56ed9f4"><div class="ttname"><a href="group__avoptions.html#gga06fc87d81c62e9abb8790b6e5713c55bac12b0a2a379fe4b4b00353aac56ed9f4">AV_HWFRAME_MAP_OVERWRITE</a></div><div class="ttdeci">@ AV_HWFRAME_MAP_OVERWRITE</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00534">hwcontext.h:534</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_a4d9b3683895581878fa3eb0669e56d4f"><div class="ttname"><a href="hwcontext__opencl_8c.html#a4d9b3683895581878fa3eb0669e56d4f">type</a></div><div class="ttdeci">cl_device_type type</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l00192">hwcontext_opencl.c:192</a></div></div>
<div class="ttc" id="astruct_h_w_map_descriptor_html_a7ecea93e498181196f2121b85c07411d"><div class="ttname"><a href="struct_h_w_map_descriptor.html#a7ecea93e498181196f2121b85c07411d">HWMapDescriptor::priv</a></div><div class="ttdeci">void * priv</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__internal_8h_source.html#l00151">hwcontext_internal.h:151</a></div></div>
<div class="ttc" id="apixdesc_8h_html"><div class="ttname"><a href="pixdesc_8h.html">pixdesc.h</a></div></div>
<div class="ttc" id="arate__distortion_8txt_html_a0e018beb061c7ac6d1f9121683a6f2c2"><div class="ttname"><a href="rate__distortion_8txt.html#a0e018beb061c7ac6d1f9121683a6f2c2">step</a></div><div class="ttdeci">trying all byte sequences megabyte in length and selecting the best looking sequence will yield cases to try But a word about which is also called distortion Distortion can be quantified by almost any quality measurement one chooses the sum of squared differences is used but more complex methods that consider psychovisual effects can be used as well It makes no difference in this discussion First step</div><div class="ttdef"><b>Definition:</b> <a href="rate__distortion_8txt_source.html#l00019">rate_distortion.txt:58</a></div></div>
<div class="ttc" id="astruct_a_v_open_c_l_device_context_html"><div class="ttname"><a href="struct_a_v_open_c_l_device_context.html">AVOpenCLDeviceContext</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8h_source.html#l00063">hwcontext_opencl.h:63</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5a76a05fccc6f58f7ab655deefd794713e"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a76a05fccc6f58f7ab655deefd794713e">AV_PIX_FMT_DRM_PRIME</a></div><div class="ttdeci">@ AV_PIX_FMT_DRM_PRIME</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00328">pixfmt.h:328</a></div></div>
<div class="ttc" id="ahwcontext_8c_html_a99e028453fba7e66483c2189439219d2"><div class="ttname"><a href="hwcontext_8c.html#a99e028453fba7e66483c2189439219d2">av_hwframe_map</a></div><div class="ttdeci">int av_hwframe_map(AVFrame *dst, const AVFrame *src, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8c_source.html#l00789">hwcontext.c:789</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_ae48babfefabb13315734e94b1d367e94"><div class="ttname"><a href="hwcontext__opencl_8c.html#ae48babfefabb13315734e94b1d367e94">opencl_map_from</a></div><div class="ttdeci">static int opencl_map_from(AVHWFramesContext *hwfc, AVFrame *dst, const AVFrame *src, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l02801">hwcontext_opencl.c:2801</a></div></div>
<div class="ttc" id="amxf_8c_html_a084824fc871e38157790c99ae1240842"><div class="ttname"><a href="mxf_8c.html#a084824fc871e38157790c99ae1240842">data</a></div><div class="ttdeci">const char data[16]</div><div class="ttdef"><b>Definition:</b> <a href="mxf_8c_source.html#l00151">mxf.c:151</a></div></div>
<div class="ttc" id="astruct_a_v_d3_d11_v_a_frames_context_html_a359e4ccfa46c05a225947aea7ce7ac17"><div class="ttname"><a href="struct_a_v_d3_d11_v_a_frames_context.html#a359e4ccfa46c05a225947aea7ce7ac17">AVD3D11VAFramesContext::texture</a></div><div class="ttdeci">ID3D11Texture2D * texture</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__d3d11va_8h_source.html#l00152">hwcontext_d3d11va.h:152</a></div></div>
<div class="ttc" id="agroup__lavu__log__constants_html_ga9b58b28e2d429b930b69db19877f76a8"><div class="ttname"><a href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a></div><div class="ttdeci">#define AV_LOG_VERBOSE</div><div class="ttdef"><b>Definition:</b> <a href="log_8h_source.html#l00210">log.h:210</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_device_context_html_a46055b48d1a40445d775b4ae24f77f20"><div class="ttname"><a href="struct_a_v_h_w_device_context.html#a46055b48d1a40445d775b4ae24f77f20">AVHWDeviceContext::hwctx</a></div><div class="ttdeci">void * hwctx</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00092">hwcontext.h:92</a></div></div>
<div class="ttc" id="astruct_a_v_dictionary_entry_html"><div class="ttname"><a href="struct_a_v_dictionary_entry.html">AVDictionaryEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="dict_8h_source.html#l00081">dict.h:81</a></div></div>
<div class="ttc" id="agroup__lavu__buffer_html_ga3e7f4c92db85ccba0b2a16dd0069842a"><div class="ttname"><a href="group__lavu__buffer.html#ga3e7f4c92db85ccba0b2a16dd0069842a">av_buffer_create</a></div><div class="ttdeci">AVBufferRef * av_buffer_create(uint8_t *data, int size, void(*free)(void *opaque, uint8_t *data), void *opaque, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00029">buffer.c:29</a></div></div>
<div class="ttc" id="ahwcontext_8c_html_a76e0387f519b3f1bd1b162e91b54b182"><div class="ttname"><a href="hwcontext_8c.html#a76e0387f519b3f1bd1b162e91b54b182">ff_hwframe_map_create</a></div><div class="ttdeci">int ff_hwframe_map_create(AVBufferRef *hwframe_ref, AVFrame *dst, const AVFrame *src, void(*unmap)(AVHWFramesContext *ctx, HWMapDescriptor *hwmap), void *priv)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8c_source.html#l00737">hwcontext.c:737</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_a6087c755c95064e4547b2b629d483e41"><div class="ttname"><a href="hwcontext__opencl_8c.html#a6087c755c95064e4547b2b629d483e41">name</a></div><div class="ttdeci">cl_platform_info name</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l00169">hwcontext_opencl.c:169</a></div></div>
<div class="ttc" id="agroup__lavu__error_html_ga4ebaa288c7684a26a591c501208910e4"><div class="ttname"><a href="group__lavu__error.html#ga4ebaa288c7684a26a591c501208910e4">AVERROR_UNKNOWN</a></div><div class="ttdeci">#define AVERROR_UNKNOWN</div><div class="ttdoc">Unknown error, typically from an external library.</div><div class="ttdef"><b>Definition:</b> <a href="error_8h_source.html#l00071">error.h:71</a></div></div>
<div class="ttc" id="astruct_a_v_d_x_v_a2_frames_context_html_a2025b21fc7ec906713c525a702fd6eb7"><div class="ttname"><a href="struct_a_v_d_x_v_a2_frames_context.html#a2025b21fc7ec906713c525a702fd6eb7">AVDXVA2FramesContext::surfaces</a></div><div class="ttdeci">IDirect3DSurface9 ** surfaces</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__dxva2_8h_source.html#l00058">hwcontext_dxva2.h:58</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_a9764b26a9d3a958cb23c49535ef72b06"><div class="ttname"><a href="hwcontext__opencl_8c.html#a9764b26a9d3a958cb23c49535ef72b06">OpenCLDeviceContext</a></div><div class="ttdeci">struct OpenCLDeviceContext OpenCLDeviceContext</div></div>
<div class="ttc" id="astruct_a_v_open_c_l_device_context_html_a221b6ee3b0538276cc28367ed0dccec2"><div class="ttname"><a href="struct_a_v_open_c_l_device_context.html#a221b6ee3b0538276cc28367ed0dccec2">AVOpenCLDeviceContext::device_id</a></div><div class="ttdeci">cl_device_id device_id</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8h_source.html#l00069">hwcontext_opencl.h:69</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_device_internal_html_ae7425663cca9541964518c66974a20bf"><div class="ttname"><a href="struct_a_v_h_w_device_internal.html#ae7425663cca9541964518c66974a20bf">AVHWDeviceInternal::priv</a></div><div class="ttdeci">void * priv</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__internal_8h_source.html#l00105">hwcontext_internal.h:105</a></div></div>
<div class="ttc" id="astruct_a_v_d_r_m_plane_descriptor_html_af1a0839b02055445257d431d946d96a7"><div class="ttname"><a href="struct_a_v_d_r_m_plane_descriptor.html#af1a0839b02055445257d431d946d96a7">AVDRMPlaneDescriptor::offset</a></div><div class="ttdeci">ptrdiff_t offset</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__drm_8h_source.html#l00083">hwcontext_drm.h:83</a></div></div>
<div class="ttc" id="atableprint__vlc_8h_html_ae97db1f58b6b1515ed57a83bea3dd572"><div class="ttname"><a href="tableprint__vlc_8h.html#ae97db1f58b6b1515ed57a83bea3dd572">av_malloc</a></div><div class="ttdeci">#define av_malloc(s)</div><div class="ttdef"><b>Definition:</b> <a href="tableprint__vlc_8h_source.html#l00031">tableprint_vlc.h:31</a></div></div>
<div class="ttc" id="avf__median_8c_html_ac1b69496bb6a841ecafe6876734708c3"><div class="ttname"><a href="vf__median_8c.html#ac1b69496bb6a841ecafe6876734708c3">hsub</a></div><div class="ttdeci">static void hsub(htype *dst, const htype *src, int bins)</div><div class="ttdef"><b>Definition:</b> <a href="vf__median_8c_source.html#l00075">vf_median.c:75</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5a28369916d5c0317168b7d1b6c22e3ba6"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a28369916d5c0317168b7d1b6c22e3ba6">AV_PIX_FMT_NB</a></div><div class="ttdeci">@ AV_PIX_FMT_NB</div><div class="ttdoc">number of pixel formats, DO NOT USE THIS if you want to link with shared libav* because the number of...</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00364">pixfmt.h:363</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_a3d7e715051fd71f6792081b679794a32"><div class="ttname"><a href="hwcontext__opencl_8c.html#a3d7e715051fd71f6792081b679794a32">opencl_map_to</a></div><div class="ttdeci">static int opencl_map_to(AVHWFramesContext *hwfc, AVFrame *dst, const AVFrame *src, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l02810">hwcontext_opencl.c:2810</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_ae6f10ee0c7f06ca57f7f37c7d7575086"><div class="ttname"><a href="hwcontext__opencl_8c.html#ae6f10ee0c7f06ca57f7f37c7d7575086">opencl_enumerate_devices</a></div><div class="ttdeci">static int opencl_enumerate_devices(AVHWDeviceContext *hwdev, cl_platform_id platform_id, const char *platform_name, cl_uint *nb_devices, cl_device_id **devices, void *context)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l00357">hwcontext_opencl.c:357</a></div></div>
<div class="ttc" id="astruct_a_v_frame_html_a29493fbfabaa21432c360a090426aa8e"><div class="ttname"><a href="struct_a_v_frame.html#a29493fbfabaa21432c360a090426aa8e">AVFrame::hw_frames_ctx</a></div><div class="ttdeci">AVBufferRef * hw_frames_ctx</div><div class="ttdef"><b>Definition:</b> <a href="frame_8h_source.html#l00647">frame.h:647</a></div></div>
<div class="ttc" id="astruct_open_c_l_frames_context_html_aebaf993c59ba7717dc4dbff4a2e57668"><div class="ttname"><a href="struct_open_c_l_frames_context.html#aebaf993c59ba7717dc4dbff4a2e57668">OpenCLFramesContext::command_queue</a></div><div class="ttdeci">cl_command_queue command_queue</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l00134">hwcontext_opencl.c:134</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_frames_constraints_html_a4258bbe81f927b76b7ca5af44ba7ef6b"><div class="ttname"><a href="struct_a_v_h_w_frames_constraints.html#a4258bbe81f927b76b7ca5af44ba7ef6b">AVHWFramesConstraints::valid_hw_formats</a></div><div class="ttdeci">enum AVPixelFormat * valid_hw_formats</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00458">hwcontext.h:458</a></div></div>
<div class="ttc" id="astruct_open_c_l_frames_context_html"><div class="ttname"><a href="struct_open_c_l_frames_context.html">OpenCLFramesContext</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l00129">hwcontext_opencl.c:129</a></div></div>
<div class="ttc" id="acheckasm_8h_html_a73a3b169ac8c3419cbe15327e75ffcfd"><div class="ttname"><a href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a></div><div class="ttdeci">#define fail()</div><div class="ttdef"><b>Definition:</b> <a href="checkasm_8h_source.html#l00123">checkasm.h:123</a></div></div>
<div class="ttc" id="apixdesc_8h_html_a76f6211b2404231bd7d206ebf4ae46f6"><div class="ttname"><a href="pixdesc_8h.html#a76f6211b2404231bd7d206ebf4ae46f6">AV_PIX_FMT_FLAG_HWACCEL</a></div><div class="ttdeci">#define AV_PIX_FMT_FLAG_HWACCEL</div><div class="ttdef"><b>Definition:</b> <a href="pixdesc_8h_source.html#l00140">pixdesc.h:140</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_af2c66952db60f2cdd30b7c6c00b80a64"><div class="ttname"><a href="hwcontext__opencl_8c.html#af2c66952db60f2cdd30b7c6c00b80a64">opencl_get_plane_format</a></div><div class="ttdeci">static int opencl_get_plane_format(enum AVPixelFormat pixfmt, int plane, int width, int height, cl_image_format *image_format, cl_image_desc *image_desc)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l01369">hwcontext_opencl.c:1369</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_a5644eb404ac92daf899141490b2f83d8"><div class="ttname"><a href="hwcontext__opencl_8c.html#a5644eb404ac92daf899141490b2f83d8">opencl_frames_init</a></div><div class="ttdeci">static int opencl_frames_init(AVHWFramesContext *hwfc)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l01695">hwcontext_opencl.c:1695</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_afe78af15c378fc40f3d89399d83d8ad2"><div class="ttname"><a href="hwcontext__opencl_8c.html#afe78af15c378fc40f3d89399d83d8ad2">opencl_check_platform_extension</a></div><div class="ttdeci">static int opencl_check_platform_extension(cl_platform_id platform_id, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l00244">hwcontext_opencl.c:244</a></div></div>
<div class="ttc" id="ahwcontext_8h_html_acf25724be4b066a51ad86aa9214b0d34a1823a64d48c796978b892dd669659c4c"><div class="ttname"><a href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34a1823a64d48c796978b892dd669659c4c">AV_HWDEVICE_TYPE_D3D11VA</a></div><div class="ttdeci">@ AV_HWDEVICE_TYPE_D3D11VA</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00035">hwcontext.h:35</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_af42f65b808f46810f0b04b7f93f38eaf"><div class="ttname"><a href="hwcontext__opencl_8c.html#af42f65b808f46810f0b04b7f93f38eaf">opencl_device_derive</a></div><div class="ttdeci">static int opencl_device_derive(AVHWDeviceContext *hwdev, AVHWDeviceContext *src_ctx, AVDictionary *opts, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l01196">hwcontext_opencl.c:1196</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_a1b604f01d7cd8967f384e0a8a8675a82"><div class="ttname"><a href="hwcontext__opencl_8c.html#a1b604f01d7cd8967f384e0a8a8675a82">opencl_device_free</a></div><div class="ttdeci">static void opencl_device_free(AVHWDeviceContext *hwdev)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l00155">hwcontext_opencl.c:155</a></div></div>
<div class="ttc" id="astruct_open_c_l_device_context_html_ae29e4d0d149bedcd5d69ee60d79d549d"><div class="ttname"><a href="struct_open_c_l_device_context.html#ae29e4d0d149bedcd5d69ee60d79d549d">OpenCLDeviceContext::command_queue</a></div><div class="ttdeci">cl_command_queue command_queue</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l00080">hwcontext_opencl.c:80</a></div></div>
<div class="ttc" id="astruct_open_c_l_device_context_html"><div class="ttname"><a href="struct_open_c_l_device_context.html">OpenCLDeviceContext</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l00076">hwcontext_opencl.c:76</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_a12846156848aad117b3fe7314b2ec8f5"><div class="ttname"><a href="hwcontext__opencl_8c.html#a12846156848aad117b3fe7314b2ec8f5">OpenCLFramesContext</a></div><div class="ttdeci">struct OpenCLFramesContext OpenCLFramesContext</div></div>
<div class="ttc" id="astruct_a_v_d3_d11_v_a_frames_context_html"><div class="ttname"><a href="struct_a_v_d3_d11_v_a_frames_context.html">AVD3D11VAFramesContext</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__d3d11va_8h_source.html#l00131">hwcontext_d3d11va.h:131</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_frames_context_html_a9c3a94dcd9c96e19059b56a6bae9c764"><div class="ttname"><a href="struct_a_v_h_w_frames_context.html#a9c3a94dcd9c96e19059b56a6bae9c764">AVHWFramesContext::initial_pool_size</a></div><div class="ttdeci">int initial_pool_size</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00199">hwcontext.h:199</a></div></div>
<div class="ttc" id="astruct_a_v_d_r_m_plane_descriptor_html_af07fe11d604e0a3b5fd934f9626c008b"><div class="ttname"><a href="struct_a_v_d_r_m_plane_descriptor.html#af07fe11d604e0a3b5fd934f9626c008b">AVDRMPlaneDescriptor::object_index</a></div><div class="ttdeci">int object_index</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__drm_8h_source.html#l00079">hwcontext_drm.h:79</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_a377664ee715aeee2c8d3f042a365f471"><div class="ttname"><a href="hwcontext__opencl_8c.html#a377664ee715aeee2c8d3f042a365f471">opencl_check_device_extension</a></div><div class="ttdeci">static int opencl_check_device_extension(cl_device_id device_id, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l00257">hwcontext_opencl.c:257</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_device_context_html"><div class="ttname"><a href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00061">hwcontext.h:61</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_af79e4113dba0b404fdeacca66238957a"><div class="ttname"><a href="hwcontext__opencl_8c.html#af79e4113dba0b404fdeacca66238957a">opencl_map_frame</a></div><div class="ttdeci">static int opencl_map_frame(AVHWFramesContext *hwfc, AVFrame *dst, const AVFrame *src, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l01947">hwcontext_opencl.c:1947</a></div></div>
<div class="ttc" id="agroup__lavu__frame_html_gac700017c5270c79c1e1befdeeb008b2f"><div class="ttname"><a href="group__lavu__frame.html#gac700017c5270c79c1e1befdeeb008b2f">av_frame_alloc</a></div><div class="ttdeci">AVFrame * av_frame_alloc(void)</div><div class="ttdef"><b>Definition:</b> <a href="frame_8c_source.html#l00190">frame.c:190</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_frames_context_html_ae61bbe1d8645a0c573085e29f1d0a58f"><div class="ttname"><a href="struct_a_v_h_w_frames_context.html#ae61bbe1d8645a0c573085e29f1d0a58f">AVHWFramesContext::height</a></div><div class="ttdeci">int height</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00229">hwcontext.h:229</a></div></div>
<div class="ttc" id="astruct_a_v_v_a_a_p_i_device_context_html_a89951d5ccfad53ce81444773ea9f774e"><div class="ttname"><a href="struct_a_v_v_a_a_p_i_device_context.html#a89951d5ccfad53ce81444773ea9f774e">AVVAAPIDeviceContext::display</a></div><div class="ttdeci">VADisplay display</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__vaapi_8h_source.html#l00072">hwcontext_vaapi.h:72</a></div></div>
<div class="ttc" id="agroup__avoptions_html_gga06fc87d81c62e9abb8790b6e5713c55ba236262031fe4c5503b2611c2c8fb520b"><div class="ttname"><a href="group__avoptions.html#gga06fc87d81c62e9abb8790b6e5713c55ba236262031fe4c5503b2611c2c8fb520b">AV_HWFRAME_MAP_READ</a></div><div class="ttdeci">@ AV_HWFRAME_MAP_READ</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00524">hwcontext.h:524</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_a76a0f6d26efbde213a0475628a01b4d2"><div class="ttname"><a href="hwcontext__opencl_8c.html#a76a0f6d26efbde213a0475628a01b4d2">opencl_device_types</a></div><div class="ttdeci">static struct @2 opencl_device_types[]</div></div>
<div class="ttc" id="astruct_open_c_l_device_selector_html_a1a03a7f88025b3b7dc8f85c1070f569a"><div class="ttname"><a href="struct_open_c_l_device_selector.html#a1a03a7f88025b3b7dc8f85c1070f569a">OpenCLDeviceSelector::enumerate_platforms</a></div><div class="ttdeci">int(* enumerate_platforms)(AVHWDeviceContext *hwdev, cl_uint *nb_platforms, cl_platform_id **platforms, void *context)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l00467">hwcontext_opencl.c:467</a></div></div>
<div class="ttc" id="aavassert_8h_html"><div class="ttname"><a href="avassert_8h.html">avassert.h</a></div></div>
<div class="ttc" id="astruct_h_w_map_descriptor_html_aac9a3c77af4a936a326770ee5973e261"><div class="ttname"><a href="struct_h_w_map_descriptor.html#aac9a3c77af4a936a326770ee5973e261">HWMapDescriptor::source</a></div><div class="ttdeci">AVFrame * source</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__internal_8h_source.html#l00136">hwcontext_internal.h:136</a></div></div>
<div class="ttc" id="agroup__avoptions_html_gga06fc87d81c62e9abb8790b6e5713c55ba8f29c39f016d0bf9a006b180b859ba4f"><div class="ttname"><a href="group__avoptions.html#gga06fc87d81c62e9abb8790b6e5713c55ba8f29c39f016d0bf9a006b180b859ba4f">AV_DRM_MAX_PLANES</a></div><div class="ttdeci">@ AV_DRM_MAX_PLANES</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__drm_8h_source.html#l00040">hwcontext_drm.h:39</a></div></div>
<div class="ttc" id="agroup__lavu__log__constants_html_gaffe151ff4cd8a24b2e77ac8d9616c85c"><div class="ttname"><a href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a></div><div class="ttdeci">#define AV_LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="log_8h_source.html#l00194">log.h:194</a></div></div>
<div class="ttc" id="astruct_open_c_l_device_selector_html_ab678e3e7946a9d3dd1bacdc67e3d6976"><div class="ttname"><a href="struct_open_c_l_device_selector.html#ab678e3e7946a9d3dd1bacdc67e3d6976">OpenCLDeviceSelector::filter_device</a></div><div class="ttdeci">int(* filter_device)(AVHWDeviceContext *hwdev, cl_device_id device_id, const char *device_name, void *context)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l00481">hwcontext_opencl.c:481</a></div></div>
<div class="ttc" id="agroup__lavu__dict_html_gae67f143237b2cb2936c9b147aa6dfde3"><div class="ttname"><a href="group__lavu__dict.html#gae67f143237b2cb2936c9b147aa6dfde3">av_dict_get</a></div><div class="ttdeci">AVDictionaryEntry * av_dict_get(const AVDictionary *m, const char *key, const AVDictionaryEntry *prev, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="dict_8c_source.html#l00040">dict.c:40</a></div></div>
<div class="ttc" id="agroup__lavu__bufferpool_html_ga2c745ecb4001452423e775b06b20fb7c"><div class="ttname"><a href="group__lavu__bufferpool.html#ga2c745ecb4001452423e775b06b20fb7c">av_buffer_pool_get</a></div><div class="ttdeci">AVBufferRef * av_buffer_pool_get(AVBufferPool *pool)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00364">buffer.c:364</a></div></div>
<div class="ttc" id="atests_2snowenc_8c_html_a667b04d7fb6ef46db4da4af554c5b6f7"><div class="ttname"><a href="tests_2snowenc_8c.html#a667b04d7fb6ef46db4da4af554c5b6f7">width</a></div><div class="ttdeci">#define width</div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5a35e418d6581792c6daa3c0aaba601cb1"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a35e418d6581792c6daa3c0aaba601cb1">AV_PIX_FMT_DXVA2_VLD</a></div><div class="ttdeci">@ AV_PIX_FMT_DXVA2_VLD</div><div class="ttdoc">HW decoding through DXVA2, Picture.data[3] contains a LPDIRECT3DSURFACE9 pointer.</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00137">pixfmt.h:137</a></div></div>
<div class="ttc" id="astruct_a_v_dictionary_entry_html_aa38678f2cad36f120d42e56449c5edb4"><div class="ttname"><a href="struct_a_v_dictionary_entry.html#aa38678f2cad36f120d42e56449c5edb4">AVDictionaryEntry::value</a></div><div class="ttdeci">char * value</div><div class="ttdef"><b>Definition:</b> <a href="dict_8h_source.html#l00083">dict.h:83</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_af92fcebe33b9d2f8af5d8796e2b33846"><div class="ttname"><a href="hwcontext__opencl_8c.html#af92fcebe33b9d2f8af5d8796e2b33846">opencl_filter_device</a></div><div class="ttdeci">static int opencl_filter_device(AVHWDeviceContext *hwdev, cl_device_id device_id, const char *device_name, void *context)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l00397">hwcontext_opencl.c:397</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_a3319ca8d01f0235b06fa3fa57cf4f7af"><div class="ttname"><a href="hwcontext__opencl_8c.html#a3319ca8d01f0235b06fa3fa57cf4f7af">OpenCLMapping</a></div><div class="ttdeci">struct OpenCLMapping OpenCLMapping</div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_a09499e0a4ce56a9a3642e7e3b27f7e86"><div class="ttname"><a href="hwcontext__opencl_8c.html#a09499e0a4ce56a9a3642e7e3b27f7e86">CHANNEL_ORDER</a></div><div class="ttdeci">#define CHANNEL_ORDER(order, type)</div></div>
<div class="ttc" id="aavassert_8h_html_aae204192396f78cc8c5cd7ad5c57c23f"><div class="ttname"><a href="avassert_8h.html#aae204192396f78cc8c5cd7ad5c57c23f">av_assert0</a></div><div class="ttdeci">#define av_assert0(cond)</div><div class="ttdef"><b>Definition:</b> <a href="avassert_8h_source.html#l00037">avassert.h:37</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_a0a9234d6a5cca399a1ea034d9f360ba4"><div class="ttname"><a href="hwcontext__opencl_8c.html#a0a9234d6a5cca399a1ea034d9f360ba4">opencl_frames_get_constraints</a></div><div class="ttdeci">static int opencl_frames_get_constraints(AVHWDeviceContext *hwdev, const void *hwconfig, AVHWFramesConstraints *constraints)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l01475">hwcontext_opencl.c:1475</a></div></div>
<div class="ttc" id="agroup__lavu__log__constants_html_ga5b7221c3afd06848486776bd834a58a5"><div class="ttname"><a href="group__lavu__log__constants.html#ga5b7221c3afd06848486776bd834a58a5">AV_LOG_DEBUG</a></div><div class="ttdeci">#define AV_LOG_DEBUG</div><div class="ttdef"><b>Definition:</b> <a href="log_8h_source.html#l00215">log.h:215</a></div></div>
<div class="ttc" id="astruct_a_v_open_c_l_device_context_html_a5152eb3c345fd6ead8ffa9e602293d20"><div class="ttname"><a href="struct_a_v_open_c_l_device_context.html#a5152eb3c345fd6ead8ffa9e602293d20">AVOpenCLDeviceContext::context</a></div><div class="ttdeci">cl_context context</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8h_source.html#l00074">hwcontext_opencl.h:74</a></div></div>
<div class="ttc" id="apixdesc_8h_html_a06924ef0ebf07d8742ff8994e3a948bf"><div class="ttname"><a href="pixdesc_8h.html#a06924ef0ebf07d8742ff8994e3a948bf">AV_PIX_FMT_FLAG_ALPHA</a></div><div class="ttdeci">#define AV_PIX_FMT_FLAG_ALPHA</div><div class="ttdef"><b>Definition:</b> <a href="pixdesc_8h_source.html#l00179">pixdesc.h:179</a></div></div>
<div class="ttc" id="atests_2movenc_8c_html_a93cc7296f13f507c1fd7abd0db36b898"><div class="ttname"><a href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a></div><div class="ttdeci">AVFormatContext * ctx</div><div class="ttdef"><b>Definition:</b> <a href="tests_2movenc_8c_source.html#l00048">movenc.c:48</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_frames_constraints_html_aabea88093c6f85d6185ffb0852a2217f"><div class="ttname"><a href="struct_a_v_h_w_frames_constraints.html#aabea88093c6f85d6185ffb0852a2217f">AVHWFramesConstraints::valid_sw_formats</a></div><div class="ttdeci">enum AVPixelFormat * valid_sw_formats</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00465">hwcontext.h:465</a></div></div>
<div class="ttc" id="aaptx_8h_html_ac9da8d7a4bd192b8a7dccbc024542709"><div class="ttname"><a href="aptx_8h.html#ac9da8d7a4bd192b8a7dccbc024542709">channels</a></div><div class="ttdeci">channels</div><div class="ttdef"><b>Definition:</b> <a href="aptx_8h_source.html#l00033">aptx.h:33</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_acb5fdd8e42701ef8385fbcec868dc6c4"><div class="ttname"><a href="hwcontext__opencl_8c.html#acb5fdd8e42701ef8385fbcec868dc6c4">CL_FUNC</a></div><div class="ttdeci">#define CL_FUNC(name, desc)</div></div>
<div class="ttc" id="ademuxing__decoding_8c_html_a7331e302ea7bb48e0b605a069576e135"><div class="ttname"><a href="demuxing__decoding_8c.html#a7331e302ea7bb48e0b605a069576e135">pix_fmt</a></div><div class="ttdeci">static enum AVPixelFormat pix_fmt</div><div class="ttdef"><b>Definition:</b> <a href="demuxing__decoding_8c_source.html#l00039">demuxing_decoding.c:40</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_frames_internal_html_a2858e1cd83082cc8bcbbf581283e7af2"><div class="ttname"><a href="struct_a_v_h_w_frames_internal.html#a2858e1cd83082cc8bcbbf581283e7af2">AVHWFramesInternal::pool_internal</a></div><div class="ttdeci">AVBufferPool * pool_internal</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__internal_8h_source.html#l00118">hwcontext_internal.h:118</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_acd3d88da3c0e0313c3645ff34f62f542"><div class="ttname"><a href="hwcontext__opencl_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a></div><div class="ttdeci">const char * key</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l00168">hwcontext_opencl.c:168</a></div></div>
<div class="ttc" id="astruct_open_c_l_mapping_html_a78b07d8a8f382df5e5b3f650e21506b6"><div class="ttname"><a href="struct_open_c_l_mapping.html#a78b07d8a8f382df5e5b3f650e21506b6">OpenCLMapping::address</a></div><div class="ttdeci">void * address[AV_NUM_DATA_POINTERS]</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l01915">hwcontext_opencl.c:1915</a></div></div>
<div class="ttc" id="afilter__design_8txt_html_a0e82f1088fdc24c14bf175d2ac77523f"><div class="ttname"><a href="filter__design_8txt.html#a0e82f1088fdc24c14bf175d2ac77523f">if</a></div><div class="ttdeci">if(ret)</div><div class="ttdef"><b>Definition:</b> <a href="filter__design_8txt_source.html#l00179">filter_design.txt:179</a></div></div>
<div class="ttc" id="awriting__filters_8txt_html_a5b5446e1f47af0c85ac6b45210d45117"><div class="ttname"><a href="writing__filters_8txt.html#a5b5446e1f47af0c85ac6b45210d45117">context</a></div><div class="ttdeci">it s the only field you need to keep assuming you have a context There is some magic you don t need to care about around this just let it vf default minimum maximum flags name is the option keep it simple and lowercase description are in without and describe what they for example set the foo of the bar offset is the offset of the field in your context</div><div class="ttdef"><b>Definition:</b> <a href="writing__filters_8txt_source.html#l00091">writing_filters.txt:91</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_af1e17c9169a69d720eac8ba83d756f0f"><div class="ttname"><a href="hwcontext__opencl_8c.html#af1e17c9169a69d720eac8ba83d756f0f">opencl_transfer_get_formats</a></div><div class="ttdeci">static int opencl_transfer_get_formats(AVHWFramesContext *hwfc, enum AVHWFrameTransferDirection dir, enum AVPixelFormat **formats)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l01760">hwcontext_opencl.c:1760</a></div></div>
<div class="ttc" id="atests_2movenc_8c_html_af540b728145b614e34c4e10930354b93"><div class="ttname"><a href="tests_2movenc_8c.html#af540b728145b614e34c4e10930354b93">opts</a></div><div class="ttdeci">AVDictionary * opts</div><div class="ttdef"><b>Definition:</b> <a href="tests_2movenc_8c_source.html#l00050">movenc.c:50</a></div></div>
<div class="ttc" id="astruct_a_v_d3_d11_v_a_device_context_html_a846ae4cb1f91302845776cc843dc2808"><div class="ttname"><a href="struct_a_v_d3_d11_v_a_device_context.html#a846ae4cb1f91302845776cc843dc2808">AVD3D11VADeviceContext::device</a></div><div class="ttdeci">ID3D11Device * device</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__d3d11va_8h_source.html#l00056">hwcontext_d3d11va.h:56</a></div></div>
<div class="ttc" id="astruct_a_v_d_r_m_plane_descriptor_html"><div class="ttname"><a href="struct_a_v_d_r_m_plane_descriptor.html">AVDRMPlaneDescriptor</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__drm_8h_source.html#l00074">hwcontext_drm.h:74</a></div></div>
<div class="ttc" id="acoverity_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="coverity_8c_source.html#l00032">coverity.c:32</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_ae0fd7381d69c6c5aff42004d71bb217f"><div class="ttname"><a href="hwcontext__opencl_8c.html#ae0fd7381d69c6c5aff42004d71bb217f">opencl_frames_uninit</a></div><div class="ttdeci">static void opencl_frames_uninit(AVHWFramesContext *hwfc)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l01708">hwcontext_opencl.c:1708</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_ad933f1f898a2be64f81d92fa4024e52c"><div class="ttname"><a href="hwcontext__opencl_8c.html#ad933f1f898a2be64f81d92fa4024e52c">opencl_device_create_internal</a></div><div class="ttdeci">static int opencl_device_create_internal(AVHWDeviceContext *hwdev, const OpenCLDeviceSelector *selector, cl_context_properties *props)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l00487">hwcontext_opencl.c:487</a></div></div>
<div class="ttc" id="ahwcontext_8h_html_acf25724be4b066a51ad86aa9214b0d34acc6f1868dad1c636d4747cc91ce71d10"><div class="ttname"><a href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34acc6f1868dad1c636d4747cc91ce71d10">AV_HWDEVICE_TYPE_DXVA2</a></div><div class="ttdeci">@ AV_HWDEVICE_TYPE_DXVA2</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00032">hwcontext.h:32</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_frames_context_html"><div class="ttname"><a href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00124">hwcontext.h:124</a></div></div>
<div class="ttc" id="astruct_a_v_component_descriptor_html"><div class="ttname"><a href="struct_a_v_component_descriptor.html">AVComponentDescriptor</a></div><div class="ttdef"><b>Definition:</b> <a href="pixdesc_8h_source.html#l00031">pixdesc.h:31</a></div></div>
<div class="ttc" id="astruct_a_v_dictionary_entry_html_a38fc80176f8f839282bb61c03392e194"><div class="ttname"><a href="struct_a_v_dictionary_entry.html#a38fc80176f8f839282bb61c03392e194">AVDictionaryEntry::key</a></div><div class="ttdeci">char * key</div><div class="ttdef"><b>Definition:</b> <a href="dict_8h_source.html#l00082">dict.h:82</a></div></div>
<div class="ttc" id="atests_2checkasm_2vp8dsp_8c_html_a858376c0918f93e656c8c0d76c63dbe8"><div class="ttname"><a href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a></div><div class="ttdeci">#define src</div><div class="ttdef"><b>Definition:</b> <a href="tests_2checkasm_2vp8dsp_8c_source.html#l00254">vp8dsp.c:254</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8h_html_aaaea4767b6c6fca5cfdbb090f579c6b5"><div class="ttname"><a href="hwcontext__opencl_8h.html#aaaea4767b6c6fca5cfdbb090f579c6b5">AVOpenCLFramesContext</a></div><div class="ttdeci">struct AVOpenCLFramesContext AVOpenCLFramesContext</div></div>
<div class="ttc" id="astruct_a_v_d3_d11_v_a_device_context_html"><div class="ttname"><a href="struct_a_v_d3_d11_v_a_device_context.html">AVD3D11VADeviceContext</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__d3d11va_8h_source.html#l00045">hwcontext_d3d11va.h:45</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_a348344b15f15878dc1077cda3655be1e"><div class="ttname"><a href="hwcontext__opencl_8c.html#a348344b15f15878dc1077cda3655be1e">opencl_transfer_data_from</a></div><div class="ttdeci">static int opencl_transfer_data_from(AVHWFramesContext *hwfc, AVFrame *dst, const AVFrame *src)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l01801">hwcontext_opencl.c:1801</a></div></div>
<div class="ttc" id="astruct_a_v_d_r_m_plane_descriptor_html_aa4eaa5a37f40dd7301ce1b8194eefc0a"><div class="ttname"><a href="struct_a_v_d_r_m_plane_descriptor.html#aa4eaa5a37f40dd7301ce1b8194eefc0a">AVDRMPlaneDescriptor::pitch</a></div><div class="ttdeci">ptrdiff_t pitch</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__drm_8h_source.html#l00087">hwcontext_drm.h:87</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5a9033468a02331a128ba10d84f55f253d"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a9033468a02331a128ba10d84f55f253d">AV_PIX_FMT_OPENCL</a></div><div class="ttdeci">@ AV_PIX_FMT_OPENCL</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00335">pixfmt.h:335</a></div></div>
<div class="ttc" id="astruct_a_v_pix_fmt_descriptor_html"><div class="ttname"><a href="struct_a_v_pix_fmt_descriptor.html">AVPixFmtDescriptor</a></div><div class="ttdef"><b>Definition:</b> <a href="pixdesc_8h_source.html#l00081">pixdesc.h:81</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5ac913414b6091ce30035b21b9c0bc1c8e"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5ac913414b6091ce30035b21b9c0bc1c8e">AV_PIX_FMT_QSV</a></div><div class="ttdeci">@ AV_PIX_FMT_QSV</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00222">pixfmt.h:222</a></div></div>
<div class="ttc" id="astruct_open_c_l_device_selector_html_a70747e251dd97e499282089b6145951e"><div class="ttname"><a href="struct_open_c_l_device_selector.html#a70747e251dd97e499282089b6145951e">OpenCLDeviceSelector::context</a></div><div class="ttdeci">void * context</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l00466">hwcontext_opencl.c:466</a></div></div>
<div class="ttc" id="agxfenc_8c_html_a750b5d744c39a06bfb13e6eb010e35d0"><div class="ttname"><a href="gxfenc_8c.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a></div><div class="ttdeci">int index</div><div class="ttdef"><b>Definition:</b> <a href="gxfenc_8c_source.html#l00089">gxfenc.c:89</a></div></div>
<div class="ttc" id="aundefined_8txt_html_a12d8853991e25cc8d069554379c29ef6"><div class="ttname"><a href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a></div><div class="ttdeci">Undefined Behavior In the C some operations are like signed integer dereferencing freed accessing outside allocated Undefined Behavior must not occur in a C it is not safe even if the output of undefined operations is unused The unsafety may seem nit picking but Optimizing compilers have in fact optimized code on the assumption that no undefined Behavior occurs Optimizing code based on wrong assumptions can and has in some cases lead to effects beyond the output of computations The signed integer overflow problem in speed critical code Code which is highly optimized and works with signed integers sometimes has the problem that often the output of the computation does not c</div><div class="ttdef"><b>Definition:</b> <a href="undefined_8txt_source.html#l00032">undefined.txt:32</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_frames_internal_html_a503cfeb391ed69856344768fd641a489"><div class="ttname"><a href="struct_a_v_h_w_frames_internal.html#a503cfeb391ed69856344768fd641a489">AVHWFramesInternal::priv</a></div><div class="ttdeci">void * priv</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__internal_8h_source.html#l00116">hwcontext_internal.h:116</a></div></div>
<div class="ttc" id="astruct_a_v_frame_html_a3f89733f429c98ba5bc64373fb0a3f13"><div class="ttname"><a href="struct_a_v_frame.html#a3f89733f429c98ba5bc64373fb0a3f13">AVFrame::height</a></div><div class="ttdeci">int height</div><div class="ttdef"><b>Definition:</b> <a href="frame_8h_source.html#l00366">frame.h:366</a></div></div>
<div class="ttc" id="ah264pred__template_8c_html_a93cca9adbbca82ea00bf3250781f6dce"><div class="ttname"><a href="h264pred__template_8c.html#a93cca9adbbca82ea00bf3250781f6dce">for</a></div><div class="ttdeci">for(j=16;j &gt;0;--j)</div><div class="ttdef"><b>Definition:</b> <a href="h264pred__template_8c_source.html#l00469">h264pred_template.c:469</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_frames_constraints_html"><div class="ttname"><a href="struct_a_v_h_w_frames_constraints.html">AVHWFramesConstraints</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00453">hwcontext.h:453</a></div></div>
<div class="ttc" id="agroup__lavu__mem__funcs_html_gaf143ecab33a3868b57345466c39de7c1"><div class="ttname"><a href="group__lavu__mem__funcs.html#gaf143ecab33a3868b57345466c39de7c1">av_mallocz</a></div><div class="ttdeci">void * av_mallocz(size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="mem_8c_source.html#l00237">mem.c:237</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_a0e35d0e2185a2bf214bf4249af3731d7"><div class="ttname"><a href="hwcontext__opencl_8c.html#a0e35d0e2185a2bf214bf4249af3731d7">opencl_wait_events</a></div><div class="ttdeci">static int opencl_wait_events(AVHWFramesContext *hwfc, cl_event *events, int nb_events)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l01777">hwcontext_opencl.c:1777</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_frames_context_html_a54e38c3e4355321e23e0f4c7411cb8ee"><div class="ttname"><a href="struct_a_v_h_w_frames_context.html#a54e38c3e4355321e23e0f4c7411cb8ee">AVHWFramesContext::hwctx</a></div><div class="ttdeci">void * hwctx</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00162">hwcontext.h:162</a></div></div>
<div class="ttc" id="ahwcontext__dxva2_8h_html"><div class="ttname"><a href="hwcontext__dxva2_8h.html">hwcontext_dxva2.h</a></div></div>
<div class="ttc" id="astruct_a_v_d_x_v_a2_device_context_html_a3baea98a35192cc661f903198d7196ab"><div class="ttname"><a href="struct_a_v_d_x_v_a2_device_context.html#a3baea98a35192cc661f903198d7196ab">AVDXVA2DeviceContext::devmgr</a></div><div class="ttdeci">IDirect3DDeviceManager9 * devmgr</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__dxva2_8h_source.html#l00040">hwcontext_dxva2.h:40</a></div></div>
<div class="ttc" id="astruct_open_c_l_device_selector_html"><div class="ttname"><a href="struct_open_c_l_device_selector.html">OpenCLDeviceSelector</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l00463">hwcontext_opencl.c:463</a></div></div>
<div class="ttc" id="ahwcontext_8h_html_acf25724be4b066a51ad86aa9214b0d34a6ba51b0079c626ee6d02991f078ecc98"><div class="ttname"><a href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34a6ba51b0079c626ee6d02991f078ecc98">AV_HWDEVICE_TYPE_OPENCL</a></div><div class="ttdeci">@ AV_HWDEVICE_TYPE_OPENCL</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00037">hwcontext.h:37</a></div></div>
<div class="ttc" id="astruct_a_v_v_a_a_p_i_device_context_html"><div class="ttname"><a href="struct_a_v_v_a_a_p_i_device_context.html">AVVAAPIDeviceContext</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__vaapi_8h_source.html#l00068">hwcontext_vaapi.h:68</a></div></div>
<div class="ttc" id="astruct_a_v_d_r_m_layer_descriptor_html_aa71ce914f53563be8207d8bc08fbfe92"><div class="ttname"><a href="struct_a_v_d_r_m_layer_descriptor.html#aa71ce914f53563be8207d8bc08fbfe92">AVDRMLayerDescriptor::nb_planes</a></div><div class="ttdeci">int nb_planes</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__drm_8h_source.html#l00106">hwcontext_drm.h:106</a></div></div>
<div class="ttc" id="astruct_a_v_d_x_v_a2_device_context_html"><div class="ttname"><a href="struct_a_v_d_x_v_a2_device_context.html">AVDXVA2DeviceContext</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__dxva2_8h_source.html#l00039">hwcontext_dxva2.h:39</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_a7898416aa2fa2f5d58aa4b6f35135205"><div class="ttname"><a href="hwcontext__qsv_8c.html#a7898416aa2fa2f5d58aa4b6f35135205">device_type</a></div><div class="ttdeci">enum AVHWDeviceType device_type</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00089">hwcontext_qsv.c:90</a></div></div>
<div class="ttc" id="aframe_8h_html_add80189702cf0f5ea82718576fb43201"><div class="ttname"><a href="frame_8h.html#add80189702cf0f5ea82718576fb43201">AV_NUM_DATA_POINTERS</a></div><div class="ttdeci">#define AV_NUM_DATA_POINTERS</div><div class="ttdef"><b>Definition:</b> <a href="frame_8h_source.html#l00309">frame.h:309</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_a18d0b7232f5d120a4794ddde564afc40"><div class="ttname"><a href="hwcontext__opencl_8c.html#a18d0b7232f5d120a4794ddde564afc40">opencl_platform_params</a></div><div class="ttdeci">static struct @0 opencl_platform_params[]</div></div>
<div class="ttc" id="apixdesc_8h_html_a0c6b423a11928d3ec5d2cd3f3b64ee81"><div class="ttname"><a href="pixdesc_8h.html#a0c6b423a11928d3ec5d2cd3f3b64ee81">AV_PIX_FMT_FLAG_BITSTREAM</a></div><div class="ttdeci">#define AV_PIX_FMT_FLAG_BITSTREAM</div><div class="ttdef"><b>Definition:</b> <a href="pixdesc_8h_source.html#l00136">pixdesc.h:136</a></div></div>
<div class="ttc" id="acbs__mpeg2__syntax__template_8c_html_a1782c46926cfea213509f4fc0f7fd555"><div class="ttname"><a href="cbs__mpeg2__syntax__template_8c.html#a1782c46926cfea213509f4fc0f7fd555">user_data</a></div><div class="ttdeci">static int FUNC() user_data(CodedBitstreamContext *ctx, RWContext *rw, MPEG2RawUserData *current)</div><div class="ttdef"><b>Definition:</b> <a href="cbs__mpeg2__syntax__template_8c_source.html#l00059">cbs_mpeg2_syntax_template.c:59</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_ac80722ea1b3deb660be44b3d4fc2e44e"><div class="ttname"><a href="hwcontext__opencl_8c.html#ac80722ea1b3deb660be44b3d4fc2e44e">opencl_device_uninit</a></div><div class="ttdeci">static void opencl_device_uninit(AVHWDeviceContext *hwdev)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l00889">hwcontext_opencl.c:889</a></div></div>
<div class="ttc" id="astruct_a_v_buffer_ref_html"><div class="ttname"><a href="struct_a_v_buffer_ref.html">AVBufferRef</a></div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00081">buffer.h:81</a></div></div>
<div class="ttc" id="astruct_h_w_context_type_html_a5ddb5fc39d16ce3147a5640c8d040937"><div class="ttname"><a href="struct_h_w_context_type.html#a5ddb5fc39d16ce3147a5640c8d040937">HWContextType::type</a></div><div class="ttdeci">enum AVHWDeviceType type</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__internal_8h_source.html#l00176">hwcontext_internal.h:30</a></div></div>
<div class="ttc" id="atests_2snowenc_8c_html_a64f9f90ece96c7bab4aee3deacf170e0"><div class="ttname"><a href="tests_2snowenc_8c.html#a64f9f90ece96c7bab4aee3deacf170e0">height</a></div><div class="ttdeci">#define height</div></div>
<div class="ttc" id="agroup__lavu__mem__funcs_html_gad8fde0c159ac905909339e082a049cde"><div class="ttname"><a href="group__lavu__mem__funcs.html#gad8fde0c159ac905909339e082a049cde">av_reallocp_array</a></div><div class="ttdeci">int av_reallocp_array(void *ptr, size_t nmemb, size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="mem_8c_source.html#l00206">mem.c:206</a></div></div>
<div class="ttc" id="amem_8c_html_aedc3761897b7e9ea8ae1222b3d013c94"><div class="ttname"><a href="mem_8c.html#aedc3761897b7e9ea8ae1222b3d013c94">av_mallocz_array</a></div><div class="ttdeci">void * av_mallocz_array(size_t nmemb, size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="mem_8c_source.html#l00190">mem.c:190</a></div></div>
<div class="ttc" id="astruct_a_v_frame_html_aa52bfc6605f6a3059a0c3226cc0f6567"><div class="ttname"><a href="struct_a_v_frame.html#aa52bfc6605f6a3059a0c3226cc0f6567">AVFrame::linesize</a></div><div class="ttdeci">int linesize[AV_NUM_DATA_POINTERS]</div><div class="ttdef"><b>Definition:</b> <a href="frame_8h_source.html#l00339">frame.h:339</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5a8cfd0b36308fa1ad3522ef8815ccbd0a"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a8cfd0b36308fa1ad3522ef8815ccbd0a">AV_PIX_FMT_D3D11</a></div><div class="ttdeci">@ AV_PIX_FMT_D3D11</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00313">pixfmt.h:313</a></div></div>
<div class="ttc" id="agroup__lavu__dict_html_ga1bafd682b1fbb90e48a4cc3814b820f7"><div class="ttname"><a href="group__lavu__dict.html#ga1bafd682b1fbb90e48a4cc3814b820f7">av_dict_free</a></div><div class="ttdeci">void av_dict_free(AVDictionary **pm)</div><div class="ttdef"><b>Definition:</b> <a href="dict_8c_source.html#l00203">dict.c:203</a></div></div>
<div class="ttc" id="astruct_a_v_d_r_m_layer_descriptor_html"><div class="ttname"><a href="struct_a_v_d_r_m_layer_descriptor.html">AVDRMLayerDescriptor</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__drm_8h_source.html#l00096">hwcontext_drm.h:96</a></div></div>
<div class="ttc" id="astruct_a_v_frame_html_a1e71ce60cedd5f3b6811714a9f7f9e0a"><div class="ttname"><a href="struct_a_v_frame.html#a1e71ce60cedd5f3b6811714a9f7f9e0a">AVFrame::width</a></div><div class="ttdeci">int width</div><div class="ttdef"><b>Definition:</b> <a href="frame_8h_source.html#l00366">frame.h:366</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5abb09cadf3b2d6b5ce5980401bcf638a8"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5abb09cadf3b2d6b5ce5980401bcf638a8">AV_PIX_FMT_VAAPI</a></div><div class="ttdeci">@ AV_PIX_FMT_VAAPI</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00122">pixfmt.h:122</a></div></div>
<div class="ttc" id="ahwcontext_8h_html_acf25724be4b066a51ad86aa9214b0d34af5dfa6181a3a6efb0f4a0c5f38d76b95"><div class="ttname"><a href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34af5dfa6181a3a6efb0f4a0c5f38d76b95">AV_HWDEVICE_TYPE_VAAPI</a></div><div class="ttdeci">@ AV_HWDEVICE_TYPE_VAAPI</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00031">hwcontext.h:31</a></div></div>
<div class="ttc" id="ainput_8c_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="input_8c_source.html#l00407">input.c:407</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_a680d1dfa2b7b327438e68094b925c587"><div class="ttname"><a href="hwcontext__opencl_8c.html#a680d1dfa2b7b327438e68094b925c587">opencl_check_extension</a></div><div class="ttdeci">static av_unused int opencl_check_extension(AVHWDeviceContext *hwdev, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l00270">hwcontext_opencl.c:270</a></div></div>
<div class="ttc" id="astruct_open_c_l_device_context_html_a84479dc9efcf125d62c0a431b301b588"><div class="ttname"><a href="struct_open_c_l_device_context.html#a84479dc9efcf125d62c0a431b301b588">OpenCLDeviceContext::platform_id</a></div><div class="ttdeci">cl_platform_id platform_id</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l00084">hwcontext_opencl.c:84</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_device_context_html_a9c3758c73b0f29925ccb2f60b5c1a803"><div class="ttname"><a href="struct_a_v_h_w_device_context.html#a9c3758c73b0f29925ccb2f60b5c1a803">AVHWDeviceContext::internal</a></div><div class="ttdeci">AVHWDeviceInternal * internal</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00071">hwcontext.h:71</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_aa446a057be8040d8f3d091d52e67ed47"><div class="ttname"><a href="hwcontext__opencl_8c.html#aa446a057be8040d8f3d091d52e67ed47">opencl_enumerate_platforms</a></div><div class="ttdeci">static int opencl_enumerate_platforms(AVHWDeviceContext *hwdev, cl_uint *nb_platforms, cl_platform_id **platforms, void *context)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l00291">hwcontext_opencl.c:291</a></div></div>
<div class="ttc" id="acommon_8h_html"><div class="ttname"><a href="common_8h.html">common.h</a></div></div>
<div class="ttc" id="apixdesc_8h_html_ac7c7d0be16fb9b6f05b3e0d463cd037b"><div class="ttname"><a href="pixdesc_8h.html#ac7c7d0be16fb9b6f05b3e0d463cd037b">AV_PIX_FMT_FLAG_BE</a></div><div class="ttdeci">#define AV_PIX_FMT_FLAG_BE</div><div class="ttdef"><b>Definition:</b> <a href="pixdesc_8h_source.html#l00128">pixdesc.h:128</a></div></div>
<div class="ttc" id="astruct_h_w_map_descriptor_html"><div class="ttname"><a href="struct_h_w_map_descriptor.html">HWMapDescriptor</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__internal_8h_source.html#l00132">hwcontext_internal.h:132</a></div></div>
<div class="ttc" id="aaudio__convert_8c_html_ae1affc9ca37cfb624959c866a73f83c2"><div class="ttname"><a href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a></div><div class="ttdeci">uint8_t</div><div class="ttdef"><b>Definition:</b> <a href="audio__convert_8c_source.html#l00194">audio_convert.c:194</a></div></div>
<div class="ttc" id="ahwcontext__drm_8h_html"><div class="ttname"><a href="hwcontext__drm_8h.html">hwcontext_drm.h</a></div></div>
<div class="ttc" id="astruct_open_c_l_mapping_html"><div class="ttname"><a href="struct_open_c_l_mapping.html">OpenCLMapping</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l01911">hwcontext_opencl.c:1911</a></div></div>
<div class="ttc" id="agroup__lavu__bufferpool_html_ga615151c8889d5be39d17bce4d8c65117"><div class="ttname"><a href="group__lavu__bufferpool.html#ga615151c8889d5be39d17bce4d8c65117">av_buffer_pool_init2</a></div><div class="ttdeci">AVBufferPool * av_buffer_pool_init2(int size, void *opaque, AVBufferRef *(*alloc)(void *opaque, int size), void(*pool_free)(void *opaque))</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00245">buffer.c:245</a></div></div>
<div class="ttc" id="ahwcontext_8c_html_af42d5b3b23a1d521e6457276e2cd0a53"><div class="ttname"><a href="hwcontext_8c.html#af42d5b3b23a1d521e6457276e2cd0a53">ff_hwframe_map_replace</a></div><div class="ttdeci">int ff_hwframe_map_replace(AVFrame *dst, const AVFrame *src)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8c_source.html#l00923">hwcontext.c:923</a></div></div>
<div class="ttc" id="ahwcontext_8h_html_aba8d70ed754b2536ca497d7d50ec7b1e"><div class="ttname"><a href="hwcontext_8h.html#aba8d70ed754b2536ca497d7d50ec7b1e">AVHWFrameTransferDirection</a></div><div class="ttdeci">AVHWFrameTransferDirection</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00415">hwcontext.h:415</a></div></div>
<div class="ttc" id="astruct_a_v_d_r_m_layer_descriptor_html_a7fbaf03f401c451e82021487fefef159"><div class="ttname"><a href="struct_a_v_d_r_m_layer_descriptor.html#a7fbaf03f401c451e82021487fefef159">AVDRMLayerDescriptor::planes</a></div><div class="ttdeci">AVDRMPlaneDescriptor planes[AV_DRM_MAX_PLANES]</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__drm_8h_source.html#l00110">hwcontext_drm.h:110</a></div></div>
<div class="ttc" id="ahwcontext__vaapi_8h_html"><div class="ttname"><a href="hwcontext__vaapi_8h.html">hwcontext_vaapi.h</a></div></div>
<div class="ttc" id="afilter__design_8txt_html_af1ec77bdca1b30e8153fc5da88f603db"><div class="ttname"><a href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a></div><div class="ttdeci">ret</div><div class="ttdef"><b>Definition:</b> <a href="filter__design_8txt_source.html#l00187">filter_design.txt:187</a></div></div>
<div class="ttc" id="akmsgrab_8c_html_ab482f514ab017799e2ac45d666537564"><div class="ttname"><a href="kmsgrab_8c.html#ab482f514ab017799e2ac45d666537564">pixfmt</a></div><div class="ttdeci">enum AVPixelFormat pixfmt</div><div class="ttdef"><b>Definition:</b> <a href="kmsgrab_8c_source.html#l00071">kmsgrab.c:367</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5a0b271df0acd125218c1e365a0f754022"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a0b271df0acd125218c1e365a0f754022">AV_PIX_FMT_NV12</a></div><div class="ttdeci">@ AV_PIX_FMT_NV12</div><div class="ttdoc">planar YUV 4:2:0, 12bpp, 1 plane for Y and 1 plane for the UV components, which are interleaved (firs...</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00089">pixfmt.h:89</a></div></div>
<div class="ttc" id="afilter__design_8txt_html_a48ad71a5b40cdd5f23c601f33665a953"><div class="ttname"><a href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a></div><div class="ttdeci">these buffered frames must be flushed immediately if a new input produces new the filter must not call request_frame to get more It must just process the frame or queue it The task of requesting more frames is left to the filter s request_frame method or the application If a filter has several the filter must be ready for frames arriving randomly on any input any filter with several inputs will most likely require some kind of queuing mechanism It is perfectly acceptable to have a limited queue and to drop frames when the inputs are too unbalanced request_frame For filters that do not use the this method is called when a frame is wanted on an output For a it should directly call filter_frame on the corresponding output For a if there are queued frames already one of these frames should be pushed If the filter should request a frame on one of its repeatedly until at least one frame has been pushed Return or at least make progress towards producing a frame</div><div class="ttdef"><b>Definition:</b> <a href="filter__design_8txt_source.html#l00264">filter_design.txt:264</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_abcf959ddcc0991a6681aa36d6e32b248"><div class="ttname"><a href="hwcontext__opencl_8c.html#abcf959ddcc0991a6681aa36d6e32b248">OpenCLDeviceSelector</a></div><div class="ttdeci">struct OpenCLDeviceSelector OpenCLDeviceSelector</div></div>
<div class="ttc" id="astruct_a_v_d_x_v_a2_frames_context_html"><div class="ttname"><a href="struct_a_v_d_x_v_a2_frames_context.html">AVDXVA2FramesContext</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__dxva2_8h_source.html#l00046">hwcontext_dxva2.h:46</a></div></div>
<div class="ttc" id="agroup__lavu__mem__funcs_html_ga34e10fdac079a9ca4512b8ccd7f20b8a"><div class="ttname"><a href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a></div><div class="ttdeci">int size</div><div class="ttdef"><b>Definition:</b> <a href="twinvq__data_8h_source.html#l11134">twinvq_data.h:11134</a></div></div>
<div class="ttc" id="asinewin__tablegen__template_8c_html_a3508a98d3ee7e2c9a4841fe264cf70f7"><div class="ttname"><a href="sinewin__tablegen__template_8c.html#a3508a98d3ee7e2c9a4841fe264cf70f7">FF_ARRAY_ELEMS</a></div><div class="ttdeci">#define FF_ARRAY_ELEMS(a)</div><div class="ttdef"><b>Definition:</b> <a href="sinewin__tablegen__template_8c_source.html#l00038">sinewin_tablegen_template.c:38</a></div></div>
<div class="ttc" id="alibavutil_2internal_8h_html_a0e48151aa81e2949bf69aaf5e3fc2cc9"><div class="ttname"><a href="libavutil_2internal_8h.html#a0e48151aa81e2949bf69aaf5e3fc2cc9">SIZE_SPECIFIER</a></div><div class="ttdeci">#define SIZE_SPECIFIER</div><div class="ttdef"><b>Definition:</b> <a href="libavutil_2internal_8h_source.html#l00229">internal.h:229</a></div></div>
<div class="ttc" id="astruct_h_w_context_type_html"><div class="ttname"><a href="struct_h_w_context_type.html">HWContextType</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__internal_8h_source.html#l00029">hwcontext_internal.h:29</a></div></div>
<div class="ttc" id="ahwcontext_8h_html_acf25724be4b066a51ad86aa9214b0d34a7a74cd2f21d680a11aa8b321ddff1358"><div class="ttname"><a href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34a7a74cd2f21d680a11aa8b321ddff1358">AV_HWDEVICE_TYPE_QSV</a></div><div class="ttdeci">@ AV_HWDEVICE_TYPE_QSV</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00033">hwcontext.h:33</a></div></div>
<div class="ttc" id="agroup__avoptions_html_gga06fc87d81c62e9abb8790b6e5713c55bab2e22cc927a3d88fe833b50bf3d71948"><div class="ttname"><a href="group__avoptions.html#gga06fc87d81c62e9abb8790b6e5713c55bab2e22cc927a3d88fe833b50bf3d71948">AV_HWFRAME_MAP_WRITE</a></div><div class="ttdeci">@ AV_HWFRAME_MAP_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00528">hwcontext.h:528</a></div></div>
<div class="ttc" id="astruct_open_c_l_device_selector_html_a0b67aed3fdb1ba2841c301f77eae44cb"><div class="ttname"><a href="struct_open_c_l_device_selector.html#a0b67aed3fdb1ba2841c301f77eae44cb">OpenCLDeviceSelector::filter_platform</a></div><div class="ttdeci">int(* filter_platform)(AVHWDeviceContext *hwdev, cl_platform_id platform_id, const char *platform_name, void *context)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l00471">hwcontext_opencl.c:471</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_frames_context_html_ac9a7dbd0cbfcabc0b1529cb34cf53b6d"><div class="ttname"><a href="struct_a_v_h_w_frames_context.html#ac9a7dbd0cbfcabc0b1529cb34cf53b6d">AVHWFramesContext::device_ctx</a></div><div class="ttdeci">AVHWDeviceContext * device_ctx</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00149">hwcontext.h:149</a></div></div>
<div class="ttc" id="astruct_a_v_frame_html_a1d0f65014a8d1bf78cec8cbed2304992"><div class="ttname"><a href="struct_a_v_frame.html#a1d0f65014a8d1bf78cec8cbed2304992">AVFrame::data</a></div><div class="ttdeci">uint8_t * data[AV_NUM_DATA_POINTERS]</div><div class="ttdef"><b>Definition:</b> <a href="frame_8h_source.html#l00322">frame.h:322</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_aea176891f9371176bff6dee38f8390ab"><div class="ttname"><a href="hwcontext__opencl_8c.html#aea176891f9371176bff6dee38f8390ab">opencl_get_platform_string</a></div><div class="ttdeci">static char * opencl_get_platform_string(cl_platform_id platform_id, cl_platform_info key)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l00202">hwcontext_opencl.c:202</a></div></div>
<div class="ttc" id="astruct_a_v_d_r_m_object_descriptor_html"><div class="ttname"><a href="struct_a_v_d_r_m_object_descriptor.html">AVDRMObjectDescriptor</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__drm_8h_source.html#l00048">hwcontext_drm.h:48</a></div></div>
<div class="ttc" id="astruct_open_c_l_device_selector_html_a87ae43f099630aff046d6d039349f12d"><div class="ttname"><a href="struct_open_c_l_device_selector.html#a87ae43f099630aff046d6d039349f12d">OpenCLDeviceSelector::enumerate_devices</a></div><div class="ttdeci">int(* enumerate_devices)(AVHWDeviceContext *hwdev, cl_platform_id platform_id, const char *platform_name, cl_uint *nb_devices, cl_device_id **devices, void *context)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l00475">hwcontext_opencl.c:475</a></div></div>
<div class="ttc" id="astruct_a_v_frame_html_aed14fa772ce46881020fd1545c86432c"><div class="ttname"><a href="struct_a_v_frame.html#aed14fa772ce46881020fd1545c86432c">AVFrame::format</a></div><div class="ttdeci">int format</div><div class="ttdef"><b>Definition:</b> <a href="frame_8h_source.html#l00381">frame.h:381</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_a3004c1b68dc75e1be574fafb61f44cfb"><div class="ttname"><a href="hwcontext__opencl_8c.html#a3004c1b68dc75e1be574fafb61f44cfb">opencl_frames_init_command_queue</a></div><div class="ttdeci">static int opencl_frames_init_command_queue(AVHWFramesContext *hwfc)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l01676">hwcontext_opencl.c:1676</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_af73f72120f21c6a98aca9ef43f51ef48"><div class="ttname"><a href="hwcontext__opencl_8c.html#af73f72120f21c6a98aca9ef43f51ef48">opencl_filter_platform</a></div><div class="ttdeci">static int opencl_filter_platform(AVHWDeviceContext *hwdev, cl_platform_id platform_id, const char *platform_name, void *context)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l00322">hwcontext_opencl.c:322</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5a0e08f8a5d0fa21c3e258816a9dcce7c3"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a0e08f8a5d0fa21c3e258816a9dcce7c3">AV_PIX_FMT_NONE</a></div><div class="ttdeci">@ AV_PIX_FMT_NONE</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00065">pixfmt.h:65</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_a70f211250033119734a586d936c078dd"><div class="ttname"><a href="hwcontext__opencl_8c.html#a70f211250033119734a586d936c078dd">opencl_device_create</a></div><div class="ttdeci">static int opencl_device_create(AVHWDeviceContext *hwdev, const char *device, AVDictionary *opts, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l00620">hwcontext_opencl.c:620</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_frames_constraints_html_af5d3a683727f7b92abca7b7114d4e15c"><div class="ttname"><a href="struct_a_v_h_w_frames_constraints.html#af5d3a683727f7b92abca7b7114d4e15c">AVHWFramesConstraints::max_height</a></div><div class="ttdeci">int max_height</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00479">hwcontext.h:479</a></div></div>
<div class="ttc" id="atests_2jpeg2000dwt_8c_html_a5cabdd8be5af41f675fed06498e094b7"><div class="ttname"><a href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a></div><div class="ttdeci">static int ref[MAX_W *MAX_W]</div><div class="ttdef"><b>Definition:</b> <a href="tests_2jpeg2000dwt_8c_source.html#l00107">jpeg2000dwt.c:107</a></div></div>
<div class="ttc" id="alibsvtav1_8c_html_a710bce51374aba96ab04912897666c35"><div class="ttname"><a href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a></div><div class="ttdeci">const char * desc</div><div class="ttdef"><b>Definition:</b> <a href="libsvtav1_8c_source.html#l00079">libsvtav1.c:79</a></div></div>
<div class="ttc" id="amem_8h_html"><div class="ttname"><a href="mem_8h.html">mem.h</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8h_html_a13abed95677347a50bf272bc7d1a7caf"><div class="ttname"><a href="hwcontext__opencl_8h.html#a13abed95677347a50bf272bc7d1a7caf">AVOpenCLDeviceContext</a></div><div class="ttdeci">struct AVOpenCLDeviceContext AVOpenCLDeviceContext</div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_aefb87273677351fb6486f45b7ac05a3b"><div class="ttname"><a href="hwcontext__opencl_8c.html#aefb87273677351fb6486f45b7ac05a3b">opencl_transfer_data_to</a></div><div class="ttdeci">static int opencl_transfer_data_to(AVHWFramesContext *hwfc, AVFrame *dst, const AVFrame *src)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l01856">hwcontext_opencl.c:1856</a></div></div>
<div class="ttc" id="ahwcontext__internal_8h_html"><div class="ttname"><a href="hwcontext__internal_8h.html">hwcontext_internal.h</a></div></div>
<div class="ttc" id="ahwcontext__vdpau_8c_html_a2996cc16b36e13c9010705bad768e866"><div class="ttname"><a href="hwcontext__vdpau_8c.html#a2996cc16b36e13c9010705bad768e866">map</a></div><div class="ttdeci">const VDPAUPixFmtMap * map</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__vdpau_8c_source.html#l00071">hwcontext_vdpau.c:71</a></div></div>
<div class="ttc" id="astruct_a_v_open_c_l_frames_context_html"><div class="ttname"><a href="struct_a_v_open_c_l_frames_context.html">AVOpenCLFramesContext</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8h_source.html#l00089">hwcontext_opencl.h:89</a></div></div>
<div class="ttc" id="atableprint__vlc_8h_html_a079eab092887563f2bef9106c6120089"><div class="ttname"><a href="tableprint__vlc_8h.html#a079eab092887563f2bef9106c6120089">av_free</a></div><div class="ttdeci">#define av_free(p)</div><div class="ttdef"><b>Definition:</b> <a href="tableprint__vlc_8h_source.html#l00034">tableprint_vlc.h:34</a></div></div>
<div class="ttc" id="ailbcdata_8h_html_a545b8c1c045fcc34b81d3ca822620277"><div class="ttname"><a href="ilbcdata_8h.html#a545b8c1c045fcc34b81d3ca822620277">alpha</a></div><div class="ttdeci">static const int16_t alpha[]</div><div class="ttdef"><b>Definition:</b> <a href="ilbcdata_8h_source.html#l00055">ilbcdata.h:55</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_device_context_html_a8c9a379fa6b08bacadf6af8ea8b84ff5"><div class="ttname"><a href="struct_a_v_h_w_device_context.html#a8c9a379fa6b08bacadf6af8ea8b84ff5">AVHWDeviceContext::free</a></div><div class="ttdeci">void(* free)(struct AVHWDeviceContext *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00104">hwcontext.h:104</a></div></div>
<div class="ttc" id="atableprint__vlc_8h_html_adba82e1bcd02de510a858fcbedf79ef1"><div class="ttname"><a href="tableprint__vlc_8h.html#adba82e1bcd02de510a858fcbedf79ef1">av_freep</a></div><div class="ttdeci">#define av_freep(p)</div><div class="ttdef"><b>Definition:</b> <a href="tableprint__vlc_8h_source.html#l00035">tableprint_vlc.h:35</a></div></div>
<div class="ttc" id="agroup__lavu__dict_html_ga8d9c2de72b310cef8e6a28c9cd3acbbe"><div class="ttname"><a href="group__lavu__dict.html#ga8d9c2de72b310cef8e6a28c9cd3acbbe">av_dict_set</a></div><div class="ttdeci">int av_dict_set(AVDictionary **pm, const char *key, const char *value, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="dict_8c_source.html#l00070">dict.c:70</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_ae0c00627f713c461d5f449c5f8ef27d9"><div class="ttname"><a href="hwcontext__opencl_8c.html#ae0c00627f713c461d5f449c5f8ef27d9">opencl_get_buffer</a></div><div class="ttdeci">static int opencl_get_buffer(AVHWFramesContext *hwfc, AVFrame *frame)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l01739">hwcontext_opencl.c:1739</a></div></div>
<div class="ttc" id="anamespaceconvert__header_html_ae1e061c0db8a47f53e1f3de5e371872e"><div class="ttname"><a href="namespaceconvert__header.html#ae1e061c0db8a47f53e1f3de5e371872e">convert_header.str</a></div><div class="ttdeci">string str</div><div class="ttdef"><b>Definition:</b> <a href="convert__header_8py_source.html#l00020">convert_header.py:20</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_frames_context_html_ad67ff3a5828a611d1b1cddd64fc1de71"><div class="ttname"><a href="struct_a_v_h_w_frames_context.html#ad67ff3a5828a611d1b1cddd64fc1de71">AVHWFramesContext::pool</a></div><div class="ttdeci">AVBufferPool * pool</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00190">hwcontext.h:190</a></div></div>
<div class="ttc" id="acbs__av1_8c_html_a67119bce106892b6dade1dc5aa405ac9"><div class="ttname"><a href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a></div><div class="ttdeci">#define flags(name, subs,...)</div><div class="ttdef"><b>Definition:</b> <a href="cbs__av1_8c_source.html#l00560">cbs_av1.c:560</a></div></div>
<div class="ttc" id="ahwcontext_8h_html"><div class="ttname"><a href="hwcontext_8h.html">hwcontext.h</a></div></div>
<div class="ttc" id="atableprint__vlc_8h_html_af38b91523053c244564a94f1ef862c2c"><div class="ttname"><a href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a></div><div class="ttdeci">#define av_log(a,...)</div><div class="ttdef"><b>Definition:</b> <a href="tableprint__vlc_8h_source.html#l00028">tableprint_vlc.h:28</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_a9d1855e39e517bac4a9e9499028eb595"><div class="ttname"><a href="hwcontext__opencl_8c.html#a9d1855e39e517bac4a9e9499028eb595">opencl_pool_free</a></div><div class="ttdeci">static void opencl_pool_free(void *opaque, uint8_t *data)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l01602">hwcontext_opencl.c:1602</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_a6931437dd20e2a1ba2f22b62941f7ae4"><div class="ttname"><a href="hwcontext__opencl_8c.html#a6931437dd20e2a1ba2f22b62941f7ae4">opencl_unmap_frame</a></div><div class="ttdeci">static void opencl_unmap_frame(AVHWFramesContext *hwfc, HWMapDescriptor *hwmap)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l01918">hwcontext_opencl.c:1918</a></div></div>
<div class="ttc" id="anvenc_8h_html_a6e9da08b1a3e1791361224730077b542"><div class="ttname"><a href="nvenc_8h.html#a6e9da08b1a3e1791361224730077b542">ID3D11Device</a></div><div class="ttdeci">void ID3D11Device</div><div class="ttdef"><b>Definition:</b> <a href="nvenc_8h_source.html#l00028">nvenc.h:28</a></div></div>
<div class="ttc" id="aavstring_8h_html"><div class="ttname"><a href="avstring_8h.html">avstring.h</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_frames_context_html_a663a9aceca97aa7b2426c9aba6543e4a"><div class="ttname"><a href="struct_a_v_h_w_frames_context.html#a663a9aceca97aa7b2426c9aba6543e4a">AVHWFramesContext::sw_format</a></div><div class="ttdeci">enum AVPixelFormat sw_format</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00199">hwcontext.h:222</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_a71dcf9f77e0ceec7f098a233fcec80f4"><div class="ttname"><a href="hwcontext__opencl_8c.html#a71dcf9f77e0ceec7f098a233fcec80f4">opencl_frames_derive_to</a></div><div class="ttdeci">static int opencl_frames_derive_to(AVHWFramesContext *dst_fc, AVHWFramesContext *src_fc, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l02851">hwcontext_opencl.c:2851</a></div></div>
<div class="ttc" id="astruct_a_v_frame_html"><div class="ttname"><a href="struct_a_v_frame.html">AVFrame</a></div><div class="ttdef"><b>Definition:</b> <a href="frame_8h_source.html#l00308">frame.h:308</a></div></div>
<div class="ttc" id="astruct_a_v_d_x_v_a2_frames_context_html_a867fec347dd21aa778948df67cf00450"><div class="ttname"><a href="struct_a_v_d_x_v_a2_frames_context.html#a867fec347dd21aa778948df67cf00450">AVDXVA2FramesContext::nb_surfaces</a></div><div class="ttdeci">int nb_surfaces</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__dxva2_8h_source.html#l00059">hwcontext_dxva2.h:59</a></div></div>
<div class="ttc" id="affmpeg__filter_8c_html_a61569f2965b7a369eb10b6d75d410d11"><div class="ttname"><a href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a></div><div class="ttdeci">int</div><div class="ttdef"><b>Definition:</b> <a href="ffmpeg__filter_8c_source.html#l00193">ffmpeg_filter.c:193</a></div></div>
<div class="ttc" id="apixdesc_8h_html_af30af160970132a3a31c4738629e4495"><div class="ttname"><a href="pixdesc_8h.html#af30af160970132a3a31c4738629e4495">AV_PIX_FMT_FLAG_PAL</a></div><div class="ttdeci">#define AV_PIX_FMT_FLAG_PAL</div><div class="ttdef"><b>Definition:</b> <a href="pixdesc_8h_source.html#l00132">pixdesc.h:132</a></div></div>
<div class="ttc" id="ahwcontext__d3d11va_8h_html"><div class="ttname"><a href="hwcontext__d3d11va_8h.html">hwcontext_d3d11va.h</a></div></div>
<div class="ttc" id="astruct_a_v_open_c_l_frame_descriptor_html"><div class="ttname"><a href="struct_a_v_open_c_l_frame_descriptor.html">AVOpenCLFrameDescriptor</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8h_source.html#l00047">hwcontext_opencl.h:47</a></div></div>
<div class="ttc" id="astruct_open_c_l_device_selector_html_aedc0c87598ef24a88481f4fa3388f2cf"><div class="ttname"><a href="struct_open_c_l_device_selector.html#aedc0c87598ef24a88481f4fa3388f2cf">OpenCLDeviceSelector::platform_index</a></div><div class="ttdeci">int platform_index</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l00464">hwcontext_opencl.c:464</a></div></div>
<div class="ttc" id="ahwcontext_8h_html_acf25724be4b066a51ad86aa9214b0d34aa04ac36fb964a5c191566a8e809de743"><div class="ttname"><a href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34aa04ac36fb964a5c191566a8e809de743">AV_HWDEVICE_TYPE_DRM</a></div><div class="ttdeci">@ AV_HWDEVICE_TYPE_DRM</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00036">hwcontext.h:36</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_aaddf3d74df38750199409c10a8bd9028"><div class="ttname"><a href="hwcontext__opencl_8c.html#aaddf3d74df38750199409c10a8bd9028">opencl_mem_flags_for_mapping</a></div><div class="ttdeci">static cl_mem_flags opencl_mem_flags_for_mapping(int map_flags)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l02185">hwcontext_opencl.c:2185</a></div></div>
<div class="ttc" id="apixdesc_8c_html_ab92e2a8a9b58c982560c49df9f01e47e"><div class="ttname"><a href="pixdesc_8c.html#ab92e2a8a9b58c982560c49df9f01e47e">av_get_pix_fmt_name</a></div><div class="ttdeci">const char * av_get_pix_fmt_name(enum AVPixelFormat pix_fmt)</div><div class="ttdef"><b>Definition:</b> <a href="pixdesc_8c_source.html#l02489">pixdesc.c:2489</a></div></div>
<div class="ttc" id="ahwcontext__opencl_8c_html_ae157d33541bb39200a86f40e9868572e"><div class="ttname"><a href="hwcontext__opencl_8c.html#ae157d33541bb39200a86f40e9868572e">opencl_error_callback</a></div><div class="ttdeci">static void CL_CALLBACK opencl_error_callback(const char *errinfo, const void *private_info, size_t cb, void *user_data)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__opencl_8c_source.html#l00146">hwcontext_opencl.c:146</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
