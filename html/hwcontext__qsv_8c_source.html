<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: E:/github/ffmpeg/libavutil/hwcontext_qsv.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_737c44b861ba7ee498141742fb455fa8.html">ffmpeg</a></li><li class="navelem"><a class="el" href="dir_d766145af7397866e2c8608f9b7b90ce.html">libavutil</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">hwcontext_qsv.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="hwcontext__qsv_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * This file is part of FFmpeg.</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * FFmpeg is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * FFmpeg is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * License along with FFmpeg; if not, write to the Free Software</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;mfx/mfxvideo.h&gt;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;config.h&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#if HAVE_PTHREADS</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;pthread.h&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#if CONFIG_VAAPI</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hwcontext__vaapi_8h.html">hwcontext_vaapi.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#if CONFIG_DXVA2</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hwcontext__dxva2_8h.html">hwcontext_dxva2.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="buffer_8h.html">buffer.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="common_8h.html">common.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hwcontext_8h.html">hwcontext.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hwcontext__internal_8h.html">hwcontext_internal.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hwcontext__qsv_8h.html">hwcontext_qsv.h</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mem_8h.html">mem.h</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="pixfmt_8h.html">pixfmt.h</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="pixdesc_8h.html">pixdesc.h</a>&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="time_8h.html">time.h</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#ab0524b5bc140fbde2ee5a944f4e93f76">   47</a></span>&#160;<span class="preprocessor">#define QSV_VERSION_ATLEAST(MAJOR, MINOR)   \</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">    (MFX_VERSION_MAJOR &gt; (MAJOR) ||         \</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">     MFX_VERSION_MAJOR == (MAJOR) &amp;&amp; MFX_VERSION_MINOR &gt;= (MINOR))</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="struct_q_s_v_device_priv.html">   51</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct_q_s_v_device_priv.html">QSVDevicePriv</a> {</div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="struct_q_s_v_device_priv.html#a4d5334a14976c0fafc8f2471df69b5a4">   52</a></span>&#160;    <a class="code" href="struct_a_v_buffer_ref.html">AVBufferRef</a> *<a class="code" href="struct_q_s_v_device_priv.html#a4d5334a14976c0fafc8f2471df69b5a4">child_device_ctx</a>;</div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#af1bb59d6eb4bc68bb468cf3f149ab076">   53</a></span>&#160;} <a class="code" href="hwcontext__qsv_8c.html#af1bb59d6eb4bc68bb468cf3f149ab076">QSVDevicePriv</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="struct_q_s_v_device_context.html">   55</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct_q_s_v_device_context.html">QSVDeviceContext</a> {</div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="struct_q_s_v_device_context.html#a83bcfd0adba00e9341895299f1afee7c">   56</a></span>&#160;    mfxHDL              <a class="code" href="struct_q_s_v_device_context.html#a83bcfd0adba00e9341895299f1afee7c">handle</a>;</div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="struct_q_s_v_device_context.html#aa12e122ac94c307f477fda7a18cd7893">   57</a></span>&#160;    mfxHandleType       <a class="code" href="struct_q_s_v_device_context.html#aa12e122ac94c307f477fda7a18cd7893">handle_type</a>;</div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="struct_q_s_v_device_context.html#a11c9e7859a9dc46f0d49bef21d2cd650">   58</a></span>&#160;    mfxVersion          <a class="code" href="struct_q_s_v_device_context.html#a11c9e7859a9dc46f0d49bef21d2cd650">ver</a>;</div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="struct_q_s_v_device_context.html#a69bcb59f86315e626b2c6c6c62fa3b91">   59</a></span>&#160;    mfxIMPL             <a class="code" href="struct_q_s_v_device_context.html#a69bcb59f86315e626b2c6c6c62fa3b91">impl</a>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keyword">enum</span> <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34">AVHWDeviceType</a> <a class="code" href="struct_q_s_v_device_context.html#a92ab7a5d495bfaa0f6319c4ed4d1350d">child_device_type</a>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keyword">enum</span> <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5">AVPixelFormat</a>  <a class="code" href="struct_q_s_v_device_context.html#afdb992f13510b59575c4c7ed940b09d4">child_pix_fmt</a>;</div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#aeba6c3488f46d75147e815bf905aa432">   63</a></span>&#160;} <a class="code" href="hwcontext__qsv_8c.html#aeba6c3488f46d75147e815bf905aa432">QSVDeviceContext</a>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct_q_s_v_frames_context.html">QSVFramesContext</a> {</div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="struct_q_s_v_frames_context.html#a3a8fe7fd15820f30b4d6dc2a655676d9">   66</a></span>&#160;    mfxSession <a class="code" href="struct_q_s_v_frames_context.html#a3a8fe7fd15820f30b4d6dc2a655676d9">session_download</a>;</div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="struct_q_s_v_frames_context.html#acf21c88b6cc4007df0c4cc33c7bc56f3">   67</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="struct_q_s_v_frames_context.html#acf21c88b6cc4007df0c4cc33c7bc56f3">session_download_init</a>;</div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="struct_q_s_v_frames_context.html#a02435a88efd4a0f6842bd18351b8cef2">   68</a></span>&#160;    mfxSession <a class="code" href="struct_q_s_v_frames_context.html#a02435a88efd4a0f6842bd18351b8cef2">session_upload</a>;</div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="struct_q_s_v_frames_context.html#a614bdada0817c0e51a89dbc1a37f82a1">   69</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="struct_q_s_v_frames_context.html#a614bdada0817c0e51a89dbc1a37f82a1">session_upload_init</a>;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#if HAVE_PTHREADS</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="os2threads_8h.html#ac171f4e937b5a585efb4a7f99ee2234a">pthread_mutex_t</a> session_lock;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="structpthread__cond__t.html">pthread_cond_t</a> session_cond;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="struct_q_s_v_frames_context.html#aa4434580b036b0885bcabddf15a5d52d">   75</a></span>&#160;    <a class="code" href="struct_a_v_buffer_ref.html">AVBufferRef</a> *<a class="code" href="struct_q_s_v_frames_context.html#aa4434580b036b0885bcabddf15a5d52d">child_frames_ref</a>;</div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="struct_q_s_v_frames_context.html#adf1cfd8787eeac2cb76c132f087acbc5">   76</a></span>&#160;    mfxFrameSurface1 *<a class="code" href="struct_q_s_v_frames_context.html#adf1cfd8787eeac2cb76c132f087acbc5">surfaces_internal</a>;</div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="struct_q_s_v_frames_context.html#ad70096c0dca240753094c4312683bdf0">   77</a></span>&#160;    <span class="keywordtype">int</span>             <a class="code" href="struct_q_s_v_frames_context.html#ad70096c0dca240753094c4312683bdf0">nb_surfaces_used</a>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">// used in the frame allocator for non-opaque surfaces</span></div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="struct_q_s_v_frames_context.html#a4dce9c7f00026f0843a9bee9e5074998">   80</a></span>&#160;    mfxMemId *<a class="code" href="struct_q_s_v_frames_context.html#a4dce9c7f00026f0843a9bee9e5074998">mem_ids</a>;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">// used in the opaque alloc request for opaque surfaces</span></div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="struct_q_s_v_frames_context.html#ae813b674060eb32336908dbf2ae5b4d1">   82</a></span>&#160;    mfxFrameSurface1 **<a class="code" href="struct_q_s_v_frames_context.html#ae813b674060eb32336908dbf2ae5b4d1">surface_ptrs</a>;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="struct_q_s_v_frames_context.html#adc35c4a7df1ae8128fae944344e1223b">   84</a></span>&#160;    mfxExtOpaqueSurfaceAlloc <a class="code" href="struct_q_s_v_frames_context.html#adc35c4a7df1ae8128fae944344e1223b">opaque_alloc</a>;</div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="struct_q_s_v_frames_context.html#a839c91e8e38aeae0d3db5648cc25f77a">   85</a></span>&#160;    mfxExtBuffer *<a class="code" href="struct_q_s_v_frames_context.html#a839c91e8e38aeae0d3db5648cc25f77a">ext_buffers</a>[1];</div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#a370f2c5459294a1f609b0dd9f3c11180">   86</a></span>&#160;} <a class="code" href="hwcontext__qsv_8c.html#a370f2c5459294a1f609b0dd9f3c11180">QSVFramesContext</a>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#a7331e302ea7bb48e0b605a069576e135">   89</a></span>&#160;    mfxHandleType <a class="code" href="hwcontext__qsv_8c.html#a3f6f34808101299d4cd094fcb313e919">handle_type</a>;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keyword">enum</span> <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34">AVHWDeviceType</a> <a class="code" href="hwcontext__qsv_8c.html#a7898416aa2fa2f5d58aa4b6f35135205">device_type</a>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keyword">enum</span> <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5">AVPixelFormat</a>  <a class="code" href="hwcontext__qsv_8c.html#a7331e302ea7bb48e0b605a069576e135">pix_fmt</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;} <a class="code" href="hwcontext__qsv_8c.html#a9711b88d071503de3915aaecede66ca0">supported_handle_types</a>[] = {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor">#if CONFIG_VAAPI</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    { MFX_HANDLE_VA_DISPLAY,          <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34af5dfa6181a3a6efb0f4a0c5f38d76b95">AV_HWDEVICE_TYPE_VAAPI</a>, <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5abb09cadf3b2d6b5ce5980401bcf638a8">AV_PIX_FMT_VAAPI</a> },</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="preprocessor">#if CONFIG_DXVA2</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    { MFX_HANDLE_D3D9_DEVICE_MANAGER, <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34acc6f1868dad1c636d4747cc91ce71d10">AV_HWDEVICE_TYPE_DXVA2</a>, <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a35e418d6581792c6daa3c0aaba601cb1">AV_PIX_FMT_DXVA2_VLD</a> },</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    { 0 },</div>
<div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#a9711b88d071503de3915aaecede66ca0">  100</a></span>&#160;};</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keyword">enum</span> <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5">AVPixelFormat</a> <a class="code" href="hwcontext__qsv_8c.html#a7331e302ea7bb48e0b605a069576e135">pix_fmt</a>;</div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#aa5d906425500585aa7832161b2a40e1b">  104</a></span>&#160;    uint32_t           <a class="code" href="hwcontext__qsv_8c.html#aa5d906425500585aa7832161b2a40e1b">fourcc</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;} <a class="code" href="hwcontext__qsv_8c.html#a5349aad53b5aa95c1ea9ab2833330e66">supported_pixel_formats</a>[] = {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    { <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a0b271df0acd125218c1e365a0f754022">AV_PIX_FMT_NV12</a>, MFX_FOURCC_NV12 },</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    { <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a41c64e3682529dd5caca6f7d5d3c19c7">AV_PIX_FMT_BGRA</a>, MFX_FOURCC_RGB4 },</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    { <a class="code" href="pixfmt_8h.html#a6265531cbe491ec34449e3769e545f1f">AV_PIX_FMT_P010</a>, MFX_FOURCC_P010 },</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    { <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5acb2d8caa4e82b70f1bbe4d83f137f8c8">AV_PIX_FMT_PAL8</a>, MFX_FOURCC_P8   },</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor">#if CONFIG_VAAPI</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    { <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5ac755aea7c3277b09a42253882ec0444e">AV_PIX_FMT_YUYV422</a>,</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                       MFX_FOURCC_YUY2 },</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="preprocessor">#if QSV_VERSION_ATLEAST(1, 27)</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    { <a class="code" href="pixfmt_8h.html#a5cfd3e9346f68f69196d9f13f8d69022">AV_PIX_FMT_Y210</a>,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                       MFX_FOURCC_Y210 },</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#a5349aad53b5aa95c1ea9ab2833330e66">  118</a></span>&#160;};</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#aaf17e113e894aa2f7b8e369e2e21224b">  120</a></span>&#160;<span class="keyword">static</span> uint32_t <a class="code" href="hwcontext__qsv_8c.html#aaf17e113e894aa2f7b8e369e2e21224b">qsv_fourcc_from_pix_fmt</a>(<span class="keyword">enum</span> <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5">AVPixelFormat</a> <a class="code" href="hwcontext__qsv_8c.html#a7331e302ea7bb48e0b605a069576e135">pix_fmt</a>)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;{</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="sinewin__tablegen__template_8c.html#a3508a98d3ee7e2c9a4841fe264cf70f7">FF_ARRAY_ELEMS</a>(<a class="code" href="hwcontext__qsv_8c.html#a5349aad53b5aa95c1ea9ab2833330e66">supported_pixel_formats</a>); <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="hwcontext__qsv_8c.html#a5349aad53b5aa95c1ea9ab2833330e66">supported_pixel_formats</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="hwcontext__qsv_8c.html#a7331e302ea7bb48e0b605a069576e135">pix_fmt</a> == <a class="code" href="hwcontext__qsv_8c.html#a7331e302ea7bb48e0b605a069576e135">pix_fmt</a>)</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="hwcontext__qsv_8c.html#a5349aad53b5aa95c1ea9ab2833330e66">supported_pixel_formats</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].fourcc;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;}</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#a2dd36ef3444f1075a4c86b6519d4448d">  130</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__qsv_8c.html#a2dd36ef3444f1075a4c86b6519d4448d">qsv_device_init</a>(<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>)</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;{</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="struct_a_v_q_s_v_device_context.html">AVQSVDeviceContext</a> *hwctx = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;hwctx;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="struct_q_s_v_device_context.html">QSVDeviceContext</a>       *<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a> = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;<a class="code" href="struct_a_v_format_context.html#a8a8bec51da36db65ff864f88a85805d9">internal</a>-&gt;priv;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    mfxStatus err;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="hwcontext__qsv_8c.html#a9711b88d071503de3915aaecede66ca0">supported_handle_types</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].handle_type; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        err = MFXVideoCORE_GetHandle(hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_device_context.html#abfdc22dbded8e90950b3dfce3f3bd83d">session</a>, <a class="code" href="hwcontext__qsv_8c.html#a9711b88d071503de3915aaecede66ca0">supported_handle_types</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].handle_type,</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                                     &amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;handle);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordflow">if</span> (err == MFX_ERR_NONE) {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;handle_type       = <a class="code" href="hwcontext__qsv_8c.html#a9711b88d071503de3915aaecede66ca0">supported_handle_types</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].handle_type;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;child_device_type = <a class="code" href="hwcontext__qsv_8c.html#a9711b88d071503de3915aaecede66ca0">supported_handle_types</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].device_type;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;child_pix_fmt     = <a class="code" href="hwcontext__qsv_8c.html#a9711b88d071503de3915aaecede66ca0">supported_handle_types</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].pix_fmt;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;handle) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>, <span class="stringliteral">&quot;No supported hw handle could be retrieved &quot;</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;               <span class="stringliteral">&quot;from the session\n&quot;</span>);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    err = MFXQueryIMPL(hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_device_context.html#abfdc22dbded8e90950b3dfce3f3bd83d">session</a>, &amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;impl);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">if</span> (err == MFX_ERR_NONE)</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        err = MFXQueryVersion(hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_device_context.html#abfdc22dbded8e90950b3dfce3f3bd83d">session</a>, &amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;ver);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">if</span> (err != MFX_ERR_NONE) {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Error querying the session attributes\n&quot;</span>);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__lavu__error.html#ga4ebaa288c7684a26a591c501208910e4">AVERROR_UNKNOWN</a>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;}</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#aae34df94330b4b328854f0883450f2d1">  164</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="hwcontext__qsv_8c.html#aae34df94330b4b328854f0883450f2d1">qsv_frames_uninit</a>(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>)</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;{</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="struct_q_s_v_frames_context.html">QSVFramesContext</a> *<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a> = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;<a class="code" href="struct_a_v_format_context.html#a8a8bec51da36db65ff864f88a85805d9">internal</a>-&gt;priv;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_download) {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        MFXVideoVPP_Close(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_download);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        MFXClose(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_download);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_download = <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_download_init = 0;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_upload) {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        MFXVideoVPP_Close(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_upload);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        MFXClose(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_upload);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_upload = <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_upload_init = 0;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="preprocessor">#if HAVE_PTHREADS</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="os2threads_8h.html#af75a104513c9384ace314b0a6b1a8240">pthread_mutex_destroy</a>(&amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_lock);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <a class="code" href="os2threads_8h.html#a4c57837c88ef09274545ae2ebd18160a">pthread_cond_destroy</a>(&amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_cond);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#adba82e1bcd02de510a858fcbedf79ef1">av_freep</a>(&amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mem_ids);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#adba82e1bcd02de510a858fcbedf79ef1">av_freep</a>(&amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;surface_ptrs);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#adba82e1bcd02de510a858fcbedf79ef1">av_freep</a>(&amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;surfaces_internal);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <a class="code" href="group__lavu__buffer.html#ga135e9e929b5033bb8f68322497b2effc">av_buffer_unref</a>(&amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;child_frames_ref);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;}</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#a32d946005cf34f8fc5c8a3d5a9fb0bf8">  193</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="hwcontext__qsv_8c.html#a32d946005cf34f8fc5c8a3d5a9fb0bf8">qsv_pool_release_dummy</a>(<span class="keywordtype">void</span> *opaque, <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *<a class="code" href="mxf_8c.html#a084824fc871e38157790c99ae1240842">data</a>)</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;{</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;}</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#ab87f7254aeac060402c699ed724722bc">  197</a></span>&#160;<span class="keyword">static</span> <a class="code" href="struct_a_v_buffer_ref.html">AVBufferRef</a> *<a class="code" href="hwcontext__qsv_8c.html#ab87f7254aeac060402c699ed724722bc">qsv_pool_alloc</a>(<span class="keywordtype">void</span> *opaque, <span class="keywordtype">int</span> <a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>)</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;{</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a>    *<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a> = (<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a>*)opaque;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <a class="code" href="struct_q_s_v_frames_context.html">QSVFramesContext</a>       *<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a> = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;<a class="code" href="struct_a_v_format_context.html#a8a8bec51da36db65ff864f88a85805d9">internal</a>-&gt;priv;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <a class="code" href="struct_a_v_q_s_v_frames_context.html">AVQSVFramesContext</a> *hwctx = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;hwctx;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;nb_surfaces_used &lt; hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#a80ce1c761479c7fe226d1eeed5f131ed">nb_surfaces</a>) {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;nb_surfaces_used++;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__lavu__buffer.html#ga3e7f4c92db85ccba0b2a16dd0069842a">av_buffer_create</a>((<a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a>*)(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;surfaces_internal + <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;nb_surfaces_used - 1),</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                                <span class="keyword">sizeof</span>(*hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#a748121791d286d4099c8073152973d70">surfaces</a>), <a class="code" href="hwcontext__qsv_8c.html#a32d946005cf34f8fc5c8a3d5a9fb0bf8">qsv_pool_release_dummy</a>, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;}</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#a48f238ab9f05e0f305ba82e179cb2253">  212</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__qsv_8c.html#a48f238ab9f05e0f305ba82e179cb2253">qsv_init_child_ctx</a>(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>)</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;{</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <a class="code" href="struct_a_v_q_s_v_frames_context.html">AVQSVFramesContext</a>     *hwctx = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;hwctx;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="struct_q_s_v_frames_context.html">QSVFramesContext</a>           *<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a> = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;<a class="code" href="struct_a_v_format_context.html#a8a8bec51da36db65ff864f88a85805d9">internal</a>-&gt;priv;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="struct_q_s_v_device_context.html">QSVDeviceContext</a> *device_priv = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;device_ctx-&gt;<a class="code" href="struct_a_v_format_context.html#a8a8bec51da36db65ff864f88a85805d9">internal</a>-&gt;priv;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="struct_a_v_buffer_ref.html">AVBufferRef</a> *child_device_ref = <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <a class="code" href="struct_a_v_buffer_ref.html">AVBufferRef</a> *child_frames_ref = <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *child_device_ctx;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *child_frames_ctx;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = 0;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">if</span> (!device_priv-&gt;<a class="code" href="struct_q_s_v_device_context.html#a83bcfd0adba00e9341895299f1afee7c">handle</a>) {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>,</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;               <span class="stringliteral">&quot;Cannot create a non-opaque internal surface pool without &quot;</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;               <span class="stringliteral">&quot;a hardware handle\n&quot;</span>);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    child_device_ref = <a class="code" href="hwcontext_8c.html#a1cb1f874bb5a0ed7743f9a2b73b47e6e">av_hwdevice_ctx_alloc</a>(device_priv-&gt;<a class="code" href="struct_q_s_v_device_context.html#a92ab7a5d495bfaa0f6319c4ed4d1350d">child_device_type</a>);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">if</span> (!child_device_ref)</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    child_device_ctx   = (<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a>*)child_device_ref-&gt;<a class="code" href="struct_a_v_buffer_ref.html#acb8452e99cd75074b93800b532c6ea4b">data</a>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;#<span class="keywordflow">if</span> CONFIG_VAAPI</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <a class="code" href="filter__design_8txt.html#a0e82f1088fdc24c14bf175d2ac77523f">if</a> (child_device_ctx-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#abc92603a11768828ef3aea1f9d089308">type</a> == <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34af5dfa6181a3a6efb0f4a0c5f38d76b95">AV_HWDEVICE_TYPE_VAAPI</a>) {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <a class="code" href="struct_a_v_v_a_a_p_i_device_context.html">AVVAAPIDeviceContext</a> *child_device_hwctx = child_device_ctx-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a46055b48d1a40445d775b4ae24f77f20">hwctx</a>;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        child_device_hwctx-&gt;<a class="code" href="struct_a_v_v_a_a_p_i_device_context.html#a89951d5ccfad53ce81444773ea9f774e">display</a> = (VADisplay)device_priv-&gt;<a class="code" href="struct_q_s_v_device_context.html#a83bcfd0adba00e9341895299f1afee7c">handle</a>;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="preprocessor">#if CONFIG_DXVA2</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">if</span> (child_device_ctx-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#abc92603a11768828ef3aea1f9d089308">type</a> == <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34acc6f1868dad1c636d4747cc91ce71d10">AV_HWDEVICE_TYPE_DXVA2</a>) {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <a class="code" href="struct_a_v_d_x_v_a2_device_context.html">AVDXVA2DeviceContext</a> *child_device_hwctx = child_device_ctx-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a46055b48d1a40445d775b4ae24f77f20">hwctx</a>;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        child_device_hwctx-&gt;<a class="code" href="struct_a_v_d_x_v_a2_device_context.html#a3baea98a35192cc661f903198d7196ab">devmgr</a> = (IDirect3DDeviceManager9*)device_priv-&gt;<a class="code" href="struct_q_s_v_device_context.html#a83bcfd0adba00e9341895299f1afee7c">handle</a>;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = <a class="code" href="hwcontext_8c.html#a11d8c9101c95cdcab3dbc5b4c03dfd4d">av_hwdevice_ctx_init</a>(child_device_ref);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> &lt; 0) {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Error initializing a child device context\n&quot;</span>);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    child_frames_ref = <a class="code" href="hwcontext_8c.html#ac45a7c039eb4e084b692f69ff5f2e217">av_hwframe_ctx_alloc</a>(child_device_ref);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordflow">if</span> (!child_frames_ref) {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    }</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    child_frames_ctx = (<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a>*)child_frames_ref-&gt;<a class="code" href="struct_a_v_buffer_ref.html#acb8452e99cd75074b93800b532c6ea4b">data</a>;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    child_frames_ctx-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a045bc1713932804f6ceef170a5578e0e">format</a>            = device_priv-&gt;<a class="code" href="struct_q_s_v_device_context.html#afdb992f13510b59575c4c7ed940b09d4">child_pix_fmt</a>;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    child_frames_ctx-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a663a9aceca97aa7b2426c9aba6543e4a">sw_format</a>         = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;sw_format;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    child_frames_ctx-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a9c3a94dcd9c96e19059b56a6bae9c764">initial_pool_size</a> = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;initial_pool_size;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    child_frames_ctx-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a9e6f29d0f744930cdd0e8bdff8771520">width</a>             = <a class="code" href="macros_8h.html#acae4ba605b3a7d535b7ac058ffe96892">FFALIGN</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;width, 16);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    child_frames_ctx-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#ae61bbe1d8645a0c573085e29f1d0a58f">height</a>            = <a class="code" href="macros_8h.html#acae4ba605b3a7d535b7ac058ffe96892">FFALIGN</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;height, 16);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="preprocessor">#if CONFIG_DXVA2</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">if</span> (child_device_ctx-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#abc92603a11768828ef3aea1f9d089308">type</a> == <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34acc6f1868dad1c636d4747cc91ce71d10">AV_HWDEVICE_TYPE_DXVA2</a>) {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <a class="code" href="struct_a_v_d_x_v_a2_frames_context.html">AVDXVA2FramesContext</a> *child_frames_hwctx = child_frames_ctx-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a54e38c3e4355321e23e0f4c7411cb8ee">hwctx</a>;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">if</span> (hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#aadf9983d5965bd4c2cbe09c25fa2757a">frame_type</a> &amp; MFX_MEMTYPE_VIDEO_MEMORY_PROCESSOR_TARGET)</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            child_frames_hwctx-&gt;<a class="code" href="struct_a_v_d_x_v_a2_frames_context.html#abc67fe5747f160bf1f0bb98a506057ba">surface_type</a> = DXVA2_VideoProcessorRenderTarget;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            child_frames_hwctx-&gt;<a class="code" href="struct_a_v_d_x_v_a2_frames_context.html#abc67fe5747f160bf1f0bb98a506057ba">surface_type</a> = DXVA2_VideoDecoderRenderTarget;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = <a class="code" href="hwcontext_8c.html#a66a7e1ebc7e459ce07d3de6639ac7e38">av_hwframe_ctx_init</a>(child_frames_ref);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> &lt; 0) {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Error initializing a child frames context\n&quot;</span>);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="preprocessor">#if CONFIG_VAAPI</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">if</span> (child_device_ctx-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#abc92603a11768828ef3aea1f9d089308">type</a> == <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34af5dfa6181a3a6efb0f4a0c5f38d76b95">AV_HWDEVICE_TYPE_VAAPI</a>) {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <a class="code" href="struct_a_v_v_a_a_p_i_frames_context.html">AVVAAPIFramesContext</a> *child_frames_hwctx = child_frames_ctx-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a54e38c3e4355321e23e0f4c7411cb8ee">hwctx</a>;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;initial_pool_size; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;surfaces_internal[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].Data.MemId = child_frames_hwctx-&gt;<a class="code" href="struct_a_v_v_a_a_p_i_frames_context.html#a18c4ca9956227c498679a823e14e1375">surface_ids</a> + <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#aadf9983d5965bd4c2cbe09c25fa2757a">frame_type</a> = MFX_MEMTYPE_VIDEO_MEMORY_DECODER_TARGET;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="preprocessor">#if CONFIG_DXVA2</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">if</span> (child_device_ctx-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#abc92603a11768828ef3aea1f9d089308">type</a> == <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34acc6f1868dad1c636d4747cc91ce71d10">AV_HWDEVICE_TYPE_DXVA2</a>) {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <a class="code" href="struct_a_v_d_x_v_a2_frames_context.html">AVDXVA2FramesContext</a> *child_frames_hwctx = child_frames_ctx-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a54e38c3e4355321e23e0f4c7411cb8ee">hwctx</a>;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;initial_pool_size; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;surfaces_internal[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].Data.MemId = (mfxMemId)child_frames_hwctx-&gt;<a class="code" href="struct_a_v_d_x_v_a2_frames_context.html#a2025b21fc7ec906713c525a702fd6eb7">surfaces</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="keywordflow">if</span> (child_frames_hwctx-&gt;<a class="code" href="struct_a_v_d_x_v_a2_frames_context.html#abc67fe5747f160bf1f0bb98a506057ba">surface_type</a> == DXVA2_VideoProcessorRenderTarget)</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#aadf9983d5965bd4c2cbe09c25fa2757a">frame_type</a> = MFX_MEMTYPE_VIDEO_MEMORY_PROCESSOR_TARGET;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#aadf9983d5965bd4c2cbe09c25fa2757a">frame_type</a> = MFX_MEMTYPE_VIDEO_MEMORY_DECODER_TARGET;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;child_frames_ref       = child_frames_ref;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    child_frames_ref          = <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>:</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="group__lavu__buffer.html#ga135e9e929b5033bb8f68322497b2effc">av_buffer_unref</a>(&amp;child_device_ref);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="group__lavu__buffer.html#ga135e9e929b5033bb8f68322497b2effc">av_buffer_unref</a>(&amp;child_frames_ref);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;}</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#aa11be42c33da0099d9989237029036a2">  315</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__qsv_8c.html#aa11be42c33da0099d9989237029036a2">qsv_init_surface</a>(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, mfxFrameSurface1 *surf)</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;{</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keyword">const</span> <a class="code" href="struct_a_v_pix_fmt_descriptor.html">AVPixFmtDescriptor</a> *<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    uint32_t <a class="code" href="hwcontext__qsv_8c.html#aa5d906425500585aa7832161b2a40e1b">fourcc</a>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a> = <a class="code" href="pixdesc_8c.html#afe0c3e8aef5173de28bbdaea4298f5f0">av_pix_fmt_desc_get</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;sw_format);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>)</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <a class="code" href="hwcontext__qsv_8c.html#aa5d906425500585aa7832161b2a40e1b">fourcc</a> = <a class="code" href="hwcontext__qsv_8c.html#aaf17e113e894aa2f7b8e369e2e21224b">qsv_fourcc_from_pix_fmt</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;sw_format);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="hwcontext__qsv_8c.html#aa5d906425500585aa7832161b2a40e1b">fourcc</a>)</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    surf-&gt;Info.BitDepthLuma   = <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;comp[0].depth;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    surf-&gt;Info.BitDepthChroma = <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;comp[0].depth;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    surf-&gt;Info.Shift          = <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;comp[0].depth &gt; 8;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;log2_chroma_w &amp;&amp; <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;log2_chroma_h)</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        surf-&gt;Info.ChromaFormat   = MFX_CHROMAFORMAT_YUV420;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;log2_chroma_w)</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        surf-&gt;Info.ChromaFormat   = MFX_CHROMAFORMAT_YUV422;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        surf-&gt;Info.ChromaFormat   = MFX_CHROMAFORMAT_YUV444;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    surf-&gt;Info.FourCC         = <a class="code" href="hwcontext__qsv_8c.html#aa5d906425500585aa7832161b2a40e1b">fourcc</a>;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    surf-&gt;Info.Width          = <a class="code" href="macros_8h.html#acae4ba605b3a7d535b7ac058ffe96892">FFALIGN</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;width, 16);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    surf-&gt;Info.CropW          = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;width;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    surf-&gt;Info.Height         = <a class="code" href="macros_8h.html#acae4ba605b3a7d535b7ac058ffe96892">FFALIGN</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;height, 16);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    surf-&gt;Info.CropH          = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;height;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    surf-&gt;Info.FrameRateExtN  = 25;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    surf-&gt;Info.FrameRateExtD  = 1;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    surf-&gt;Info.PicStruct      = MFX_PICSTRUCT_PROGRESSIVE;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;}</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#a803ad9dc7d68cc443babfd7ba37d4671">  351</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__qsv_8c.html#a803ad9dc7d68cc443babfd7ba37d4671">qsv_init_pool</a>(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, uint32_t <a class="code" href="hwcontext__qsv_8c.html#aa5d906425500585aa7832161b2a40e1b">fourcc</a>)</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;{</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <a class="code" href="struct_q_s_v_frames_context.html">QSVFramesContext</a>              *<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a> = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;<a class="code" href="struct_a_v_format_context.html#a8a8bec51da36db65ff864f88a85805d9">internal</a>-&gt;priv;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <a class="code" href="struct_a_v_q_s_v_frames_context.html">AVQSVFramesContext</a> *frames_hwctx = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;hwctx;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = 0;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;initial_pool_size &lt;= 0) {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;QSV requires a fixed frame pool size\n&quot;</span>);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;surfaces_internal = <a class="code" href="mem_8c.html#aedc3761897b7e9ea8ae1222b3d013c94">av_mallocz_array</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;initial_pool_size,</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                                            <span class="keyword">sizeof</span>(*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;surfaces_internal));</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;surfaces_internal)</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;initial_pool_size; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = <a class="code" href="hwcontext__qsv_8c.html#aa11be42c33da0099d9989237029036a2">qsv_init_surface</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, &amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;surfaces_internal[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> &lt; 0)</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    }</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">if</span> (!(frames_hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#aadf9983d5965bd4c2cbe09c25fa2757a">frame_type</a> &amp; MFX_MEMTYPE_OPAQUE_FRAME)) {</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = <a class="code" href="hwcontext__qsv_8c.html#a48f238ab9f05e0f305ba82e179cb2253">qsv_init_child_ctx</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> &lt; 0)</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    }</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;<a class="code" href="struct_a_v_format_context.html#a8a8bec51da36db65ff864f88a85805d9">internal</a>-&gt;pool_internal = <a class="code" href="group__lavu__bufferpool.html#ga615151c8889d5be39d17bce4d8c65117">av_buffer_pool_init2</a>(<span class="keyword">sizeof</span>(mfxFrameSurface1),</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                                                        <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="hwcontext__qsv_8c.html#ab87f7254aeac060402c699ed724722bc">qsv_pool_alloc</a>, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;<a class="code" href="struct_a_v_format_context.html#a8a8bec51da36db65ff864f88a85805d9">internal</a>-&gt;pool_internal)</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    frames_hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#a748121791d286d4099c8073152973d70">surfaces</a>    = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;surfaces_internal;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    frames_hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#a80ce1c761479c7fe226d1eeed5f131ed">nb_surfaces</a> = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;initial_pool_size;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;}</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#a57ebafa8b3520aa3c0fb8a1a893559cf">  391</a></span>&#160;<span class="keyword">static</span> mfxStatus <a class="code" href="hwcontext__qsv_8c.html#a57ebafa8b3520aa3c0fb8a1a893559cf">frame_alloc</a>(mfxHDL pthis, mfxFrameAllocRequest *req,</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                             mfxFrameAllocResponse *resp)</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;{</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a>    *<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a> = pthis;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <a class="code" href="struct_q_s_v_frames_context.html">QSVFramesContext</a>       *<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a> = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;<a class="code" href="struct_a_v_format_context.html#a8a8bec51da36db65ff864f88a85805d9">internal</a>-&gt;priv;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <a class="code" href="struct_a_v_q_s_v_frames_context.html">AVQSVFramesContext</a> *hwctx = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;hwctx;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    mfxFrameInfo *<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>  = &amp;req-&gt;Info;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    mfxFrameInfo *i1 = &amp;hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#a748121791d286d4099c8073152973d70">surfaces</a>[0].Info;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordflow">if</span> (!(req-&gt;Type &amp; MFX_MEMTYPE_VIDEO_MEMORY_PROCESSOR_TARGET) ||</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        !(req-&gt;Type &amp; (MFX_MEMTYPE_FROM_VPPIN | MFX_MEMTYPE_FROM_VPPOUT)) ||</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        !(req-&gt;Type &amp; MFX_MEMTYPE_EXTERNAL_FRAME))</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="keywordflow">return</span> MFX_ERR_UNSUPPORTED;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>-&gt;Width  &gt; i1-&gt;Width || <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>-&gt;Height &gt; i1-&gt;Height ||</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>-&gt;FourCC != i1-&gt;FourCC || <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>-&gt;ChromaFormat != i1-&gt;ChromaFormat) {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Mismatching surface properties in an &quot;</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;               <span class="stringliteral">&quot;allocation request: %dx%d %d %d vs %dx%d %d %d\n&quot;</span>,</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;               <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>-&gt;Width,  <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>-&gt;Height,  <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>-&gt;FourCC,  <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>-&gt;ChromaFormat,</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;               i1-&gt;Width, i1-&gt;Height, i1-&gt;FourCC, i1-&gt;ChromaFormat);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <span class="keywordflow">return</span> MFX_ERR_UNSUPPORTED;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    resp-&gt;mids           = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mem_ids;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    resp-&gt;NumFrameActual = hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#a80ce1c761479c7fe226d1eeed5f131ed">nb_surfaces</a>;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordflow">return</span> MFX_ERR_NONE;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;}</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#acb8eeb6e668f19381ec8cac034decd71">  419</a></span>&#160;<span class="keyword">static</span> mfxStatus <a class="code" href="hwcontext__qsv_8c.html#acb8eeb6e668f19381ec8cac034decd71">frame_free</a>(mfxHDL pthis, mfxFrameAllocResponse *resp)</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;{</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordflow">return</span> MFX_ERR_NONE;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;}</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#a791047364870cba9824a059a30f0daab">  424</a></span>&#160;<span class="keyword">static</span> mfxStatus <a class="code" href="hwcontext__qsv_8c.html#a791047364870cba9824a059a30f0daab">frame_lock</a>(mfxHDL pthis, mfxMemId mid, mfxFrameData *ptr)</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;{</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordflow">return</span> MFX_ERR_UNSUPPORTED;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;}</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#ad98c9959d58461d45084a6644c26cb45">  429</a></span>&#160;<span class="keyword">static</span> mfxStatus <a class="code" href="hwcontext__qsv_8c.html#ad98c9959d58461d45084a6644c26cb45">frame_unlock</a>(mfxHDL pthis, mfxMemId mid, mfxFrameData *ptr)</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;{</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordflow">return</span> MFX_ERR_UNSUPPORTED;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;}</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#a6bbaba0ff800822726baffce44482dd1">  434</a></span>&#160;<span class="keyword">static</span> mfxStatus <a class="code" href="hwcontext__qsv_8c.html#a6bbaba0ff800822726baffce44482dd1">frame_get_hdl</a>(mfxHDL pthis, mfxMemId mid, mfxHDL *hdl)</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;{</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    *hdl = mid;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordflow">return</span> MFX_ERR_NONE;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;}</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#a56a518c57d01ebe5a2c68ce6035ad837">  440</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__qsv_8c.html#a56a518c57d01ebe5a2c68ce6035ad837">qsv_init_internal_session</a>(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>,</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                                     mfxSession *session, <span class="keywordtype">int</span> upload)</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;{</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <a class="code" href="struct_q_s_v_frames_context.html">QSVFramesContext</a>              *<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a> = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;<a class="code" href="struct_a_v_format_context.html#a8a8bec51da36db65ff864f88a85805d9">internal</a>-&gt;priv;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <a class="code" href="struct_a_v_q_s_v_frames_context.html">AVQSVFramesContext</a> *frames_hwctx = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;hwctx;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <a class="code" href="struct_q_s_v_device_context.html">QSVDeviceContext</a>   *device_priv  = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;device_ctx-&gt;<a class="code" href="struct_a_v_format_context.html#a8a8bec51da36db65ff864f88a85805d9">internal</a>-&gt;priv;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordtype">int</span> opaque = !!(frames_hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#aadf9983d5965bd4c2cbe09c25fa2757a">frame_type</a> &amp; MFX_MEMTYPE_OPAQUE_FRAME);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    mfxFrameAllocator frame_allocator = {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        .pthis  = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>,</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        .Alloc  = <a class="code" href="hwcontext__qsv_8c.html#a57ebafa8b3520aa3c0fb8a1a893559cf">frame_alloc</a>,</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        .Lock   = <a class="code" href="hwcontext__qsv_8c.html#a791047364870cba9824a059a30f0daab">frame_lock</a>,</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        .Unlock = <a class="code" href="hwcontext__qsv_8c.html#ad98c9959d58461d45084a6644c26cb45">frame_unlock</a>,</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        .GetHDL = <a class="code" href="hwcontext__qsv_8c.html#a6bbaba0ff800822726baffce44482dd1">frame_get_hdl</a>,</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        .Free   = <a class="code" href="hwcontext__qsv_8c.html#acb8eeb6e668f19381ec8cac034decd71">frame_free</a>,</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    };</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    mfxVideoParam par;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    mfxStatus err;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    err = MFXInit(device_priv-&gt;<a class="code" href="struct_q_s_v_device_context.html#a69bcb59f86315e626b2c6c6c62fa3b91">impl</a>, &amp;device_priv-&gt;<a class="code" href="struct_q_s_v_device_context.html#a11c9e7859a9dc46f0d49bef21d2cd650">ver</a>, session);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordflow">if</span> (err != MFX_ERR_NONE) {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Error initializing an internal session\n&quot;</span>);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__lavu__error.html#ga4ebaa288c7684a26a591c501208910e4">AVERROR_UNKNOWN</a>;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    }</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordflow">if</span> (device_priv-&gt;<a class="code" href="struct_q_s_v_device_context.html#a83bcfd0adba00e9341895299f1afee7c">handle</a>) {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        err = MFXVideoCORE_SetHandle(*session, device_priv-&gt;<a class="code" href="struct_q_s_v_device_context.html#aa12e122ac94c307f477fda7a18cd7893">handle_type</a>,</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                                     device_priv-&gt;<a class="code" href="struct_q_s_v_device_context.html#a83bcfd0adba00e9341895299f1afee7c">handle</a>);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        <span class="keywordflow">if</span> (err != MFX_ERR_NONE)</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="group__lavu__error.html#ga4ebaa288c7684a26a591c501208910e4">AVERROR_UNKNOWN</a>;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">if</span> (!opaque) {</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        err = MFXVideoCORE_SetFrameAllocator(*session, &amp;frame_allocator);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <span class="keywordflow">if</span> (err != MFX_ERR_NONE)</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="group__lavu__error.html#ga4ebaa288c7684a26a591c501208910e4">AVERROR_UNKNOWN</a>;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    }</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    memset(&amp;par, 0, <span class="keyword">sizeof</span>(par));</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordflow">if</span> (opaque) {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        par.ExtParam    = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;ext_buffers;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        par.NumExtParam = <a class="code" href="sinewin__tablegen__template_8c.html#a3508a98d3ee7e2c9a4841fe264cf70f7">FF_ARRAY_ELEMS</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;ext_buffers);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        par.IOPattern   = upload ? MFX_IOPATTERN_OUT_OPAQUE_MEMORY :</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                                   MFX_IOPATTERN_IN_OPAQUE_MEMORY;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        par.IOPattern = upload ? MFX_IOPATTERN_OUT_VIDEO_MEMORY :</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                                 MFX_IOPATTERN_IN_VIDEO_MEMORY;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    }</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    par.IOPattern |= upload ? MFX_IOPATTERN_IN_SYSTEM_MEMORY :</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                              MFX_IOPATTERN_OUT_SYSTEM_MEMORY;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    par.AsyncDepth = 1;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    par.vpp.In = frames_hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#a748121791d286d4099c8073152973d70">surfaces</a>[0].Info;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160; </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="comment">/* Apparently VPP requires the frame rate to be set to some value, otherwise</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">     * init will fail (probably for the framerate conversion filter). Since we</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">     * are only doing data upload/download here, we just invent an arbitrary</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">     * value */</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    par.vpp.In.FrameRateExtN = 25;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    par.vpp.In.FrameRateExtD = 1;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    par.vpp.Out = par.vpp.In;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160; </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    err = MFXVideoVPP_Init(*session, &amp;par);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordflow">if</span> (err != MFX_ERR_NONE) {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>, <span class="stringliteral">&quot;Error opening the internal VPP session.&quot;</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;               <span class="stringliteral">&quot;Surface upload/download will not be possible\n&quot;</span>);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        MFXClose(*session);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        *session = <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;}</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#a5e17476aca2cc0ba08808ca9bd0a4213">  516</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__qsv_8c.html#a5e17476aca2cc0ba08808ca9bd0a4213">qsv_frames_init</a>(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>)</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;{</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <a class="code" href="struct_q_s_v_frames_context.html">QSVFramesContext</a>              *<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a> = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;<a class="code" href="struct_a_v_format_context.html#a8a8bec51da36db65ff864f88a85805d9">internal</a>-&gt;priv;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <a class="code" href="struct_a_v_q_s_v_frames_context.html">AVQSVFramesContext</a> *frames_hwctx = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;hwctx;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keywordtype">int</span> opaque = !!(frames_hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#aadf9983d5965bd4c2cbe09c25fa2757a">frame_type</a> &amp; MFX_MEMTYPE_OPAQUE_FRAME);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    uint32_t <a class="code" href="hwcontext__qsv_8c.html#aa5d906425500585aa7832161b2a40e1b">fourcc</a>;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <a class="code" href="hwcontext__qsv_8c.html#aa5d906425500585aa7832161b2a40e1b">fourcc</a> = <a class="code" href="hwcontext__qsv_8c.html#aaf17e113e894aa2f7b8e369e2e21224b">qsv_fourcc_from_pix_fmt</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;sw_format);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="hwcontext__qsv_8c.html#aa5d906425500585aa7832161b2a40e1b">fourcc</a>) {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Unsupported pixel format\n&quot;</span>);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOSYS);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    }</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;pool) {</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = <a class="code" href="hwcontext__qsv_8c.html#a803ad9dc7d68cc443babfd7ba37d4671">qsv_init_pool</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="hwcontext__qsv_8c.html#aa5d906425500585aa7832161b2a40e1b">fourcc</a>);</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> &lt; 0) {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Error creating an internal frame pool\n&quot;</span>);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        }</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    }</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160; </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="keywordflow">if</span> (opaque) {</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;surface_ptrs = <a class="code" href="mem_8c.html#aedc3761897b7e9ea8ae1222b3d013c94">av_mallocz_array</a>(frames_hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#a80ce1c761479c7fe226d1eeed5f131ed">nb_surfaces</a>,</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                                           <span class="keyword">sizeof</span>(*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;surface_ptrs));</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;surface_ptrs)</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; frames_hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#a80ce1c761479c7fe226d1eeed5f131ed">nb_surfaces</a>; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;surface_ptrs[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>] = frames_hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#a748121791d286d4099c8073152973d70">surfaces</a> + <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;opaque_alloc.In.Surfaces   = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;surface_ptrs;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;opaque_alloc.In.NumSurface = frames_hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#a80ce1c761479c7fe226d1eeed5f131ed">nb_surfaces</a>;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;opaque_alloc.In.Type       = frames_hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#aadf9983d5965bd4c2cbe09c25fa2757a">frame_type</a>;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;opaque_alloc.Out = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;opaque_alloc.In;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160; </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;opaque_alloc.Header.BufferId = MFX_EXTBUFF_OPAQUE_SURFACE_ALLOCATION;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;opaque_alloc.Header.BufferSz = <span class="keyword">sizeof</span>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;opaque_alloc);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;ext_buffers[0] = (mfxExtBuffer*)&amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;opaque_alloc;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mem_ids = <a class="code" href="mem_8c.html#aedc3761897b7e9ea8ae1222b3d013c94">av_mallocz_array</a>(frames_hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#a80ce1c761479c7fe226d1eeed5f131ed">nb_surfaces</a>, <span class="keyword">sizeof</span>(*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mem_ids));</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mem_ids)</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160; </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; frames_hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#a80ce1c761479c7fe226d1eeed5f131ed">nb_surfaces</a>; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;            <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mem_ids[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>] = frames_hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#a748121791d286d4099c8073152973d70">surfaces</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].Data.MemId;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    }</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_download = <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_upload   = <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160; </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_download_init = 0;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_upload_init   = 0;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160; </div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="preprocessor">#if HAVE_PTHREADS</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <a class="code" href="os2threads_8h.html#a4f8250fbf301e0e62dad0aad3ba030a9">pthread_mutex_init</a>(&amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_lock, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <a class="code" href="os2threads_8h.html#a90293d12cef762b6df0139309d13fdbf">pthread_cond_init</a>(&amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_cond, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;}</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#ae0cd7b25815a2c03d49159633998d6ec">  582</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__qsv_8c.html#ae0cd7b25815a2c03d49159633998d6ec">qsv_get_buffer</a>(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="struct_a_v_frame.html">AVFrame</a> *<a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>)</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;{</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;buf[0] = <a class="code" href="group__lavu__bufferpool.html#ga2c745ecb4001452423e775b06b20fb7c">av_buffer_pool_get</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;pool);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;buf[0])</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;data[3] = <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;buf[0]-&gt;data;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;format  = <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5ac913414b6091ce30035b21b9c0bc1c8e">AV_PIX_FMT_QSV</a>;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;width   = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;width;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;height  = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;height;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;}</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; </div>
<div class="line"><a name="l00596"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#a8562eaeaf740a3e9756615b6c3bbbccb">  596</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__qsv_8c.html#a8562eaeaf740a3e9756615b6c3bbbccb">qsv_transfer_get_formats</a>(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>,</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                                    <span class="keyword">enum</span> <a class="code" href="hwcontext_8h.html#aba8d70ed754b2536ca497d7d50ec7b1e">AVHWFrameTransferDirection</a> dir,</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                                    <span class="keyword">enum</span> <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5">AVPixelFormat</a> **<a class="code" href="signature_8h.html#a12f58149bb2cdab504621ba5b390ef64">formats</a>)</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;{</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keyword">enum</span> <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5">AVPixelFormat</a> *fmts;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    fmts = <a class="code" href="mem_8c.html#a254f3455439c15a2c8a75b8f0235fdbd">av_malloc_array</a>(2, <span class="keyword">sizeof</span>(*fmts));</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordflow">if</span> (!fmts)</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    fmts[0] = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;sw_format;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    fmts[1] = <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a0e08f8a5d0fa21c3e258816a9dcce7c3">AV_PIX_FMT_NONE</a>;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    *<a class="code" href="signature_8h.html#a12f58149bb2cdab504621ba5b390ef64">formats</a> = fmts;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;}</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160; </div>
<div class="line"><a name="l00614"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#a7ac8c294b998bd5ef04142db43c10e29">  614</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__qsv_8c.html#a7ac8c294b998bd5ef04142db43c10e29">qsv_frames_derive_from</a>(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *dst_ctx,</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                                  <a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *src_ctx, <span class="keywordtype">int</span> <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>)</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;{</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <a class="code" href="struct_a_v_q_s_v_frames_context.html">AVQSVFramesContext</a> *src_hwctx = src_ctx-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a54e38c3e4355321e23e0f4c7411cb8ee">hwctx</a>;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160; </div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="keywordflow">switch</span> (dst_ctx-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#ac9a7dbd0cbfcabc0b1529cb34cf53b6d">device_ctx</a>-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#abc92603a11768828ef3aea1f9d089308">type</a>) {</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="preprocessor">#if CONFIG_VAAPI</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34af5dfa6181a3a6efb0f4a0c5f38d76b95">AV_HWDEVICE_TYPE_VAAPI</a>:</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            <a class="code" href="struct_a_v_v_a_a_p_i_frames_context.html">AVVAAPIFramesContext</a> *dst_hwctx = dst_ctx-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a54e38c3e4355321e23e0f4c7411cb8ee">hwctx</a>;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            dst_hwctx-&gt;<a class="code" href="struct_a_v_v_a_a_p_i_frames_context.html#a18c4ca9956227c498679a823e14e1375">surface_ids</a> = <a class="code" href="mem_8c.html#aedc3761897b7e9ea8ae1222b3d013c94">av_mallocz_array</a>(src_hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#a80ce1c761479c7fe226d1eeed5f131ed">nb_surfaces</a>,</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                                                      <span class="keyword">sizeof</span>(*dst_hwctx-&gt;<a class="code" href="struct_a_v_v_a_a_p_i_frames_context.html#a18c4ca9956227c498679a823e14e1375">surface_ids</a>));</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            <span class="keywordflow">if</span> (!dst_hwctx-&gt;<a class="code" href="struct_a_v_v_a_a_p_i_frames_context.html#a18c4ca9956227c498679a823e14e1375">surface_ids</a>)</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; src_hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#a80ce1c761479c7fe226d1eeed5f131ed">nb_surfaces</a>; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                dst_hwctx-&gt;<a class="code" href="struct_a_v_v_a_a_p_i_frames_context.html#a18c4ca9956227c498679a823e14e1375">surface_ids</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>] =</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                    *(VASurfaceID*)src_hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#a748121791d286d4099c8073152973d70">surfaces</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].Data.MemId;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            dst_hwctx-&gt;<a class="code" href="struct_a_v_v_a_a_p_i_frames_context.html#af574bfa0abf14b96ae667f25494a3bcf">nb_surfaces</a> = src_hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#a80ce1c761479c7fe226d1eeed5f131ed">nb_surfaces</a>;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        }</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="preprocessor">#if CONFIG_DXVA2</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34acc6f1868dad1c636d4747cc91ce71d10">AV_HWDEVICE_TYPE_DXVA2</a>:</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            <a class="code" href="struct_a_v_d_x_v_a2_frames_context.html">AVDXVA2FramesContext</a> *dst_hwctx = dst_ctx-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a54e38c3e4355321e23e0f4c7411cb8ee">hwctx</a>;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            dst_hwctx-&gt;<a class="code" href="struct_a_v_d_x_v_a2_frames_context.html#a2025b21fc7ec906713c525a702fd6eb7">surfaces</a> = <a class="code" href="mem_8c.html#aedc3761897b7e9ea8ae1222b3d013c94">av_mallocz_array</a>(src_hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#a80ce1c761479c7fe226d1eeed5f131ed">nb_surfaces</a>,</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                                                   <span class="keyword">sizeof</span>(*dst_hwctx-&gt;<a class="code" href="struct_a_v_d_x_v_a2_frames_context.html#a2025b21fc7ec906713c525a702fd6eb7">surfaces</a>));</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <span class="keywordflow">if</span> (!dst_hwctx-&gt;<a class="code" href="struct_a_v_d_x_v_a2_frames_context.html#a2025b21fc7ec906713c525a702fd6eb7">surfaces</a>)</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; src_hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#a80ce1c761479c7fe226d1eeed5f131ed">nb_surfaces</a>; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                dst_hwctx-&gt;<a class="code" href="struct_a_v_d_x_v_a2_frames_context.html#a2025b21fc7ec906713c525a702fd6eb7">surfaces</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>] =</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                    (IDirect3DSurface9*)src_hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#a748121791d286d4099c8073152973d70">surfaces</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].Data.MemId;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            dst_hwctx-&gt;<a class="code" href="struct_a_v_d_x_v_a2_frames_context.html#a867fec347dd21aa778948df67cf00450">nb_surfaces</a> = src_hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#a80ce1c761479c7fe226d1eeed5f131ed">nb_surfaces</a>;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            <span class="keywordflow">if</span> (src_hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#aadf9983d5965bd4c2cbe09c25fa2757a">frame_type</a> == MFX_MEMTYPE_VIDEO_MEMORY_DECODER_TARGET)</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                dst_hwctx-&gt;<a class="code" href="struct_a_v_d_x_v_a2_frames_context.html#abc67fe5747f160bf1f0bb98a506057ba">surface_type</a> = DXVA2_VideoDecoderRenderTarget;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                dst_hwctx-&gt;<a class="code" href="struct_a_v_d_x_v_a2_frames_context.html#abc67fe5747f160bf1f0bb98a506057ba">surface_type</a> = DXVA2_VideoProcessorRenderTarget;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        }</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOSYS);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    }</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;}</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#a077c57cd37540d31a31f00519805b982">  662</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__qsv_8c.html#a077c57cd37540d31a31f00519805b982">qsv_map_from</a>(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>,</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                        <a class="code" href="struct_a_v_frame.html">AVFrame</a> *dst, <span class="keyword">const</span> <a class="code" href="struct_a_v_frame.html">AVFrame</a> *<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>, <span class="keywordtype">int</span> <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>)</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;{</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <a class="code" href="struct_q_s_v_frames_context.html">QSVFramesContext</a> *<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a> = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;<a class="code" href="struct_a_v_format_context.html#a8a8bec51da36db65ff864f88a85805d9">internal</a>-&gt;priv;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    mfxFrameSurface1 *surf = (mfxFrameSurface1*)<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;data[3];</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *child_frames_ctx;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="keyword">const</span> <a class="code" href="struct_a_v_pix_fmt_descriptor.html">AVPixFmtDescriptor</a> *<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *child_data;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <a class="code" href="struct_a_v_frame.html">AVFrame</a> *<a class="code" href="motion_8c.html#a7c1d654b7b6114d7a0abc8d351dd1bcd">dummy</a>;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = 0;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <a class="code" href="filter__design_8txt.html#a0e82f1088fdc24c14bf175d2ac77523f">if</a> (!<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;child_frames_ref)</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOSYS);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    child_frames_ctx = (<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a>*)<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;child_frames_ref-&gt;data;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    switch (child_frames_ctx-&gt;device_ctx-&gt;type) {</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="preprocessor">#if CONFIG_VAAPI</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34af5dfa6181a3a6efb0f4a0c5f38d76b95">AV_HWDEVICE_TYPE_VAAPI</a>:</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        child_data = (<a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a>*)(intptr_t)*(VASurfaceID*)surf-&gt;Data.MemId;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;#endif</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;#<span class="keywordflow">if</span> CONFIG_DXVA2</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34acc6f1868dad1c636d4747cc91ce71d10">AV_HWDEVICE_TYPE_DXVA2</a>:</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        child_data = surf-&gt;Data.MemId;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;#endif</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOSYS);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    }</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160; </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="keywordflow">if</span> (dst-&gt;<a class="code" href="struct_a_v_frame.html#aed14fa772ce46881020fd1545c86432c">format</a> == child_frames_ctx-&gt;format) {</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = <a class="code" href="hwcontext_8c.html#a76e0387f519b3f1bd1b162e91b54b182">ff_hwframe_map_create</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;child_frames_ref,</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                                    dst, <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> &lt; 0)</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        dst-&gt;<a class="code" href="struct_a_v_frame.html#a1e71ce60cedd5f3b6811714a9f7f9e0a">width</a>   = <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;width;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        dst-&gt;<a class="code" href="struct_a_v_frame.html#a3f89733f429c98ba5bc64373fb0a3f13">height</a>  = <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;height;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        dst-&gt;<a class="code" href="struct_a_v_frame.html#a1d0f65014a8d1bf78cec8cbed2304992">data</a>[3] = child_data;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160; </div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    }</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a> = <a class="code" href="pixdesc_8c.html#afe0c3e8aef5173de28bbdaea4298f5f0">av_pix_fmt_desc_get</a>(dst-&gt;<a class="code" href="struct_a_v_frame.html#aed14fa772ce46881020fd1545c86432c">format</a>);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a> &amp;&amp; <a class="code" href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a>-&gt;flags &amp; <a class="code" href="pixdesc_8h.html#a76f6211b2404231bd7d206ebf4ae46f6">AV_PIX_FMT_FLAG_HWACCEL</a>) {</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <span class="comment">// This only supports mapping to software.</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOSYS);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    }</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; </div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <a class="code" href="motion_8c.html#a7c1d654b7b6114d7a0abc8d351dd1bcd">dummy</a> = <a class="code" href="group__lavu__frame.html#gac700017c5270c79c1e1befdeeb008b2f">av_frame_alloc</a>();</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="motion_8c.html#a7c1d654b7b6114d7a0abc8d351dd1bcd">dummy</a>)</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <a class="code" href="motion_8c.html#a7c1d654b7b6114d7a0abc8d351dd1bcd">dummy</a>-&gt;buf[0]        = <a class="code" href="group__lavu__buffer.html#gaa40ce7d3ede946a89d03323bbd7268c1">av_buffer_ref</a>(<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;buf[0]);</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <a class="code" href="motion_8c.html#a7c1d654b7b6114d7a0abc8d351dd1bcd">dummy</a>-&gt;hw_frames_ctx = <a class="code" href="group__lavu__buffer.html#gaa40ce7d3ede946a89d03323bbd7268c1">av_buffer_ref</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;child_frames_ref);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="motion_8c.html#a7c1d654b7b6114d7a0abc8d351dd1bcd">dummy</a>-&gt;buf[0] || !<a class="code" href="motion_8c.html#a7c1d654b7b6114d7a0abc8d351dd1bcd">dummy</a>-&gt;hw_frames_ctx)</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160; </div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <a class="code" href="motion_8c.html#a7c1d654b7b6114d7a0abc8d351dd1bcd">dummy</a>-&gt;format        = child_frames_ctx-&gt;format;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <a class="code" href="motion_8c.html#a7c1d654b7b6114d7a0abc8d351dd1bcd">dummy</a>-&gt;width         = <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;width;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <a class="code" href="motion_8c.html#a7c1d654b7b6114d7a0abc8d351dd1bcd">dummy</a>-&gt;height        = <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;height;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <a class="code" href="motion_8c.html#a7c1d654b7b6114d7a0abc8d351dd1bcd">dummy</a>-&gt;data[3]       = child_data;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = <a class="code" href="hwcontext_8c.html#a99e028453fba7e66483c2189439219d2">av_hwframe_map</a>(dst, <a class="code" href="motion_8c.html#a7c1d654b7b6114d7a0abc8d351dd1bcd">dummy</a>, <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160; </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>:</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <a class="code" href="group__lavu__frame.html#ga979d73f3228814aee56aeca0636e37cc">av_frame_free</a>(&amp;<a class="code" href="motion_8c.html#a7c1d654b7b6114d7a0abc8d351dd1bcd">dummy</a>);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160; </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;}</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; </div>
<div class="line"><a name="l00733"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#ae83242ca5392487045d4e2d5a4e172c7">  733</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__qsv_8c.html#ae83242ca5392487045d4e2d5a4e172c7">qsv_transfer_data_child</a>(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="struct_a_v_frame.html">AVFrame</a> *dst,</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                                   <span class="keyword">const</span> <a class="code" href="struct_a_v_frame.html">AVFrame</a> *<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>)</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;{</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <a class="code" href="struct_q_s_v_frames_context.html">QSVFramesContext</a> *<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a> = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;<a class="code" href="struct_a_v_format_context.html#a8a8bec51da36db65ff864f88a85805d9">internal</a>-&gt;priv;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *child_frames_ctx = (<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a>*)<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;child_frames_ref-&gt;data;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="keywordtype">int</span> download = !!<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;hw_frames_ctx;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    mfxFrameSurface1 *surf = (mfxFrameSurface1*)(download ? <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;data[3] : dst-&gt;<a class="code" href="struct_a_v_frame.html#a1d0f65014a8d1bf78cec8cbed2304992">data</a>[3]);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160; </div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <a class="code" href="struct_a_v_frame.html">AVFrame</a> *<a class="code" href="motion_8c.html#a7c1d654b7b6114d7a0abc8d351dd1bcd">dummy</a>;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160; </div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <a class="code" href="motion_8c.html#a7c1d654b7b6114d7a0abc8d351dd1bcd">dummy</a> = <a class="code" href="group__lavu__frame.html#gac700017c5270c79c1e1befdeeb008b2f">av_frame_alloc</a>();</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="motion_8c.html#a7c1d654b7b6114d7a0abc8d351dd1bcd">dummy</a>)</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160; </div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <a class="code" href="motion_8c.html#a7c1d654b7b6114d7a0abc8d351dd1bcd">dummy</a>-&gt;format        = child_frames_ctx-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a045bc1713932804f6ceef170a5578e0e">format</a>;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <a class="code" href="motion_8c.html#a7c1d654b7b6114d7a0abc8d351dd1bcd">dummy</a>-&gt;width         = <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;width;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <a class="code" href="motion_8c.html#a7c1d654b7b6114d7a0abc8d351dd1bcd">dummy</a>-&gt;height        = <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;height;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <a class="code" href="motion_8c.html#a7c1d654b7b6114d7a0abc8d351dd1bcd">dummy</a>-&gt;buf[0]        = download ? <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;buf[0] : dst-&gt;<a class="code" href="struct_a_v_frame.html#a4a64d05cc676bfa8e18bf22d16c8a51f">buf</a>[0];</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <a class="code" href="motion_8c.html#a7c1d654b7b6114d7a0abc8d351dd1bcd">dummy</a>-&gt;data[3]       = surf-&gt;Data.MemId;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <a class="code" href="motion_8c.html#a7c1d654b7b6114d7a0abc8d351dd1bcd">dummy</a>-&gt;hw_frames_ctx = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;child_frames_ref;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160; </div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = download ? <a class="code" href="hwcontext_8c.html#abf1b1664b8239d953ae2cac8b643815a">av_hwframe_transfer_data</a>(dst, <a class="code" href="motion_8c.html#a7c1d654b7b6114d7a0abc8d351dd1bcd">dummy</a>, 0) :</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                     <a class="code" href="hwcontext_8c.html#abf1b1664b8239d953ae2cac8b643815a">av_hwframe_transfer_data</a>(<a class="code" href="motion_8c.html#a7c1d654b7b6114d7a0abc8d351dd1bcd">dummy</a>, <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>, 0);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160; </div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <a class="code" href="motion_8c.html#a7c1d654b7b6114d7a0abc8d351dd1bcd">dummy</a>-&gt;buf[0]        = <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <a class="code" href="motion_8c.html#a7c1d654b7b6114d7a0abc8d351dd1bcd">dummy</a>-&gt;data[3]       = <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <a class="code" href="motion_8c.html#a7c1d654b7b6114d7a0abc8d351dd1bcd">dummy</a>-&gt;hw_frames_ctx = <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160; </div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <a class="code" href="group__lavu__frame.html#ga979d73f3228814aee56aeca0636e37cc">av_frame_free</a>(&amp;<a class="code" href="motion_8c.html#a7c1d654b7b6114d7a0abc8d351dd1bcd">dummy</a>);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160; </div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;}</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#acc5f5f5cb256375fcd76e0d370db203f">  767</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__qsv_8c.html#acc5f5f5cb256375fcd76e0d370db203f">map_frame_to_surface</a>(<span class="keyword">const</span> <a class="code" href="struct_a_v_frame.html">AVFrame</a> *<a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>, mfxFrameSurface1 *surface)</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;{</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;format) {</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a0b271df0acd125218c1e365a0f754022">AV_PIX_FMT_NV12</a>:</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="pixfmt_8h.html#a6265531cbe491ec34449e3769e545f1f">AV_PIX_FMT_P010</a>:</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        surface-&gt;Data.Y  = <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;data[0];</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        surface-&gt;Data.UV = <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;data[1];</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a1aa7677092740d8def31655b5d7f0cc2">AV_PIX_FMT_YUV420P</a>:</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        surface-&gt;Data.Y = <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;data[0];</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        surface-&gt;Data.U = <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;data[1];</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        surface-&gt;Data.V = <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;data[2];</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a41c64e3682529dd5caca6f7d5d3c19c7">AV_PIX_FMT_BGRA</a>:</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        surface-&gt;Data.B = <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;data[0];</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        surface-&gt;Data.G = <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;data[0] + 1;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        surface-&gt;Data.R = <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;data[0] + 2;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        surface-&gt;Data.A = <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;data[0] + 3;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="preprocessor">#if CONFIG_VAAPI</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5ac755aea7c3277b09a42253882ec0444e">AV_PIX_FMT_YUYV422</a>:</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        surface-&gt;Data.Y = <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;data[0];</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        surface-&gt;Data.U = <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;data[0] + 1;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        surface-&gt;Data.V = <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;data[0] + 3;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160; </div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="pixfmt_8h.html#a5cfd3e9346f68f69196d9f13f8d69022">AV_PIX_FMT_Y210</a>:</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        surface-&gt;Data.Y16 = (mfxU16 *)<a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;data[0];</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        surface-&gt;Data.U16 = (mfxU16 *)<a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;data[0] + 1;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        surface-&gt;Data.V16 = (mfxU16 *)<a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;data[0] + 3;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;#endif</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        <span class="keywordflow">return</span> MFX_ERR_UNSUPPORTED;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    }</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    surface-&gt;Data.Pitch     = <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;linesize[0];</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    surface-&gt;Data.TimeStamp = <a class="code" href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a>-&gt;pts;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160; </div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;}</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160; </div>
<div class="line"><a name="l00810"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#a9e634a2b6443eff98a84b2596f81ed87">  810</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__qsv_8c.html#a9e634a2b6443eff98a84b2596f81ed87">qsv_transfer_data_from</a>(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="struct_a_v_frame.html">AVFrame</a> *dst,</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                                  <span class="keyword">const</span> <a class="code" href="struct_a_v_frame.html">AVFrame</a> *<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>)</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;{</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <a class="code" href="struct_q_s_v_frames_context.html">QSVFramesContext</a>  *<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a> = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;<a class="code" href="struct_a_v_format_context.html#a8a8bec51da36db65ff864f88a85805d9">internal</a>-&gt;priv;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    mfxFrameSurface1 <a class="code" href="tests_2movenc_8c.html#a1277960b5f2b37137fe9b0b5a1ea0beb">out</a> = {{ 0 }};</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    mfxFrameSurface1 *<a class="code" href="audio__convert_8c.html#ab92ad91055387e15b43ff5f6f60f2895">in</a> = (mfxFrameSurface1*)<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;data[3];</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160; </div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    mfxSyncPoint sync = <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    mfxStatus err;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = 0;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160; </div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    while (!<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_download_init &amp;&amp; !<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_download &amp;&amp; !<a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>) {</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="preprocessor">#if HAVE_PTHREADS</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        <span class="keywordflow">if</span> (pthread_mutex_trylock(&amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_lock) == 0) {</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_download_init) {</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = <a class="code" href="hwcontext__qsv_8c.html#a56a518c57d01ebe5a2c68ce6035ad837">qsv_init_internal_session</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, &amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_download, 0);</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_download)</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                    <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_download_init = 1;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            }</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="preprocessor">#if HAVE_PTHREADS</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            <a class="code" href="ffprobe_8c.html#aa91b7ec8ae8a2d699fb09cc20c444fe8">pthread_mutex_unlock</a>(&amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_lock);</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            <a class="code" href="os2threads_8h.html#a215efed993567deadcea30a74ed05d6c">pthread_cond_signal</a>(&amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_cond);</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            <a class="code" href="ffprobe_8c.html#a3bd1ad5edf8fc93f783af77e8cd6ee9a">pthread_mutex_lock</a>(&amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_lock);</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            <span class="keywordflow">while</span> (!<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_download_init &amp;&amp; !<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_download) {</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                <a class="code" href="os2threads_8h.html#af2ed122199f455b63a734ae9b592d286">pthread_cond_wait</a>(&amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_cond, &amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_lock);</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;            }</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            <a class="code" href="ffprobe_8c.html#aa91b7ec8ae8a2d699fb09cc20c444fe8">pthread_mutex_unlock</a>(&amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_lock);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        }</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    }</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160; </div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> &lt; 0)</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160; </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_download) {</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;child_frames_ref)</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="hwcontext__qsv_8c.html#ae83242ca5392487045d4e2d5a4e172c7">qsv_transfer_data_child</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, dst, <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160; </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Surface download not possible\n&quot;</span>);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOSYS);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    }</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160; </div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <a class="code" href="tests_2movenc_8c.html#a1277960b5f2b37137fe9b0b5a1ea0beb">out</a>.Info = <a class="code" href="audio__convert_8c.html#ab92ad91055387e15b43ff5f6f60f2895">in</a>-&gt;Info;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <a class="code" href="hwcontext__qsv_8c.html#acc5f5f5cb256375fcd76e0d370db203f">map_frame_to_surface</a>(dst, &amp;<a class="code" href="tests_2movenc_8c.html#a1277960b5f2b37137fe9b0b5a1ea0beb">out</a>);</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160; </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        err = MFXVideoVPP_RunFrameVPPAsync(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_download, <a class="code" href="audio__convert_8c.html#ab92ad91055387e15b43ff5f6f60f2895">in</a>, &amp;<a class="code" href="tests_2movenc_8c.html#a1277960b5f2b37137fe9b0b5a1ea0beb">out</a>, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;sync);</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        <span class="keywordflow">if</span> (err == MFX_WRN_DEVICE_BUSY)</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            <a class="code" href="time_8c.html#a4eee9c65835652a808973f4bc1641a51">av_usleep</a>(1);</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    } <span class="keywordflow">while</span> (err == MFX_WRN_DEVICE_BUSY);</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160; </div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="keywordflow">if</span> (err &lt; 0 || !sync) {</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Error downloading the surface\n&quot;</span>);</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__lavu__error.html#ga4ebaa288c7684a26a591c501208910e4">AVERROR_UNKNOWN</a>;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    }</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160; </div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        err = MFXVideoCORE_SyncOperation(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_download, sync, 1000);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    } <span class="keywordflow">while</span> (err == MFX_WRN_IN_EXECUTION);</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="keywordflow">if</span> (err &lt; 0) {</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Error synchronizing the operation: %d\n&quot;</span>, err);</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__lavu__error.html#ga4ebaa288c7684a26a591c501208910e4">AVERROR_UNKNOWN</a>;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    }</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160; </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;}</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160; </div>
<div class="line"><a name="l00879"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#a4d1045736f0865dc805ec613fb82dde6">  879</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__qsv_8c.html#a4d1045736f0865dc805ec613fb82dde6">qsv_transfer_data_to</a>(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="struct_a_v_frame.html">AVFrame</a> *dst,</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                                <span class="keyword">const</span> <a class="code" href="struct_a_v_frame.html">AVFrame</a> *<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>)</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;{</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <a class="code" href="struct_q_s_v_frames_context.html">QSVFramesContext</a>   *<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a> = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;<a class="code" href="struct_a_v_format_context.html#a8a8bec51da36db65ff864f88a85805d9">internal</a>-&gt;priv;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    mfxFrameSurface1   <a class="code" href="audio__convert_8c.html#ab92ad91055387e15b43ff5f6f60f2895">in</a> = {{ 0 }};</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    mfxFrameSurface1 *<a class="code" href="tests_2movenc_8c.html#a1277960b5f2b37137fe9b0b5a1ea0beb">out</a> = (mfxFrameSurface1*)dst-&gt;<a class="code" href="struct_a_v_frame.html#a1d0f65014a8d1bf78cec8cbed2304992">data</a>[3];</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160; </div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    mfxSyncPoint sync = <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    mfxStatus err;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = 0;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="comment">/* make a copy if the input is not padded as libmfx requires */</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <a class="code" href="struct_a_v_frame.html">AVFrame</a> tmp_frame;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="keyword">const</span> <a class="code" href="struct_a_v_frame.html">AVFrame</a> *src_frame;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="keywordtype">int</span> realigned = 0;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160; </div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160; </div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    while (!<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_upload_init &amp;&amp; !<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_upload &amp;&amp; !<a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>) {</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="preprocessor">#if HAVE_PTHREADS</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        <span class="keywordflow">if</span> (pthread_mutex_trylock(&amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_lock) == 0) {</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_upload_init) {</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = <a class="code" href="hwcontext__qsv_8c.html#a56a518c57d01ebe5a2c68ce6035ad837">qsv_init_internal_session</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, &amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_upload, 1);</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_upload)</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                    <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_upload_init = 1;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;            }</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="preprocessor">#if HAVE_PTHREADS</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;            <a class="code" href="ffprobe_8c.html#aa91b7ec8ae8a2d699fb09cc20c444fe8">pthread_mutex_unlock</a>(&amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_lock);</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            <a class="code" href="os2threads_8h.html#a215efed993567deadcea30a74ed05d6c">pthread_cond_signal</a>(&amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_cond);</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;            <a class="code" href="ffprobe_8c.html#a3bd1ad5edf8fc93f783af77e8cd6ee9a">pthread_mutex_lock</a>(&amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_lock);</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;            <span class="keywordflow">while</span> (!<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_upload_init &amp;&amp; !<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_upload) {</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                <a class="code" href="os2threads_8h.html#af2ed122199f455b63a734ae9b592d286">pthread_cond_wait</a>(&amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_cond, &amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_lock);</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;            }</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;            <a class="code" href="ffprobe_8c.html#aa91b7ec8ae8a2d699fb09cc20c444fe8">pthread_mutex_unlock</a>(&amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_lock);</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        }</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    }</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> &lt; 0)</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160; </div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;height &amp; 15 || <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;linesize[0] &amp; 15) {</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        realigned = 1;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        memset(&amp;tmp_frame, 0, <span class="keyword">sizeof</span>(tmp_frame));</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        tmp_frame.format         = <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;format;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        tmp_frame.width          = <a class="code" href="macros_8h.html#acae4ba605b3a7d535b7ac058ffe96892">FFALIGN</a>(<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;width, 16);</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        tmp_frame.height         = <a class="code" href="macros_8h.html#acae4ba605b3a7d535b7ac058ffe96892">FFALIGN</a>(<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;height, 16);</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = <a class="code" href="group__lavu__frame.html#ga6b1acbfa82c79bf7fd78d868572f0ceb">av_frame_get_buffer</a>(&amp;tmp_frame, 0);</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> &lt; 0)</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160; </div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = <a class="code" href="group__lavu__frame.html#gaec4e92f6e1e75ffaf76e07586fb0c9ed">av_frame_copy</a>(&amp;tmp_frame, <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>);</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> &lt; 0) {</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;            <a class="code" href="group__lavu__frame.html#ga0a2b687f9c1c5ed0089b01fd61227108">av_frame_unref</a>(&amp;tmp_frame);</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        }</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    }</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160; </div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    src_frame = realigned ? &amp;tmp_frame : <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160; </div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_upload) {</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;child_frames_ref)</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="hwcontext__qsv_8c.html#ae83242ca5392487045d4e2d5a4e172c7">qsv_transfer_data_child</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, dst, src_frame);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160; </div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Surface upload not possible\n&quot;</span>);</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOSYS);</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    }</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160; </div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <a class="code" href="audio__convert_8c.html#ab92ad91055387e15b43ff5f6f60f2895">in</a>.Info = <a class="code" href="tests_2movenc_8c.html#a1277960b5f2b37137fe9b0b5a1ea0beb">out</a>-&gt;Info;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <a class="code" href="hwcontext__qsv_8c.html#acc5f5f5cb256375fcd76e0d370db203f">map_frame_to_surface</a>(src_frame, &amp;<a class="code" href="audio__convert_8c.html#ab92ad91055387e15b43ff5f6f60f2895">in</a>);</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160; </div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        err = MFXVideoVPP_RunFrameVPPAsync(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_upload, &amp;<a class="code" href="audio__convert_8c.html#ab92ad91055387e15b43ff5f6f60f2895">in</a>, <a class="code" href="tests_2movenc_8c.html#a1277960b5f2b37137fe9b0b5a1ea0beb">out</a>, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;sync);</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        <span class="keywordflow">if</span> (err == MFX_WRN_DEVICE_BUSY)</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;            <a class="code" href="time_8c.html#a4eee9c65835652a808973f4bc1641a51">av_usleep</a>(1);</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    } <span class="keywordflow">while</span> (err == MFX_WRN_DEVICE_BUSY);</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160; </div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="keywordflow">if</span> (err &lt; 0 || !sync) {</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Error uploading the surface\n&quot;</span>);</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__lavu__error.html#ga4ebaa288c7684a26a591c501208910e4">AVERROR_UNKNOWN</a>;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    }</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160; </div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        err = MFXVideoCORE_SyncOperation(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;session_upload, sync, 1000);</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    } <span class="keywordflow">while</span> (err == MFX_WRN_IN_EXECUTION);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="keywordflow">if</span> (err &lt; 0) {</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Error synchronizing the operation\n&quot;</span>);</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__lavu__error.html#ga4ebaa288c7684a26a591c501208910e4">AVERROR_UNKNOWN</a>;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    }</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160; </div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <span class="keywordflow">if</span> (realigned)</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        <a class="code" href="group__lavu__frame.html#ga0a2b687f9c1c5ed0089b01fd61227108">av_frame_unref</a>(&amp;tmp_frame);</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160; </div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;}</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160; </div>
<div class="line"><a name="l00974"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#a91d7ae5466e990afd92c0e62d1807d05">  974</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__qsv_8c.html#a91d7ae5466e990afd92c0e62d1807d05">qsv_frames_derive_to</a>(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *dst_ctx,</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                                <a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *src_ctx, <span class="keywordtype">int</span> <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>)</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;{</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <a class="code" href="struct_q_s_v_frames_context.html">QSVFramesContext</a> *<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a> = dst_ctx-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a69e956e8d2d73d65d015c4ed895ec642">internal</a>-&gt;<a class="code" href="struct_a_v_h_w_frames_internal.html#a503cfeb391ed69856344768fd641a489">priv</a>;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <a class="code" href="struct_a_v_q_s_v_frames_context.html">AVQSVFramesContext</a> *dst_hwctx = dst_ctx-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a54e38c3e4355321e23e0f4c7411cb8ee">hwctx</a>;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160; </div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="keywordflow">switch</span> (src_ctx-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#ac9a7dbd0cbfcabc0b1529cb34cf53b6d">device_ctx</a>-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#abc92603a11768828ef3aea1f9d089308">type</a>) {</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="preprocessor">#if CONFIG_VAAPI</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34af5dfa6181a3a6efb0f4a0c5f38d76b95">AV_HWDEVICE_TYPE_VAAPI</a>:</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        {</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            <a class="code" href="struct_a_v_v_a_a_p_i_frames_context.html">AVVAAPIFramesContext</a> *src_hwctx = src_ctx-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a54e38c3e4355321e23e0f4c7411cb8ee">hwctx</a>;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;surfaces_internal = <a class="code" href="mem_8c.html#aedc3761897b7e9ea8ae1222b3d013c94">av_mallocz_array</a>(src_hwctx-&gt;<a class="code" href="struct_a_v_v_a_a_p_i_frames_context.html#af574bfa0abf14b96ae667f25494a3bcf">nb_surfaces</a>,</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                                                    <span class="keyword">sizeof</span>(*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;surfaces_internal));</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;surfaces_internal)</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; src_hwctx-&gt;<a class="code" href="struct_a_v_v_a_a_p_i_frames_context.html#af574bfa0abf14b96ae667f25494a3bcf">nb_surfaces</a>; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                <a class="code" href="hwcontext__qsv_8c.html#aa11be42c33da0099d9989237029036a2">qsv_init_surface</a>(dst_ctx, &amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;surfaces_internal[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;surfaces_internal[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].Data.MemId = src_hwctx-&gt;<a class="code" href="struct_a_v_v_a_a_p_i_frames_context.html#a18c4ca9956227c498679a823e14e1375">surface_ids</a> + <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            }</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            dst_hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#a80ce1c761479c7fe226d1eeed5f131ed">nb_surfaces</a> = src_hwctx-&gt;<a class="code" href="struct_a_v_v_a_a_p_i_frames_context.html#af574bfa0abf14b96ae667f25494a3bcf">nb_surfaces</a>;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;            dst_hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#aadf9983d5965bd4c2cbe09c25fa2757a">frame_type</a>  = MFX_MEMTYPE_VIDEO_MEMORY_DECODER_TARGET;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        }</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="preprocessor">#if CONFIG_DXVA2</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34acc6f1868dad1c636d4747cc91ce71d10">AV_HWDEVICE_TYPE_DXVA2</a>:</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        {</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;            <a class="code" href="struct_a_v_d_x_v_a2_frames_context.html">AVDXVA2FramesContext</a> *src_hwctx = src_ctx-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a54e38c3e4355321e23e0f4c7411cb8ee">hwctx</a>;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;            <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;surfaces_internal = <a class="code" href="mem_8c.html#aedc3761897b7e9ea8ae1222b3d013c94">av_mallocz_array</a>(src_hwctx-&gt;<a class="code" href="struct_a_v_d_x_v_a2_frames_context.html#a867fec347dd21aa778948df67cf00450">nb_surfaces</a>,</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                                                    <span class="keyword">sizeof</span>(*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;surfaces_internal));</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;surfaces_internal)</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; src_hwctx-&gt;<a class="code" href="struct_a_v_d_x_v_a2_frames_context.html#a867fec347dd21aa778948df67cf00450">nb_surfaces</a>; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                <a class="code" href="hwcontext__qsv_8c.html#aa11be42c33da0099d9989237029036a2">qsv_init_surface</a>(dst_ctx, &amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;surfaces_internal[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;surfaces_internal[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].Data.MemId = (mfxMemId)src_hwctx-&gt;<a class="code" href="struct_a_v_d_x_v_a2_frames_context.html#a2025b21fc7ec906713c525a702fd6eb7">surfaces</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;            }</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;            dst_hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#a80ce1c761479c7fe226d1eeed5f131ed">nb_surfaces</a> = src_hwctx-&gt;<a class="code" href="struct_a_v_d_x_v_a2_frames_context.html#a867fec347dd21aa778948df67cf00450">nb_surfaces</a>;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;            <span class="keywordflow">if</span> (src_hwctx-&gt;<a class="code" href="struct_a_v_d_x_v_a2_frames_context.html#abc67fe5747f160bf1f0bb98a506057ba">surface_type</a> == DXVA2_VideoProcessorRenderTarget)</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                dst_hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#aadf9983d5965bd4c2cbe09c25fa2757a">frame_type</a> = MFX_MEMTYPE_VIDEO_MEMORY_PROCESSOR_TARGET;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                dst_hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#aadf9983d5965bd4c2cbe09c25fa2757a">frame_type</a> = MFX_MEMTYPE_VIDEO_MEMORY_DECODER_TARGET;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        }</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOSYS);</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    }</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160; </div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    dst_hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#a748121791d286d4099c8073152973d70">surfaces</a> = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;surfaces_internal;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160; </div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;}</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160; </div>
<div class="line"><a name="l01028"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#a8a60b03ecce61e300dfee4589ab3720c"> 1028</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__qsv_8c.html#a8a60b03ecce61e300dfee4589ab3720c">qsv_map_to</a>(<a class="code" href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a> *dst_ctx,</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                      <a class="code" href="struct_a_v_frame.html">AVFrame</a> *dst, <span class="keyword">const</span> <a class="code" href="struct_a_v_frame.html">AVFrame</a> *<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>, <span class="keywordtype">int</span> <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>)</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;{</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <a class="code" href="struct_a_v_q_s_v_frames_context.html">AVQSVFramesContext</a> *hwctx = dst_ctx-&gt;<a class="code" href="struct_a_v_h_w_frames_context.html#a54e38c3e4355321e23e0f4c7411cb8ee">hwctx</a>;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, err;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160; </div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#a80ce1c761479c7fe226d1eeed5f131ed">nb_surfaces</a>; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="preprocessor">#if CONFIG_VAAPI</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        <span class="keywordflow">if</span> (*(VASurfaceID*)hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#a748121791d286d4099c8073152973d70">surfaces</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].Data.MemId ==</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;            (VASurfaceID)(uintptr_t)<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;data[3])</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="preprocessor">#if CONFIG_DXVA2</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        <span class="keywordflow">if</span> ((IDirect3DSurface9*)hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#a748121791d286d4099c8073152973d70">surfaces</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].Data.MemId ==</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;            (IDirect3DSurface9*)(uintptr_t)<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;data[3])</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    }</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt;= hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#a80ce1c761479c7fe226d1eeed5f131ed">nb_surfaces</a>) {</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(dst_ctx, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Trying to map from a surface which &quot;</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;               <span class="stringliteral">&quot;is not in the mapped frames context.\n&quot;</span>);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(EINVAL);</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    }</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160; </div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    err = <a class="code" href="hwcontext_8c.html#a76e0387f519b3f1bd1b162e91b54b182">ff_hwframe_map_create</a>(dst-&gt;<a class="code" href="struct_a_v_frame.html#a29493fbfabaa21432c360a090426aa8e">hw_frames_ctx</a>,</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                                dst, <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="keywordflow">if</span> (err)</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160; </div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    dst-&gt;<a class="code" href="struct_a_v_frame.html#a1e71ce60cedd5f3b6811714a9f7f9e0a">width</a>   = <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;width;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    dst-&gt;<a class="code" href="struct_a_v_frame.html#a3f89733f429c98ba5bc64373fb0a3f13">height</a>  = <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>-&gt;height;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    dst-&gt;<a class="code" href="struct_a_v_frame.html#a1d0f65014a8d1bf78cec8cbed2304992">data</a>[3] = (<a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a>*)&amp;hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_frames_context.html#a748121791d286d4099c8073152973d70">surfaces</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160; </div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;}</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160; </div>
<div class="line"><a name="l01064"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#a3cdfd61164b23f7665c942dfed5a5dac"> 1064</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__qsv_8c.html#a3cdfd61164b23f7665c942dfed5a5dac">qsv_frames_get_constraints</a>(<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>,</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                                      <span class="keyword">const</span> <span class="keywordtype">void</span> *hwconfig,</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                                      <a class="code" href="struct_a_v_h_w_frames_constraints.html">AVHWFramesConstraints</a> *constraints)</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;{</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160; </div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    constraints-&gt;<a class="code" href="struct_a_v_h_w_frames_constraints.html#aabea88093c6f85d6185ffb0852a2217f">valid_sw_formats</a> = <a class="code" href="mem_8c.html#a254f3455439c15a2c8a75b8f0235fdbd">av_malloc_array</a>(<a class="code" href="sinewin__tablegen__template_8c.html#a3508a98d3ee7e2c9a4841fe264cf70f7">FF_ARRAY_ELEMS</a>(<a class="code" href="hwcontext__qsv_8c.html#a5349aad53b5aa95c1ea9ab2833330e66">supported_pixel_formats</a>) + 1,</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                                                    <span class="keyword">sizeof</span>(*constraints-&gt;<a class="code" href="struct_a_v_h_w_frames_constraints.html#aabea88093c6f85d6185ffb0852a2217f">valid_sw_formats</a>));</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="keywordflow">if</span> (!constraints-&gt;<a class="code" href="struct_a_v_h_w_frames_constraints.html#aabea88093c6f85d6185ffb0852a2217f">valid_sw_formats</a>)</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160; </div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="sinewin__tablegen__template_8c.html#a3508a98d3ee7e2c9a4841fe264cf70f7">FF_ARRAY_ELEMS</a>(<a class="code" href="hwcontext__qsv_8c.html#a5349aad53b5aa95c1ea9ab2833330e66">supported_pixel_formats</a>); <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        constraints-&gt;<a class="code" href="struct_a_v_h_w_frames_constraints.html#aabea88093c6f85d6185ffb0852a2217f">valid_sw_formats</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="hwcontext__qsv_8c.html#a5349aad53b5aa95c1ea9ab2833330e66">supported_pixel_formats</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].pix_fmt;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    constraints-&gt;<a class="code" href="struct_a_v_h_w_frames_constraints.html#aabea88093c6f85d6185ffb0852a2217f">valid_sw_formats</a>[<a class="code" href="sinewin__tablegen__template_8c.html#a3508a98d3ee7e2c9a4841fe264cf70f7">FF_ARRAY_ELEMS</a>(<a class="code" href="hwcontext__qsv_8c.html#a5349aad53b5aa95c1ea9ab2833330e66">supported_pixel_formats</a>)] = <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a0e08f8a5d0fa21c3e258816a9dcce7c3">AV_PIX_FMT_NONE</a>;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160; </div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    constraints-&gt;<a class="code" href="struct_a_v_h_w_frames_constraints.html#a4258bbe81f927b76b7ca5af44ba7ef6b">valid_hw_formats</a> = <a class="code" href="mem_8c.html#a254f3455439c15a2c8a75b8f0235fdbd">av_malloc_array</a>(2, <span class="keyword">sizeof</span>(*constraints-&gt;<a class="code" href="struct_a_v_h_w_frames_constraints.html#a4258bbe81f927b76b7ca5af44ba7ef6b">valid_hw_formats</a>));</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <span class="keywordflow">if</span> (!constraints-&gt;<a class="code" href="struct_a_v_h_w_frames_constraints.html#a4258bbe81f927b76b7ca5af44ba7ef6b">valid_hw_formats</a>)</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160; </div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    constraints-&gt;<a class="code" href="struct_a_v_h_w_frames_constraints.html#a4258bbe81f927b76b7ca5af44ba7ef6b">valid_hw_formats</a>[0] = <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5ac913414b6091ce30035b21b9c0bc1c8e">AV_PIX_FMT_QSV</a>;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    constraints-&gt;<a class="code" href="struct_a_v_h_w_frames_constraints.html#a4258bbe81f927b76b7ca5af44ba7ef6b">valid_hw_formats</a>[1] = <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a0e08f8a5d0fa21c3e258816a9dcce7c3">AV_PIX_FMT_NONE</a>;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160; </div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;}</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160; </div>
<div class="line"><a name="l01089"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#a57701212b729e0f56d1cfe2b2a2e7c82"> 1089</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="hwcontext__qsv_8c.html#a57701212b729e0f56d1cfe2b2a2e7c82">qsv_device_free</a>(<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>)</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;{</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    <a class="code" href="struct_a_v_q_s_v_device_context.html">AVQSVDeviceContext</a> *hwctx = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;hwctx;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    <a class="code" href="struct_q_s_v_device_priv.html">QSVDevicePriv</a>       *priv = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;user_opaque;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160; </div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <span class="keywordflow">if</span> (hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_device_context.html#abfdc22dbded8e90950b3dfce3f3bd83d">session</a>)</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        MFXClose(hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_device_context.html#abfdc22dbded8e90950b3dfce3f3bd83d">session</a>);</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160; </div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <a class="code" href="group__lavu__buffer.html#ga135e9e929b5033bb8f68322497b2effc">av_buffer_unref</a>(&amp;priv-&gt;<a class="code" href="struct_q_s_v_device_priv.html#a4d5334a14976c0fafc8f2471df69b5a4">child_device_ctx</a>);</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#adba82e1bcd02de510a858fcbedf79ef1">av_freep</a>(&amp;priv);</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;}</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160; </div>
<div class="line"><a name="l01101"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#a949553fe06bc0d90c8081daa3d679fab"> 1101</a></span>&#160;<span class="keyword">static</span> mfxIMPL <a class="code" href="hwcontext__qsv_8c.html#a949553fe06bc0d90c8081daa3d679fab">choose_implementation</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *device)</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;{</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="writing__filters_8txt.html#adb27990ed3d4ad300fd1dde281903508">name</a>;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        mfxIMPL     impl;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    } impl_map[] = {</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        { <span class="stringliteral">&quot;auto&quot;</span>,     MFX_IMPL_AUTO         },</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;        { <span class="stringliteral">&quot;sw&quot;</span>,       MFX_IMPL_SOFTWARE     },</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        { <span class="stringliteral">&quot;hw&quot;</span>,       MFX_IMPL_HARDWARE     },</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;        { <span class="stringliteral">&quot;auto_any&quot;</span>, MFX_IMPL_AUTO_ANY     },</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;        { <span class="stringliteral">&quot;hw_any&quot;</span>,   MFX_IMPL_HARDWARE_ANY },</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;        { <span class="stringliteral">&quot;hw2&quot;</span>,      MFX_IMPL_HARDWARE2    },</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        { <span class="stringliteral">&quot;hw3&quot;</span>,      MFX_IMPL_HARDWARE3    },</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        { <span class="stringliteral">&quot;hw4&quot;</span>,      MFX_IMPL_HARDWARE4    },</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    };</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160; </div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    mfxIMPL impl = MFX_IMPL_AUTO_ANY;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160; </div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <span class="keywordflow">if</span> (device) {</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="sinewin__tablegen__template_8c.html#a3508a98d3ee7e2c9a4841fe264cf70f7">FF_ARRAY_ELEMS</a>(impl_map); <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;            <span class="keywordflow">if</span> (!strcmp(device, impl_map[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="writing__filters_8txt.html#adb27990ed3d4ad300fd1dde281903508">name</a>)) {</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                impl = impl_map[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].impl;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;            }</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> == <a class="code" href="sinewin__tablegen__template_8c.html#a3508a98d3ee7e2c9a4841fe264cf70f7">FF_ARRAY_ELEMS</a>(impl_map))</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;            impl = strtol(device, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0);</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    }</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160; </div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    <span class="keywordflow">return</span> impl;</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;}</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160; </div>
<div class="line"><a name="l01133"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#a42004a4575324f7c763ca19192a4eefa"> 1133</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__qsv_8c.html#a42004a4575324f7c763ca19192a4eefa">qsv_device_derive_from_child</a>(<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>,</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                                        mfxIMPL implementation,</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                                        <a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *child_device_ctx,</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                                        <span class="keywordtype">int</span> <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>)</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;{</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <a class="code" href="struct_a_v_q_s_v_device_context.html">AVQSVDeviceContext</a> *hwctx = <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;hwctx;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160; </div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    mfxVersion    ver = { { 3, 1 } };</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    mfxHDL        handle;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    mfxHandleType <a class="code" href="hwcontext__qsv_8c.html#a3f6f34808101299d4cd094fcb313e919">handle_type</a>;</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    mfxStatus     err;</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160; </div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    <span class="keywordflow">switch</span> (child_device_ctx-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#abc92603a11768828ef3aea1f9d089308">type</a>) {</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="preprocessor">#if CONFIG_VAAPI</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34af5dfa6181a3a6efb0f4a0c5f38d76b95">AV_HWDEVICE_TYPE_VAAPI</a>:</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        {</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;            <a class="code" href="struct_a_v_v_a_a_p_i_device_context.html">AVVAAPIDeviceContext</a> *child_device_hwctx = child_device_ctx-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a46055b48d1a40445d775b4ae24f77f20">hwctx</a>;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;            <a class="code" href="hwcontext__qsv_8c.html#a3f6f34808101299d4cd094fcb313e919">handle_type</a> = MFX_HANDLE_VA_DISPLAY;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;            handle = (mfxHDL)child_device_hwctx-&gt;<a class="code" href="struct_a_v_v_a_a_p_i_device_context.html#a89951d5ccfad53ce81444773ea9f774e">display</a>;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        }</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="preprocessor">#if CONFIG_DXVA2</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34acc6f1868dad1c636d4747cc91ce71d10">AV_HWDEVICE_TYPE_DXVA2</a>:</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;        {</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;            <a class="code" href="struct_a_v_d_x_v_a2_device_context.html">AVDXVA2DeviceContext</a> *child_device_hwctx = child_device_ctx-&gt;<a class="code" href="struct_a_v_h_w_device_context.html#a46055b48d1a40445d775b4ae24f77f20">hwctx</a>;</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;            <a class="code" href="hwcontext__qsv_8c.html#a3f6f34808101299d4cd094fcb313e919">handle_type</a> = MFX_HANDLE_D3D9_DEVICE_MANAGER;</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;            handle = (mfxHDL)child_device_hwctx-&gt;<a class="code" href="struct_a_v_d_x_v_a2_device_context.html#a3baea98a35192cc661f903198d7196ab">devmgr</a>;</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        }</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;        <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOSYS);</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    }</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160; </div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    err = MFXInit(implementation, &amp;ver, &amp;hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_device_context.html#abfdc22dbded8e90950b3dfce3f3bd83d">session</a>);</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <span class="keywordflow">if</span> (err != MFX_ERR_NONE) {</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Error initializing an MFX session: &quot;</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;               <span class="stringliteral">&quot;%d.\n&quot;</span>, err);</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;        <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = <a class="code" href="group__lavu__error.html#ga4ebaa288c7684a26a591c501208910e4">AVERROR_UNKNOWN</a>;</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    }</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160; </div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    err = MFXQueryVersion(hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_device_context.html#abfdc22dbded8e90950b3dfce3f3bd83d">session</a>, &amp;ver);</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="keywordflow">if</span> (err != MFX_ERR_NONE) {</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Error querying an MFX session: %d.\n&quot;</span>, err);</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = <a class="code" href="group__lavu__error.html#ga4ebaa288c7684a26a591c501208910e4">AVERROR_UNKNOWN</a>;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    }</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160; </div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a>,</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;           <span class="stringliteral">&quot;Initialize MFX session: API version is %d.%d, implementation version is %d.%d\n&quot;</span>,</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;           MFX_VERSION_MAJOR, MFX_VERSION_MINOR, ver.Major, ver.Minor);</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160; </div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    MFXClose(hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_device_context.html#abfdc22dbded8e90950b3dfce3f3bd83d">session</a>);</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160; </div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    err = MFXInit(implementation, &amp;ver, &amp;hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_device_context.html#abfdc22dbded8e90950b3dfce3f3bd83d">session</a>);</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    <span class="keywordflow">if</span> (err != MFX_ERR_NONE) {</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>,</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;               <span class="stringliteral">&quot;Error initializing an MFX session: %d.\n&quot;</span>, err);</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;        <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = <a class="code" href="group__lavu__error.html#ga4ebaa288c7684a26a591c501208910e4">AVERROR_UNKNOWN</a>;</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    }</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160; </div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    err = MFXVideoCORE_SetHandle(hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_device_context.html#abfdc22dbded8e90950b3dfce3f3bd83d">session</a>, <a class="code" href="hwcontext__qsv_8c.html#a3f6f34808101299d4cd094fcb313e919">handle_type</a>, handle);</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <span class="keywordflow">if</span> (err != MFX_ERR_NONE) {</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;Error setting child device handle: &quot;</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;               <span class="stringliteral">&quot;%d\n&quot;</span>, err);</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = <a class="code" href="group__lavu__error.html#ga4ebaa288c7684a26a591c501208910e4">AVERROR_UNKNOWN</a>;</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    }</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160; </div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160; </div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<a class="code" href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a>:</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="keywordflow">if</span> (hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_device_context.html#abfdc22dbded8e90950b3dfce3f3bd83d">session</a>)</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;        MFXClose(hwctx-&gt;<a class="code" href="struct_a_v_q_s_v_device_context.html#abfdc22dbded8e90950b3dfce3f3bd83d">session</a>);</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;}</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160; </div>
<div class="line"><a name="l01215"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#af589f29b99bf88601f20dcae89c81b54"> 1215</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__qsv_8c.html#af589f29b99bf88601f20dcae89c81b54">qsv_device_derive</a>(<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>,</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                             <a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *child_device_ctx,</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                             <a class="code" href="struct_a_v_dictionary.html">AVDictionary</a> *<a class="code" href="tests_2movenc_8c.html#af540b728145b614e34c4e10930354b93">opts</a>, <span class="keywordtype">int</span> <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>)</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;{</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="hwcontext__qsv_8c.html#a42004a4575324f7c763ca19192a4eefa">qsv_device_derive_from_child</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, MFX_IMPL_HARDWARE_ANY,</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                                        child_device_ctx, <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>);</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;}</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160; </div>
<div class="line"><a name="l01223"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#ae731c529ab1b013ddb059e57e401ca26"> 1223</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="hwcontext__qsv_8c.html#ae731c529ab1b013ddb059e57e401ca26">qsv_device_create</a>(<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *device,</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                             <a class="code" href="struct_a_v_dictionary.html">AVDictionary</a> *<a class="code" href="tests_2movenc_8c.html#af540b728145b614e34c4e10930354b93">opts</a>, <span class="keywordtype">int</span> <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>)</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;{</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <a class="code" href="struct_q_s_v_device_priv.html">QSVDevicePriv</a> *priv;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="keyword">enum</span> <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34">AVHWDeviceType</a> child_device_type;</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    <a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a> *child_device;</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <a class="code" href="struct_a_v_dictionary.html">AVDictionary</a> *child_device_opts;</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    <a class="code" href="struct_a_v_dictionary_entry.html">AVDictionaryEntry</a> *e;</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160; </div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    mfxIMPL impl;</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>;</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160; </div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    priv = <a class="code" href="group__lavu__mem__funcs.html#gaf143ecab33a3868b57345466c39de7c1">av_mallocz</a>(<span class="keyword">sizeof</span>(*priv));</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="keywordflow">if</span> (!priv)</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOMEM);</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160; </div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;user_opaque = priv;</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    <a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>-&gt;free        = <a class="code" href="hwcontext__qsv_8c.html#a57701212b729e0f56d1cfe2b2a2e7c82">qsv_device_free</a>;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160; </div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    e = <a class="code" href="group__lavu__dict.html#gae67f143237b2cb2936c9b147aa6dfde3">av_dict_get</a>(<a class="code" href="tests_2movenc_8c.html#af540b728145b614e34c4e10930354b93">opts</a>, <span class="stringliteral">&quot;child_device&quot;</span>, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0);</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160; </div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    child_device_opts = <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <span class="keywordflow">if</span> (CONFIG_VAAPI) {</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        child_device_type = <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34af5dfa6181a3a6efb0f4a0c5f38d76b95">AV_HWDEVICE_TYPE_VAAPI</a>;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        <span class="comment">// libmfx does not actually implement VAAPI properly, rather it</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        <span class="comment">// depends on the specific behaviour of a matching iHD driver when</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        <span class="comment">// used on recent Intel hardware.  Set options to the VAAPI device</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        <span class="comment">// creation so that we should pick a usable setup by default if</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        <span class="comment">// possible, even when multiple devices and drivers are available.</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        <a class="code" href="group__lavu__dict.html#ga8d9c2de72b310cef8e6a28c9cd3acbbe">av_dict_set</a>(&amp;child_device_opts, <span class="stringliteral">&quot;kernel_driver&quot;</span>, <span class="stringliteral">&quot;i915&quot;</span>, 0);</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        <a class="code" href="group__lavu__dict.html#ga8d9c2de72b310cef8e6a28c9cd3acbbe">av_dict_set</a>(&amp;child_device_opts, <span class="stringliteral">&quot;driver&quot;</span>,        <span class="stringliteral">&quot;iHD&quot;</span>,  0);</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (CONFIG_DXVA2)</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;        child_device_type = <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34acc6f1868dad1c636d4747cc91ce71d10">AV_HWDEVICE_TYPE_DXVA2</a>;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;No supported child device type is enabled\n&quot;</span>);</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a>(ENOSYS);</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    }</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160; </div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> = <a class="code" href="hwcontext_8c.html#a21fbd088225e4e25c4d9a01b3f5e8c51">av_hwdevice_ctx_create</a>(&amp;priv-&gt;<a class="code" href="struct_q_s_v_device_priv.html#a4d5334a14976c0fafc8f2471df69b5a4">child_device_ctx</a>, child_device_type,</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;                                 e ? e-&gt;<a class="code" href="struct_a_v_dictionary_entry.html#aa38678f2cad36f120d42e56449c5edb4">value</a> : <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, child_device_opts, 0);</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160; </div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    <a class="code" href="group__lavu__dict.html#ga1bafd682b1fbb90e48a4cc3814b820f7">av_dict_free</a>(&amp;child_device_opts);</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a> &lt; 0)</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a>;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160; </div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    child_device = (<a class="code" href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a>*)priv-&gt;<a class="code" href="struct_q_s_v_device_priv.html#a4d5334a14976c0fafc8f2471df69b5a4">child_device_ctx</a>-&gt;<a class="code" href="struct_a_v_buffer_ref.html#acb8452e99cd75074b93800b532c6ea4b">data</a>;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160; </div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    impl = <a class="code" href="hwcontext__qsv_8c.html#a949553fe06bc0d90c8081daa3d679fab">choose_implementation</a>(device);</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160; </div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="hwcontext__qsv_8c.html#a42004a4575324f7c763ca19192a4eefa">qsv_device_derive_from_child</a>(<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, impl, child_device, 0);</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;}</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160; </div>
<div class="line"><a name="l01275"></a><span class="lineno"><a class="line" href="hwcontext__qsv_8c.html#a58106054e4c71a65547359bbe51fea82"> 1275</a></span>&#160;<span class="keyword">const</span> <a class="code" href="struct_h_w_context_type.html">HWContextType</a> <a class="code" href="hwcontext__qsv_8c.html#a58106054e4c71a65547359bbe51fea82">ff_hwcontext_type_qsv</a> = {</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    .<a class="code" href="struct_h_w_context_type.html#a5ddb5fc39d16ce3147a5640c8d040937">type</a>                   = <a class="code" href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34a7a74cd2f21d680a11aa8b321ddff1358">AV_HWDEVICE_TYPE_QSV</a>,</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    .name                   = <span class="stringliteral">&quot;QSV&quot;</span>,</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160; </div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    .device_hwctx_size      = <span class="keyword">sizeof</span>(<a class="code" href="hwcontext__qsv_8h.html#a999b7f33a5bf3f36e9429ea7e770e67e">AVQSVDeviceContext</a>),</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    .device_priv_size       = <span class="keyword">sizeof</span>(<a class="code" href="struct_q_s_v_device_context.html">QSVDeviceContext</a>),</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    .frames_hwctx_size      = <span class="keyword">sizeof</span>(<a class="code" href="hwcontext__qsv_8h.html#a10ba7f00d7b385769171443708b294b8">AVQSVFramesContext</a>),</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    .frames_priv_size       = <span class="keyword">sizeof</span>(<a class="code" href="struct_q_s_v_frames_context.html">QSVFramesContext</a>),</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160; </div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    .device_create          = <a class="code" href="hwcontext__qsv_8c.html#ae731c529ab1b013ddb059e57e401ca26">qsv_device_create</a>,</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    .device_derive          = <a class="code" href="hwcontext__qsv_8c.html#af589f29b99bf88601f20dcae89c81b54">qsv_device_derive</a>,</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    .device_init            = <a class="code" href="hwcontext__qsv_8c.html#a2dd36ef3444f1075a4c86b6519d4448d">qsv_device_init</a>,</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    .frames_get_constraints = <a class="code" href="hwcontext__qsv_8c.html#a3cdfd61164b23f7665c942dfed5a5dac">qsv_frames_get_constraints</a>,</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    .frames_init            = <a class="code" href="hwcontext__qsv_8c.html#a5e17476aca2cc0ba08808ca9bd0a4213">qsv_frames_init</a>,</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    .frames_uninit          = <a class="code" href="hwcontext__qsv_8c.html#aae34df94330b4b328854f0883450f2d1">qsv_frames_uninit</a>,</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    .frames_get_buffer      = <a class="code" href="hwcontext__qsv_8c.html#ae0cd7b25815a2c03d49159633998d6ec">qsv_get_buffer</a>,</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    .transfer_get_formats   = <a class="code" href="hwcontext__qsv_8c.html#a8562eaeaf740a3e9756615b6c3bbbccb">qsv_transfer_get_formats</a>,</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    .transfer_data_to       = <a class="code" href="hwcontext__qsv_8c.html#a4d1045736f0865dc805ec613fb82dde6">qsv_transfer_data_to</a>,</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    .transfer_data_from     = <a class="code" href="hwcontext__qsv_8c.html#a9e634a2b6443eff98a84b2596f81ed87">qsv_transfer_data_from</a>,</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    .map_to                 = <a class="code" href="hwcontext__qsv_8c.html#a8a60b03ecce61e300dfee4589ab3720c">qsv_map_to</a>,</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    .map_from               = <a class="code" href="hwcontext__qsv_8c.html#a077c57cd37540d31a31f00519805b982">qsv_map_from</a>,</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    .frames_derive_to       = <a class="code" href="hwcontext__qsv_8c.html#a91d7ae5466e990afd92c0e62d1807d05">qsv_frames_derive_to</a>,</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    .frames_derive_from     = <a class="code" href="hwcontext__qsv_8c.html#a7ac8c294b998bd5ef04142db43c10e29">qsv_frames_derive_from</a>,</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160; </div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    .pix_fmts = (<span class="keyword">const</span> <span class="keyword">enum</span> <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5">AVPixelFormat</a>[]){ <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5ac913414b6091ce30035b21b9c0bc1c8e">AV_PIX_FMT_QSV</a>, <a class="code" href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a0e08f8a5d0fa21c3e258816a9dcce7c3">AV_PIX_FMT_NONE</a> },</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;};</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="asignature_8h_html_a12f58149bb2cdab504621ba5b390ef64"><div class="ttname"><a href="signature_8h.html#a12f58149bb2cdab504621ba5b390ef64">formats</a></div><div class="ttdeci">formats</div><div class="ttdef"><b>Definition:</b> <a href="signature_8h_source.html#l00048">signature.h:48</a></div></div>
<div class="ttc" id="astruct_a_v_v_a_a_p_i_frames_context_html_af574bfa0abf14b96ae667f25494a3bcf"><div class="ttname"><a href="struct_a_v_v_a_a_p_i_frames_context.html#af574bfa0abf14b96ae667f25494a3bcf">AVVAAPIFramesContext::nb_surfaces</a></div><div class="ttdeci">int nb_surfaces</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__vaapi_8h_source.html#l00102">hwcontext_vaapi.h:102</a></div></div>
<div class="ttc" id="aos2threads_8h_html_ac171f4e937b5a585efb4a7f99ee2234a"><div class="ttname"><a href="os2threads_8h.html#ac171f4e937b5a585efb4a7f99ee2234a">pthread_mutex_t</a></div><div class="ttdeci">_fmutex pthread_mutex_t</div><div class="ttdef"><b>Definition:</b> <a href="os2threads_8h_source.html#l00053">os2threads.h:53</a></div></div>
<div class="ttc" id="astruct_q_s_v_frames_context_html_a4dce9c7f00026f0843a9bee9e5074998"><div class="ttname"><a href="struct_q_s_v_frames_context.html#a4dce9c7f00026f0843a9bee9e5074998">QSVFramesContext::mem_ids</a></div><div class="ttdeci">mfxMemId * mem_ids</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00080">hwcontext_qsv.c:80</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_ae83242ca5392487045d4e2d5a4e172c7"><div class="ttname"><a href="hwcontext__qsv_8c.html#ae83242ca5392487045d4e2d5a4e172c7">qsv_transfer_data_child</a></div><div class="ttdeci">static int qsv_transfer_data_child(AVHWFramesContext *ctx, AVFrame *dst, const AVFrame *src)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00733">hwcontext_qsv.c:733</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5">AVPixelFormat</a></div><div class="ttdeci">AVPixelFormat</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00064">pixfmt.h:64</a></div></div>
<div class="ttc" id="awriting__filters_8txt_html_adb27990ed3d4ad300fd1dde281903508"><div class="ttname"><a href="writing__filters_8txt.html#adb27990ed3d4ad300fd1dde281903508">name</a></div><div class="ttdeci">it s the only field you need to keep assuming you have a context There is some magic you don t need to care about around this just let it vf default minimum maximum flags name is the option name</div><div class="ttdef"><b>Definition:</b> <a href="writing__filters_8txt_source.html#l00088">writing_filters.txt:88</a></div></div>
<div class="ttc" id="afilter__design_8txt_html_adf2fb515710d47541f7150ecd2950e76"><div class="ttname"><a href="filter__design_8txt.html#adf2fb515710d47541f7150ecd2950e76">AVERROR</a></div><div class="ttdeci">Filter the word “frame” indicates either a video frame or a group of audio as stored in an AVFrame structure Format for each input and each output the list of supported formats For video that means pixel format For audio that means channel sample they are references to shared objects When the negotiation mechanism computes the intersection of the formats supported at each end of a all references to both lists are replaced with a reference to the intersection And when a single format is eventually chosen for a link amongst the remaining all references to the list are updated That means that if a filter requires that its input and output have the same format amongst a supported all it has to do is use a reference to the same list of formats query_formats can leave some formats unset and return AVERROR(EAGAIN) to cause the negotiation mechanism toagain later. That can be used by filters with complex requirements to use the format negotiated on one link to set the formats supported on another. Frame references ownership and permissions</div></div>
<div class="ttc" id="astruct_a_v_dictionary_html"><div class="ttname"><a href="struct_a_v_dictionary.html">AVDictionary</a></div><div class="ttdef"><b>Definition:</b> <a href="dict_8c_source.html#l00030">dict.c:30</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_frames_context_html_a9e6f29d0f744930cdd0e8bdff8771520"><div class="ttname"><a href="struct_a_v_h_w_frames_context.html#a9e6f29d0f744930cdd0e8bdff8771520">AVHWFramesContext::width</a></div><div class="ttdeci">int width</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00229">hwcontext.h:229</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_device_context_html_abc92603a11768828ef3aea1f9d089308"><div class="ttname"><a href="struct_a_v_h_w_device_context.html#abc92603a11768828ef3aea1f9d089308">AVHWDeviceContext::type</a></div><div class="ttdeci">enum AVHWDeviceType type</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00071">hwcontext.h:79</a></div></div>
<div class="ttc" id="astruct_q_s_v_device_priv_html"><div class="ttname"><a href="struct_q_s_v_device_priv.html">QSVDevicePriv</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00051">hwcontext_qsv.c:51</a></div></div>
<div class="ttc" id="atests_2movenc_8c_html_a1277960b5f2b37137fe9b0b5a1ea0beb"><div class="ttname"><a href="tests_2movenc_8c.html#a1277960b5f2b37137fe9b0b5a1ea0beb">out</a></div><div class="ttdeci">FILE * out</div><div class="ttdef"><b>Definition:</b> <a href="tests_2movenc_8c_source.html#l00054">movenc.c:54</a></div></div>
<div class="ttc" id="agroup__lavu__frame_html_ga6b1acbfa82c79bf7fd78d868572f0ceb"><div class="ttname"><a href="group__lavu__frame.html#ga6b1acbfa82c79bf7fd78d868572f0ceb">av_frame_get_buffer</a></div><div class="ttdeci">int av_frame_get_buffer(AVFrame *frame, int align)</div><div class="ttdef"><b>Definition:</b> <a href="frame_8c_source.html#l00337">frame.c:337</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_frames_context_html_a045bc1713932804f6ceef170a5578e0e"><div class="ttname"><a href="struct_a_v_h_w_frames_context.html#a045bc1713932804f6ceef170a5578e0e">AVHWFramesContext::format</a></div><div class="ttdeci">enum AVPixelFormat format</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00199">hwcontext.h:209</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_af1bb59d6eb4bc68bb468cf3f149ab076"><div class="ttname"><a href="hwcontext__qsv_8c.html#af1bb59d6eb4bc68bb468cf3f149ab076">QSVDevicePriv</a></div><div class="ttdeci">struct QSVDevicePriv QSVDevicePriv</div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_a4d1045736f0865dc805ec613fb82dde6"><div class="ttname"><a href="hwcontext__qsv_8c.html#a4d1045736f0865dc805ec613fb82dde6">qsv_transfer_data_to</a></div><div class="ttdeci">static int qsv_transfer_data_to(AVHWFramesContext *ctx, AVFrame *dst, const AVFrame *src)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00879">hwcontext_qsv.c:879</a></div></div>
<div class="ttc" id="apixdesc_8c_html_afe0c3e8aef5173de28bbdaea4298f5f0"><div class="ttname"><a href="pixdesc_8c.html#afe0c3e8aef5173de28bbdaea4298f5f0">av_pix_fmt_desc_get</a></div><div class="ttdeci">const AVPixFmtDescriptor * av_pix_fmt_desc_get(enum AVPixelFormat pix_fmt)</div><div class="ttdef"><b>Definition:</b> <a href="pixdesc_8c_source.html#l02573">pixdesc.c:2573</a></div></div>
<div class="ttc" id="amem_8c_html_a254f3455439c15a2c8a75b8f0235fdbd"><div class="ttname"><a href="mem_8c.html#a254f3455439c15a2c8a75b8f0235fdbd">av_malloc_array</a></div><div class="ttdeci">void * av_malloc_array(size_t nmemb, size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="mem_8c_source.html#l00182">mem.c:182</a></div></div>
<div class="ttc" id="aos2threads_8h_html_a4f8250fbf301e0e62dad0aad3ba030a9"><div class="ttname"><a href="os2threads_8h.html#a4f8250fbf301e0e62dad0aad3ba030a9">pthread_mutex_init</a></div><div class="ttdeci">static av_always_inline int pthread_mutex_init(pthread_mutex_t *mutex, const pthread_mutexattr_t *attr)</div><div class="ttdef"><b>Definition:</b> <a href="os2threads_8h_source.html#l00104">os2threads.h:104</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_a077c57cd37540d31a31f00519805b982"><div class="ttname"><a href="hwcontext__qsv_8c.html#a077c57cd37540d31a31f00519805b982">qsv_map_from</a></div><div class="ttdeci">static int qsv_map_from(AVHWFramesContext *ctx, AVFrame *dst, const AVFrame *src, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00662">hwcontext_qsv.c:662</a></div></div>
<div class="ttc" id="astruct_a_v_buffer_ref_html_acb8452e99cd75074b93800b532c6ea4b"><div class="ttname"><a href="struct_a_v_buffer_ref.html#acb8452e99cd75074b93800b532c6ea4b">AVBufferRef::data</a></div><div class="ttdeci">uint8_t * data</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00089">buffer.h:89</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_aaf17e113e894aa2f7b8e369e2e21224b"><div class="ttname"><a href="hwcontext__qsv_8c.html#aaf17e113e894aa2f7b8e369e2e21224b">qsv_fourcc_from_pix_fmt</a></div><div class="ttdeci">static uint32_t qsv_fourcc_from_pix_fmt(enum AVPixelFormat pix_fmt)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00120">hwcontext_qsv.c:120</a></div></div>
<div class="ttc" id="astruct_a_v_q_s_v_frames_context_html"><div class="ttname"><a href="struct_a_v_q_s_v_frames_context.html">AVQSVFramesContext</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8h_source.html#l00042">hwcontext_qsv.h:42</a></div></div>
<div class="ttc" id="agroup__lavu__frame_html_ga979d73f3228814aee56aeca0636e37cc"><div class="ttname"><a href="group__lavu__frame.html#ga979d73f3228814aee56aeca0636e37cc">av_frame_free</a></div><div class="ttdeci">void av_frame_free(AVFrame **frame)</div><div class="ttdef"><b>Definition:</b> <a href="frame_8c_source.html#l00203">frame.c:203</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_frames_context_html_a69e956e8d2d73d65d015c4ed895ec642"><div class="ttname"><a href="struct_a_v_h_w_frames_context.html#a69e956e8d2d73d65d015c4ed895ec642">AVHWFramesContext::internal</a></div><div class="ttdeci">AVHWFramesInternal * internal</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00134">hwcontext.h:134</a></div></div>
<div class="ttc" id="ahwcontext_8c_html_a66a7e1ebc7e459ce07d3de6639ac7e38"><div class="ttname"><a href="hwcontext_8c.html#a66a7e1ebc7e459ce07d3de6639ac7e38">av_hwframe_ctx_init</a></div><div class="ttdeci">int av_hwframe_ctx_init(AVBufferRef *ref)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8c_source.html#l00333">hwcontext.c:333</a></div></div>
<div class="ttc" id="apixdesc_8h_html"><div class="ttname"><a href="pixdesc_8h.html">pixdesc.h</a></div></div>
<div class="ttc" id="ahwcontext_8c_html_ac45a7c039eb4e084b692f69ff5f2e217"><div class="ttname"><a href="hwcontext_8c.html#ac45a7c039eb4e084b692f69ff5f2e217">av_hwframe_ctx_alloc</a></div><div class="ttdeci">AVBufferRef * av_hwframe_ctx_alloc(AVBufferRef *device_ref_in)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8c_source.html#l00247">hwcontext.c:247</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_af589f29b99bf88601f20dcae89c81b54"><div class="ttname"><a href="hwcontext__qsv_8c.html#af589f29b99bf88601f20dcae89c81b54">qsv_device_derive</a></div><div class="ttdeci">static int qsv_device_derive(AVHWDeviceContext *ctx, AVHWDeviceContext *child_device_ctx, AVDictionary *opts, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l01215">hwcontext_qsv.c:1215</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_a7ac8c294b998bd5ef04142db43c10e29"><div class="ttname"><a href="hwcontext__qsv_8c.html#a7ac8c294b998bd5ef04142db43c10e29">qsv_frames_derive_from</a></div><div class="ttdeci">static int qsv_frames_derive_from(AVHWFramesContext *dst_ctx, AVHWFramesContext *src_ctx, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00614">hwcontext_qsv.c:614</a></div></div>
<div class="ttc" id="ahwcontext_8c_html_a99e028453fba7e66483c2189439219d2"><div class="ttname"><a href="hwcontext_8c.html#a99e028453fba7e66483c2189439219d2">av_hwframe_map</a></div><div class="ttdeci">int av_hwframe_map(AVFrame *dst, const AVFrame *src, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8c_source.html#l00789">hwcontext.c:789</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_aa11be42c33da0099d9989237029036a2"><div class="ttname"><a href="hwcontext__qsv_8c.html#aa11be42c33da0099d9989237029036a2">qsv_init_surface</a></div><div class="ttdeci">static int qsv_init_surface(AVHWFramesContext *ctx, mfxFrameSurface1 *surf)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00315">hwcontext_qsv.c:315</a></div></div>
<div class="ttc" id="amxf_8c_html_a084824fc871e38157790c99ae1240842"><div class="ttname"><a href="mxf_8c.html#a084824fc871e38157790c99ae1240842">data</a></div><div class="ttdeci">const char data[16]</div><div class="ttdef"><b>Definition:</b> <a href="mxf_8c_source.html#l00151">mxf.c:151</a></div></div>
<div class="ttc" id="astruct_a_v_q_s_v_frames_context_html_a748121791d286d4099c8073152973d70"><div class="ttname"><a href="struct_a_v_q_s_v_frames_context.html#a748121791d286d4099c8073152973d70">AVQSVFramesContext::surfaces</a></div><div class="ttdeci">mfxFrameSurface1 * surfaces</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8h_source.html#l00043">hwcontext_qsv.h:43</a></div></div>
<div class="ttc" id="agroup__lavu__log__constants_html_ga9b58b28e2d429b930b69db19877f76a8"><div class="ttname"><a href="group__lavu__log__constants.html#ga9b58b28e2d429b930b69db19877f76a8">AV_LOG_VERBOSE</a></div><div class="ttdeci">#define AV_LOG_VERBOSE</div><div class="ttdef"><b>Definition:</b> <a href="log_8h_source.html#l00210">log.h:210</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_device_context_html_a46055b48d1a40445d775b4ae24f77f20"><div class="ttname"><a href="struct_a_v_h_w_device_context.html#a46055b48d1a40445d775b4ae24f77f20">AVHWDeviceContext::hwctx</a></div><div class="ttdeci">void * hwctx</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00092">hwcontext.h:92</a></div></div>
<div class="ttc" id="astruct_a_v_q_s_v_device_context_html"><div class="ttname"><a href="struct_a_v_q_s_v_device_context.html">AVQSVDeviceContext</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8h_source.html#l00035">hwcontext_qsv.h:35</a></div></div>
<div class="ttc" id="astruct_a_v_dictionary_entry_html"><div class="ttname"><a href="struct_a_v_dictionary_entry.html">AVDictionaryEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="dict_8h_source.html#l00081">dict.h:81</a></div></div>
<div class="ttc" id="agroup__lavu__buffer_html_ga3e7f4c92db85ccba0b2a16dd0069842a"><div class="ttname"><a href="group__lavu__buffer.html#ga3e7f4c92db85ccba0b2a16dd0069842a">av_buffer_create</a></div><div class="ttdeci">AVBufferRef * av_buffer_create(uint8_t *data, int size, void(*free)(void *opaque, uint8_t *data), void *opaque, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00029">buffer.c:29</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5a41c64e3682529dd5caca6f7d5d3c19c7"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a41c64e3682529dd5caca6f7d5d3c19c7">AV_PIX_FMT_BGRA</a></div><div class="ttdeci">@ AV_PIX_FMT_BGRA</div><div class="ttdoc">packed BGRA 8:8:8:8, 32bpp, BGRABGRA...</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00095">pixfmt.h:95</a></div></div>
<div class="ttc" id="ahwcontext_8c_html_a76e0387f519b3f1bd1b162e91b54b182"><div class="ttname"><a href="hwcontext_8c.html#a76e0387f519b3f1bd1b162e91b54b182">ff_hwframe_map_create</a></div><div class="ttdeci">int ff_hwframe_map_create(AVBufferRef *hwframe_ref, AVFrame *dst, const AVFrame *src, void(*unmap)(AVHWFramesContext *ctx, HWMapDescriptor *hwmap), void *priv)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8c_source.html#l00737">hwcontext.c:737</a></div></div>
<div class="ttc" id="astruct_a_v_d_x_v_a2_frames_context_html_abc67fe5747f160bf1f0bb98a506057ba"><div class="ttname"><a href="struct_a_v_d_x_v_a2_frames_context.html#abc67fe5747f160bf1f0bb98a506057ba">AVDXVA2FramesContext::surface_type</a></div><div class="ttdeci">DWORD surface_type</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__dxva2_8h_source.html#l00051">hwcontext_dxva2.h:51</a></div></div>
<div class="ttc" id="agroup__lavu__error_html_ga4ebaa288c7684a26a591c501208910e4"><div class="ttname"><a href="group__lavu__error.html#ga4ebaa288c7684a26a591c501208910e4">AVERROR_UNKNOWN</a></div><div class="ttdeci">#define AVERROR_UNKNOWN</div><div class="ttdoc">Unknown error, typically from an external library.</div><div class="ttdef"><b>Definition:</b> <a href="error_8h_source.html#l00071">error.h:71</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_aa5d906425500585aa7832161b2a40e1b"><div class="ttname"><a href="hwcontext__qsv_8c.html#aa5d906425500585aa7832161b2a40e1b">fourcc</a></div><div class="ttdeci">uint32_t fourcc</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00104">hwcontext_qsv.c:104</a></div></div>
<div class="ttc" id="ahwcontext_8c_html_a11d8c9101c95cdcab3dbc5b4c03dfd4d"><div class="ttname"><a href="hwcontext_8c.html#a11d8c9101c95cdcab3dbc5b4c03dfd4d">av_hwdevice_ctx_init</a></div><div class="ttdeci">int av_hwdevice_ctx_init(AVBufferRef *ref)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8c_source.html#l00200">hwcontext.c:200</a></div></div>
<div class="ttc" id="astruct_a_v_d_x_v_a2_frames_context_html_a2025b21fc7ec906713c525a702fd6eb7"><div class="ttname"><a href="struct_a_v_d_x_v_a2_frames_context.html#a2025b21fc7ec906713c525a702fd6eb7">AVDXVA2FramesContext::surfaces</a></div><div class="ttdeci">IDirect3DSurface9 ** surfaces</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__dxva2_8h_source.html#l00058">hwcontext_dxva2.h:58</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_a9e634a2b6443eff98a84b2596f81ed87"><div class="ttname"><a href="hwcontext__qsv_8c.html#a9e634a2b6443eff98a84b2596f81ed87">qsv_transfer_data_from</a></div><div class="ttdeci">static int qsv_transfer_data_from(AVHWFramesContext *ctx, AVFrame *dst, const AVFrame *src)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00810">hwcontext_qsv.c:810</a></div></div>
<div class="ttc" id="astruct_a_v_frame_html_a29493fbfabaa21432c360a090426aa8e"><div class="ttname"><a href="struct_a_v_frame.html#a29493fbfabaa21432c360a090426aa8e">AVFrame::hw_frames_ctx</a></div><div class="ttdeci">AVBufferRef * hw_frames_ctx</div><div class="ttdef"><b>Definition:</b> <a href="frame_8h_source.html#l00647">frame.h:647</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_a48f238ab9f05e0f305ba82e179cb2253"><div class="ttname"><a href="hwcontext__qsv_8c.html#a48f238ab9f05e0f305ba82e179cb2253">qsv_init_child_ctx</a></div><div class="ttdeci">static int qsv_init_child_ctx(AVHWFramesContext *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00212">hwcontext_qsv.c:212</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_frames_constraints_html_a4258bbe81f927b76b7ca5af44ba7ef6b"><div class="ttname"><a href="struct_a_v_h_w_frames_constraints.html#a4258bbe81f927b76b7ca5af44ba7ef6b">AVHWFramesConstraints::valid_hw_formats</a></div><div class="ttdeci">enum AVPixelFormat * valid_hw_formats</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00458">hwcontext.h:458</a></div></div>
<div class="ttc" id="acheckasm_8h_html_a73a3b169ac8c3419cbe15327e75ffcfd"><div class="ttname"><a href="checkasm_8h.html#a73a3b169ac8c3419cbe15327e75ffcfd">fail</a></div><div class="ttdeci">#define fail()</div><div class="ttdef"><b>Definition:</b> <a href="checkasm_8h_source.html#l00123">checkasm.h:123</a></div></div>
<div class="ttc" id="astruct_q_s_v_frames_context_html_aa4434580b036b0885bcabddf15a5d52d"><div class="ttname"><a href="struct_q_s_v_frames_context.html#aa4434580b036b0885bcabddf15a5d52d">QSVFramesContext::child_frames_ref</a></div><div class="ttdeci">AVBufferRef * child_frames_ref</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00075">hwcontext_qsv.c:75</a></div></div>
<div class="ttc" id="apixdesc_8h_html_a76f6211b2404231bd7d206ebf4ae46f6"><div class="ttname"><a href="pixdesc_8h.html#a76f6211b2404231bd7d206ebf4ae46f6">AV_PIX_FMT_FLAG_HWACCEL</a></div><div class="ttdeci">#define AV_PIX_FMT_FLAG_HWACCEL</div><div class="ttdef"><b>Definition:</b> <a href="pixdesc_8h_source.html#l00140">pixdesc.h:140</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_a3cdfd61164b23f7665c942dfed5a5dac"><div class="ttname"><a href="hwcontext__qsv_8c.html#a3cdfd61164b23f7665c942dfed5a5dac">qsv_frames_get_constraints</a></div><div class="ttdeci">static int qsv_frames_get_constraints(AVHWDeviceContext *ctx, const void *hwconfig, AVHWFramesConstraints *constraints)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l01064">hwcontext_qsv.c:1064</a></div></div>
<div class="ttc" id="astruct_q_s_v_device_context_html_a11c9e7859a9dc46f0d49bef21d2cd650"><div class="ttname"><a href="struct_q_s_v_device_context.html#a11c9e7859a9dc46f0d49bef21d2cd650">QSVDeviceContext::ver</a></div><div class="ttdeci">mfxVersion ver</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00058">hwcontext_qsv.c:58</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_a370f2c5459294a1f609b0dd9f3c11180"><div class="ttname"><a href="hwcontext__qsv_8c.html#a370f2c5459294a1f609b0dd9f3c11180">QSVFramesContext</a></div><div class="ttdeci">struct QSVFramesContext QSVFramesContext</div></div>
<div class="ttc" id="astruct_a_v_h_w_frames_context_html_a9c3a94dcd9c96e19059b56a6bae9c764"><div class="ttname"><a href="struct_a_v_h_w_frames_context.html#a9c3a94dcd9c96e19059b56a6bae9c764">AVHWFramesContext::initial_pool_size</a></div><div class="ttdeci">int initial_pool_size</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00199">hwcontext.h:199</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_a3f6f34808101299d4cd094fcb313e919"><div class="ttname"><a href="hwcontext__qsv_8c.html#a3f6f34808101299d4cd094fcb313e919">handle_type</a></div><div class="ttdeci">mfxHandleType handle_type</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00089">hwcontext_qsv.c:89</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_a91d7ae5466e990afd92c0e62d1807d05"><div class="ttname"><a href="hwcontext__qsv_8c.html#a91d7ae5466e990afd92c0e62d1807d05">qsv_frames_derive_to</a></div><div class="ttdeci">static int qsv_frames_derive_to(AVHWFramesContext *dst_ctx, AVHWFramesContext *src_ctx, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00974">hwcontext_qsv.c:974</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_device_context_html"><div class="ttname"><a href="struct_a_v_h_w_device_context.html">AVHWDeviceContext</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00061">hwcontext.h:61</a></div></div>
<div class="ttc" id="astruct_q_s_v_device_context_html_a92ab7a5d495bfaa0f6319c4ed4d1350d"><div class="ttname"><a href="struct_q_s_v_device_context.html#a92ab7a5d495bfaa0f6319c4ed4d1350d">QSVDeviceContext::child_device_type</a></div><div class="ttdeci">enum AVHWDeviceType child_device_type</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00059">hwcontext_qsv.c:61</a></div></div>
<div class="ttc" id="agroup__lavu__frame_html_gac700017c5270c79c1e1befdeeb008b2f"><div class="ttname"><a href="group__lavu__frame.html#gac700017c5270c79c1e1befdeeb008b2f">av_frame_alloc</a></div><div class="ttdeci">AVFrame * av_frame_alloc(void)</div><div class="ttdef"><b>Definition:</b> <a href="frame_8c_source.html#l00190">frame.c:190</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_acb8eeb6e668f19381ec8cac034decd71"><div class="ttname"><a href="hwcontext__qsv_8c.html#acb8eeb6e668f19381ec8cac034decd71">frame_free</a></div><div class="ttdeci">static mfxStatus frame_free(mfxHDL pthis, mfxFrameAllocResponse *resp)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00419">hwcontext_qsv.c:419</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_frames_context_html_ae61bbe1d8645a0c573085e29f1d0a58f"><div class="ttname"><a href="struct_a_v_h_w_frames_context.html#ae61bbe1d8645a0c573085e29f1d0a58f">AVHWFramesContext::height</a></div><div class="ttdeci">int height</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00229">hwcontext.h:229</a></div></div>
<div class="ttc" id="astruct_a_v_v_a_a_p_i_device_context_html_a89951d5ccfad53ce81444773ea9f774e"><div class="ttname"><a href="struct_a_v_v_a_a_p_i_device_context.html#a89951d5ccfad53ce81444773ea9f774e">AVVAAPIDeviceContext::display</a></div><div class="ttdeci">VADisplay display</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__vaapi_8h_source.html#l00072">hwcontext_vaapi.h:72</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a5cfd3e9346f68f69196d9f13f8d69022"><div class="ttname"><a href="pixfmt_8h.html#a5cfd3e9346f68f69196d9f13f8d69022">AV_PIX_FMT_Y210</a></div><div class="ttdeci">#define AV_PIX_FMT_Y210</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00451">pixfmt.h:451</a></div></div>
<div class="ttc" id="agroup__lavu__log__constants_html_gaffe151ff4cd8a24b2e77ac8d9616c85c"><div class="ttname"><a href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a></div><div class="ttdeci">#define AV_LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="log_8h_source.html#l00194">log.h:194</a></div></div>
<div class="ttc" id="astruct_q_s_v_device_context_html"><div class="ttname"><a href="struct_q_s_v_device_context.html">QSVDeviceContext</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00055">hwcontext_qsv.c:55</a></div></div>
<div class="ttc" id="ahwcontext_8c_html_a1cb1f874bb5a0ed7743f9a2b73b47e6e"><div class="ttname"><a href="hwcontext_8c.html#a1cb1f874bb5a0ed7743f9a2b73b47e6e">av_hwdevice_ctx_alloc</a></div><div class="ttdeci">AVBufferRef * av_hwdevice_ctx_alloc(enum AVHWDeviceType type)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8c_source.html#l00142">hwcontext.c:142</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_a57ebafa8b3520aa3c0fb8a1a893559cf"><div class="ttname"><a href="hwcontext__qsv_8c.html#a57ebafa8b3520aa3c0fb8a1a893559cf">frame_alloc</a></div><div class="ttdeci">static mfxStatus frame_alloc(mfxHDL pthis, mfxFrameAllocRequest *req, mfxFrameAllocResponse *resp)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00391">hwcontext_qsv.c:391</a></div></div>
<div class="ttc" id="agroup__lavu__dict_html_gae67f143237b2cb2936c9b147aa6dfde3"><div class="ttname"><a href="group__lavu__dict.html#gae67f143237b2cb2936c9b147aa6dfde3">av_dict_get</a></div><div class="ttdeci">AVDictionaryEntry * av_dict_get(const AVDictionary *m, const char *key, const AVDictionaryEntry *prev, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="dict_8c_source.html#l00040">dict.c:40</a></div></div>
<div class="ttc" id="agroup__lavu__bufferpool_html_ga2c745ecb4001452423e775b06b20fb7c"><div class="ttname"><a href="group__lavu__bufferpool.html#ga2c745ecb4001452423e775b06b20fb7c">av_buffer_pool_get</a></div><div class="ttdeci">AVBufferRef * av_buffer_pool_get(AVBufferPool *pool)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00364">buffer.c:364</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5a35e418d6581792c6daa3c0aaba601cb1"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a35e418d6581792c6daa3c0aaba601cb1">AV_PIX_FMT_DXVA2_VLD</a></div><div class="ttdeci">@ AV_PIX_FMT_DXVA2_VLD</div><div class="ttdoc">HW decoding through DXVA2, Picture.data[3] contains a LPDIRECT3DSURFACE9 pointer.</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00137">pixfmt.h:137</a></div></div>
<div class="ttc" id="acbs__vp9_8c_html_a5950eda76c8ffc67651de936cd8c79ec"><div class="ttname"><a href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a></div><div class="ttdeci">#define s(width, name)</div><div class="ttdef"><b>Definition:</b> <a href="cbs__vp9_8c_source.html#l00257">cbs_vp9.c:257</a></div></div>
<div class="ttc" id="astruct_a_v_dictionary_entry_html_aa38678f2cad36f120d42e56449c5edb4"><div class="ttname"><a href="struct_a_v_dictionary_entry.html#aa38678f2cad36f120d42e56449c5edb4">AVDictionaryEntry::value</a></div><div class="ttdeci">char * value</div><div class="ttdef"><b>Definition:</b> <a href="dict_8h_source.html#l00083">dict.h:83</a></div></div>
<div class="ttc" id="astruct_q_s_v_device_priv_html_a4d5334a14976c0fafc8f2471df69b5a4"><div class="ttname"><a href="struct_q_s_v_device_priv.html#a4d5334a14976c0fafc8f2471df69b5a4">QSVDevicePriv::child_device_ctx</a></div><div class="ttdeci">AVBufferRef * child_device_ctx</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00052">hwcontext_qsv.c:52</a></div></div>
<div class="ttc" id="ahwcontext_8h_html_acf25724be4b066a51ad86aa9214b0d34"><div class="ttname"><a href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34">AVHWDeviceType</a></div><div class="ttdeci">AVHWDeviceType</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00027">hwcontext.h:27</a></div></div>
<div class="ttc" id="atests_2movenc_8c_html_a93cc7296f13f507c1fd7abd0db36b898"><div class="ttname"><a href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a></div><div class="ttdeci">AVFormatContext * ctx</div><div class="ttdef"><b>Definition:</b> <a href="tests_2movenc_8c_source.html#l00048">movenc.c:48</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_frames_constraints_html_aabea88093c6f85d6185ffb0852a2217f"><div class="ttname"><a href="struct_a_v_h_w_frames_constraints.html#aabea88093c6f85d6185ffb0852a2217f">AVHWFramesConstraints::valid_sw_formats</a></div><div class="ttdeci">enum AVPixelFormat * valid_sw_formats</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00465">hwcontext.h:465</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5a1aa7677092740d8def31655b5d7f0cc2"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a1aa7677092740d8def31655b5d7f0cc2">AV_PIX_FMT_YUV420P</a></div><div class="ttdeci">@ AV_PIX_FMT_YUV420P</div><div class="ttdoc">planar YUV 4:2:0, 12bpp, (1 Cr &amp; Cb sample per 2x2 Y samples)</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00066">pixfmt.h:66</a></div></div>
<div class="ttc" id="atime_8c_html_a4eee9c65835652a808973f4bc1641a51"><div class="ttname"><a href="time_8c.html#a4eee9c65835652a808973f4bc1641a51">av_usleep</a></div><div class="ttdeci">int av_usleep(unsigned usec)</div><div class="ttdef"><b>Definition:</b> <a href="time_8c_source.html#l00084">time.c:84</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_aeba6c3488f46d75147e815bf905aa432"><div class="ttname"><a href="hwcontext__qsv_8c.html#aeba6c3488f46d75147e815bf905aa432">QSVDeviceContext</a></div><div class="ttdeci">struct QSVDeviceContext QSVDeviceContext</div></div>
<div class="ttc" id="afilter__design_8txt_html_a0e82f1088fdc24c14bf175d2ac77523f"><div class="ttname"><a href="filter__design_8txt.html#a0e82f1088fdc24c14bf175d2ac77523f">if</a></div><div class="ttdeci">if(ret)</div><div class="ttdef"><b>Definition:</b> <a href="filter__design_8txt_source.html#l00179">filter_design.txt:179</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_a9711b88d071503de3915aaecede66ca0"><div class="ttname"><a href="hwcontext__qsv_8c.html#a9711b88d071503de3915aaecede66ca0">supported_handle_types</a></div><div class="ttdeci">static const struct @0 supported_handle_types[]</div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_a58106054e4c71a65547359bbe51fea82"><div class="ttname"><a href="hwcontext__qsv_8c.html#a58106054e4c71a65547359bbe51fea82">ff_hwcontext_type_qsv</a></div><div class="ttdeci">const HWContextType ff_hwcontext_type_qsv</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l01275">hwcontext_qsv.c:1275</a></div></div>
<div class="ttc" id="atests_2movenc_8c_html_af540b728145b614e34c4e10930354b93"><div class="ttname"><a href="tests_2movenc_8c.html#af540b728145b614e34c4e10930354b93">opts</a></div><div class="ttdeci">AVDictionary * opts</div><div class="ttdef"><b>Definition:</b> <a href="tests_2movenc_8c_source.html#l00050">movenc.c:50</a></div></div>
<div class="ttc" id="astruct_q_s_v_frames_context_html_acf21c88b6cc4007df0c4cc33c7bc56f3"><div class="ttname"><a href="struct_q_s_v_frames_context.html#acf21c88b6cc4007df0c4cc33c7bc56f3">QSVFramesContext::session_download_init</a></div><div class="ttdeci">int session_download_init</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00067">hwcontext_qsv.c:67</a></div></div>
<div class="ttc" id="acoverity_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="coverity_8c_source.html#l00032">coverity.c:32</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_aae34df94330b4b328854f0883450f2d1"><div class="ttname"><a href="hwcontext__qsv_8c.html#aae34df94330b4b328854f0883450f2d1">qsv_frames_uninit</a></div><div class="ttdeci">static void qsv_frames_uninit(AVHWFramesContext *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00164">hwcontext_qsv.c:164</a></div></div>
<div class="ttc" id="agroup__lavu__buffer_html_ga135e9e929b5033bb8f68322497b2effc"><div class="ttname"><a href="group__lavu__buffer.html#ga135e9e929b5033bb8f68322497b2effc">av_buffer_unref</a></div><div class="ttdeci">void av_buffer_unref(AVBufferRef **buf)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00125">buffer.c:125</a></div></div>
<div class="ttc" id="ahwcontext_8h_html_acf25724be4b066a51ad86aa9214b0d34acc6f1868dad1c636d4747cc91ce71d10"><div class="ttname"><a href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34acc6f1868dad1c636d4747cc91ce71d10">AV_HWDEVICE_TYPE_DXVA2</a></div><div class="ttdeci">@ AV_HWDEVICE_TYPE_DXVA2</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00032">hwcontext.h:32</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5ac755aea7c3277b09a42253882ec0444e"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5ac755aea7c3277b09a42253882ec0444e">AV_PIX_FMT_YUYV422</a></div><div class="ttdeci">@ AV_PIX_FMT_YUYV422</div><div class="ttdoc">packed YUV 4:2:2, 16bpp, Y0 Cb Y1 Cr</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00067">pixfmt.h:67</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_frames_context_html"><div class="ttname"><a href="struct_a_v_h_w_frames_context.html">AVHWFramesContext</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00124">hwcontext.h:124</a></div></div>
<div class="ttc" id="atests_2checkasm_2vp8dsp_8c_html_a858376c0918f93e656c8c0d76c63dbe8"><div class="ttname"><a href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a></div><div class="ttdeci">#define src</div><div class="ttdef"><b>Definition:</b> <a href="tests_2checkasm_2vp8dsp_8c_source.html#l00254">vp8dsp.c:254</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_a5e17476aca2cc0ba08808ca9bd0a4213"><div class="ttname"><a href="hwcontext__qsv_8c.html#a5e17476aca2cc0ba08808ca9bd0a4213">qsv_frames_init</a></div><div class="ttdeci">static int qsv_frames_init(AVHWFramesContext *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00516">hwcontext_qsv.c:516</a></div></div>
<div class="ttc" id="atime_8h_html"><div class="ttname"><a href="time_8h.html">time.h</a></div></div>
<div class="ttc" id="astruct_a_v_pix_fmt_descriptor_html"><div class="ttname"><a href="struct_a_v_pix_fmt_descriptor.html">AVPixFmtDescriptor</a></div><div class="ttdef"><b>Definition:</b> <a href="pixdesc_8h_source.html#l00081">pixdesc.h:81</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5ac913414b6091ce30035b21b9c0bc1c8e"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5ac913414b6091ce30035b21b9c0bc1c8e">AV_PIX_FMT_QSV</a></div><div class="ttdeci">@ AV_PIX_FMT_QSV</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00222">pixfmt.h:222</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_acc5f5f5cb256375fcd76e0d370db203f"><div class="ttname"><a href="hwcontext__qsv_8c.html#acc5f5f5cb256375fcd76e0d370db203f">map_frame_to_surface</a></div><div class="ttdeci">static int map_frame_to_surface(const AVFrame *frame, mfxFrameSurface1 *surface)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00767">hwcontext_qsv.c:767</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_ad98c9959d58461d45084a6644c26cb45"><div class="ttname"><a href="hwcontext__qsv_8c.html#ad98c9959d58461d45084a6644c26cb45">frame_unlock</a></div><div class="ttdeci">static mfxStatus frame_unlock(mfxHDL pthis, mfxMemId mid, mfxFrameData *ptr)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00429">hwcontext_qsv.c:429</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_frames_internal_html_a503cfeb391ed69856344768fd641a489"><div class="ttname"><a href="struct_a_v_h_w_frames_internal.html#a503cfeb391ed69856344768fd641a489">AVHWFramesInternal::priv</a></div><div class="ttdeci">void * priv</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__internal_8h_source.html#l00116">hwcontext_internal.h:116</a></div></div>
<div class="ttc" id="affprobe_8c_html_aa91b7ec8ae8a2d699fb09cc20c444fe8"><div class="ttname"><a href="ffprobe_8c.html#aa91b7ec8ae8a2d699fb09cc20c444fe8">pthread_mutex_unlock</a></div><div class="ttdeci">#define pthread_mutex_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="ffprobe_8c_source.html#l00066">ffprobe.c:66</a></div></div>
<div class="ttc" id="astruct_a_v_frame_html_a3f89733f429c98ba5bc64373fb0a3f13"><div class="ttname"><a href="struct_a_v_frame.html#a3f89733f429c98ba5bc64373fb0a3f13">AVFrame::height</a></div><div class="ttdeci">int height</div><div class="ttdef"><b>Definition:</b> <a href="frame_8h_source.html#l00366">frame.h:366</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_frames_constraints_html"><div class="ttname"><a href="struct_a_v_h_w_frames_constraints.html">AVHWFramesConstraints</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00453">hwcontext.h:453</a></div></div>
<div class="ttc" id="agroup__lavu__mem__funcs_html_gaf143ecab33a3868b57345466c39de7c1"><div class="ttname"><a href="group__lavu__mem__funcs.html#gaf143ecab33a3868b57345466c39de7c1">av_mallocz</a></div><div class="ttdeci">void * av_mallocz(size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="mem_8c_source.html#l00237">mem.c:237</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_frames_context_html_a54e38c3e4355321e23e0f4c7411cb8ee"><div class="ttname"><a href="struct_a_v_h_w_frames_context.html#a54e38c3e4355321e23e0f4c7411cb8ee">AVHWFramesContext::hwctx</a></div><div class="ttdeci">void * hwctx</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00162">hwcontext.h:162</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_a56a518c57d01ebe5a2c68ce6035ad837"><div class="ttname"><a href="hwcontext__qsv_8c.html#a56a518c57d01ebe5a2c68ce6035ad837">qsv_init_internal_session</a></div><div class="ttdeci">static int qsv_init_internal_session(AVHWFramesContext *ctx, mfxSession *session, int upload)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00440">hwcontext_qsv.c:440</a></div></div>
<div class="ttc" id="ahwcontext__dxva2_8h_html"><div class="ttname"><a href="hwcontext__dxva2_8h.html">hwcontext_dxva2.h</a></div></div>
<div class="ttc" id="astruct_a_v_d_x_v_a2_device_context_html_a3baea98a35192cc661f903198d7196ab"><div class="ttname"><a href="struct_a_v_d_x_v_a2_device_context.html#a3baea98a35192cc661f903198d7196ab">AVDXVA2DeviceContext::devmgr</a></div><div class="ttdeci">IDirect3DDeviceManager9 * devmgr</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__dxva2_8h_source.html#l00040">hwcontext_dxva2.h:40</a></div></div>
<div class="ttc" id="astruct_a_v_v_a_a_p_i_device_context_html"><div class="ttname"><a href="struct_a_v_v_a_a_p_i_device_context.html">AVVAAPIDeviceContext</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__vaapi_8h_source.html#l00068">hwcontext_vaapi.h:68</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_ae0cd7b25815a2c03d49159633998d6ec"><div class="ttname"><a href="hwcontext__qsv_8c.html#ae0cd7b25815a2c03d49159633998d6ec">qsv_get_buffer</a></div><div class="ttdeci">static int qsv_get_buffer(AVHWFramesContext *ctx, AVFrame *frame)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00582">hwcontext_qsv.c:582</a></div></div>
<div class="ttc" id="astruct_a_v_v_a_a_p_i_frames_context_html_a18c4ca9956227c498679a823e14e1375"><div class="ttname"><a href="struct_a_v_v_a_a_p_i_frames_context.html#a18c4ca9956227c498679a823e14e1375">AVVAAPIFramesContext::surface_ids</a></div><div class="ttdeci">VASurfaceID * surface_ids</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__vaapi_8h_source.html#l00101">hwcontext_vaapi.h:101</a></div></div>
<div class="ttc" id="agroup__lavu__frame_html_gaec4e92f6e1e75ffaf76e07586fb0c9ed"><div class="ttname"><a href="group__lavu__frame.html#gaec4e92f6e1e75ffaf76e07586fb0c9ed">av_frame_copy</a></div><div class="ttdeci">int av_frame_copy(AVFrame *dst, const AVFrame *src)</div><div class="ttdef"><b>Definition:</b> <a href="frame_8c_source.html#l00799">frame.c:799</a></div></div>
<div class="ttc" id="astruct_a_v_d_x_v_a2_device_context_html"><div class="ttname"><a href="struct_a_v_d_x_v_a2_device_context.html">AVDXVA2DeviceContext</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__dxva2_8h_source.html#l00039">hwcontext_dxva2.h:39</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_a7898416aa2fa2f5d58aa4b6f35135205"><div class="ttname"><a href="hwcontext__qsv_8c.html#a7898416aa2fa2f5d58aa4b6f35135205">device_type</a></div><div class="ttdeci">enum AVHWDeviceType device_type</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00089">hwcontext_qsv.c:90</a></div></div>
<div class="ttc" id="astruct_q_s_v_device_context_html_a69bcb59f86315e626b2c6c6c62fa3b91"><div class="ttname"><a href="struct_q_s_v_device_context.html#a69bcb59f86315e626b2c6c6c62fa3b91">QSVDeviceContext::impl</a></div><div class="ttdeci">mfxIMPL impl</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00059">hwcontext_qsv.c:59</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_a57701212b729e0f56d1cfe2b2a2e7c82"><div class="ttname"><a href="hwcontext__qsv_8c.html#a57701212b729e0f56d1cfe2b2a2e7c82">qsv_device_free</a></div><div class="ttdeci">static void qsv_device_free(AVHWDeviceContext *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l01089">hwcontext_qsv.c:1089</a></div></div>
<div class="ttc" id="astruct_a_v_buffer_ref_html"><div class="ttname"><a href="struct_a_v_buffer_ref.html">AVBufferRef</a></div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00081">buffer.h:81</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_ab87f7254aeac060402c699ed724722bc"><div class="ttname"><a href="hwcontext__qsv_8c.html#ab87f7254aeac060402c699ed724722bc">qsv_pool_alloc</a></div><div class="ttdeci">static AVBufferRef * qsv_pool_alloc(void *opaque, int size)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00197">hwcontext_qsv.c:197</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_a8562eaeaf740a3e9756615b6c3bbbccb"><div class="ttname"><a href="hwcontext__qsv_8c.html#a8562eaeaf740a3e9756615b6c3bbbccb">qsv_transfer_get_formats</a></div><div class="ttdeci">static int qsv_transfer_get_formats(AVHWFramesContext *ctx, enum AVHWFrameTransferDirection dir, enum AVPixelFormat **formats)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00596">hwcontext_qsv.c:596</a></div></div>
<div class="ttc" id="abuffer_8h_html"><div class="ttname"><a href="buffer_8h.html">buffer.h</a></div></div>
<div class="ttc" id="astruct_h_w_context_type_html_a5ddb5fc39d16ce3147a5640c8d040937"><div class="ttname"><a href="struct_h_w_context_type.html#a5ddb5fc39d16ce3147a5640c8d040937">HWContextType::type</a></div><div class="ttdeci">enum AVHWDeviceType type</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__internal_8h_source.html#l00176">hwcontext_internal.h:30</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_a42004a4575324f7c763ca19192a4eefa"><div class="ttname"><a href="hwcontext__qsv_8c.html#a42004a4575324f7c763ca19192a4eefa">qsv_device_derive_from_child</a></div><div class="ttdeci">static int qsv_device_derive_from_child(AVHWDeviceContext *ctx, mfxIMPL implementation, AVHWDeviceContext *child_device_ctx, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l01133">hwcontext_qsv.c:1133</a></div></div>
<div class="ttc" id="astruct_q_s_v_frames_context_html_a839c91e8e38aeae0d3db5648cc25f77a"><div class="ttname"><a href="struct_q_s_v_frames_context.html#a839c91e8e38aeae0d3db5648cc25f77a">QSVFramesContext::ext_buffers</a></div><div class="ttdeci">mfxExtBuffer * ext_buffers[1]</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00085">hwcontext_qsv.c:85</a></div></div>
<div class="ttc" id="amem_8c_html_aedc3761897b7e9ea8ae1222b3d013c94"><div class="ttname"><a href="mem_8c.html#aedc3761897b7e9ea8ae1222b3d013c94">av_mallocz_array</a></div><div class="ttdeci">void * av_mallocz_array(size_t nmemb, size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="mem_8c_source.html#l00190">mem.c:190</a></div></div>
<div class="ttc" id="agroup__lavu__dict_html_ga1bafd682b1fbb90e48a4cc3814b820f7"><div class="ttname"><a href="group__lavu__dict.html#ga1bafd682b1fbb90e48a4cc3814b820f7">av_dict_free</a></div><div class="ttdeci">void av_dict_free(AVDictionary **pm)</div><div class="ttdef"><b>Definition:</b> <a href="dict_8c_source.html#l00203">dict.c:203</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_a6bbaba0ff800822726baffce44482dd1"><div class="ttname"><a href="hwcontext__qsv_8c.html#a6bbaba0ff800822726baffce44482dd1">frame_get_hdl</a></div><div class="ttdeci">static mfxStatus frame_get_hdl(mfxHDL pthis, mfxMemId mid, mfxHDL *hdl)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00434">hwcontext_qsv.c:434</a></div></div>
<div class="ttc" id="astruct_a_v_frame_html_a1e71ce60cedd5f3b6811714a9f7f9e0a"><div class="ttname"><a href="struct_a_v_frame.html#a1e71ce60cedd5f3b6811714a9f7f9e0a">AVFrame::width</a></div><div class="ttdeci">int width</div><div class="ttdef"><b>Definition:</b> <a href="frame_8h_source.html#l00366">frame.h:366</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5abb09cadf3b2d6b5ce5980401bcf638a8"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5abb09cadf3b2d6b5ce5980401bcf638a8">AV_PIX_FMT_VAAPI</a></div><div class="ttdeci">@ AV_PIX_FMT_VAAPI</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00122">pixfmt.h:122</a></div></div>
<div class="ttc" id="aos2threads_8h_html_a4c57837c88ef09274545ae2ebd18160a"><div class="ttname"><a href="os2threads_8h.html#a4c57837c88ef09274545ae2ebd18160a">pthread_cond_destroy</a></div><div class="ttdeci">static av_always_inline int pthread_cond_destroy(pthread_cond_t *cond)</div><div class="ttdef"><b>Definition:</b> <a href="os2threads_8h_source.html#l00144">os2threads.h:144</a></div></div>
<div class="ttc" id="astruct_q_s_v_frames_context_html_adc35c4a7df1ae8128fae944344e1223b"><div class="ttname"><a href="struct_q_s_v_frames_context.html#adc35c4a7df1ae8128fae944344e1223b">QSVFramesContext::opaque_alloc</a></div><div class="ttdeci">mfxExtOpaqueSurfaceAlloc opaque_alloc</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00084">hwcontext_qsv.c:84</a></div></div>
<div class="ttc" id="ahwcontext_8h_html_acf25724be4b066a51ad86aa9214b0d34af5dfa6181a3a6efb0f4a0c5f38d76b95"><div class="ttname"><a href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34af5dfa6181a3a6efb0f4a0c5f38d76b95">AV_HWDEVICE_TYPE_VAAPI</a></div><div class="ttdeci">@ AV_HWDEVICE_TYPE_VAAPI</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00031">hwcontext.h:31</a></div></div>
<div class="ttc" id="aos2threads_8h_html_af75a104513c9384ace314b0a6b1a8240"><div class="ttname"><a href="os2threads_8h.html#af75a104513c9384ace314b0a6b1a8240">pthread_mutex_destroy</a></div><div class="ttdeci">static av_always_inline int pthread_mutex_destroy(pthread_mutex_t *mutex)</div><div class="ttdef"><b>Definition:</b> <a href="os2threads_8h_source.html#l00112">os2threads.h:112</a></div></div>
<div class="ttc" id="aaudio__convert_8c_html_ab92ad91055387e15b43ff5f6f60f2895"><div class="ttname"><a href="audio__convert_8c.html#ab92ad91055387e15b43ff5f6f60f2895">in</a></div><div class="ttdeci">uint8_t pi&lt;&lt; 24) CONV_FUNC_GROUP(AV_SAMPLE_FMT_FLT, float, AV_SAMPLE_FMT_U8, uint8_t,(*(const uint8_t *) pi - 0x80) *(1.0f/(1&lt;&lt; 7))) CONV_FUNC_GROUP(AV_SAMPLE_FMT_DBL, double, AV_SAMPLE_FMT_U8, uint8_t,(*(const uint8_t *) pi - 0x80) *(1.0/(1&lt;&lt; 7))) CONV_FUNC_GROUP(AV_SAMPLE_FMT_U8, uint8_t, AV_SAMPLE_FMT_S16, int16_t,(*(const int16_t *) pi &gt;&gt; 8)+0x80) CONV_FUNC_GROUP(AV_SAMPLE_FMT_FLT, float, AV_SAMPLE_FMT_S16, int16_t, *(const int16_t *) pi *(1.0f/(1&lt;&lt; 15))) CONV_FUNC_GROUP(AV_SAMPLE_FMT_DBL, double, AV_SAMPLE_FMT_S16, int16_t, *(const int16_t *) pi *(1.0/(1&lt;&lt; 15))) CONV_FUNC_GROUP(AV_SAMPLE_FMT_U8, uint8_t, AV_SAMPLE_FMT_S32, int32_t,(*(const int32_t *) pi &gt;&gt; 24)+0x80) CONV_FUNC_GROUP(AV_SAMPLE_FMT_FLT, float, AV_SAMPLE_FMT_S32, int32_t, *(const int32_t *) pi *(1.0f/(1U&lt;&lt; 31))) CONV_FUNC_GROUP(AV_SAMPLE_FMT_DBL, double, AV_SAMPLE_FMT_S32, int32_t, *(const int32_t *) pi *(1.0/(1U&lt;&lt; 31))) CONV_FUNC_GROUP(AV_SAMPLE_FMT_U8, uint8_t, AV_SAMPLE_FMT_FLT, float, av_clip_uint8(lrintf(*(const float *) pi *(1&lt;&lt; 7))+0x80)) CONV_FUNC_GROUP(AV_SAMPLE_FMT_S16, int16_t, AV_SAMPLE_FMT_FLT, float, av_clip_int16(lrintf(*(const float *) pi *(1&lt;&lt; 15)))) CONV_FUNC_GROUP(AV_SAMPLE_FMT_S32, int32_t, AV_SAMPLE_FMT_FLT, float, av_clipl_int32(llrintf(*(const float *) pi *(1U&lt;&lt; 31)))) CONV_FUNC_GROUP(AV_SAMPLE_FMT_U8, uint8_t, AV_SAMPLE_FMT_DBL, double, av_clip_uint8(lrint(*(const double *) pi *(1&lt;&lt; 7))+0x80)) CONV_FUNC_GROUP(AV_SAMPLE_FMT_S16, int16_t, AV_SAMPLE_FMT_DBL, double, av_clip_int16(lrint(*(const double *) pi *(1&lt;&lt; 15)))) CONV_FUNC_GROUP(AV_SAMPLE_FMT_S32, int32_t, AV_SAMPLE_FMT_DBL, double, av_clipl_int32(llrint(*(const double *) pi *(1U&lt;&lt; 31)))) #define SET_CONV_FUNC_GROUP(ofmt, ifmt) static void set_generic_function(AudioConvert *ac) { } void ff_audio_convert_free(AudioConvert **ac) { if(! *ac) return;ff_dither_free(&amp;(*ac) -&gt;dc);av_freep(ac);} AudioConvert *ff_audio_convert_alloc(AVAudioResampleContext *avr, enum AVSampleFormat out_fmt, enum AVSampleFormat in_fmt, int channels, int sample_rate, int apply_map) { AudioConvert *ac;int in_planar, out_planar;ac=av_mallocz(sizeof(*ac));if(!ac) return NULL;ac-&gt;avr=avr;ac-&gt;out_fmt=out_fmt;ac-&gt;in_fmt=in_fmt;ac-&gt;channels=channels;ac-&gt;apply_map=apply_map;if(avr-&gt;dither_method !=AV_RESAMPLE_DITHER_NONE &amp;&amp;av_get_packed_sample_fmt(out_fmt)==AV_SAMPLE_FMT_S16 &amp;&amp;av_get_bytes_per_sample(in_fmt) &gt; 2) { ac-&gt;dc=ff_dither_alloc(avr, out_fmt, in_fmt, channels, sample_rate, apply_map);if(!ac-&gt;dc) { av_free(ac);return NULL;} return ac;} in_planar=ff_sample_fmt_is_planar(in_fmt, channels);out_planar=ff_sample_fmt_is_planar(out_fmt, channels);if(in_planar==out_planar) { ac-&gt;func_type=CONV_FUNC_TYPE_FLAT;ac-&gt;planes=in_planar ? ac-&gt;channels :1;} else if(in_planar) ac-&gt;func_type=CONV_FUNC_TYPE_INTERLEAVE;else ac-&gt;func_type=CONV_FUNC_TYPE_DEINTERLEAVE;set_generic_function(ac);if(ARCH_AARCH64) ff_audio_convert_init_aarch64(ac);if(ARCH_ARM) ff_audio_convert_init_arm(ac);if(ARCH_X86) ff_audio_convert_init_x86(ac);return ac;} int ff_audio_convert(AudioConvert *ac, AudioData *out, AudioData *in) { int use_generic=1;int len=in-&gt;nb_samples;int p;if(ac-&gt;dc) { av_log(ac-&gt;avr, AV_LOG_TRACE, &quot;%d samples - audio_convert: %s to %s (dithered)\n&quot;, len, av_get_sample_fmt_name(ac-&gt;in_fmt), av_get_sample_fmt_name(ac-&gt;out_fmt));return ff_convert_dither(ac-&gt; in</div><div class="ttdef"><b>Definition:</b> <a href="audio__convert_8c_source.html#l00326">audio_convert.c:326</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8h_html"><div class="ttname"><a href="hwcontext__qsv_8h.html">hwcontext_qsv.h</a></div></div>
<div class="ttc" id="ainput_8c_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="input_8c_source.html#l00407">input.c:407</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_a2dd36ef3444f1075a4c86b6519d4448d"><div class="ttname"><a href="hwcontext__qsv_8c.html#a2dd36ef3444f1075a4c86b6519d4448d">qsv_device_init</a></div><div class="ttdeci">static int qsv_device_init(AVHWDeviceContext *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00130">hwcontext_qsv.c:130</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_a5349aad53b5aa95c1ea9ab2833330e66"><div class="ttname"><a href="hwcontext__qsv_8c.html#a5349aad53b5aa95c1ea9ab2833330e66">supported_pixel_formats</a></div><div class="ttdeci">static const struct @1 supported_pixel_formats[]</div></div>
<div class="ttc" id="astruct_q_s_v_frames_context_html"><div class="ttname"><a href="struct_q_s_v_frames_context.html">QSVFramesContext</a></div><div class="ttdef"><b>Definition:</b> <a href="qsv__internal_8h_source.html#l00093">qsv_internal.h:93</a></div></div>
<div class="ttc" id="astruct_q_s_v_device_context_html_aa12e122ac94c307f477fda7a18cd7893"><div class="ttname"><a href="struct_q_s_v_device_context.html#aa12e122ac94c307f477fda7a18cd7893">QSVDeviceContext::handle_type</a></div><div class="ttdeci">mfxHandleType handle_type</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00057">hwcontext_qsv.c:57</a></div></div>
<div class="ttc" id="astruct_q_s_v_frames_context_html_ad70096c0dca240753094c4312683bdf0"><div class="ttname"><a href="struct_q_s_v_frames_context.html#ad70096c0dca240753094c4312683bdf0">QSVFramesContext::nb_surfaces_used</a></div><div class="ttdeci">int nb_surfaces_used</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00077">hwcontext_qsv.c:77</a></div></div>
<div class="ttc" id="acommon_8h_html"><div class="ttname"><a href="common_8h.html">common.h</a></div></div>
<div class="ttc" id="astruct_a_v_frame_html_a4a64d05cc676bfa8e18bf22d16c8a51f"><div class="ttname"><a href="struct_a_v_frame.html#a4a64d05cc676bfa8e18bf22d16c8a51f">AVFrame::buf</a></div><div class="ttdeci">AVBufferRef * buf[AV_NUM_DATA_POINTERS]</div><div class="ttdef"><b>Definition:</b> <a href="frame_8h_source.html#l00499">frame.h:499</a></div></div>
<div class="ttc" id="aaudio__convert_8c_html_ae1affc9ca37cfb624959c866a73f83c2"><div class="ttname"><a href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a></div><div class="ttdeci">uint8_t</div><div class="ttdef"><b>Definition:</b> <a href="audio__convert_8c_source.html#l00194">audio_convert.c:194</a></div></div>
<div class="ttc" id="agroup__lavu__frame_html_ga0a2b687f9c1c5ed0089b01fd61227108"><div class="ttname"><a href="group__lavu__frame.html#ga0a2b687f9c1c5ed0089b01fd61227108">av_frame_unref</a></div><div class="ttdeci">void av_frame_unref(AVFrame *frame)</div><div class="ttdef"><b>Definition:</b> <a href="frame_8c_source.html#l00553">frame.c:553</a></div></div>
<div class="ttc" id="agroup__lavu__bufferpool_html_ga615151c8889d5be39d17bce4d8c65117"><div class="ttname"><a href="group__lavu__bufferpool.html#ga615151c8889d5be39d17bce4d8c65117">av_buffer_pool_init2</a></div><div class="ttdeci">AVBufferPool * av_buffer_pool_init2(int size, void *opaque, AVBufferRef *(*alloc)(void *opaque, int size), void(*pool_free)(void *opaque))</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00245">buffer.c:245</a></div></div>
<div class="ttc" id="astructpthread__cond__t_html"><div class="ttname"><a href="structpthread__cond__t.html">pthread_cond_t</a></div><div class="ttdef"><b>Definition:</b> <a href="os2threads_8h_source.html#l00058">os2threads.h:58</a></div></div>
<div class="ttc" id="ahwcontext_8h_html_aba8d70ed754b2536ca497d7d50ec7b1e"><div class="ttname"><a href="hwcontext_8h.html#aba8d70ed754b2536ca497d7d50ec7b1e">AVHWFrameTransferDirection</a></div><div class="ttdeci">AVHWFrameTransferDirection</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00415">hwcontext.h:415</a></div></div>
<div class="ttc" id="ahwcontext__vaapi_8h_html"><div class="ttname"><a href="hwcontext__vaapi_8h.html">hwcontext_vaapi.h</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_a8a60b03ecce61e300dfee4589ab3720c"><div class="ttname"><a href="hwcontext__qsv_8c.html#a8a60b03ecce61e300dfee4589ab3720c">qsv_map_to</a></div><div class="ttdeci">static int qsv_map_to(AVHWFramesContext *dst_ctx, AVFrame *dst, const AVFrame *src, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l01028">hwcontext_qsv.c:1028</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5acb2d8caa4e82b70f1bbe4d83f137f8c8"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5acb2d8caa4e82b70f1bbe4d83f137f8c8">AV_PIX_FMT_PAL8</a></div><div class="ttdeci">@ AV_PIX_FMT_PAL8</div><div class="ttdoc">8 bits with AV_PIX_FMT_RGB32 palette</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00077">pixfmt.h:77</a></div></div>
<div class="ttc" id="afilter__design_8txt_html_af1ec77bdca1b30e8153fc5da88f603db"><div class="ttname"><a href="filter__design_8txt.html#af1ec77bdca1b30e8153fc5da88f603db">ret</a></div><div class="ttdeci">ret</div><div class="ttdef"><b>Definition:</b> <a href="filter__design_8txt_source.html#l00187">filter_design.txt:187</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_a7331e302ea7bb48e0b605a069576e135"><div class="ttname"><a href="hwcontext__qsv_8c.html#a7331e302ea7bb48e0b605a069576e135">pix_fmt</a></div><div class="ttdeci">enum AVPixelFormat pix_fmt</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00089">hwcontext_qsv.c:91</a></div></div>
<div class="ttc" id="apixfmt_8h_html"><div class="ttname"><a href="pixfmt_8h.html">pixfmt.h</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5a0b271df0acd125218c1e365a0f754022"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a0b271df0acd125218c1e365a0f754022">AV_PIX_FMT_NV12</a></div><div class="ttdeci">@ AV_PIX_FMT_NV12</div><div class="ttdoc">planar YUV 4:2:0, 12bpp, 1 plane for Y and 1 plane for the UV components, which are interleaved (firs...</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00089">pixfmt.h:89</a></div></div>
<div class="ttc" id="afilter__design_8txt_html_a48ad71a5b40cdd5f23c601f33665a953"><div class="ttname"><a href="filter__design_8txt.html#a48ad71a5b40cdd5f23c601f33665a953">frame</a></div><div class="ttdeci">these buffered frames must be flushed immediately if a new input produces new the filter must not call request_frame to get more It must just process the frame or queue it The task of requesting more frames is left to the filter s request_frame method or the application If a filter has several the filter must be ready for frames arriving randomly on any input any filter with several inputs will most likely require some kind of queuing mechanism It is perfectly acceptable to have a limited queue and to drop frames when the inputs are too unbalanced request_frame For filters that do not use the this method is called when a frame is wanted on an output For a it should directly call filter_frame on the corresponding output For a if there are queued frames already one of these frames should be pushed If the filter should request a frame on one of its repeatedly until at least one frame has been pushed Return or at least make progress towards producing a frame</div><div class="ttdef"><b>Definition:</b> <a href="filter__design_8txt_source.html#l00264">filter_design.txt:264</a></div></div>
<div class="ttc" id="astruct_q_s_v_frames_context_html_ae813b674060eb32336908dbf2ae5b4d1"><div class="ttname"><a href="struct_q_s_v_frames_context.html#ae813b674060eb32336908dbf2ae5b4d1">QSVFramesContext::surface_ptrs</a></div><div class="ttdeci">mfxFrameSurface1 ** surface_ptrs</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00082">hwcontext_qsv.c:82</a></div></div>
<div class="ttc" id="ahwcontext_8c_html_a21fbd088225e4e25c4d9a01b3f5e8c51"><div class="ttname"><a href="hwcontext_8c.html#a21fbd088225e4e25c4d9a01b3f5e8c51">av_hwdevice_ctx_create</a></div><div class="ttdeci">int av_hwdevice_ctx_create(AVBufferRef **pdevice_ref, enum AVHWDeviceType type, const char *device, AVDictionary *opts, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8c_source.html#l00610">hwcontext.c:610</a></div></div>
<div class="ttc" id="astruct_a_v_v_a_a_p_i_frames_context_html"><div class="ttname"><a href="struct_a_v_v_a_a_p_i_frames_context.html">AVVAAPIFramesContext</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__vaapi_8h_source.html#l00088">hwcontext_vaapi.h:88</a></div></div>
<div class="ttc" id="astruct_a_v_d_x_v_a2_frames_context_html"><div class="ttname"><a href="struct_a_v_d_x_v_a2_frames_context.html">AVDXVA2FramesContext</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__dxva2_8h_source.html#l00046">hwcontext_dxva2.h:46</a></div></div>
<div class="ttc" id="agroup__lavu__mem__funcs_html_ga34e10fdac079a9ca4512b8ccd7f20b8a"><div class="ttname"><a href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a></div><div class="ttdeci">int size</div><div class="ttdef"><b>Definition:</b> <a href="twinvq__data_8h_source.html#l11134">twinvq_data.h:11134</a></div></div>
<div class="ttc" id="ahwcontext_8c_html_abf1b1664b8239d953ae2cac8b643815a"><div class="ttname"><a href="hwcontext_8c.html#abf1b1664b8239d953ae2cac8b643815a">av_hwframe_transfer_data</a></div><div class="ttdeci">int av_hwframe_transfer_data(AVFrame *dst, const AVFrame *src, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8c_source.html#l00443">hwcontext.c:443</a></div></div>
<div class="ttc" id="aos2threads_8h_html_a215efed993567deadcea30a74ed05d6c"><div class="ttname"><a href="os2threads_8h.html#a215efed993567deadcea30a74ed05d6c">pthread_cond_signal</a></div><div class="ttdeci">static av_always_inline int pthread_cond_signal(pthread_cond_t *cond)</div><div class="ttdef"><b>Definition:</b> <a href="os2threads_8h_source.html#l00152">os2threads.h:152</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_a791047364870cba9824a059a30f0daab"><div class="ttname"><a href="hwcontext__qsv_8c.html#a791047364870cba9824a059a30f0daab">frame_lock</a></div><div class="ttdeci">static mfxStatus frame_lock(mfxHDL pthis, mfxMemId mid, mfxFrameData *ptr)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00424">hwcontext_qsv.c:424</a></div></div>
<div class="ttc" id="asinewin__tablegen__template_8c_html_a3508a98d3ee7e2c9a4841fe264cf70f7"><div class="ttname"><a href="sinewin__tablegen__template_8c.html#a3508a98d3ee7e2c9a4841fe264cf70f7">FF_ARRAY_ELEMS</a></div><div class="ttdeci">#define FF_ARRAY_ELEMS(a)</div><div class="ttdef"><b>Definition:</b> <a href="sinewin__tablegen__template_8c_source.html#l00038">sinewin_tablegen_template.c:38</a></div></div>
<div class="ttc" id="astruct_h_w_context_type_html"><div class="ttname"><a href="struct_h_w_context_type.html">HWContextType</a></div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__internal_8h_source.html#l00029">hwcontext_internal.h:29</a></div></div>
<div class="ttc" id="ahwcontext_8h_html_acf25724be4b066a51ad86aa9214b0d34a7a74cd2f21d680a11aa8b321ddff1358"><div class="ttname"><a href="hwcontext_8h.html#acf25724be4b066a51ad86aa9214b0d34a7a74cd2f21d680a11aa8b321ddff1358">AV_HWDEVICE_TYPE_QSV</a></div><div class="ttdeci">@ AV_HWDEVICE_TYPE_QSV</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00033">hwcontext.h:33</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_frames_context_html_ac9a7dbd0cbfcabc0b1529cb34cf53b6d"><div class="ttname"><a href="struct_a_v_h_w_frames_context.html#ac9a7dbd0cbfcabc0b1529cb34cf53b6d">AVHWFramesContext::device_ctx</a></div><div class="ttdeci">AVHWDeviceContext * device_ctx</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00149">hwcontext.h:149</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_a32d946005cf34f8fc5c8a3d5a9fb0bf8"><div class="ttname"><a href="hwcontext__qsv_8c.html#a32d946005cf34f8fc5c8a3d5a9fb0bf8">qsv_pool_release_dummy</a></div><div class="ttdeci">static void qsv_pool_release_dummy(void *opaque, uint8_t *data)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00193">hwcontext_qsv.c:193</a></div></div>
<div class="ttc" id="astruct_a_v_frame_html_a1d0f65014a8d1bf78cec8cbed2304992"><div class="ttname"><a href="struct_a_v_frame.html#a1d0f65014a8d1bf78cec8cbed2304992">AVFrame::data</a></div><div class="ttdeci">uint8_t * data[AV_NUM_DATA_POINTERS]</div><div class="ttdef"><b>Definition:</b> <a href="frame_8h_source.html#l00322">frame.h:322</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8h_html_a999b7f33a5bf3f36e9429ea7e770e67e"><div class="ttname"><a href="hwcontext__qsv_8h.html#a999b7f33a5bf3f36e9429ea7e770e67e">AVQSVDeviceContext</a></div><div class="ttdeci">struct AVQSVDeviceContext AVQSVDeviceContext</div></div>
<div class="ttc" id="astruct_a_v_frame_html_aed14fa772ce46881020fd1545c86432c"><div class="ttname"><a href="struct_a_v_frame.html#aed14fa772ce46881020fd1545c86432c">AVFrame::format</a></div><div class="ttdeci">int format</div><div class="ttdef"><b>Definition:</b> <a href="frame_8h_source.html#l00381">frame.h:381</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a9a8e335cf3be472042bc9f0cf80cd4c5a0e08f8a5d0fa21c3e258816a9dcce7c3"><div class="ttname"><a href="pixfmt_8h.html#a9a8e335cf3be472042bc9f0cf80cd4c5a0e08f8a5d0fa21c3e258816a9dcce7c3">AV_PIX_FMT_NONE</a></div><div class="ttdeci">@ AV_PIX_FMT_NONE</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00065">pixfmt.h:65</a></div></div>
<div class="ttc" id="amotion_8c_html_a7c1d654b7b6114d7a0abc8d351dd1bcd"><div class="ttname"><a href="motion_8c.html#a7c1d654b7b6114d7a0abc8d351dd1bcd">dummy</a></div><div class="ttdeci">int dummy</div><div class="ttdef"><b>Definition:</b> <a href="motion_8c_source.html#l00064">motion.c:64</a></div></div>
<div class="ttc" id="astruct_a_v_format_context_html_a8a8bec51da36db65ff864f88a85805d9"><div class="ttname"><a href="struct_a_v_format_context.html#a8a8bec51da36db65ff864f88a85805d9">AVFormatContext::internal</a></div><div class="ttdeci">AVFormatInternal * internal</div><div class="ttdef"><b>Definition:</b> <a href="avformat_8h_source.html#l01688">avformat.h:1688</a></div></div>
<div class="ttc" id="astruct_q_s_v_frames_context_html_a3a8fe7fd15820f30b4d6dc2a655676d9"><div class="ttname"><a href="struct_q_s_v_frames_context.html#a3a8fe7fd15820f30b4d6dc2a655676d9">QSVFramesContext::session_download</a></div><div class="ttdeci">mfxSession session_download</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00066">hwcontext_qsv.c:66</a></div></div>
<div class="ttc" id="astruct_q_s_v_frames_context_html_a614bdada0817c0e51a89dbc1a37f82a1"><div class="ttname"><a href="struct_q_s_v_frames_context.html#a614bdada0817c0e51a89dbc1a37f82a1">QSVFramesContext::session_upload_init</a></div><div class="ttdeci">int session_upload_init</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00069">hwcontext_qsv.c:69</a></div></div>
<div class="ttc" id="agroup__lavu__buffer_html_gaa40ce7d3ede946a89d03323bbd7268c1"><div class="ttname"><a href="group__lavu__buffer.html#gaa40ce7d3ede946a89d03323bbd7268c1">av_buffer_ref</a></div><div class="ttdeci">AVBufferRef * av_buffer_ref(AVBufferRef *buf)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00093">buffer.c:93</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_ae731c529ab1b013ddb059e57e401ca26"><div class="ttname"><a href="hwcontext__qsv_8c.html#ae731c529ab1b013ddb059e57e401ca26">qsv_device_create</a></div><div class="ttdeci">static int qsv_device_create(AVHWDeviceContext *ctx, const char *device, AVDictionary *opts, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l01223">hwcontext_qsv.c:1223</a></div></div>
<div class="ttc" id="astruct_q_s_v_frames_context_html_a02435a88efd4a0f6842bd18351b8cef2"><div class="ttname"><a href="struct_q_s_v_frames_context.html#a02435a88efd4a0f6842bd18351b8cef2">QSVFramesContext::session_upload</a></div><div class="ttdeci">mfxSession session_upload</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00068">hwcontext_qsv.c:68</a></div></div>
<div class="ttc" id="aos2threads_8h_html_af2ed122199f455b63a734ae9b592d286"><div class="ttname"><a href="os2threads_8h.html#af2ed122199f455b63a734ae9b592d286">pthread_cond_wait</a></div><div class="ttdeci">static av_always_inline int pthread_cond_wait(pthread_cond_t *cond, pthread_mutex_t *mutex)</div><div class="ttdef"><b>Definition:</b> <a href="os2threads_8h_source.html#l00192">os2threads.h:192</a></div></div>
<div class="ttc" id="apixfmt_8h_html_a6265531cbe491ec34449e3769e545f1f"><div class="ttname"><a href="pixfmt_8h.html#a6265531cbe491ec34449e3769e545f1f">AV_PIX_FMT_P010</a></div><div class="ttdeci">#define AV_PIX_FMT_P010</div><div class="ttdef"><b>Definition:</b> <a href="pixfmt_8h_source.html#l00448">pixfmt.h:448</a></div></div>
<div class="ttc" id="alibsvtav1_8c_html_a710bce51374aba96ab04912897666c35"><div class="ttname"><a href="libsvtav1_8c.html#a710bce51374aba96ab04912897666c35">desc</a></div><div class="ttdeci">const char * desc</div><div class="ttdef"><b>Definition:</b> <a href="libsvtav1_8c_source.html#l00079">libsvtav1.c:79</a></div></div>
<div class="ttc" id="amem_8h_html"><div class="ttname"><a href="mem_8h.html">mem.h</a></div></div>
<div class="ttc" id="astruct_a_v_q_s_v_device_context_html_abfdc22dbded8e90950b3dfce3f3bd83d"><div class="ttname"><a href="struct_a_v_q_s_v_device_context.html#abfdc22dbded8e90950b3dfce3f3bd83d">AVQSVDeviceContext::session</a></div><div class="ttdeci">mfxSession session</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8h_source.html#l00036">hwcontext_qsv.h:36</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_a949553fe06bc0d90c8081daa3d679fab"><div class="ttname"><a href="hwcontext__qsv_8c.html#a949553fe06bc0d90c8081daa3d679fab">choose_implementation</a></div><div class="ttdeci">static mfxIMPL choose_implementation(const char *device)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l01101">hwcontext_qsv.c:1101</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8h_html_a10ba7f00d7b385769171443708b294b8"><div class="ttname"><a href="hwcontext__qsv_8h.html#a10ba7f00d7b385769171443708b294b8">AVQSVFramesContext</a></div><div class="ttdeci">struct AVQSVFramesContext AVQSVFramesContext</div></div>
<div class="ttc" id="ahwcontext__internal_8h_html"><div class="ttname"><a href="hwcontext__internal_8h.html">hwcontext_internal.h</a></div></div>
<div class="ttc" id="astruct_a_v_q_s_v_frames_context_html_a80ce1c761479c7fe226d1eeed5f131ed"><div class="ttname"><a href="struct_a_v_q_s_v_frames_context.html#a80ce1c761479c7fe226d1eeed5f131ed">AVQSVFramesContext::nb_surfaces</a></div><div class="ttdeci">int nb_surfaces</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8h_source.html#l00044">hwcontext_qsv.h:44</a></div></div>
<div class="ttc" id="amacros_8h_html_acae4ba605b3a7d535b7ac058ffe96892"><div class="ttname"><a href="macros_8h.html#acae4ba605b3a7d535b7ac058ffe96892">FFALIGN</a></div><div class="ttdeci">#define FFALIGN(x, a)</div><div class="ttdef"><b>Definition:</b> <a href="macros_8h_source.html#l00048">macros.h:48</a></div></div>
<div class="ttc" id="atableprint__vlc_8h_html_adba82e1bcd02de510a858fcbedf79ef1"><div class="ttname"><a href="tableprint__vlc_8h.html#adba82e1bcd02de510a858fcbedf79ef1">av_freep</a></div><div class="ttdeci">#define av_freep(p)</div><div class="ttdef"><b>Definition:</b> <a href="tableprint__vlc_8h_source.html#l00035">tableprint_vlc.h:35</a></div></div>
<div class="ttc" id="agroup__lavu__dict_html_ga8d9c2de72b310cef8e6a28c9cd3acbbe"><div class="ttname"><a href="group__lavu__dict.html#ga8d9c2de72b310cef8e6a28c9cd3acbbe">av_dict_set</a></div><div class="ttdeci">int av_dict_set(AVDictionary **pm, const char *key, const char *value, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="dict_8c_source.html#l00070">dict.c:70</a></div></div>
<div class="ttc" id="acbs__av1_8c_html_a67119bce106892b6dade1dc5aa405ac9"><div class="ttname"><a href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a></div><div class="ttdeci">#define flags(name, subs,...)</div><div class="ttdef"><b>Definition:</b> <a href="cbs__av1_8c_source.html#l00560">cbs_av1.c:560</a></div></div>
<div class="ttc" id="ahwcontext_8h_html"><div class="ttname"><a href="hwcontext_8h.html">hwcontext.h</a></div></div>
<div class="ttc" id="atableprint__vlc_8h_html_af38b91523053c244564a94f1ef862c2c"><div class="ttname"><a href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a></div><div class="ttdeci">#define av_log(a,...)</div><div class="ttdef"><b>Definition:</b> <a href="tableprint__vlc_8h_source.html#l00028">tableprint_vlc.h:28</a></div></div>
<div class="ttc" id="astruct_q_s_v_device_context_html_afdb992f13510b59575c4c7ed940b09d4"><div class="ttname"><a href="struct_q_s_v_device_context.html#afdb992f13510b59575c4c7ed940b09d4">QSVDeviceContext::child_pix_fmt</a></div><div class="ttdeci">enum AVPixelFormat child_pix_fmt</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00059">hwcontext_qsv.c:62</a></div></div>
<div class="ttc" id="astruct_q_s_v_frames_context_html_adf1cfd8787eeac2cb76c132f087acbc5"><div class="ttname"><a href="struct_q_s_v_frames_context.html#adf1cfd8787eeac2cb76c132f087acbc5">QSVFramesContext::surfaces_internal</a></div><div class="ttdeci">mfxFrameSurface1 * surfaces_internal</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00076">hwcontext_qsv.c:76</a></div></div>
<div class="ttc" id="aos2threads_8h_html_a90293d12cef762b6df0139309d13fdbf"><div class="ttname"><a href="os2threads_8h.html#a90293d12cef762b6df0139309d13fdbf">pthread_cond_init</a></div><div class="ttdeci">static av_always_inline int pthread_cond_init(pthread_cond_t *cond, const pthread_condattr_t *attr)</div><div class="ttdef"><b>Definition:</b> <a href="os2threads_8h_source.html#l00133">os2threads.h:133</a></div></div>
<div class="ttc" id="astruct_a_v_h_w_frames_context_html_a663a9aceca97aa7b2426c9aba6543e4a"><div class="ttname"><a href="struct_a_v_h_w_frames_context.html#a663a9aceca97aa7b2426c9aba6543e4a">AVHWFramesContext::sw_format</a></div><div class="ttdeci">enum AVPixelFormat sw_format</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext_8h_source.html#l00199">hwcontext.h:222</a></div></div>
<div class="ttc" id="astruct_a_v_frame_html"><div class="ttname"><a href="struct_a_v_frame.html">AVFrame</a></div><div class="ttdef"><b>Definition:</b> <a href="frame_8h_source.html#l00308">frame.h:308</a></div></div>
<div class="ttc" id="astruct_a_v_q_s_v_frames_context_html_aadf9983d5965bd4c2cbe09c25fa2757a"><div class="ttname"><a href="struct_a_v_q_s_v_frames_context.html#aadf9983d5965bd4c2cbe09c25fa2757a">AVQSVFramesContext::frame_type</a></div><div class="ttdeci">int frame_type</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8h_source.html#l00049">hwcontext_qsv.h:49</a></div></div>
<div class="ttc" id="astruct_a_v_d_x_v_a2_frames_context_html_a867fec347dd21aa778948df67cf00450"><div class="ttname"><a href="struct_a_v_d_x_v_a2_frames_context.html#a867fec347dd21aa778948df67cf00450">AVDXVA2FramesContext::nb_surfaces</a></div><div class="ttdeci">int nb_surfaces</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__dxva2_8h_source.html#l00059">hwcontext_dxva2.h:59</a></div></div>
<div class="ttc" id="ahwcontext__qsv_8c_html_a803ad9dc7d68cc443babfd7ba37d4671"><div class="ttname"><a href="hwcontext__qsv_8c.html#a803ad9dc7d68cc443babfd7ba37d4671">qsv_init_pool</a></div><div class="ttdeci">static int qsv_init_pool(AVHWFramesContext *ctx, uint32_t fourcc)</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00351">hwcontext_qsv.c:351</a></div></div>
<div class="ttc" id="astruct_q_s_v_device_context_html_a83bcfd0adba00e9341895299f1afee7c"><div class="ttname"><a href="struct_q_s_v_device_context.html#a83bcfd0adba00e9341895299f1afee7c">QSVDeviceContext::handle</a></div><div class="ttdeci">mfxHDL handle</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__qsv_8c_source.html#l00056">hwcontext_qsv.c:56</a></div></div>
<div class="ttc" id="affprobe_8c_html_a3bd1ad5edf8fc93f783af77e8cd6ee9a"><div class="ttname"><a href="ffprobe_8c.html#a3bd1ad5edf8fc93f783af77e8cd6ee9a">pthread_mutex_lock</a></div><div class="ttdeci">#define pthread_mutex_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="ffprobe_8c_source.html#l00062">ffprobe.c:62</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
