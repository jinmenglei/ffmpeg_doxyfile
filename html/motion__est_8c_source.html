<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: E:/github/ffmpeg/libavcodec/motion_est.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_737c44b861ba7ee498141742fb455fa8.html">ffmpeg</a></li><li class="navelem"><a class="el" href="dir_56ad1dd09ca1ce410b5ba2c46dd71e4b.html">libavcodec</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">motion_est.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="motion__est_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Motion estimation</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * Copyright (c) 2000,2001 Fabrice Bellard</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * Copyright (c) 2002-2004 Michael Niedermayer</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * new motion estimation (X1/EPZS) by Michael Niedermayer &lt;michaelni@gmx.at&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * This file is part of FFmpeg.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * FFmpeg is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * FFmpeg is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> * You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> * License along with FFmpeg; if not, write to the Free Software</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="limits_8h.html">limits.h</a>&gt;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="avcodec_8h.html">avcodec.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="libavutil_2internal_8h.html">internal.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="x86_2mathops_8h.html">mathops.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="motion__est_8h.html">motion_est.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mpegutils_8h.html">mpegutils.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mpegvideo_8h.html">mpegvideo.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">   41</a></span>&#160;<span class="preprocessor">#define P_LEFT P[1]</span></div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">   42</a></span>&#160;<span class="preprocessor">#define P_TOP P[2]</span></div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">   43</a></span>&#160;<span class="preprocessor">#define P_TOPRIGHT P[3]</span></div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="motion__est_8c.html#a68d7a1b5a5e7aa7cb4a42f893b3cfc57">   44</a></span>&#160;<span class="preprocessor">#define P_MEDIAN P[4]</span></div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="motion__est_8c.html#a51273d274807fce7296dc30d6e79f4c1">   45</a></span>&#160;<span class="preprocessor">#define P_MV1 P[9]</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="motion__est_8c.html#abfcb2c97c1457c7be1ecfc61c26751a9">   47</a></span>&#160;<span class="preprocessor">#define ME_MAP_SHIFT 3</span></div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="motion__est_8c.html#a4f220553feb940f2d98d8ce2b4d1227d">   48</a></span>&#160;<span class="preprocessor">#define ME_MAP_MV_BITS 11</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="motion__est_8c.html#a922289dee948023bcdefbefa1c10bde7">sad_hpel_motion_search</a>(<a class="code" href="struct_mpeg_enc_context.html">MpegEncContext</a> * <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>,</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                                  <span class="keywordtype">int</span> *mx_ptr, <span class="keywordtype">int</span> *my_ptr, <span class="keywordtype">int</span> dmin,</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                                  <span class="keywordtype">int</span> src_index, <span class="keywordtype">int</span> ref_index,</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                                  <span class="keywordtype">int</span> <a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>, <span class="keywordtype">int</span> <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="motion__est_8c.html#a9e8729707e5022a345cc130841eab01d">   55</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <a class="code" href="motion__est_8c.html#a9e8729707e5022a345cc130841eab01d">update_map_generation</a>(<a class="code" href="struct_motion_est_context.html">MotionEstContext</a> *<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>)</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;{</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;map_generation+= 1&lt;&lt;(<a class="code" href="motion__est_8c.html#a4f220553feb940f2d98d8ce2b4d1227d">ME_MAP_MV_BITS</a>*2);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;map_generation==0){</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;map_generation= 1&lt;&lt;(<a class="code" href="motion__est_8c.html#a4f220553feb940f2d98d8ce2b4d1227d">ME_MAP_MV_BITS</a>*2);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        memset(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;map, 0, <span class="keyword">sizeof</span>(uint32_t)*<a class="code" href="motion__est_8h.html#a503dd0cae8a23f8c6b5767888250a72f">ME_MAP_SIZE</a>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;map_generation;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;}</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">/* shape adaptive search stuff */</span></div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="struct_minima.html">   66</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct_minima.html">Minima</a>{</div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="struct_minima.html#ac1d307fee8b7d782734be2896e39e000">   67</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="struct_minima.html#ac1d307fee8b7d782734be2896e39e000">height</a>;</div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="struct_minima.html#ac5910eda3e4332d567f351f42bde117a">   68</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="struct_minima.html#aef76135c12e75fcf0aba085887cf6352">x</a>, <a class="code" href="struct_minima.html#ac5910eda3e4332d567f351f42bde117a">y</a>;</div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="struct_minima.html#a78fb665760d0fa71774e3354e7432db2">   69</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="struct_minima.html#a78fb665760d0fa71774e3354e7432db2">checked</a>;</div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="motion__est_8c.html#a49af71f3ffa9fa3c952ac93246ddbb27">   70</a></span>&#160;}<a class="code" href="motion__est_8c.html#a49af71f3ffa9fa3c952ac93246ddbb27">Minima</a>;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="motion__est_8c.html#a0db0b24114e1621157fcf58f159f7199">   72</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="motion__est_8c.html#a0db0b24114e1621157fcf58f159f7199">minima_cmp</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="undefined_8txt.html#ad99f336d4c117c453fef82993434eb4d">a</a>, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="input_8c.html#ad6cdb6a14abe3eab42eaaadc93409aec">b</a>){</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keyword">const</span> <a class="code" href="struct_minima.html">Minima</a> *da = (<span class="keyword">const</span> <a class="code" href="struct_minima.html">Minima</a> *) <a class="code" href="undefined_8txt.html#ad99f336d4c117c453fef82993434eb4d">a</a>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keyword">const</span> <a class="code" href="struct_minima.html">Minima</a> *db = (<span class="keyword">const</span> <a class="code" href="struct_minima.html">Minima</a> *) <a class="code" href="input_8c.html#ad6cdb6a14abe3eab42eaaadc93409aec">b</a>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">return</span> da-&gt;<a class="code" href="struct_minima.html#ac1d307fee8b7d782734be2896e39e000">height</a> - db-&gt;<a class="code" href="struct_minima.html#ac1d307fee8b7d782734be2896e39e000">height</a>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;}</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="motion__est_8c.html#aa24c5a6ce7cbb044271633d20a7b7a36">   79</a></span>&#160;<span class="preprocessor">#define FLAG_QPEL   1 //must be 1</span></div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="motion__est_8c.html#a40a1fad0d5f30fc21b6b4ee474b66b37">   80</a></span>&#160;<span class="preprocessor">#define FLAG_CHROMA 2</span></div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="motion__est_8c.html#a8d487dcbee8d1f4d01795a2c5abb43bd">   81</a></span>&#160;<span class="preprocessor">#define FLAG_DIRECT 4</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="motion__est_8c.html#a4fb3984ec1e5fa4ef18d3aec973394f6">   83</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="motion__est_8c.html#a4fb3984ec1e5fa4ef18d3aec973394f6">init_ref</a>(<a class="code" href="struct_motion_est_context.html">MotionEstContext</a> *<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>, <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *<a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>[3], <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *<a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>[3], <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *ref2[3], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> ref_index){</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="writing__filters_8txt.html#ae1df9c886af8e844bb8849d403b76663">offset</a>[3]= {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;          y*<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;  <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a> + x,</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        ((y*<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;uvstride + x)&gt;&gt;1),</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        ((y*<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;uvstride + x)&gt;&gt;1),</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    };</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;3; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++){</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;src[0][<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>]= <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a> [<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>] + <a class="code" href="writing__filters_8txt.html#ae1df9c886af8e844bb8849d403b76663">offset</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ref[0][<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>]= <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a> [<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>] + <a class="code" href="writing__filters_8txt.html#ae1df9c886af8e844bb8849d403b76663">offset</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">if</span>(ref_index){</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;3; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++){</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ref[ref_index][<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>]= ref2[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>] + <a class="code" href="writing__filters_8txt.html#ae1df9c886af8e844bb8849d403b76663">offset</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        }</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;}</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="motion__est_8c.html#a5eb44f71317870c609c153e9d0960b16">  101</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="motion__est_8c.html#a5eb44f71317870c609c153e9d0960b16">get_flags</a>(<a class="code" href="struct_motion_est_context.html">MotionEstContext</a> *<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>, <span class="keywordtype">int</span> <a class="code" href="libavfilter_2af__afir_8c.html#a2935ad4574b6b85a524d227a44e8f171">direct</a>, <span class="keywordtype">int</span> <a class="code" href="vf__waveform_8c.html#a155491a071a66a7795f49f3a5e079fac">chroma</a>){</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">return</span>   ((<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;flags&amp;<a class="code" href="group__lavc__core.html#ga0e51f9240c85bc00f9dd684f020e2150">AV_CODEC_FLAG_QPEL</a>) ? <a class="code" href="motion__est_8c.html#aa24c5a6ce7cbb044271633d20a7b7a36">FLAG_QPEL</a> : 0)</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;           + (<a class="code" href="libavfilter_2af__afir_8c.html#a2935ad4574b6b85a524d227a44e8f171">direct</a> ? <a class="code" href="motion__est_8c.html#a8d487dcbee8d1f4d01795a2c5abb43bd">FLAG_DIRECT</a> : 0)</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;           + (<a class="code" href="vf__waveform_8c.html#a155491a071a66a7795f49f3a5e079fac">chroma</a> ? <a class="code" href="motion__est_8c.html#a40a1fad0d5f30fc21b6b4ee474b66b37">FLAG_CHROMA</a> : 0);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;}</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="motion__est_8c.html#a12d74a50191081fc93ef9b40f9b736ea">  107</a></span>&#160;<span class="keyword">static</span> <a class="code" href="attributes_8h.html#a28f50f4c125959216885f01d56dbe866">av_always_inline</a> <span class="keywordtype">int</span> <a class="code" href="motion__est_8c.html#a12d74a50191081fc93ef9b40f9b736ea">cmp_direct_inline</a>(<a class="code" href="struct_mpeg_enc_context.html">MpegEncContext</a> *<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> x, <span class="keyword">const</span> <span class="keywordtype">int</span> y, <span class="keyword">const</span> <span class="keywordtype">int</span> subx, <span class="keyword">const</span> <span class="keywordtype">int</span> suby,</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>, <span class="keywordtype">int</span> ref_index, <span class="keywordtype">int</span> src_index,</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                      <a class="code" href="me__cmp_8h.html#aaaf0538a95053ebc8b9662cc61b7191f">me_cmp_func</a> <a class="code" href="vf__palettegen_8c.html#ae342d1a8ad4d2ea56462fc096983664e">cmp_func</a>, <a class="code" href="me__cmp_8h.html#aaaf0538a95053ebc8b9662cc61b7191f">me_cmp_func</a> chroma_cmp_func, <span class="keywordtype">int</span> qpel){</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <a class="code" href="struct_motion_est_context.html">MotionEstContext</a> * <span class="keyword">const</span> <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>= &amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;me;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;stride;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> hx= subx + (x&lt;&lt;(1+qpel));</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> hy= suby + (y&lt;&lt;(1+qpel));</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> * <span class="keyword">const</span> * <span class="keyword">const</span> <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ref[ref_index];</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> * <span class="keyword">const</span> * <span class="keyword">const</span> <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;src[src_index];</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordtype">int</span> d;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">//FIXME check chroma 4mv, (no crashes ...)</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <a class="code" href="avassert_8h.html#a2764bf422e4df5bf3aac652f21fe780a">av_assert2</a>(x &gt;= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmin &amp;&amp; hx &lt;= c-&gt;xmax&lt;&lt;(qpel+1) &amp;&amp; y &gt;= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymin &amp;&amp; hy &lt;= c-&gt;ymax&lt;&lt;(qpel+1));</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordflow">if</span>(x &gt;= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmin &amp;&amp; hx &lt;= c-&gt;xmax&lt;&lt;(qpel+1) &amp;&amp; y &gt;= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymin &amp;&amp; hy &lt;= c-&gt;ymax&lt;&lt;(qpel+1)){</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> time_pp= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;pp_time;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> time_pb= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;pb_time;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="lzw_8c.html#a450ea4ae52aeb4ca6e2fabf02c695153">mask</a>= 2*qpel+1;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mv_type==<a class="code" href="mpegvideo_8h.html#a98f9328b4f99d0b6a3974cf441633edf">MV_TYPE_8X8</a>){</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                <span class="keywordtype">int</span> <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                <span class="keywordflow">for</span>(<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;4; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++){</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                    <span class="keywordtype">int</span> fx = <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;direct_basis_mv[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][0] + hx;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                    <span class="keywordtype">int</span> fy = <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;direct_basis_mv[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][1] + hy;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                    <span class="keywordtype">int</span> bx = hx ? fx - <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;co_located_mv[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][0] : <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;co_located_mv[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][0]*(time_pb - time_pp)/time_pp + ((<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &amp;1)&lt;&lt;(qpel+4));</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                    <span class="keywordtype">int</span> by = hy ? fy - <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;co_located_mv[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][1] : <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;co_located_mv[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][1]*(time_pb - time_pp)/time_pp + ((<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>&gt;&gt;1)&lt;&lt;(qpel+4));</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                    <span class="keywordtype">int</span> fxy= (fx&amp;<a class="code" href="lzw_8c.html#a450ea4ae52aeb4ca6e2fabf02c695153">mask</a>) + ((fy&amp;<a class="code" href="lzw_8c.html#a450ea4ae52aeb4ca6e2fabf02c695153">mask</a>)&lt;&lt;(qpel+1));</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                    <span class="keywordtype">int</span> bxy= (bx&amp;<a class="code" href="lzw_8c.html#a450ea4ae52aeb4ca6e2fabf02c695153">mask</a>) + ((by&amp;<a class="code" href="lzw_8c.html#a450ea4ae52aeb4ca6e2fabf02c695153">mask</a>)&lt;&lt;(qpel+1));</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                    <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *dst= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;temp + 8*(<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>&amp;1) + 8*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>*(<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>&gt;&gt;1);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                    <span class="keywordflow">if</span>(qpel){</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;qpel_put[1][fxy](dst, <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>[0] + (fx&gt;&gt;2) + (fy&gt;&gt;2)*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;qpel_avg[1][bxy](dst, <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>[8] + (bx&gt;&gt;2) + (by&gt;&gt;2)*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;hpel_put[1][fxy](dst, <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>[0] + (fx&gt;&gt;1) + (fy&gt;&gt;1)*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, 8);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;hpel_avg[1][bxy](dst, <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>[8] + (bx&gt;&gt;1) + (by&gt;&gt;1)*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, 8);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                    }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                <span class="keywordtype">int</span> fx = <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;direct_basis_mv[0][0] + hx;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                <span class="keywordtype">int</span> fy = <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;direct_basis_mv[0][1] + hy;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                <span class="keywordtype">int</span> bx = hx ? fx - <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;co_located_mv[0][0] : (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;co_located_mv[0][0]*(time_pb - time_pp)/time_pp);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                <span class="keywordtype">int</span> by = hy ? fy - <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;co_located_mv[0][1] : (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;co_located_mv[0][1]*(time_pb - time_pp)/time_pp);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                <span class="keywordtype">int</span> fxy= (fx&amp;<a class="code" href="lzw_8c.html#a450ea4ae52aeb4ca6e2fabf02c695153">mask</a>) + ((fy&amp;<a class="code" href="lzw_8c.html#a450ea4ae52aeb4ca6e2fabf02c695153">mask</a>)&lt;&lt;(qpel+1));</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                <span class="keywordtype">int</span> bxy= (bx&amp;<a class="code" href="lzw_8c.html#a450ea4ae52aeb4ca6e2fabf02c695153">mask</a>) + ((by&amp;<a class="code" href="lzw_8c.html#a450ea4ae52aeb4ca6e2fabf02c695153">mask</a>)&lt;&lt;(qpel+1));</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                <span class="keywordflow">if</span>(qpel){</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;qpel_put[1][fxy](<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;temp               , <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>[0] + (fx&gt;&gt;2) + (fy&gt;&gt;2)*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>               , <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;qpel_put[1][fxy](<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;temp + 8           , <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>[0] + (fx&gt;&gt;2) + (fy&gt;&gt;2)*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a> + 8           , <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;qpel_put[1][fxy](<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;temp     + 8*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>[0] + (fx&gt;&gt;2) + (fy&gt;&gt;2)*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>     + 8*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;qpel_put[1][fxy](<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;temp + 8 + 8*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>[0] + (fx&gt;&gt;2) + (fy&gt;&gt;2)*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a> + 8 + 8*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;qpel_avg[1][bxy](<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;temp               , <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>[8] + (bx&gt;&gt;2) + (by&gt;&gt;2)*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>               , <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;qpel_avg[1][bxy](<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;temp + 8           , <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>[8] + (bx&gt;&gt;2) + (by&gt;&gt;2)*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a> + 8           , <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;qpel_avg[1][bxy](<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;temp     + 8*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>[8] + (bx&gt;&gt;2) + (by&gt;&gt;2)*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>     + 8*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;qpel_avg[1][bxy](<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;temp + 8 + 8*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>[8] + (bx&gt;&gt;2) + (by&gt;&gt;2)*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a> + 8 + 8*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                    <a class="code" href="avassert_8h.html#a2764bf422e4df5bf3aac652f21fe780a">av_assert2</a>((fx&gt;&gt;1) + 16*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_x &gt;= -16);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                    <a class="code" href="avassert_8h.html#a2764bf422e4df5bf3aac652f21fe780a">av_assert2</a>((fy&gt;&gt;1) + 16*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_y &gt;= -16);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                    <a class="code" href="avassert_8h.html#a2764bf422e4df5bf3aac652f21fe780a">av_assert2</a>((fx&gt;&gt;1) + 16*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_x &lt;= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;width);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                    <a class="code" href="avassert_8h.html#a2764bf422e4df5bf3aac652f21fe780a">av_assert2</a>((fy&gt;&gt;1) + 16*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_y &lt;= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;height);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                    <a class="code" href="avassert_8h.html#a2764bf422e4df5bf3aac652f21fe780a">av_assert2</a>((bx&gt;&gt;1) + 16*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_x &gt;= -16);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                    <a class="code" href="avassert_8h.html#a2764bf422e4df5bf3aac652f21fe780a">av_assert2</a>((by&gt;&gt;1) + 16*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_y &gt;= -16);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                    <a class="code" href="avassert_8h.html#a2764bf422e4df5bf3aac652f21fe780a">av_assert2</a>((bx&gt;&gt;1) + 16*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_x &lt;= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;width);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                    <a class="code" href="avassert_8h.html#a2764bf422e4df5bf3aac652f21fe780a">av_assert2</a>((by&gt;&gt;1) + 16*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_y &lt;= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;height);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;hpel_put[0][fxy](<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;temp, <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>[0] + (fx&gt;&gt;1) + (fy&gt;&gt;1)*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, 16);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;hpel_avg[0][bxy](<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;temp, <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>[8] + (bx&gt;&gt;1) + (by&gt;&gt;1)*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, 16);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            d = <a class="code" href="vf__palettegen_8c.html#ae342d1a8ad4d2ea56462fc096983664e">cmp_func</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;temp, <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>[0], <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, 16);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        }<span class="keywordflow">else</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            d= 256*256*256*32;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordflow">return</span> d;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;}</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="motion__est_8c.html#a147b555fcbdd1e577cb0c0701dbfc9cb">  179</a></span>&#160;<span class="keyword">static</span> <a class="code" href="attributes_8h.html#a28f50f4c125959216885f01d56dbe866">av_always_inline</a> <span class="keywordtype">int</span> <a class="code" href="motion__est_8c.html#a147b555fcbdd1e577cb0c0701dbfc9cb">cmp_inline</a>(<a class="code" href="struct_mpeg_enc_context.html">MpegEncContext</a> *<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> x, <span class="keyword">const</span> <span class="keywordtype">int</span> y, <span class="keyword">const</span> <span class="keywordtype">int</span> subx, <span class="keyword">const</span> <span class="keywordtype">int</span> suby,</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>, <span class="keywordtype">int</span> ref_index, <span class="keywordtype">int</span> src_index,</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                      <a class="code" href="me__cmp_8h.html#aaaf0538a95053ebc8b9662cc61b7191f">me_cmp_func</a> <a class="code" href="vf__palettegen_8c.html#ae342d1a8ad4d2ea56462fc096983664e">cmp_func</a>, <a class="code" href="me__cmp_8h.html#aaaf0538a95053ebc8b9662cc61b7191f">me_cmp_func</a> chroma_cmp_func, <span class="keywordtype">int</span> qpel, <span class="keywordtype">int</span> <a class="code" href="vf__waveform_8c.html#a155491a071a66a7795f49f3a5e079fac">chroma</a>){</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <a class="code" href="struct_motion_est_context.html">MotionEstContext</a> * <span class="keyword">const</span> <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>= &amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;me;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;stride;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> uvstride= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;uvstride;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> dxy= subx + (suby&lt;&lt;(1+qpel)); <span class="comment">//FIXME log2_subpel?</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> hx= subx + x*(1&lt;&lt;(1+qpel));</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> hy= suby + y*(1&lt;&lt;(1+qpel));</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> * <span class="keyword">const</span> * <span class="keyword">const</span> <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ref[ref_index];</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> * <span class="keyword">const</span> * <span class="keyword">const</span> <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;src[src_index];</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordtype">int</span> d;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">//FIXME check chroma 4mv, (no crashes ...)</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordtype">int</span> uvdxy;              <span class="comment">/* no, it might not be used uninitialized */</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="keywordflow">if</span>(dxy){</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <span class="keywordflow">if</span>(qpel){</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a> &lt;&lt; <a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a> == 16) {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;qpel_put[<a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>][dxy](<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;temp, <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>[0] + x + y*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>); <span class="comment">//FIXME prototype (add h)</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a> == 0 &amp;&amp; <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a> == 8) {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;qpel_put[1][dxy](<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;temp    , <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>[0] + x + y*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>    , <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;qpel_put[1][dxy](<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;temp + 8, <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>[0] + x + y*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a> + 8, <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                    <a class="code" href="avassert_8h.html#a2764bf422e4df5bf3aac652f21fe780a">av_assert2</a>(0);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="vf__waveform_8c.html#a155491a071a66a7795f49f3a5e079fac">chroma</a>){</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                    <span class="keywordtype">int</span> cx= hx/2;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                    <span class="keywordtype">int</span> cy= hy/2;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                    cx= (cx&gt;&gt;1)|(cx&amp;1);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                    cy= (cy&gt;&gt;1)|(cy&amp;1);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                    uvdxy= (cx&amp;1) + 2*(cy&amp;1);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                    <span class="comment">// FIXME x/y wrong, but MPEG-4 qpel is sick anyway, we should drop as much of it as possible in favor for H.264</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;hpel_put[<a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>][dxy](<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;temp, <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>[0] + x + y*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="vf__waveform_8c.html#a155491a071a66a7795f49f3a5e079fac">chroma</a>)</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                    uvdxy= dxy | (x&amp;1) | (2*(y&amp;1));</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            d = <a class="code" href="vf__palettegen_8c.html#ae342d1a8ad4d2ea56462fc096983664e">cmp_func</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;temp, <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>[0], <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            d = <a class="code" href="vf__palettegen_8c.html#ae342d1a8ad4d2ea56462fc096983664e">cmp_func</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>[0], <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>[0] + x + y*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="vf__waveform_8c.html#a155491a071a66a7795f49f3a5e079fac">chroma</a>)</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                uvdxy= (x&amp;1) + 2*(y&amp;1);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="vf__waveform_8c.html#a155491a071a66a7795f49f3a5e079fac">chroma</a>){</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> * <span class="keyword">const</span> uvtemp= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;temp + 16*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;hpel_put[<a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>+1][uvdxy](uvtemp  , <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>[1] + (x&gt;&gt;1) + (y&gt;&gt;1)*uvstride, uvstride, <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>&gt;&gt;1);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;hpel_put[<a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>+1][uvdxy](uvtemp+8, <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>[2] + (x&gt;&gt;1) + (y&gt;&gt;1)*uvstride, uvstride, <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>&gt;&gt;1);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            d += chroma_cmp_func(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, uvtemp  , <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>[1], uvstride, <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>&gt;&gt;1);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            d += chroma_cmp_func(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, uvtemp+8, <a class="code" href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a>[2], uvstride, <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>&gt;&gt;1);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">return</span> d;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;}</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="motion__est_8c.html#aad480cc0efda051e616451ee270b6343">  231</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="motion__est_8c.html#aad480cc0efda051e616451ee270b6343">cmp_simple</a>(<a class="code" href="struct_mpeg_enc_context.html">MpegEncContext</a> *<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> x, <span class="keyword">const</span> <span class="keywordtype">int</span> y,</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                      <span class="keywordtype">int</span> ref_index, <span class="keywordtype">int</span> src_index,</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                      <a class="code" href="me__cmp_8h.html#aaaf0538a95053ebc8b9662cc61b7191f">me_cmp_func</a> <a class="code" href="vf__palettegen_8c.html#ae342d1a8ad4d2ea56462fc096983664e">cmp_func</a>, <a class="code" href="me__cmp_8h.html#aaaf0538a95053ebc8b9662cc61b7191f">me_cmp_func</a> chroma_cmp_func){</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="motion__est_8c.html#a147b555fcbdd1e577cb0c0701dbfc9cb">cmp_inline</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>,x,y,0,0,0,16,ref_index,src_index, <a class="code" href="vf__palettegen_8c.html#ae342d1a8ad4d2ea56462fc096983664e">cmp_func</a>, chroma_cmp_func, 0, 0);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;}</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno"><a class="line" href="motion__est_8c.html#a5712491315de45680cf9869c5fc0ce7a">  237</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="motion__est_8c.html#a5712491315de45680cf9869c5fc0ce7a">cmp_fpel_internal</a>(<a class="code" href="struct_mpeg_enc_context.html">MpegEncContext</a> *<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> x, <span class="keyword">const</span> <span class="keywordtype">int</span> y,</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>, <span class="keywordtype">int</span> ref_index, <span class="keywordtype">int</span> src_index,</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                      <a class="code" href="me__cmp_8h.html#aaaf0538a95053ebc8b9662cc61b7191f">me_cmp_func</a> <a class="code" href="vf__palettegen_8c.html#ae342d1a8ad4d2ea56462fc096983664e">cmp_func</a>, <a class="code" href="me__cmp_8h.html#aaaf0538a95053ebc8b9662cc61b7191f">me_cmp_func</a> chroma_cmp_func, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>){</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>&amp;<a class="code" href="motion__est_8c.html#a8d487dcbee8d1f4d01795a2c5abb43bd">FLAG_DIRECT</a>){</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="motion__est_8c.html#a12d74a50191081fc93ef9b40f9b736ea">cmp_direct_inline</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>,x,y,0,0,<a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>,<a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>,ref_index,src_index, <a class="code" href="vf__palettegen_8c.html#ae342d1a8ad4d2ea56462fc096983664e">cmp_func</a>, chroma_cmp_func, <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>&amp;<a class="code" href="motion__est_8c.html#aa24c5a6ce7cbb044271633d20a7b7a36">FLAG_QPEL</a>);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="motion__est_8c.html#a147b555fcbdd1e577cb0c0701dbfc9cb">cmp_inline</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>,x,y,0,0,<a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>,<a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>,ref_index,src_index, <a class="code" href="vf__palettegen_8c.html#ae342d1a8ad4d2ea56462fc096983664e">cmp_func</a>, chroma_cmp_func, 0, <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>&amp;<a class="code" href="motion__est_8c.html#a40a1fad0d5f30fc21b6b4ee474b66b37">FLAG_CHROMA</a>);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;}</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno"><a class="line" href="motion__est_8c.html#a5b7a747060090a1ea17649555ef960f4">  247</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="motion__est_8c.html#a5b7a747060090a1ea17649555ef960f4">cmp_internal</a>(<a class="code" href="struct_mpeg_enc_context.html">MpegEncContext</a> *<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> x, <span class="keyword">const</span> <span class="keywordtype">int</span> y, <span class="keyword">const</span> <span class="keywordtype">int</span> subx, <span class="keyword">const</span> <span class="keywordtype">int</span> suby,</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>, <span class="keywordtype">int</span> ref_index, <span class="keywordtype">int</span> src_index,</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                      <a class="code" href="me__cmp_8h.html#aaaf0538a95053ebc8b9662cc61b7191f">me_cmp_func</a> <a class="code" href="vf__palettegen_8c.html#ae342d1a8ad4d2ea56462fc096983664e">cmp_func</a>, <a class="code" href="me__cmp_8h.html#aaaf0538a95053ebc8b9662cc61b7191f">me_cmp_func</a> chroma_cmp_func, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>){</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>&amp;<a class="code" href="motion__est_8c.html#a8d487dcbee8d1f4d01795a2c5abb43bd">FLAG_DIRECT</a>){</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="motion__est_8c.html#a12d74a50191081fc93ef9b40f9b736ea">cmp_direct_inline</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>,x,y,subx,suby,<a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>,<a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>,ref_index,src_index, <a class="code" href="vf__palettegen_8c.html#ae342d1a8ad4d2ea56462fc096983664e">cmp_func</a>, chroma_cmp_func, <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>&amp;<a class="code" href="motion__est_8c.html#aa24c5a6ce7cbb044271633d20a7b7a36">FLAG_QPEL</a>);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="motion__est_8c.html#a147b555fcbdd1e577cb0c0701dbfc9cb">cmp_inline</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>,x,y,subx,suby,<a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>,<a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>,ref_index,src_index, <a class="code" href="vf__palettegen_8c.html#ae342d1a8ad4d2ea56462fc096983664e">cmp_func</a>, chroma_cmp_func, <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>&amp;<a class="code" href="motion__est_8c.html#aa24c5a6ce7cbb044271633d20a7b7a36">FLAG_QPEL</a>, <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>&amp;<a class="code" href="motion__est_8c.html#a40a1fad0d5f30fc21b6b4ee474b66b37">FLAG_CHROMA</a>);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;}</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno"><a class="line" href="motion__est_8c.html#aa8dbd96e837401561874816377fb71a1">  260</a></span>&#160;<span class="keyword">static</span> <a class="code" href="attributes_8h.html#a28f50f4c125959216885f01d56dbe866">av_always_inline</a> <span class="keywordtype">int</span> <a class="code" href="motion__est_8c.html#aa8dbd96e837401561874816377fb71a1">cmp</a>(<a class="code" href="struct_mpeg_enc_context.html">MpegEncContext</a> *<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> x, <span class="keyword">const</span> <span class="keywordtype">int</span> y, <span class="keyword">const</span> <span class="keywordtype">int</span> subx, <span class="keyword">const</span> <span class="keywordtype">int</span> suby,</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>, <span class="keywordtype">int</span> ref_index, <span class="keywordtype">int</span> src_index,</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                      <a class="code" href="me__cmp_8h.html#aaaf0538a95053ebc8b9662cc61b7191f">me_cmp_func</a> <a class="code" href="vf__palettegen_8c.html#ae342d1a8ad4d2ea56462fc096983664e">cmp_func</a>, <a class="code" href="me__cmp_8h.html#aaaf0538a95053ebc8b9662cc61b7191f">me_cmp_func</a> chroma_cmp_func, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>){</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="attributes_8h.html#a438e7ed66a9e258ea0d1d1ff0c91e608">av_builtin_constant_p</a>(<a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>) &amp;&amp; <a class="code" href="attributes_8h.html#a438e7ed66a9e258ea0d1d1ff0c91e608">av_builtin_constant_p</a>(<a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>) &amp;&amp; <a class="code" href="attributes_8h.html#a438e7ed66a9e258ea0d1d1ff0c91e608">av_builtin_constant_p</a>(<a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>)</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;       &amp;&amp; <a class="code" href="attributes_8h.html#a438e7ed66a9e258ea0d1d1ff0c91e608">av_builtin_constant_p</a>(subx) &amp;&amp; <a class="code" href="attributes_8h.html#a438e7ed66a9e258ea0d1d1ff0c91e608">av_builtin_constant_p</a>(suby)</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;       &amp;&amp; <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>==0 &amp;&amp; <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>==16 &amp;&amp; <a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>==0 &amp;&amp; subx==0 &amp;&amp; suby==0){</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="motion__est_8c.html#aad480cc0efda051e616451ee270b6343">cmp_simple</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>,x,y,ref_index,src_index, <a class="code" href="vf__palettegen_8c.html#ae342d1a8ad4d2ea56462fc096983664e">cmp_func</a>, chroma_cmp_func);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="attributes_8h.html#a438e7ed66a9e258ea0d1d1ff0c91e608">av_builtin_constant_p</a>(subx) &amp;&amp; <a class="code" href="attributes_8h.html#a438e7ed66a9e258ea0d1d1ff0c91e608">av_builtin_constant_p</a>(suby)</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;       &amp;&amp; subx==0 &amp;&amp; suby==0){</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="motion__est_8c.html#a5712491315de45680cf9869c5fc0ce7a">cmp_fpel_internal</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>,x,y,<a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>,<a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>,ref_index,src_index, <a class="code" href="vf__palettegen_8c.html#ae342d1a8ad4d2ea56462fc096983664e">cmp_func</a>, chroma_cmp_func,<a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="motion__est_8c.html#a5b7a747060090a1ea17649555ef960f4">cmp_internal</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>,x,y,subx,suby,<a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>,<a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>,ref_index,src_index, <a class="code" href="vf__palettegen_8c.html#ae342d1a8ad4d2ea56462fc096983664e">cmp_func</a>, chroma_cmp_func, <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;}</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno"><a class="line" href="motion__est_8c.html#a7342164785de716c131fd37000235a42">  275</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="motion__est_8c.html#a7342164785de716c131fd37000235a42">cmp_hpel</a>(<a class="code" href="struct_mpeg_enc_context.html">MpegEncContext</a> *<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> x, <span class="keyword">const</span> <span class="keywordtype">int</span> y, <span class="keyword">const</span> <span class="keywordtype">int</span> subx, <span class="keyword">const</span> <span class="keywordtype">int</span> suby,</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>, <span class="keywordtype">int</span> ref_index, <span class="keywordtype">int</span> src_index,</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                      <a class="code" href="me__cmp_8h.html#aaaf0538a95053ebc8b9662cc61b7191f">me_cmp_func</a> <a class="code" href="vf__palettegen_8c.html#ae342d1a8ad4d2ea56462fc096983664e">cmp_func</a>, <a class="code" href="me__cmp_8h.html#aaaf0538a95053ebc8b9662cc61b7191f">me_cmp_func</a> chroma_cmp_func, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>){</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>&amp;<a class="code" href="motion__est_8c.html#a8d487dcbee8d1f4d01795a2c5abb43bd">FLAG_DIRECT</a>){</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="motion__est_8c.html#a12d74a50191081fc93ef9b40f9b736ea">cmp_direct_inline</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>,x,y,subx,suby,<a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>,<a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>,ref_index,src_index, <a class="code" href="vf__palettegen_8c.html#ae342d1a8ad4d2ea56462fc096983664e">cmp_func</a>, chroma_cmp_func, 0);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="motion__est_8c.html#a147b555fcbdd1e577cb0c0701dbfc9cb">cmp_inline</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>,x,y,subx,suby,<a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>,<a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>,ref_index,src_index, <a class="code" href="vf__palettegen_8c.html#ae342d1a8ad4d2ea56462fc096983664e">cmp_func</a>, chroma_cmp_func, 0, <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>&amp;<a class="code" href="motion__est_8c.html#a40a1fad0d5f30fc21b6b4ee474b66b37">FLAG_CHROMA</a>);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;}</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno"><a class="line" href="motion__est_8c.html#a9c7af2fe6dd8e68212dcb087534bfac2">  285</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="motion__est_8c.html#a9c7af2fe6dd8e68212dcb087534bfac2">cmp_qpel</a>(<a class="code" href="struct_mpeg_enc_context.html">MpegEncContext</a> *<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> x, <span class="keyword">const</span> <span class="keywordtype">int</span> y, <span class="keyword">const</span> <span class="keywordtype">int</span> subx, <span class="keyword">const</span> <span class="keywordtype">int</span> suby,</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>, <span class="keywordtype">int</span> ref_index, <span class="keywordtype">int</span> src_index,</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                      <a class="code" href="me__cmp_8h.html#aaaf0538a95053ebc8b9662cc61b7191f">me_cmp_func</a> <a class="code" href="vf__palettegen_8c.html#ae342d1a8ad4d2ea56462fc096983664e">cmp_func</a>, <a class="code" href="me__cmp_8h.html#aaaf0538a95053ebc8b9662cc61b7191f">me_cmp_func</a> chroma_cmp_func, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>){</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>&amp;<a class="code" href="motion__est_8c.html#a8d487dcbee8d1f4d01795a2c5abb43bd">FLAG_DIRECT</a>){</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="motion__est_8c.html#a12d74a50191081fc93ef9b40f9b736ea">cmp_direct_inline</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>,x,y,subx,suby,<a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>,<a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>,ref_index,src_index, <a class="code" href="vf__palettegen_8c.html#ae342d1a8ad4d2ea56462fc096983664e">cmp_func</a>, chroma_cmp_func, 1);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="motion__est_8c.html#a147b555fcbdd1e577cb0c0701dbfc9cb">cmp_inline</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>,x,y,subx,suby,<a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>,<a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>,ref_index,src_index, <a class="code" href="vf__palettegen_8c.html#ae342d1a8ad4d2ea56462fc096983664e">cmp_func</a>, chroma_cmp_func, 1, <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>&amp;<a class="code" href="motion__est_8c.html#a40a1fad0d5f30fc21b6b4ee474b66b37">FLAG_CHROMA</a>);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;}</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="motion__est__template_8c.html">motion_est_template.c</a>&quot;</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno"><a class="line" href="motion__est_8c.html#a7d41bef5a92f2cea22ac3ab24ce14c38">  297</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="motion__est_8c.html#a7d41bef5a92f2cea22ac3ab24ce14c38">zero_cmp</a>(<a class="code" href="struct_mpeg_enc_context.html">MpegEncContext</a> *<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *<a class="code" href="undefined_8txt.html#ad99f336d4c117c453fef82993434eb4d">a</a>, <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *<a class="code" href="input_8c.html#ad6cdb6a14abe3eab42eaaadc93409aec">b</a>,</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                    ptrdiff_t <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <span class="keywordtype">int</span> <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>)</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;{</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;}</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno"><a class="line" href="motion__est_8c.html#ad11b393e2138c92edda4b5a9406e0eb8">  303</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="motion__est_8c.html#ad11b393e2138c92edda4b5a9406e0eb8">zero_hpel</a>(<a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *<a class="code" href="undefined_8txt.html#ad99f336d4c117c453fef82993434eb4d">a</a>, <span class="keyword">const</span> <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *<a class="code" href="input_8c.html#ad6cdb6a14abe3eab42eaaadc93409aec">b</a>, ptrdiff_t <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <span class="keywordtype">int</span> <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>){</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;}</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="motion__est_8h.html#aa9d22a6d19ed91234d4252de80dd09f7">  306</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="motion__est_8c.html#a4a506db79296eee3bab2b087f27801ca">ff_init_me</a>(<a class="code" href="struct_mpeg_enc_context.html">MpegEncContext</a> *<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>){</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <a class="code" href="struct_motion_est_context.html">MotionEstContext</a> * <span class="keyword">const</span> <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>= &amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;me;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordtype">int</span> cache_size= <a class="code" href="common_8h.html#a0f84cbd7fd810cd678157c98cbfad4b0">FFMIN</a>(<a class="code" href="motion__est_8h.html#a503dd0cae8a23f8c6b5767888250a72f">ME_MAP_SIZE</a>&gt;&gt;<a class="code" href="motion__est_8c.html#abfcb2c97c1457c7be1ecfc61c26751a9">ME_MAP_SHIFT</a>, 1&lt;&lt;<a class="code" href="motion__est_8c.html#abfcb2c97c1457c7be1ecfc61c26751a9">ME_MAP_SHIFT</a>);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordtype">int</span> dia_size= <a class="code" href="common_8h.html#a9960bd6780a9b16a216a57be1ee04359">FFMAX</a>(<a class="code" href="common_8h.html#ad6d88940cfc29c13a3e51ded211fc242">FFABS</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;avctx-&gt;dia_size)&amp;255, <a class="code" href="common_8h.html#ad6d88940cfc29c13a3e51ded211fc242">FFABS</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;avctx-&gt;pre_dia_size)&amp;255);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="common_8h.html#a0f84cbd7fd810cd678157c98cbfad4b0">FFMIN</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;avctx-&gt;dia_size, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;avctx-&gt;pre_dia_size) &lt; -<a class="code" href="common_8h.html#a0f84cbd7fd810cd678157c98cbfad4b0">FFMIN</a>(<a class="code" href="motion__est_8h.html#a503dd0cae8a23f8c6b5767888250a72f">ME_MAP_SIZE</a>, <a class="code" href="motion__est__template_8c.html#ad2bc0764a3c0ba33006bcdec8228a282">MAX_SAB_SIZE</a>)){</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;avctx, <a class="code" href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a>, <span class="stringliteral">&quot;ME_MAP size is too small for SAB diamond\n&quot;</span>);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    }</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;avctx;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;codec_id == <a class="code" href="group__lavc__core.html#ggaadca229ad2c20e060a14fec08a5cc7cea11cf9a49627f70f6ab33d3bf93752ae4">AV_CODEC_ID_H261</a>)</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;me_sub_cmp = <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;me_cmp;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">if</span>(cache_size &lt; 2*dia_size &amp;&amp; !c-&gt;<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>){</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <a class="code" href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;avctx, <a class="code" href="group__lavu__log__constants.html#gad172eacfed8653e454c6fdcbe53baab3">AV_LOG_INFO</a>, <span class="stringliteral">&quot;ME_MAP size may be a little small for the selected diamond size\n&quot;</span>);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    }</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <a class="code" href="me__cmp_8c.html#a75513e6a622cdbbe65d692568d21b81e">ff_set_cmp</a>(&amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mecc, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mecc.me_pre_cmp, <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;me_pre_cmp);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <a class="code" href="me__cmp_8c.html#a75513e6a622cdbbe65d692568d21b81e">ff_set_cmp</a>(&amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mecc, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mecc.me_cmp,     <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;me_cmp);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <a class="code" href="me__cmp_8c.html#a75513e6a622cdbbe65d692568d21b81e">ff_set_cmp</a>(&amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mecc, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mecc.me_sub_cmp, <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;me_sub_cmp);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <a class="code" href="me__cmp_8c.html#a75513e6a622cdbbe65d692568d21b81e">ff_set_cmp</a>(&amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mecc, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mecc.mb_cmp,     <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;mb_cmp);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;flags    = <a class="code" href="motion__est_8c.html#a5eb44f71317870c609c153e9d0960b16">get_flags</a>(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>, 0, <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;me_cmp    &amp;<a class="code" href="avcodec_8h.html#a265e91f6d00ad75d918bedccfeedd08a">FF_CMP_CHROMA</a>);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;sub_flags= <a class="code" href="motion__est_8c.html#a5eb44f71317870c609c153e9d0960b16">get_flags</a>(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>, 0, <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;me_sub_cmp&amp;<a class="code" href="avcodec_8h.html#a265e91f6d00ad75d918bedccfeedd08a">FF_CMP_CHROMA</a>);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;mb_flags = <a class="code" href="motion__est_8c.html#a5eb44f71317870c609c153e9d0960b16">get_flags</a>(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>, 0, <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;mb_cmp    &amp;<a class="code" href="avcodec_8h.html#a265e91f6d00ad75d918bedccfeedd08a">FF_CMP_CHROMA</a>);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">/*FIXME s-&gt;no_rounding b_type*/</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;avctx-&gt;flags &amp; <a class="code" href="group__lavc__core.html#ga0e51f9240c85bc00f9dd684f020e2150">AV_CODEC_FLAG_QPEL</a>) {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;sub_motion_search= <a class="code" href="motion__est__template_8c.html#a8c691b507e22d7d56ccc60d7bee24493">qpel_motion_search</a>;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;qpel_avg = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;qdsp.avg_qpel_pixels_tab;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;no_rounding)</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;qpel_put = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;qdsp.put_no_rnd_qpel_pixels_tab;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;qpel_put = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;qdsp.put_qpel_pixels_tab;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;me_sub_cmp&amp;<a class="code" href="avcodec_8h.html#a265e91f6d00ad75d918bedccfeedd08a">FF_CMP_CHROMA</a>)</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;sub_motion_search= <a class="code" href="motion__est__template_8c.html#a6c3ca8691cc7091a5c12fb4deb648c01">hpel_motion_search</a>;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(   <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;me_sub_cmp == <a class="code" href="avcodec_8h.html#a5ced04f38d12ad119dda509da1b43eb7">FF_CMP_SAD</a></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                &amp;&amp; <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;    me_cmp == <a class="code" href="avcodec_8h.html#a5ced04f38d12ad119dda509da1b43eb7">FF_CMP_SAD</a></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                &amp;&amp; <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;    mb_cmp == <a class="code" href="avcodec_8h.html#a5ced04f38d12ad119dda509da1b43eb7">FF_CMP_SAD</a>)</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;sub_motion_search= <a class="code" href="motion__est_8c.html#a922289dee948023bcdefbefa1c10bde7">sad_hpel_motion_search</a>; <span class="comment">// 2050 vs. 2450 cycles</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;sub_motion_search= <a class="code" href="motion__est__template_8c.html#a6c3ca8691cc7091a5c12fb4deb648c01">hpel_motion_search</a>;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;hpel_avg = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;hdsp.avg_pixels_tab;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;no_rounding)</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;hpel_put = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;hdsp.put_no_rnd_pixels_tab;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;hpel_put = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;hdsp.put_pixels_tab;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;linesize){</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;stride  = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;linesize;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;uvstride= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;uvlinesize;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;stride  = 16*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_width + 32;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;uvstride=  8*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_width + 16;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    }</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">/* 8x8 fullpel search would need a 4x4 chroma compare, which we do</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">     * not have yet, and even if we had, the motion estimation code</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">     * does not expect it. */</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;codec_id != <a class="code" href="group__lavc__core.html#ggaadca229ad2c20e060a14fec08a5cc7cea253b7f23251a791e6f1d95a86dbab0cd">AV_CODEC_ID_SNOW</a>) {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;me_cmp &amp; <a class="code" href="avcodec_8h.html#a265e91f6d00ad75d918bedccfeedd08a">FF_CMP_CHROMA</a>) <span class="comment">/* &amp;&amp; !s-&gt;mecc.me_cmp[2] */</span>)</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mecc.me_cmp[2] = <a class="code" href="motion__est_8c.html#a7d41bef5a92f2cea22ac3ab24ce14c38">zero_cmp</a>;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;me_sub_cmp &amp; <a class="code" href="avcodec_8h.html#a265e91f6d00ad75d918bedccfeedd08a">FF_CMP_CHROMA</a>) &amp;&amp; !<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mecc.me_sub_cmp[2])</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mecc.me_sub_cmp[2] = <a class="code" href="motion__est_8c.html#a7d41bef5a92f2cea22ac3ab24ce14c38">zero_cmp</a>;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;hpel_put[2][0]= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;hpel_put[2][1]=</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;hpel_put[2][2]= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;hpel_put[2][3]= <a class="code" href="motion__est_8c.html#ad11b393e2138c92edda4b5a9406e0eb8">zero_hpel</a>;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    }</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;codec_id == <a class="code" href="group__lavc__core.html#ggaadca229ad2c20e060a14fec08a5cc7cea11cf9a49627f70f6ab33d3bf93752ae4">AV_CODEC_ID_H261</a>){</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;sub_motion_search= <a class="code" href="motion__est__template_8c.html#a982731b98e86abcd1af0d84102168e6e">no_sub_motion_search</a>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    }</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;}</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno"><a class="line" href="motion__est_8c.html#a3a4d2d91da4f0c9d70bc3b8f1a8462c0">  385</a></span>&#160;<span class="preprocessor">#define CHECK_SAD_HALF_MV(suffix, x, y) \</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="preprocessor">{\</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="preprocessor">    d  = s-&gt;mecc.pix_abs[size][(x ? 1 : 0) + (y ? 2 : 0)](NULL, pix, ptr + ((x) &gt;&gt; 1), stride, h); \</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="preprocessor">    d += (mv_penalty[pen_x + x] + mv_penalty[pen_y + y])*penalty_factor;\</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="preprocessor">    COPY3_IF_LT(dminh, d, dx, x, dy, y)\</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="preprocessor">}</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; </div>
<div class="line"><a name="l00392"></a><span class="lineno"><a class="line" href="motion__est_8c.html#a922289dee948023bcdefbefa1c10bde7">  392</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="motion__est_8c.html#a922289dee948023bcdefbefa1c10bde7">sad_hpel_motion_search</a>(<a class="code" href="struct_mpeg_enc_context.html">MpegEncContext</a> * <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>,</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                                  <span class="keywordtype">int</span> *mx_ptr, <span class="keywordtype">int</span> *my_ptr, <span class="keywordtype">int</span> dmin,</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                                  <span class="keywordtype">int</span> src_index, <span class="keywordtype">int</span> ref_index,</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                                  <span class="keywordtype">int</span> <a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>, <span class="keywordtype">int</span> <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>)</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;{</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <a class="code" href="struct_motion_est_context.html">MotionEstContext</a> * <span class="keyword">const</span> <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>= &amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;me;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> penalty_factor= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;sub_penalty_factor;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordtype">int</span> mx, my, dminh;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *pix, *ptr;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;stride;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <a class="code" href="motion__est__template_8c.html#a0447f2099c0748d07a3a2cba75f34dc6">LOAD_COMMON</a></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <a class="code" href="avassert_8h.html#a2764bf422e4df5bf3aac652f21fe780a">av_assert2</a>(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;sub_flags == 0);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;skip){</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        *mx_ptr = 0;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        *my_ptr = 0;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="keywordflow">return</span> dmin;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    pix = <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;src[src_index][0];</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    mx = *mx_ptr;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    my = *my_ptr;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    ptr = <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ref[ref_index][0] + (my * <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>) + mx;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    dminh = dmin;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordflow">if</span> (mx &gt; xmin &amp;&amp; mx &lt; xmax &amp;&amp;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        my &gt; ymin &amp;&amp; my &lt; ymax) {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="keywordtype">int</span> dx=0, dy=0;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <span class="keywordtype">int</span> d, pen_x, pen_y;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="gxfenc_8c.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>= my*(1&lt;&lt;<a class="code" href="motion__est_8c.html#abfcb2c97c1457c7be1ecfc61c26751a9">ME_MAP_SHIFT</a>) + mx;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> t= score_map[(<a class="code" href="gxfenc_8c.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>-(1&lt;&lt;<a class="code" href="motion__est_8c.html#abfcb2c97c1457c7be1ecfc61c26751a9">ME_MAP_SHIFT</a>))&amp;(<a class="code" href="motion__est_8h.html#a503dd0cae8a23f8c6b5767888250a72f">ME_MAP_SIZE</a>-1)];</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> l= score_map[(<a class="code" href="gxfenc_8c.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>- 1               )&amp;(<a class="code" href="motion__est_8h.html#a503dd0cae8a23f8c6b5767888250a72f">ME_MAP_SIZE</a>-1)];</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="vf__curves_8c.html#a33ac7b8ce37a3a60855883424fcf8b62">r</a>= score_map[(<a class="code" href="gxfenc_8c.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>+ 1               )&amp;(<a class="code" href="motion__est_8h.html#a503dd0cae8a23f8c6b5767888250a72f">ME_MAP_SIZE</a>-1)];</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="input_8c.html#ad6cdb6a14abe3eab42eaaadc93409aec">b</a>= score_map[(<a class="code" href="gxfenc_8c.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>+(1&lt;&lt;<a class="code" href="motion__est_8c.html#abfcb2c97c1457c7be1ecfc61c26751a9">ME_MAP_SHIFT</a>))&amp;(<a class="code" href="motion__est_8h.html#a503dd0cae8a23f8c6b5767888250a72f">ME_MAP_SIZE</a>-1)];</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        mx += mx;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        my += my;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        pen_x= pred_x + mx;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        pen_y= pred_y + my;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        ptr-= <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <span class="keywordflow">if</span>(t&lt;=<a class="code" href="input_8c.html#ad6cdb6a14abe3eab42eaaadc93409aec">b</a>){</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            <a class="code" href="motion__est_8c.html#a3a4d2d91da4f0c9d70bc3b8f1a8462c0">CHECK_SAD_HALF_MV</a>(y2 , 0, -1)</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            <span class="keywordflow">if</span>(l&lt;=<a class="code" href="vf__curves_8c.html#a33ac7b8ce37a3a60855883424fcf8b62">r</a>){</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                <a class="code" href="motion__est_8c.html#a3a4d2d91da4f0c9d70bc3b8f1a8462c0">CHECK_SAD_HALF_MV</a>(xy2, -1, -1)</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                <span class="keywordflow">if</span>(t+<a class="code" href="vf__curves_8c.html#a33ac7b8ce37a3a60855883424fcf8b62">r</a>&lt;=<a class="code" href="input_8c.html#ad6cdb6a14abe3eab42eaaadc93409aec">b</a>+l){</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                    <a class="code" href="motion__est_8c.html#a3a4d2d91da4f0c9d70bc3b8f1a8462c0">CHECK_SAD_HALF_MV</a>(xy2, +1, -1)</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                    ptr+= <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                    ptr+= <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                    <a class="code" href="motion__est_8c.html#a3a4d2d91da4f0c9d70bc3b8f1a8462c0">CHECK_SAD_HALF_MV</a>(xy2, -1, +1)</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                }</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                <a class="code" href="motion__est_8c.html#a3a4d2d91da4f0c9d70bc3b8f1a8462c0">CHECK_SAD_HALF_MV</a>(x2 , -1,  0)</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                <a class="code" href="motion__est_8c.html#a3a4d2d91da4f0c9d70bc3b8f1a8462c0">CHECK_SAD_HALF_MV</a>(xy2, +1, -1)</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                <span class="keywordflow">if</span>(t+l&lt;=<a class="code" href="input_8c.html#ad6cdb6a14abe3eab42eaaadc93409aec">b</a>+<a class="code" href="vf__curves_8c.html#a33ac7b8ce37a3a60855883424fcf8b62">r</a>){</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                    <a class="code" href="motion__est_8c.html#a3a4d2d91da4f0c9d70bc3b8f1a8462c0">CHECK_SAD_HALF_MV</a>(xy2, -1, -1)</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                    ptr+= <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                    ptr+= <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                    <a class="code" href="motion__est_8c.html#a3a4d2d91da4f0c9d70bc3b8f1a8462c0">CHECK_SAD_HALF_MV</a>(xy2, +1, +1)</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                <a class="code" href="motion__est_8c.html#a3a4d2d91da4f0c9d70bc3b8f1a8462c0">CHECK_SAD_HALF_MV</a>(x2 , +1,  0)</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            }</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            <span class="keywordflow">if</span>(l&lt;=<a class="code" href="vf__curves_8c.html#a33ac7b8ce37a3a60855883424fcf8b62">r</a>){</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                <span class="keywordflow">if</span>(t+l&lt;=<a class="code" href="input_8c.html#ad6cdb6a14abe3eab42eaaadc93409aec">b</a>+<a class="code" href="vf__curves_8c.html#a33ac7b8ce37a3a60855883424fcf8b62">r</a>){</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                    <a class="code" href="motion__est_8c.html#a3a4d2d91da4f0c9d70bc3b8f1a8462c0">CHECK_SAD_HALF_MV</a>(xy2, -1, -1)</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                    ptr+= <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                    ptr+= <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                    <a class="code" href="motion__est_8c.html#a3a4d2d91da4f0c9d70bc3b8f1a8462c0">CHECK_SAD_HALF_MV</a>(xy2, +1, +1)</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                }</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                <a class="code" href="motion__est_8c.html#a3a4d2d91da4f0c9d70bc3b8f1a8462c0">CHECK_SAD_HALF_MV</a>(x2 , -1,  0)</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                <a class="code" href="motion__est_8c.html#a3a4d2d91da4f0c9d70bc3b8f1a8462c0">CHECK_SAD_HALF_MV</a>(xy2, -1, +1)</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                <span class="keywordflow">if</span>(t+<a class="code" href="vf__curves_8c.html#a33ac7b8ce37a3a60855883424fcf8b62">r</a>&lt;=<a class="code" href="input_8c.html#ad6cdb6a14abe3eab42eaaadc93409aec">b</a>+l){</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                    <a class="code" href="motion__est_8c.html#a3a4d2d91da4f0c9d70bc3b8f1a8462c0">CHECK_SAD_HALF_MV</a>(xy2, +1, -1)</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                    ptr+= <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                    ptr+= <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                    <a class="code" href="motion__est_8c.html#a3a4d2d91da4f0c9d70bc3b8f1a8462c0">CHECK_SAD_HALF_MV</a>(xy2, -1, +1)</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                }</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                <a class="code" href="motion__est_8c.html#a3a4d2d91da4f0c9d70bc3b8f1a8462c0">CHECK_SAD_HALF_MV</a>(x2 , +1,  0)</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                <a class="code" href="motion__est_8c.html#a3a4d2d91da4f0c9d70bc3b8f1a8462c0">CHECK_SAD_HALF_MV</a>(xy2, +1, +1)</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            }</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            <a class="code" href="motion__est_8c.html#a3a4d2d91da4f0c9d70bc3b8f1a8462c0">CHECK_SAD_HALF_MV</a>(y2 ,  0, +1)</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        }</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        mx+=dx;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        my+=dy;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        mx += mx;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        my += my;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    }</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160; </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    *mx_ptr = mx;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    *my_ptr = my;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">return</span> dminh;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;}</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160; </div>
<div class="line"><a name="l00497"></a><span class="lineno"><a class="line" href="motion__est_8c.html#a5022bf1a3af5defbb33270233241c2e7">  497</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="motion__est_8c.html#a5022bf1a3af5defbb33270233241c2e7">set_p_mv_tables</a>(<a class="code" href="struct_mpeg_enc_context.html">MpegEncContext</a> * <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, <span class="keywordtype">int</span> mx, <span class="keywordtype">int</span> my, <span class="keywordtype">int</span> mv4)</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;{</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> xy= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_x + <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_y*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_stride;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;p_mv_table[xy][0] = mx;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;p_mv_table[xy][1] = my;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160; </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="comment">/* has already been set to the 4 MV if 4MV is done */</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="keywordflow">if</span>(mv4){</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keywordtype">int</span> mot_xy= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;block_index[0];</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture.motion_val[0][mot_xy    ][0] = mx;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture.motion_val[0][mot_xy    ][1] = my;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture.motion_val[0][mot_xy + 1][0] = mx;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture.motion_val[0][mot_xy + 1][1] = my;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        mot_xy += <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b8_stride;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture.motion_val[0][mot_xy    ][0] = mx;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture.motion_val[0][mot_xy    ][1] = my;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture.motion_val[0][mot_xy + 1][0] = mx;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture.motion_val[0][mot_xy + 1][1] = my;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    }</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;}</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00524"></a><span class="lineno"><a class="line" href="motion__est_8c.html#a8291c1722da711c174d2a08f04f86109">  524</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="motion__est_8c.html#a8291c1722da711c174d2a08f04f86109">get_limits</a>(<a class="code" href="struct_mpeg_enc_context.html">MpegEncContext</a> *<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y)</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;{</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <a class="code" href="struct_motion_est_context.html">MotionEstContext</a> * <span class="keyword">const</span> <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>= &amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;me;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keywordtype">int</span> range= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;me_range &gt;&gt; (1 + !!(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;flags&amp;<a class="code" href="motion__est_8c.html#aa24c5a6ce7cbb044271633d20a7b7a36">FLAG_QPEL</a>));</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordtype">int</span> max_range = <a class="code" href="motion__est_8h.html#a1df7d470d965904adde0e67fed4480e4">MAX_MV</a> &gt;&gt; (1 + !!(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;flags&amp;<a class="code" href="motion__est_8c.html#aa24c5a6ce7cbb044271633d20a7b7a36">FLAG_QPEL</a>));</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">    if(c-&gt;avctx-&gt;me_range) c-&gt;range= c-&gt;avctx-&gt;me_range &gt;&gt; 1;</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">    else                   c-&gt;range= 16;</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;unrestricted_mv) {</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmin = - x - 16;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymin = - y - 16;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmax = - x + <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;width;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymax = - y + <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;height;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;out_format == <a class="code" href="mpegutils_8h.html#aeb712c6c6c0a8af0dfd79f451ecb9277a5bd89968f8e67aa8a34c703dcd1b5fd6">FMT_H261</a>){</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <span class="comment">// Search range of H.261 is different from other codec standards</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmin = (x &gt; 15) ? - 15 : 0;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymin = (y &gt; 15) ? - 15 : 0;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmax = (x &lt; <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_width * 16 - 16) ? 15 : 0;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymax = (y &lt; <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_height * 16 - 16) ? 15 : 0;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmin = - x;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymin = - y;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmax = - x + <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_width *16 - 16;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymax = - y + <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_height*16 - 16;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    }</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="keywordflow">if</span>(!range || range &gt; max_range)</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        range = max_range;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordflow">if</span>(range){</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmin = <a class="code" href="common_8h.html#a9960bd6780a9b16a216a57be1ee04359">FFMAX</a>(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmin,-range);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmax = <a class="code" href="common_8h.html#a0f84cbd7fd810cd678157c98cbfad4b0">FFMIN</a>(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmax, range);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymin = <a class="code" href="common_8h.html#a9960bd6780a9b16a216a57be1ee04359">FFMAX</a>(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymin,-range);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymax = <a class="code" href="common_8h.html#a0f84cbd7fd810cd678157c98cbfad4b0">FFMIN</a>(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymax, range);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;}</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno"><a class="line" href="motion__est_8c.html#a96d7936d8f679ebafa9f3d4f5e8e70a3">  560</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="motion__est_8c.html#a96d7936d8f679ebafa9f3d4f5e8e70a3">init_mv4_ref</a>(<a class="code" href="struct_motion_est_context.html">MotionEstContext</a> *<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>){</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;stride;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ref[1][0] = <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ref[0][0] + 8;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ref[2][0] = <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ref[0][0] + 8*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ref[3][0] = <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ref[2][0] + 8;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;src[1][0] = <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;src[0][0] + 8;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;src[2][0] = <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;src[0][0] + 8*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;src[3][0] = <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;src[2][0] + 8;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;}</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160; </div>
<div class="line"><a name="l00571"></a><span class="lineno"><a class="line" href="motion__est_8c.html#a6d27971967536143702e3f8e23e71b32">  571</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="motion__est_8c.html#a6d27971967536143702e3f8e23e71b32">h263_mv4_search</a>(<a class="code" href="struct_mpeg_enc_context.html">MpegEncContext</a> *<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, <span class="keywordtype">int</span> mx, <span class="keywordtype">int</span> my, <span class="keywordtype">int</span> <a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>)</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;{</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <a class="code" href="struct_motion_est_context.html">MotionEstContext</a> * <span class="keyword">const</span> <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>= &amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;me;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>= 1;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>=8;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="mpegaudioenc__template_8c.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[10][2];</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordtype">int</span> dmin_sum=0, mx4_sum=0, my4_sum=0, <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keywordtype">int</span> same=1;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;stride;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *<a class="code" href="ituh263enc_8c.html#a35869db1e130a4cf46dc9163cb194531">mv_penalty</a>= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;current_mv_penalty;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keywordtype">int</span> safety_clipping= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;unrestricted_mv &amp;&amp; (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;width&amp;15) &amp;&amp; (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;height&amp;15);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <a class="code" href="motion__est_8c.html#a96d7936d8f679ebafa9f3d4f5e8e70a3">init_mv4_ref</a>(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>=0; <a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>&lt;4; <a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>++){</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        <span class="keywordtype">int</span> mx4, my4;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <span class="keywordtype">int</span> pred_x4, pred_y4;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <span class="keywordtype">int</span> dmin4;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> off[4]= {2, 1, 1, -1};</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> mot_stride = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b8_stride;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> mot_xy = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;block_index[<a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>];</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="keywordflow">if</span>(safety_clipping){</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmax = - 16*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_x + <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;width  - 8*(<a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a> &amp;1);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymax = - 16*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_y + <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;height - 8*(<a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>&gt;&gt;1);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        }</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160; </div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[0] = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture.motion_val[0][mot_xy - 1][0];</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[1] = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture.motion_val[0][mot_xy - 1][1];</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[0]       &gt; (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmax&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>)) <a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[0]       = (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmax&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        <span class="comment">/* special case for first line */</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;first_slice_line &amp;&amp; <a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>&lt;2) {</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;pred_x= pred_x4= <a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[0];</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;pred_y= pred_y4= <a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[1];</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            <a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[0]      = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture.motion_val[0][mot_xy - mot_stride             ][0];</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            <a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[1]      = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture.motion_val[0][mot_xy - mot_stride             ][1];</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[0] = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture.motion_val[0][mot_xy - mot_stride + off[<a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>]][0];</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[1] = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture.motion_val[0][mot_xy - mot_stride + off[<a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>]][1];</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[1]      &gt; (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymax&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>)) <a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[1]     = (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymax&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[0] &lt; (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmin&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>)) <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[0]= (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmin&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[0] &gt; (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmax&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>)) <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[0]= (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmax&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[1] &gt; (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymax&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>)) <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[1]= (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymax&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160; </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            <a class="code" href="motion__est_8c.html#a68d7a1b5a5e7aa7cb4a42f893b3cfc57">P_MEDIAN</a>[0]= <a class="code" href="mathops_8h.html#a6948a24017ba60d76640f7587429a9f6">mid_pred</a>(<a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[0], <a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[0], <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[0]);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            <a class="code" href="motion__est_8c.html#a68d7a1b5a5e7aa7cb4a42f893b3cfc57">P_MEDIAN</a>[1]= <a class="code" href="mathops_8h.html#a6948a24017ba60d76640f7587429a9f6">mid_pred</a>(<a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[1], <a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[1], <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[1]);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;pred_x= pred_x4 = <a class="code" href="motion__est_8c.html#a68d7a1b5a5e7aa7cb4a42f893b3cfc57">P_MEDIAN</a>[0];</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;pred_y= pred_y4 = <a class="code" href="motion__est_8c.html#a68d7a1b5a5e7aa7cb4a42f893b3cfc57">P_MEDIAN</a>[1];</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        }</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <a class="code" href="motion__est_8c.html#a51273d274807fce7296dc30d6e79f4c1">P_MV1</a>[0]= mx;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <a class="code" href="motion__est_8c.html#a51273d274807fce7296dc30d6e79f4c1">P_MV1</a>[1]= my;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        <span class="keywordflow">if</span>(safety_clipping)</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>=1; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;10; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++){</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;first_slice_line &amp;&amp; block&lt;2 &amp;&amp; i&gt;1 &amp;&amp; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;9)</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>&gt;4 &amp;&amp; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;9)</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="mpegaudioenc__template_8c.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][0] &gt; (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmax&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>)) <a class="code" href="mpegaudioenc__template_8c.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][0]= (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmax&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="mpegaudioenc__template_8c.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][1] &gt; (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymax&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>)) <a class="code" href="mpegaudioenc__template_8c.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][1]= (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymax&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            }</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        dmin4 = <a class="code" href="motion__est__template_8c.html#a9060494a0b2837cbe7f85a352e2cfbf0">epzs_motion_search2</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, &amp;mx4, &amp;my4, <a class="code" href="mpegaudioenc__template_8c.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>, <a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>, <a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;p_mv_table, (1&lt;&lt;16)&gt;&gt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>, 1);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        dmin4= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;sub_motion_search(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, &amp;mx4, &amp;my4, dmin4, <a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>, <a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>, <a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>, <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>);</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mecc.me_sub_cmp[0] != <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mecc.mb_cmp[0]) {</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            <span class="keywordtype">int</span> dxy;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="writing__filters_8txt.html#ae1df9c886af8e844bb8849d403b76663">offset</a>= ((<a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>&amp;1) + (<a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>&gt;&gt;1)*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>)*8;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *dest_y = <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;scratchpad + <a class="code" href="writing__filters_8txt.html#ae1df9c886af8e844bb8849d403b76663">offset</a>;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;quarter_sample){</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *<a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ref[<a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>][0] + (mx4&gt;&gt;2) + (my4&gt;&gt;2)*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                dxy = ((my4 &amp; 3) &lt;&lt; 2) | (mx4 &amp; 3);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;no_rounding)</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                    <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;qdsp.put_no_rnd_qpel_pixels_tab[1][dxy](dest_y, <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>, <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                    <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;qdsp.put_qpel_pixels_tab[1][dxy](dest_y, <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>, <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *<a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ref[<a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>][0] + (mx4&gt;&gt;1) + (my4&gt;&gt;1)*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                dxy = ((my4 &amp; 1) &lt;&lt; 1) | (mx4 &amp; 1);</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;no_rounding)</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                    <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;hdsp.put_no_rnd_pixels_tab[1][dxy](dest_y    , <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>    , <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                    <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;hdsp.put_pixels_tab       [1][dxy](dest_y    , <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>    , <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            }</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;            dmin_sum+= (<a class="code" href="ituh263enc_8c.html#a35869db1e130a4cf46dc9163cb194531">mv_penalty</a>[mx4-pred_x4] + <a class="code" href="ituh263enc_8c.html#a35869db1e130a4cf46dc9163cb194531">mv_penalty</a>[my4-pred_y4])*<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;mb_penalty_factor;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        }<span class="keywordflow">else</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            dmin_sum+= dmin4;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160; </div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;quarter_sample){</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            mx4_sum+= mx4/2;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            my4_sum+= my4/2;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            mx4_sum+= mx4;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            my4_sum+= my4;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture.motion_val[0][<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;block_index[<a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>]][0] = mx4;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture.motion_val[0][<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;block_index[<a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>]][1] = my4;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160; </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <span class="keywordflow">if</span>(mx4 != mx || my4 != my) same=0;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    }</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160; </div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="keywordflow">if</span>(same)</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <span class="keywordflow">return</span> INT_MAX;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160; </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mecc.me_sub_cmp[0] != <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mecc.mb_cmp[0]) {</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        dmin_sum += <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mecc.mb_cmp[0](<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>,</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                                      <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;new_picture.f-&gt;data[0] +</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                                      <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_x * 16 + <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_y * 16 * <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>,</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                                      <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;scratchpad, <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, 16);</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    }</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160; </div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;mb_cmp&amp;<a class="code" href="avcodec_8h.html#a265e91f6d00ad75d918bedccfeedd08a">FF_CMP_CHROMA</a>){</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        <span class="keywordtype">int</span> dxy;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        <span class="keywordtype">int</span> mx, my;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="writing__filters_8txt.html#ae1df9c886af8e844bb8849d403b76663">offset</a>;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160; </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        mx= <a class="code" href="motion__est_8h.html#a7218b8d248303e9eee02438a35198ca7">ff_h263_round_chroma</a>(mx4_sum);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        my= <a class="code" href="motion__est_8h.html#a7218b8d248303e9eee02438a35198ca7">ff_h263_round_chroma</a>(my4_sum);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        dxy = ((my &amp; 1) &lt;&lt; 1) | (mx &amp; 1);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <a class="code" href="writing__filters_8txt.html#ae1df9c886af8e844bb8849d403b76663">offset</a>= (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_x*8 + (mx&gt;&gt;1)) + (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_y*8 + (my&gt;&gt;1))*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;uvlinesize;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;no_rounding){</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;            <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;hdsp.put_no_rnd_pixels_tab[1][dxy](<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;scratchpad    , <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;last_picture.f-&gt;data[1] + <a class="code" href="writing__filters_8txt.html#ae1df9c886af8e844bb8849d403b76663">offset</a>, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;uvlinesize, 8);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;hdsp.put_no_rnd_pixels_tab[1][dxy](<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;scratchpad + 8, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;last_picture.f-&gt;data[2] + <a class="code" href="writing__filters_8txt.html#ae1df9c886af8e844bb8849d403b76663">offset</a>, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;uvlinesize, 8);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;            <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;hdsp.put_pixels_tab       [1][dxy](<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;scratchpad    , <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;last_picture.f-&gt;data[1] + <a class="code" href="writing__filters_8txt.html#ae1df9c886af8e844bb8849d403b76663">offset</a>, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;uvlinesize, 8);</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;            <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;hdsp.put_pixels_tab       [1][dxy](<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;scratchpad + 8, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;last_picture.f-&gt;data[2] + <a class="code" href="writing__filters_8txt.html#ae1df9c886af8e844bb8849d403b76663">offset</a>, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;uvlinesize, 8);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        }</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        dmin_sum += <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mecc.mb_cmp[1](<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;new_picture.f-&gt;data[1] + <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_x * 8 + <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_y * 8 * <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;uvlinesize, <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;scratchpad,     <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;uvlinesize, 8);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        dmin_sum += <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mecc.mb_cmp[1](<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;new_picture.f-&gt;data[2] + <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_x * 8 + <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_y * 8 * <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;uvlinesize, <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;scratchpad + 8, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;uvlinesize, 8);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    }</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160; </div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;pred_x= mx;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;pred_y= my;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="keywordflow">switch</span>(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;mb_cmp&amp;0xFF){</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="comment">/*case FF_CMP_SSE:</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment">        return dmin_sum+ 32*s-&gt;qscale*s-&gt;qscale;*/</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="avcodec_8h.html#af0e853ac6880d5ce4122b367f7f60b23">FF_CMP_RD</a>:</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        <span class="keywordflow">return</span> dmin_sum;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <span class="keywordflow">return</span> dmin_sum+ 11*<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;mb_penalty_factor;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    }</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;}</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno"><a class="line" href="motion__est_8c.html#ae9799fee842b207cf847788d5a2447f8">  725</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="motion__est_8c.html#ae9799fee842b207cf847788d5a2447f8">init_interlaced_ref</a>(<a class="code" href="struct_mpeg_enc_context.html">MpegEncContext</a> *<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, <span class="keywordtype">int</span> ref_index){</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <a class="code" href="struct_motion_est_context.html">MotionEstContext</a> * <span class="keyword">const</span> <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>= &amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;me;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160; </div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ref[1+ref_index][0] = <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ref[0+ref_index][0] + <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;linesize;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;src[1][0] = <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;src[0][0] + <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;linesize;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;flags &amp; <a class="code" href="motion__est_8c.html#a40a1fad0d5f30fc21b6b4ee474b66b37">FLAG_CHROMA</a>){</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ref[1+ref_index][1] = <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ref[0+ref_index][1] + <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;uvlinesize;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ref[1+ref_index][2] = <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ref[0+ref_index][2] + <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;uvlinesize;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;src[1][1] = <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;src[0][1] + <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;uvlinesize;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;src[1][2] = <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;src[0][2] + <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;uvlinesize;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    }</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;}</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160; </div>
<div class="line"><a name="l00738"></a><span class="lineno"><a class="line" href="motion__est_8c.html#a5f0418ef58399e169aa9383dd4d0b80c">  738</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="motion__est_8c.html#a5f0418ef58399e169aa9383dd4d0b80c">interlaced_search</a>(<a class="code" href="struct_mpeg_enc_context.html">MpegEncContext</a> *<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, <span class="keywordtype">int</span> ref_index,</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                             int16_t (*mv_tables[2][2])[2], <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *field_select_tables[2], <span class="keywordtype">int</span> mx, <span class="keywordtype">int</span> my, <span class="keywordtype">int</span> user_field_select)</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;{</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <a class="code" href="struct_motion_est_context.html">MotionEstContext</a> * <span class="keyword">const</span> <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>= &amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;me;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>=0;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>=8;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="mpegaudioenc__template_8c.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[10][2];</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> * <span class="keyword">const</span> <a class="code" href="ituh263enc_8c.html#a35869db1e130a4cf46dc9163cb194531">mv_penalty</a>= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;current_mv_penalty;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="keywordtype">int</span> same=1;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>= 2*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;linesize;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="keywordtype">int</span> dmin_sum= 0;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> mot_stride= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_stride;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> xy= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_x + <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_y*mot_stride;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymin&gt;&gt;=1;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymax&gt;&gt;=1;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;stride&lt;&lt;=1;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;uvstride&lt;&lt;=1;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <a class="code" href="motion__est_8c.html#ae9799fee842b207cf847788d5a2447f8">init_interlaced_ref</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, ref_index);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160; </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>=0; <a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>&lt;2; <a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>++){</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <span class="keywordtype">int</span> field_select;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <span class="keywordtype">int</span> best_dmin= INT_MAX;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        <span class="keywordtype">int</span> best_field= -1;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160; </div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        <span class="keywordflow">for</span>(field_select=0; field_select&lt;2; field_select++){</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            <span class="keywordtype">int</span> dmin, mx_i, my_i;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            int16_t (*mv_table)[2]= mv_tables[<a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>][field_select];</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160; </div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;            <span class="keywordflow">if</span>(user_field_select){</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                <a class="code" href="avassert_8h.html#a557ed9c8df70c282bf6b7e0e07d7d5b0">av_assert1</a>(field_select==0 || field_select==1);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                <a class="code" href="avassert_8h.html#a557ed9c8df70c282bf6b7e0e07d7d5b0">av_assert1</a>(field_select_tables[<a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>][xy]==0 || field_select_tables[<a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>][xy]==1);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                <span class="keywordflow">if</span>(field_select_tables[<a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>][xy] != field_select)</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            }</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160; </div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            <a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[0] = mv_table[xy - 1][0];</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            <a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[1] = mv_table[xy - 1][1];</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[0]       &gt; (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmax&lt;&lt;1)) <a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[0]       = (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmax&lt;&lt;1);</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;pred_x= <a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[0];</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;pred_y= <a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[1];</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            <span class="keywordflow">if</span>(!<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;first_slice_line){</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                <a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[0]      = mv_table[xy - mot_stride][0];</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                <a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[1]      = mv_table[xy - mot_stride][1];</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[0] = mv_table[xy - mot_stride + 1][0];</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[1] = mv_table[xy - mot_stride + 1][1];</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[1]      &gt; (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymax&lt;&lt;1)) <a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[1]     = (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymax&lt;&lt;1);</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[0] &lt; (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmin&lt;&lt;1)) <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[0]= (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmin&lt;&lt;1);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[0] &gt; (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmax&lt;&lt;1)) <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[0]= (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmax&lt;&lt;1);</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[1] &gt; (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymax&lt;&lt;1)) <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[1]= (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymax&lt;&lt;1);</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160; </div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                <a class="code" href="motion__est_8c.html#a68d7a1b5a5e7aa7cb4a42f893b3cfc57">P_MEDIAN</a>[0]= <a class="code" href="mathops_8h.html#a6948a24017ba60d76640f7587429a9f6">mid_pred</a>(<a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[0], <a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[0], <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[0]);</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                <a class="code" href="motion__est_8c.html#a68d7a1b5a5e7aa7cb4a42f893b3cfc57">P_MEDIAN</a>[1]= <a class="code" href="mathops_8h.html#a6948a24017ba60d76640f7587429a9f6">mid_pred</a>(<a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[1], <a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[1], <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[1]);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            }</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;            <a class="code" href="motion__est_8c.html#a51273d274807fce7296dc30d6e79f4c1">P_MV1</a>[0]= mx; <span class="comment">//FIXME not correct if block != field_select</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            <a class="code" href="motion__est_8c.html#a51273d274807fce7296dc30d6e79f4c1">P_MV1</a>[1]= my / 2;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;            dmin = <a class="code" href="motion__est__template_8c.html#a9060494a0b2837cbe7f85a352e2cfbf0">epzs_motion_search2</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, &amp;mx_i, &amp;my_i, <a class="code" href="mpegaudioenc__template_8c.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>, <a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>, field_select+ref_index, mv_table, (1&lt;&lt;16)&gt;&gt;1, 0);</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160; </div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            dmin= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;sub_motion_search(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, &amp;mx_i, &amp;my_i, dmin, <a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>, field_select+ref_index, <a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>, <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160; </div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            mv_table[xy][0]= mx_i;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;            mv_table[xy][1]= my_i;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160; </div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mecc.me_sub_cmp[0] != <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mecc.mb_cmp[0]) {</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                <span class="keywordtype">int</span> dxy;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160; </div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                <span class="comment">//FIXME chroma ME</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *<a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ref[field_select+ref_index][0] + (mx_i&gt;&gt;1) + (my_i&gt;&gt;1)*<a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                dxy = ((my_i &amp; 1) &lt;&lt; 1) | (mx_i &amp; 1);</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160; </div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;no_rounding){</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                    <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;hdsp.put_no_rnd_pixels_tab[<a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>][dxy](<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;scratchpad, <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>    , <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                    <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;hdsp.put_pixels_tab       [<a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>][dxy](<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;scratchpad, <a class="code" href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a>    , <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>);</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                }</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                dmin = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mecc.mb_cmp[<a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>](<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;src[<a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>][0], <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;scratchpad, <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                dmin+= (<a class="code" href="ituh263enc_8c.html#a35869db1e130a4cf46dc9163cb194531">mv_penalty</a>[mx_i-<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;pred_x] + <a class="code" href="ituh263enc_8c.html#a35869db1e130a4cf46dc9163cb194531">mv_penalty</a>[my_i-<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;pred_y] + 1)*<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;mb_penalty_factor;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;            }<span class="keywordflow">else</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                dmin+= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;mb_penalty_factor; <span class="comment">//field_select bits</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160; </div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            dmin += field_select != <a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>; <span class="comment">//slightly prefer same field</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160; </div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            <span class="keywordflow">if</span>(dmin &lt; best_dmin){</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                best_dmin= dmin;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                best_field= field_select;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            }</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        }</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        {</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            int16_t (*mv_table)[2]= mv_tables[<a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>][best_field];</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160; </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            <span class="keywordflow">if</span>(mv_table[xy][0] != mx) same=0; <span class="comment">//FIXME check if these checks work and are any good at all</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            <span class="keywordflow">if</span>(mv_table[xy][1]&amp;1) same=0;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            <span class="keywordflow">if</span>(mv_table[xy][1]*2 != my) same=0;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            <span class="keywordflow">if</span>(best_field != <a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>) same=0;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        }</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160; </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        field_select_tables[<a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>][xy]= best_field;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        dmin_sum += best_dmin;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    }</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160; </div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymin&lt;&lt;=1;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymax&lt;&lt;=1;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;stride&gt;&gt;=1;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;uvstride&gt;&gt;=1;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160; </div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="keywordflow">if</span>(same)</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        <span class="keywordflow">return</span> INT_MAX;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160; </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="keywordflow">switch</span>(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;mb_cmp&amp;0xFF){</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="comment">/*case FF_CMP_SSE:</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment">        return dmin_sum+ 32*s-&gt;qscale*s-&gt;qscale;*/</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="avcodec_8h.html#af0e853ac6880d5ce4122b367f7f60b23">FF_CMP_RD</a>:</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        <span class="keywordflow">return</span> dmin_sum;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        <span class="keywordflow">return</span> dmin_sum+ 11*<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;mb_penalty_factor;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    }</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;}</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160; </div>
<div class="line"><a name="l00860"></a><span class="lineno"><a class="line" href="motion__est_8c.html#a298213d16c81aa33a67382490e43c975">  860</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="motion__est_8c.html#a298213d16c81aa33a67382490e43c975">get_penalty_factor</a>(<span class="keywordtype">int</span> lambda, <span class="keywordtype">int</span> lambda2, <span class="keywordtype">int</span> <a class="code" href="writing__filters_8txt.html#a860450fba1f740387dc082792ad89517">type</a>){</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="keywordflow">switch</span>(<a class="code" href="writing__filters_8txt.html#a860450fba1f740387dc082792ad89517">type</a>&amp;0xFF){</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="avcodec_8h.html#a5ced04f38d12ad119dda509da1b43eb7">FF_CMP_SAD</a>:</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        <span class="keywordflow">return</span> lambda&gt;&gt;<a class="code" href="group__lavu__enc.html#ga979d8e4b4947c924436fcc3b62cafea7">FF_LAMBDA_SHIFT</a>;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="avcodec_8h.html#a25c94282d6ab84f5f8e6803105813527">FF_CMP_DCT</a>:</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <span class="keywordflow">return</span> (3*lambda)&gt;&gt;(<a class="code" href="group__lavu__enc.html#ga979d8e4b4947c924436fcc3b62cafea7">FF_LAMBDA_SHIFT</a>+1);</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="avcodec_8h.html#a083963028b2c118103c8f6bcfc2e024f">FF_CMP_W53</a>:</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        <span class="keywordflow">return</span> (4*lambda)&gt;&gt;(<a class="code" href="group__lavu__enc.html#ga979d8e4b4947c924436fcc3b62cafea7">FF_LAMBDA_SHIFT</a>);</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="avcodec_8h.html#a301cef5b2b4e3268be40c9f30c7f371f">FF_CMP_W97</a>:</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        <span class="keywordflow">return</span> (2*lambda)&gt;&gt;(<a class="code" href="group__lavu__enc.html#ga979d8e4b4947c924436fcc3b62cafea7">FF_LAMBDA_SHIFT</a>);</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="avcodec_8h.html#a47d744af4e9db69ed15409ed056007c0">FF_CMP_SATD</a>:</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="avcodec_8h.html#a02d665e44512df1db73fde009c8aa3ca">FF_CMP_DCT264</a>:</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        <span class="keywordflow">return</span> (2*lambda)&gt;&gt;<a class="code" href="group__lavu__enc.html#ga979d8e4b4947c924436fcc3b62cafea7">FF_LAMBDA_SHIFT</a>;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="avcodec_8h.html#af0e853ac6880d5ce4122b367f7f60b23">FF_CMP_RD</a>:</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="avcodec_8h.html#aa1a37935d19036f578c5e766178f59b6">FF_CMP_PSNR</a>:</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="avcodec_8h.html#a08cc824c6da624325be6c0a48561729e">FF_CMP_SSE</a>:</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="avcodec_8h.html#a4a7e6a77e5f27d3fc1a8de5effa3897c">FF_CMP_NSSE</a>:</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        <span class="keywordflow">return</span> lambda2&gt;&gt;<a class="code" href="group__lavu__enc.html#ga979d8e4b4947c924436fcc3b62cafea7">FF_LAMBDA_SHIFT</a>;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="avcodec_8h.html#a4408d3a17a4de7dac2f99a751524ac27">FF_CMP_BIT</a>:</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="avcodec_8h.html#afd49ad1e465d3fc2dfa1307bd9f7bb71">FF_CMP_MEDIAN_SAD</a>:</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    }</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;}</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160; </div>
<div class="line"><a name="l00885"></a><span class="lineno"><a class="line" href="motion__est_8h.html#aa13386531287b6f55bbd134bd91cbe82">  885</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="motion__est_8c.html#a359a476e54bd7ef7176967224fdabf60">ff_estimate_p_frame_motion</a>(<a class="code" href="struct_mpeg_enc_context.html">MpegEncContext</a> * <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>,</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                                <span class="keywordtype">int</span> mb_x, <span class="keywordtype">int</span> mb_y)</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;{</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <a class="code" href="struct_motion_est_context.html">MotionEstContext</a> * <span class="keyword">const</span> <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>= &amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;me;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *pix, *ppix;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="keywordtype">int</span> sum, mx = 0, my = 0, dmin = 0;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="keywordtype">int</span> varc;            </div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="keywordtype">int</span> vard;            </div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="mpegaudioenc__template_8c.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[10][2];</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>= 1+<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;quarter_sample;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="keywordtype">int</span> mb_type=0;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <a class="code" href="struct_picture.html">Picture</a> * <span class="keyword">const</span> pic= &amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture;</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160; </div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <a class="code" href="motion__est_8c.html#a4fb3984ec1e5fa4ef18d3aec973394f6">init_ref</a>(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;new_picture.f-&gt;data, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;last_picture.f-&gt;data, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 16*mb_x, 16*mb_y, 0);</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160; </div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <a class="code" href="avassert_8h.html#aae204192396f78cc8c5cd7ad5c57c23f">av_assert0</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;quarter_sample==0 || <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;quarter_sample==1);</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <a class="code" href="avassert_8h.html#aae204192396f78cc8c5cd7ad5c57c23f">av_assert0</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;linesize == <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;stride);</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    <a class="code" href="avassert_8h.html#aae204192396f78cc8c5cd7ad5c57c23f">av_assert0</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;uvlinesize == <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;uvstride);</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160; </div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;penalty_factor    = <a class="code" href="motion__est_8c.html#a298213d16c81aa33a67382490e43c975">get_penalty_factor</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;lambda, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;lambda2, <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;me_cmp);</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;sub_penalty_factor= <a class="code" href="motion__est_8c.html#a298213d16c81aa33a67382490e43c975">get_penalty_factor</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;lambda, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;lambda2, <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;me_sub_cmp);</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;mb_penalty_factor = <a class="code" href="motion__est_8c.html#a298213d16c81aa33a67382490e43c975">get_penalty_factor</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;lambda, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;lambda2, <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;mb_cmp);</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;current_mv_penalty= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;mv_penalty[<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;f_code] + <a class="code" href="motion__est_8h.html#aff5e63cbe9a89f209f562aa9a846c7ab">MAX_DMV</a>;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160; </div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <a class="code" href="motion__est_8c.html#a8291c1722da711c174d2a08f04f86109">get_limits</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, 16*mb_x, 16*mb_y);</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;skip=0;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="comment">/* intra / predictive decision */</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    pix = <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;src[0][0];</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    sum  = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mpvencdsp.pix_sum(pix, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;linesize);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    varc = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mpvencdsp.pix_norm1(pix, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;linesize) -</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;           (((unsigned) sum * sum) &gt;&gt; 8) + 500;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160; </div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    pic-&gt;<a class="code" href="struct_picture.html#a58bd22d2d99b09d8b2bc7a2f33849255">mb_mean</a>[<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_stride * mb_y + mb_x] = (sum+128)&gt;&gt;8;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    pic-&gt;<a class="code" href="struct_picture.html#a702f8e577cd4df73f4b6f448319aef97">mb_var</a> [<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_stride * mb_y + mb_x] = (varc+128)&gt;&gt;8;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;mb_var_sum_temp += (varc+128)&gt;&gt;8;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160; </div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;motion_est != <a class="code" href="motion__est_8h.html#ae990b594d112ea5fd0574106cd9a0491">FF_ME_ZERO</a>) {</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> mot_stride = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b8_stride;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> mot_xy = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;block_index[0];</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160; </div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        <a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[0] = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture.motion_val[0][mot_xy - 1][0];</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        <a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[1] = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture.motion_val[0][mot_xy - 1][1];</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160; </div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[0] &gt; (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmax &lt;&lt; <a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>))</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;            <a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[0] =  <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmax &lt;&lt; <a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160; </div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        <a class="code" href="filter__design_8txt.html#a0e82f1088fdc24c14bf175d2ac77523f">if</a> (!<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;first_slice_line) {</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;            <a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[0]      = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture.motion_val[0][mot_xy - mot_stride    ][0];</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;            <a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[1]      = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture.motion_val[0][mot_xy - mot_stride    ][1];</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;            <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[0] = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture.motion_val[0][mot_xy - mot_stride + 2][0];</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;            <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[1] = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture.motion_val[0][mot_xy - mot_stride + 2][1];</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[1] &gt; (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymax &lt;&lt; <a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>))</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                <a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[1] =  <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymax &lt;&lt; <a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;            <a class="code" href="filter__design_8txt.html#a0e82f1088fdc24c14bf175d2ac77523f">if</a> (<a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[0] &lt; (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmin * (1 &lt;&lt; <a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>)))</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[0] =  <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmin * (1 &lt;&lt; <a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[1] &gt; (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymax * (1 &lt;&lt; <a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>)))</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[1] =  <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymax * (1 &lt;&lt; <a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>);</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160; </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;            <a class="code" href="motion__est_8c.html#a68d7a1b5a5e7aa7cb4a42f893b3cfc57">P_MEDIAN</a>[0] = <a class="code" href="mathops_8h.html#a6948a24017ba60d76640f7587429a9f6">mid_pred</a>(<a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[0], <a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[0], <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[0]);</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;            <a class="code" href="motion__est_8c.html#a68d7a1b5a5e7aa7cb4a42f893b3cfc57">P_MEDIAN</a>[1] = <a class="code" href="mathops_8h.html#a6948a24017ba60d76640f7587429a9f6">mid_pred</a>(<a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[1], <a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[1], <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[1]);</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160; </div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;out_format == <a class="code" href="mpegutils_8h.html#aeb712c6c6c0a8af0dfd79f451ecb9277acbc818c9ff383e30d36451d333dd1a1a">FMT_H263</a>) {</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;pred_x = <a class="code" href="motion__est_8c.html#a68d7a1b5a5e7aa7cb4a42f893b3cfc57">P_MEDIAN</a>[0];</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;pred_y = <a class="code" href="motion__est_8c.html#a68d7a1b5a5e7aa7cb4a42f893b3cfc57">P_MEDIAN</a>[1];</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;            } <span class="keywordflow">else</span> { <span class="comment">/* MPEG-1 at least */</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;pred_x = <a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[0];</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;pred_y = <a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[1];</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;            }</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;            <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;pred_x = <a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[0];</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;            <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;pred_y = <a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[1];</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        }</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        dmin = <a class="code" href="motion__est_8h.html#a55c27d33d3ab1c93c0baa2923a85ff74">ff_epzs_motion_search</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, &amp;mx, &amp;my, <a class="code" href="mpegaudioenc__template_8c.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>, 0, 0, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;p_mv_table, (1&lt;&lt;16)&gt;&gt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>, 0, 16);</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    }</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160; </div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="comment">/* At this point (mx,my) are full-pell and the relative displacement */</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    ppix = <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ref[0][0] + (my * <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;linesize) + mx;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160; </div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    vard = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mecc.sse[0](<a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, pix, ppix, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;linesize, 16);</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160; </div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    pic-&gt;<a class="code" href="struct_picture.html#a6f5fb4157107761a2c16d3ec2710bb37">mc_mb_var</a>[<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_stride * mb_y + mb_x] = (vard+128)&gt;&gt;8;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;mc_mb_var_sum_temp += (vard+128)&gt;&gt;8;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160; </div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;mb_decision &gt; <a class="code" href="avcodec_8h.html#ac07b09eadb08fd0c03b1a321bdd0a87e">FF_MB_DECISION_SIMPLE</a>) {</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        <span class="keywordtype">int</span> p_score= <a class="code" href="common_8h.html#a0f84cbd7fd810cd678157c98cbfad4b0">FFMIN</a>(vard, varc-500+(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;lambda2&gt;&gt;<a class="code" href="group__lavu__enc.html#ga979d8e4b4947c924436fcc3b62cafea7">FF_LAMBDA_SHIFT</a>)*100);</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <span class="keywordtype">int</span> i_score= varc-500+(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;lambda2&gt;&gt;<a class="code" href="group__lavu__enc.html#ga979d8e4b4947c924436fcc3b62cafea7">FF_LAMBDA_SHIFT</a>)*20;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;scene_change_score+= <a class="code" href="mathops_8h.html#a7d92df17cf51f763cbd29c1bea3436dc">ff_sqrt</a>(p_score) - <a class="code" href="mathops_8h.html#a7d92df17cf51f763cbd29c1bea3436dc">ff_sqrt</a>(i_score);</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160; </div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        <span class="keywordflow">if</span> (vard*2 + 200*256 &gt; varc &amp;&amp; !<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;intra_penalty)</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;            mb_type|= <a class="code" href="mpegutils_8h.html#a0628ca7c41ad229d1786fd2ccddd0ed8">CANDIDATE_MB_TYPE_INTRA</a>;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        <span class="keywordflow">if</span> (varc*2 + 200*256 &gt; vard || <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;qscale &gt; 24){</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="comment">//        if (varc*2 + 200*256 + 50*(s-&gt;lambda2&gt;&gt;FF_LAMBDA_SHIFT) &gt; vard){</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;            mb_type|= <a class="code" href="mpegutils_8h.html#a660a22ba325af570369879cb392d3d21">CANDIDATE_MB_TYPE_INTER</a>;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;            <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;sub_motion_search(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, &amp;mx, &amp;my, dmin, 0, 0, 0, 16);</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mpv_flags &amp; <a class="code" href="mpegvideo_8h.html#a7f5f72b0628939f9942f9e43bfa371cc">FF_MPV_FLAG_MV0</a>)</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                <span class="keywordflow">if</span>(mx || my)</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                    mb_type |= <a class="code" href="mpegutils_8h.html#a5ad4a10962f36d81e69599049a2b81c8">CANDIDATE_MB_TYPE_SKIPPED</a>; <span class="comment">//FIXME check difference</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;            mx &lt;&lt;=<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            my &lt;&lt;=<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        }</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;avctx-&gt;flags &amp; <a class="code" href="group__lavc__core.html#gac66356d3e9a7ae8b2b29e14402367649">AV_CODEC_FLAG_4MV</a>)</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;           &amp;&amp; !<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;skip &amp;&amp; varc&gt;50&lt;&lt;8 &amp;&amp; vard&gt;10&lt;&lt;8){</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="motion__est_8c.html#a6d27971967536143702e3f8e23e71b32">h263_mv4_search</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, mx, my, <a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>) &lt; INT_MAX)</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                mb_type|=<a class="code" href="mpegutils_8h.html#ac5b3437f815e738d56f4e61515500323">CANDIDATE_MB_TYPE_INTER4V</a>;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160; </div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;            <a class="code" href="motion__est_8c.html#a5022bf1a3af5defbb33270233241c2e7">set_p_mv_tables</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, mx, my, 0);</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        }<span class="keywordflow">else</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            <a class="code" href="motion__est_8c.html#a5022bf1a3af5defbb33270233241c2e7">set_p_mv_tables</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, mx, my, 1);</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;avctx-&gt;flags &amp; <a class="code" href="group__lavc__core.html#ga936c6ae1b3d24d7504f0a9aea1a24c74">AV_CODEC_FLAG_INTERLACED_ME</a>)</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;           &amp;&amp; !<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;skip){ <span class="comment">//FIXME varc/d checks</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="motion__est_8c.html#a5f0418ef58399e169aa9383dd4d0b80c">interlaced_search</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, 0, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;p_field_mv_table, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;p_field_select_table, mx, my, 0) &lt; INT_MAX)</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                mb_type |= <a class="code" href="mpegutils_8h.html#a3a8c485ab75c9815487bca56b8b2947a">CANDIDATE_MB_TYPE_INTER_I</a>;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        }</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        <span class="keywordtype">int</span> intra_score, <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        mb_type= <a class="code" href="mpegutils_8h.html#a660a22ba325af570369879cb392d3d21">CANDIDATE_MB_TYPE_INTER</a>;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160; </div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        dmin= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;sub_motion_search(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, &amp;mx, &amp;my, dmin, 0, 0, 0, 16);</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;me_sub_cmp != <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;mb_cmp &amp;&amp; !<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;skip)</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;            dmin= <a class="code" href="motion__est__template_8c.html#a754506c51e164526d8160ebfb3afc96b">get_mb_score</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, mx, my, 0, 0, 0, 16, 1);</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160; </div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;avctx-&gt;flags &amp; <a class="code" href="group__lavc__core.html#gac66356d3e9a7ae8b2b29e14402367649">AV_CODEC_FLAG_4MV</a>)</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;           &amp;&amp; !<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;skip &amp;&amp; varc&gt;50&lt;&lt;8 &amp;&amp; vard&gt;10&lt;&lt;8){</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;            <span class="keywordtype">int</span> dmin4= <a class="code" href="motion__est_8c.html#a6d27971967536143702e3f8e23e71b32">h263_mv4_search</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, mx, my, <a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;            <span class="keywordflow">if</span>(dmin4 &lt; dmin){</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                mb_type= <a class="code" href="mpegutils_8h.html#ac5b3437f815e738d56f4e61515500323">CANDIDATE_MB_TYPE_INTER4V</a>;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                dmin=dmin4;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;            }</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        }</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;avctx-&gt;flags &amp; <a class="code" href="group__lavc__core.html#ga936c6ae1b3d24d7504f0a9aea1a24c74">AV_CODEC_FLAG_INTERLACED_ME</a>)</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;           &amp;&amp; !<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;skip){ <span class="comment">//FIXME varc/d checks</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;            <span class="keywordtype">int</span> dmin_i= <a class="code" href="motion__est_8c.html#a5f0418ef58399e169aa9383dd4d0b80c">interlaced_search</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, 0, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;p_field_mv_table, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;p_field_select_table, mx, my, 0);</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            <span class="keywordflow">if</span>(dmin_i &lt; dmin){</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                mb_type = <a class="code" href="mpegutils_8h.html#a3a8c485ab75c9815487bca56b8b2947a">CANDIDATE_MB_TYPE_INTER_I</a>;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                dmin= dmin_i;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;            }</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        }</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160; </div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;        <a class="code" href="motion__est_8c.html#a5022bf1a3af5defbb33270233241c2e7">set_p_mv_tables</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, mx, my, mb_type!=<a class="code" href="mpegutils_8h.html#ac5b3437f815e738d56f4e61515500323">CANDIDATE_MB_TYPE_INTER4V</a>);</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160; </div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        <span class="comment">/* get intra luma score */</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;        <span class="keywordflow">if</span>((<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;mb_cmp&amp;0xFF)==<a class="code" href="avcodec_8h.html#a08cc824c6da624325be6c0a48561729e">FF_CMP_SSE</a>){</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;            intra_score= varc - 500;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;            <span class="keywordtype">unsigned</span> mean = (sum+128)&gt;&gt;8;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;            mean*= 0x01010101;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160; </div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;16; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++){</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                *(uint32_t*)(&amp;<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;scratchpad[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;linesize+ 0]) = mean;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                *(uint32_t*)(&amp;<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;scratchpad[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;linesize+ 4]) = mean;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                *(uint32_t*)(&amp;<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;scratchpad[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;linesize+ 8]) = mean;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                *(uint32_t*)(&amp;<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;scratchpad[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;linesize+12]) = mean;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;            }</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160; </div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;            intra_score= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mecc.mb_cmp[0](<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;scratchpad, pix, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;linesize, 16);</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        }</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        intra_score += <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;mb_penalty_factor*16 + <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;intra_penalty;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160; </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        <span class="keywordflow">if</span>(intra_score &lt; dmin){</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;            mb_type= <a class="code" href="mpegutils_8h.html#a0628ca7c41ad229d1786fd2ccddd0ed8">CANDIDATE_MB_TYPE_INTRA</a>;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;            <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture.mb_type[mb_y*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_stride + mb_x] = <a class="code" href="mpegutils_8h.html#a0628ca7c41ad229d1786fd2ccddd0ed8">CANDIDATE_MB_TYPE_INTRA</a>; <span class="comment">//FIXME cleanup</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        }<span class="keywordflow">else</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;            <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture.mb_type[mb_y*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_stride + mb_x] = 0;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160; </div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        {</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;            <span class="keywordtype">int</span> p_score= <a class="code" href="common_8h.html#a0f84cbd7fd810cd678157c98cbfad4b0">FFMIN</a>(vard, varc-500+(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;lambda2&gt;&gt;<a class="code" href="group__lavu__enc.html#ga979d8e4b4947c924436fcc3b62cafea7">FF_LAMBDA_SHIFT</a>)*100);</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;            <span class="keywordtype">int</span> i_score= varc-500+(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;lambda2&gt;&gt;<a class="code" href="group__lavu__enc.html#ga979d8e4b4947c924436fcc3b62cafea7">FF_LAMBDA_SHIFT</a>)*20;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;            <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;scene_change_score+= <a class="code" href="mathops_8h.html#a7d92df17cf51f763cbd29c1bea3436dc">ff_sqrt</a>(p_score) - <a class="code" href="mathops_8h.html#a7d92df17cf51f763cbd29c1bea3436dc">ff_sqrt</a>(i_score);</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        }</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    }</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160; </div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_type[mb_y*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_stride + mb_x]= mb_type;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;}</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160; </div>
<div class="line"><a name="l01061"></a><span class="lineno"><a class="line" href="motion__est_8h.html#a72fe598edd846c328ac9e91568bb2207"> 1061</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="motion__est_8c.html#a9c2bbf5027cde81a350968b13c82d698">ff_pre_estimate_p_frame_motion</a>(<a class="code" href="struct_mpeg_enc_context.html">MpegEncContext</a> * <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>,</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                                    <span class="keywordtype">int</span> mb_x, <span class="keywordtype">int</span> mb_y)</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;{</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <a class="code" href="struct_motion_est_context.html">MotionEstContext</a> * <span class="keyword">const</span> <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>= &amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;me;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    <span class="keywordtype">int</span> mx, my, dmin;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="mpegaudioenc__template_8c.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[10][2];</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>= 1+<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;quarter_sample;</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> xy= mb_x + mb_y*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_stride;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <a class="code" href="motion__est_8c.html#a4fb3984ec1e5fa4ef18d3aec973394f6">init_ref</a>(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;new_picture.f-&gt;data, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;last_picture.f-&gt;data, <a class="code" href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 16*mb_x, 16*mb_y, 0);</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160; </div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <a class="code" href="avassert_8h.html#aae204192396f78cc8c5cd7ad5c57c23f">av_assert0</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;quarter_sample==0 || <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;quarter_sample==1);</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160; </div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;pre_penalty_factor    = <a class="code" href="motion__est_8c.html#a298213d16c81aa33a67382490e43c975">get_penalty_factor</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;lambda, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;lambda2, <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;me_pre_cmp);</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;current_mv_penalty= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;mv_penalty[<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;f_code] + <a class="code" href="motion__est_8h.html#aff5e63cbe9a89f209f562aa9a846c7ab">MAX_DMV</a>;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160; </div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <a class="code" href="motion__est_8c.html#a8291c1722da711c174d2a08f04f86109">get_limits</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, 16*mb_x, 16*mb_y);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;skip=0;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160; </div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[0]       = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;p_mv_table[xy + 1][0];</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[1]       = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;p_mv_table[xy + 1][1];</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160; </div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[0]       &lt; (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmin&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>)) <a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[0]       = (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmin&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>);</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160; </div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <span class="comment">/* special case for first line */</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;first_slice_line) {</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;pred_x= <a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[0];</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;pred_y= <a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[1];</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        <a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[0]= <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[0]= <a class="code" href="motion__est_8c.html#a68d7a1b5a5e7aa7cb4a42f893b3cfc57">P_MEDIAN</a>[0]=</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        <a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[1]= <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[1]= <a class="code" href="motion__est_8c.html#a68d7a1b5a5e7aa7cb4a42f893b3cfc57">P_MEDIAN</a>[1]= 0; <span class="comment">//FIXME</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        <a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[0]      = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;p_mv_table[xy + <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_stride    ][0];</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        <a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[1]      = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;p_mv_table[xy + <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_stride    ][1];</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;        <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[0] = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;p_mv_table[xy + <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_stride - 1][0];</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[1] = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;p_mv_table[xy + <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_stride - 1][1];</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[1]      &lt; (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymin&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>)) <a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[1]     = (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymin&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>);</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[0] &gt; (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmax&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>)) <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[0]= (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmax&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>);</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[1] &lt; (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymin&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>)) <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[1]= (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymin&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>);</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160; </div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        <a class="code" href="motion__est_8c.html#a68d7a1b5a5e7aa7cb4a42f893b3cfc57">P_MEDIAN</a>[0]= <a class="code" href="mathops_8h.html#a6948a24017ba60d76640f7587429a9f6">mid_pred</a>(<a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[0], <a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[0], <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[0]);</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        <a class="code" href="motion__est_8c.html#a68d7a1b5a5e7aa7cb4a42f893b3cfc57">P_MEDIAN</a>[1]= <a class="code" href="mathops_8h.html#a6948a24017ba60d76640f7587429a9f6">mid_pred</a>(<a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[1], <a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[1], <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[1]);</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160; </div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;pred_x = <a class="code" href="motion__est_8c.html#a68d7a1b5a5e7aa7cb4a42f893b3cfc57">P_MEDIAN</a>[0];</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;pred_y = <a class="code" href="motion__est_8c.html#a68d7a1b5a5e7aa7cb4a42f893b3cfc57">P_MEDIAN</a>[1];</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    }</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160; </div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    dmin = <a class="code" href="motion__est_8h.html#a55c27d33d3ab1c93c0baa2923a85ff74">ff_epzs_motion_search</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, &amp;mx, &amp;my, <a class="code" href="mpegaudioenc__template_8c.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>, 0, 0, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;p_mv_table, (1&lt;&lt;16)&gt;&gt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>, 0, 16);</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160; </div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;p_mv_table[xy][0] = mx&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>;</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;p_mv_table[xy][1] = my&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160; </div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <span class="keywordflow">return</span> dmin;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;}</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160; </div>
<div class="line"><a name="l01114"></a><span class="lineno"><a class="line" href="motion__est_8c.html#a3b5b6bf22c2f7bac4e28094de2a47e64"> 1114</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="motion__est_8c.html#a3b5b6bf22c2f7bac4e28094de2a47e64">estimate_motion_b</a>(<a class="code" href="struct_mpeg_enc_context.html">MpegEncContext</a> *<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, <span class="keywordtype">int</span> mb_x, <span class="keywordtype">int</span> mb_y,</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                             int16_t (*mv_table)[2], <span class="keywordtype">int</span> ref_index, <span class="keywordtype">int</span> f_code)</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;{</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <a class="code" href="struct_motion_est_context.html">MotionEstContext</a> * <span class="keyword">const</span> <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>= &amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;me;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <span class="keywordtype">int</span> mx = 0, my = 0, dmin = 0;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="mpegaudioenc__template_8c.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[10][2];</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>= 1+<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;quarter_sample;</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> mot_stride = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_stride;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> mot_xy = mb_y*mot_stride + mb_x;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> * <span class="keyword">const</span> <a class="code" href="ituh263enc_8c.html#a35869db1e130a4cf46dc9163cb194531">mv_penalty</a>= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;mv_penalty[f_code] + <a class="code" href="motion__est_8h.html#aff5e63cbe9a89f209f562aa9a846c7ab">MAX_DMV</a>;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="hevc__mvs_8c.html#a8ed92cefaaf458a85c494202a6b32409">mv_scale</a>;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160; </div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;penalty_factor    = <a class="code" href="motion__est_8c.html#a298213d16c81aa33a67382490e43c975">get_penalty_factor</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;lambda, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;lambda2, <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;me_cmp);</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;sub_penalty_factor= <a class="code" href="motion__est_8c.html#a298213d16c81aa33a67382490e43c975">get_penalty_factor</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;lambda, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;lambda2, <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;me_sub_cmp);</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;mb_penalty_factor = <a class="code" href="motion__est_8c.html#a298213d16c81aa33a67382490e43c975">get_penalty_factor</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;lambda, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;lambda2, <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;mb_cmp);</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;current_mv_penalty= <a class="code" href="ituh263enc_8c.html#a35869db1e130a4cf46dc9163cb194531">mv_penalty</a>;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160; </div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    <a class="code" href="motion__est_8c.html#a8291c1722da711c174d2a08f04f86109">get_limits</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, 16*mb_x, 16*mb_y);</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160; </div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;motion_est != <a class="code" href="motion__est_8h.html#ae990b594d112ea5fd0574106cd9a0491">FF_ME_ZERO</a>) {</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        <a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[0] = mv_table[mot_xy - 1][0];</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;        <a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[1] = mv_table[mot_xy - 1][1];</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160; </div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[0] &gt; (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmax &lt;&lt; <a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>)) <a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[0] = (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmax &lt;&lt; <a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>);</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160; </div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        <span class="comment">/* special case for first line */</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;first_slice_line) {</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;            <a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[0]      = mv_table[mot_xy - mot_stride    ][0];</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;            <a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[1]      = mv_table[mot_xy - mot_stride    ][1];</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;            <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[0] = mv_table[mot_xy - mot_stride + 1][0];</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;            <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[1] = mv_table[mot_xy - mot_stride + 1][1];</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[1] &gt; (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymax &lt;&lt; <a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>)) <a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[1] = (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymax &lt;&lt; <a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>);</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[0] &lt; (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmin &lt;&lt; <a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>)) <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[0] = (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmin &lt;&lt; <a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>);</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[1] &gt; (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymax &lt;&lt; <a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>)) <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[1] = (<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymax &lt;&lt; <a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>);</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160; </div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;            <a class="code" href="motion__est_8c.html#a68d7a1b5a5e7aa7cb4a42f893b3cfc57">P_MEDIAN</a>[0] = <a class="code" href="mathops_8h.html#a6948a24017ba60d76640f7587429a9f6">mid_pred</a>(<a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[0], <a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[0], <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[0]);</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;            <a class="code" href="motion__est_8c.html#a68d7a1b5a5e7aa7cb4a42f893b3cfc57">P_MEDIAN</a>[1] = <a class="code" href="mathops_8h.html#a6948a24017ba60d76640f7587429a9f6">mid_pred</a>(<a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[1], <a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[1], <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[1]);</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;        }</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;pred_x = <a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[0];</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;pred_y = <a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[1];</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160; </div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;        <span class="keywordflow">if</span>(mv_table == <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_forw_mv_table){</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;            <a class="code" href="hevc__mvs_8c.html#a8ed92cefaaf458a85c494202a6b32409">mv_scale</a>= (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;pb_time&lt;&lt;16) / (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;pp_time&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>);</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;        }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;            <a class="code" href="hevc__mvs_8c.html#a8ed92cefaaf458a85c494202a6b32409">mv_scale</a>= ((<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;pb_time - <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;pp_time)&lt;&lt;16) / (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;pp_time&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>);</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;        }</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160; </div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        dmin = <a class="code" href="motion__est_8h.html#a55c27d33d3ab1c93c0baa2923a85ff74">ff_epzs_motion_search</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, &amp;mx, &amp;my, <a class="code" href="mpegaudioenc__template_8c.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>, 0, ref_index, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;p_mv_table, <a class="code" href="hevc__mvs_8c.html#a8ed92cefaaf458a85c494202a6b32409">mv_scale</a>, 0, 16);</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    }</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160; </div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    dmin= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;sub_motion_search(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, &amp;mx, &amp;my, dmin, 0, ref_index, 0, 16);</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160; </div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;me_sub_cmp != <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;mb_cmp &amp;&amp; !<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;skip)</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;        dmin= <a class="code" href="motion__est__template_8c.html#a754506c51e164526d8160ebfb3afc96b">get_mb_score</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, mx, my, 0, ref_index, 0, 16, 1);</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160; </div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="comment">//    s-&gt;mb_type[mb_y*s-&gt;mb_width + mb_x]= mb_type;</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    mv_table[mot_xy][0]= mx;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    mv_table[mot_xy][1]= my;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160; </div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="keywordflow">return</span> dmin;</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;}</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160; </div>
<div class="line"><a name="l01176"></a><span class="lineno"><a class="line" href="motion__est_8c.html#a8dac5469cef1b1fe735f72db3302e8e3"> 1176</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="motion__est_8c.html#a8dac5469cef1b1fe735f72db3302e8e3">check_bidir_mv</a>(<a class="code" href="struct_mpeg_enc_context.html">MpegEncContext</a> * <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>,</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                   <span class="keywordtype">int</span> motion_fx, <span class="keywordtype">int</span> motion_fy,</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                   <span class="keywordtype">int</span> motion_bx, <span class="keywordtype">int</span> motion_by,</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                   <span class="keywordtype">int</span> pred_fx, <span class="keywordtype">int</span> pred_fy,</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                   <span class="keywordtype">int</span> pred_bx, <span class="keywordtype">int</span> pred_by,</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                   <span class="keywordtype">int</span> <a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>, <span class="keywordtype">int</span> <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>)</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;{</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <span class="comment">//FIXME optimize?</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <span class="comment">//FIXME better f_code prediction (max mv &amp; distance)</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <span class="comment">//FIXME pointers</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <a class="code" href="struct_motion_est_context.html">MotionEstContext</a> * <span class="keyword">const</span> <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>= &amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;me;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> * <span class="keyword">const</span> mv_penalty_f= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;mv_penalty[<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;f_code] + <a class="code" href="motion__est_8h.html#aff5e63cbe9a89f209f562aa9a846c7ab">MAX_DMV</a>; <span class="comment">// f_code of the prev frame</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> * <span class="keyword">const</span> mv_penalty_b= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;mv_penalty[<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_code] + <a class="code" href="motion__est_8h.html#aff5e63cbe9a89f209f562aa9a846c7ab">MAX_DMV</a>; <span class="comment">// f_code of the prev frame</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;stride;</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *dest_y = <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;scratchpad;</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *ptr;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    <span class="keywordtype">int</span> dxy;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <span class="keywordtype">int</span> src_x, src_y;</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="keywordtype">int</span> fbmin;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> **src_data= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;src[0];</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> **ref_data= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ref[0];</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> **ref2_data= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ref[2];</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160; </div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;quarter_sample){</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;        dxy = ((motion_fy &amp; 3) &lt;&lt; 2) | (motion_fx &amp; 3);</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        src_x = motion_fx &gt;&gt; 2;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        src_y = motion_fy &gt;&gt; 2;</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160; </div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;        ptr = ref_data[0] + (src_y * <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>) + src_x;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;        <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;qdsp.put_qpel_pixels_tab[0][dxy](dest_y, ptr, <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>);</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160; </div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        dxy = ((motion_by &amp; 3) &lt;&lt; 2) | (motion_bx &amp; 3);</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        src_x = motion_bx &gt;&gt; 2;</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        src_y = motion_by &gt;&gt; 2;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160; </div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;        ptr = ref2_data[0] + (src_y * <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>) + src_x;</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;qdsp.avg_qpel_pixels_tab[<a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>][dxy](dest_y, ptr, <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>);</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        dxy = ((motion_fy &amp; 1) &lt;&lt; 1) | (motion_fx &amp; 1);</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        src_x = motion_fx &gt;&gt; 1;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;        src_y = motion_fy &gt;&gt; 1;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160; </div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        ptr = ref_data[0] + (src_y * <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>) + src_x;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;        <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;hdsp.put_pixels_tab[<a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>][dxy](dest_y    , ptr    , <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>);</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160; </div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        dxy = ((motion_by &amp; 1) &lt;&lt; 1) | (motion_bx &amp; 1);</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;        src_x = motion_bx &gt;&gt; 1;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;        src_y = motion_by &gt;&gt; 1;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160; </div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        ptr = ref2_data[0] + (src_y * <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>) + src_x;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;hdsp.avg_pixels_tab[<a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>][dxy](dest_y    , ptr    , <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>);</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    }</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160; </div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    fbmin = (mv_penalty_f[motion_fx-pred_fx] + mv_penalty_f[motion_fy-pred_fy])*<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;mb_penalty_factor</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;           +(mv_penalty_b[motion_bx-pred_bx] + mv_penalty_b[motion_by-pred_by])*<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;mb_penalty_factor</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;           + <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mecc.mb_cmp[<a class="code" href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a>](<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, src_data[0], dest_y, <a class="code" href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>, <a class="code" href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a>); <span class="comment">// FIXME new_pic</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160; </div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;mb_cmp&amp;<a class="code" href="avcodec_8h.html#a265e91f6d00ad75d918bedccfeedd08a">FF_CMP_CHROMA</a>){</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    }</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    <span class="comment">//FIXME CHROMA !!!</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160; </div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="keywordflow">return</span> fbmin;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;}</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160; </div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;<span class="comment">/* refine the bidir vectors in hq mode and return the score in both lq &amp; hq mode*/</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"><a class="line" href="motion__est_8c.html#aae0d3379c290082fb581db00fbd3bb1e"> 1241</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="motion__est_8c.html#aae0d3379c290082fb581db00fbd3bb1e">bidir_refine</a>(<a class="code" href="struct_mpeg_enc_context.html">MpegEncContext</a> * <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, <span class="keywordtype">int</span> mb_x, <span class="keywordtype">int</span> mb_y)</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;{</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <a class="code" href="struct_motion_est_context.html">MotionEstContext</a> * <span class="keyword">const</span> <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>= &amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;me;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> mot_stride = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_stride;</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> xy = mb_y *mot_stride + mb_x;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="keywordtype">int</span> fbmin;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="keywordtype">int</span> pred_fx= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_bidir_forw_mv_table[xy-1][0];</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    <span class="keywordtype">int</span> pred_fy= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_bidir_forw_mv_table[xy-1][1];</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    <span class="keywordtype">int</span> pred_bx= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_bidir_back_mv_table[xy-1][0];</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    <span class="keywordtype">int</span> pred_by= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_bidir_back_mv_table[xy-1][1];</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    <span class="keywordtype">int</span> motion_fx= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_bidir_forw_mv_table[xy][0]= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_forw_mv_table[xy][0];</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <span class="keywordtype">int</span> motion_fy= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_bidir_forw_mv_table[xy][1]= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_forw_mv_table[xy][1];</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    <span class="keywordtype">int</span> motion_bx= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_bidir_back_mv_table[xy][0]= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_back_mv_table[xy][0];</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <span class="keywordtype">int</span> motion_by= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_bidir_back_mv_table[xy][1]= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_back_mv_table[xy][1];</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;sub_flags;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> qpel= <a class="code" href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a>&amp;<a class="code" href="motion__est_8c.html#aa24c5a6ce7cbb044271633d20a7b7a36">FLAG_QPEL</a>;</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>= 1+qpel;</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> xmin= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmin&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> ymin= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymin&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> xmax= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmax&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> ymax= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymax&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="preprocessor">#define HASH(fx,fy,bx,by) ((fx)+17*(fy)+63*(bx)+117*(by))</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="preprocessor">#define HASH8(fx,fy,bx,by) ((uint8_t)HASH(fx,fy,bx,by))</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    <span class="keywordtype">int</span> hashidx= <a class="code" href="motion__est_8c.html#a9e27a3952c14e8c97b71028756924090">HASH</a>(motion_fx,motion_fy, motion_bx, motion_by);</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> <a class="code" href="hwcontext__vdpau_8c.html#a2996cc16b36e13c9010705bad768e866">map</a>[256] = { 0 };</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160; </div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    <a class="code" href="hwcontext__vdpau_8c.html#a2996cc16b36e13c9010705bad768e866">map</a>[hashidx&amp;255] = 1;</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160; </div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    fbmin= <a class="code" href="motion__est_8c.html#a8dac5469cef1b1fe735f72db3302e8e3">check_bidir_mv</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, motion_fx, motion_fy,</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                          motion_bx, motion_by,</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                          pred_fx, pred_fy,</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                          pred_bx, pred_by,</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                          0, 16);</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160; </div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;avctx-&gt;bidir_refine){</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="avrndec_8c.html#a13191ba45577b1d4f9b37d64df91eb55">end</a>;</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;        <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> limittab[5]={0,8,32,64,80};</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> limit= limittab[<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;avctx-&gt;bidir_refine];</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;        <span class="keyword">static</span> <span class="keyword">const</span> int8_t vect[][4]={</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;{ 0, 0, 0, 1}, { 0, 0, 0,-1}, { 0, 0, 1, 0}, { 0, 0,-1, 0}, { 0, 1, 0, 0}, { 0,-1, 0, 0}, { 1, 0, 0, 0}, {-1, 0, 0, 0},</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160; </div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;{ 0, 0, 1, 1}, { 0, 0,-1,-1}, { 0, 1, 1, 0}, { 0,-1,-1, 0}, { 1, 1, 0, 0}, {-1,-1, 0, 0}, { 1, 0, 0, 1}, {-1, 0, 0,-1},</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;{ 0, 1, 0, 1}, { 0,-1, 0,-1}, { 1, 0, 1, 0}, {-1, 0,-1, 0},</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;{ 0, 0,-1, 1}, { 0, 0, 1,-1}, { 0,-1, 1, 0}, { 0, 1,-1, 0}, {-1, 1, 0, 0}, { 1,-1, 0, 0}, { 1, 0, 0,-1}, {-1, 0, 0, 1},</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;{ 0,-1, 0, 1}, { 0, 1, 0,-1}, {-1, 0, 1, 0}, { 1, 0,-1, 0},</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160; </div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;{ 0, 1, 1, 1}, { 0,-1,-1,-1}, { 1, 1, 1, 0}, {-1,-1,-1, 0}, { 1, 1, 0, 1}, {-1,-1, 0,-1}, { 1, 0, 1, 1}, {-1, 0,-1,-1},</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;{ 0,-1, 1, 1}, { 0, 1,-1,-1}, {-1, 1, 1, 0}, { 1,-1,-1, 0}, { 1, 1, 0,-1}, {-1,-1, 0, 1}, { 1, 0,-1, 1}, {-1, 0, 1,-1},</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;{ 0, 1,-1, 1}, { 0,-1, 1,-1}, { 1,-1, 1, 0}, {-1, 1,-1, 0}, {-1, 1, 0, 1}, { 1,-1, 0,-1}, { 1, 0, 1,-1}, {-1, 0,-1, 1},</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;{ 0, 1, 1,-1}, { 0,-1,-1, 1}, { 1, 1,-1, 0}, {-1,-1, 1, 0}, { 1,-1, 0, 1}, {-1, 1, 0,-1}, {-1, 0, 1, 1}, { 1, 0,-1,-1},</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160; </div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;{ 1, 1, 1, 1}, {-1,-1,-1,-1},</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;{ 1, 1, 1,-1}, {-1,-1,-1, 1}, { 1, 1,-1, 1}, {-1,-1, 1,-1}, { 1,-1, 1, 1}, {-1, 1,-1,-1}, {-1, 1, 1, 1}, { 1,-1,-1,-1},</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;{ 1, 1,-1,-1}, {-1,-1, 1, 1}, { 1,-1,-1, 1}, {-1, 1, 1,-1}, { 1,-1, 1,-1}, {-1, 1,-1, 1},</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        };</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;        <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> <a class="code" href="tests_2movenc_8c.html#a8509848f135e0b5f310c969a6c5344ec">hash</a>[]={</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 0, 0, 0, 1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 0, 0, 0,-1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 0, 0, 1, 0), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 0, 0,-1, 0), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 0, 1, 0, 0), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 0,-1, 0, 0), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 1, 0, 0, 0), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>(-1, 0, 0, 0),</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160; </div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;<a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 0, 0, 1, 1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 0, 0,-1,-1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 0, 1, 1, 0), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 0,-1,-1, 0), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 1, 1, 0, 0), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>(-1,-1, 0, 0), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 1, 0, 0, 1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>(-1, 0, 0,-1),</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;<a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 0, 1, 0, 1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 0,-1, 0,-1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 1, 0, 1, 0), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>(-1, 0,-1, 0),</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 0, 0,-1, 1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 0, 0, 1,-1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 0,-1, 1, 0), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 0, 1,-1, 0), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>(-1, 1, 0, 0), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 1,-1, 0, 0), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 1, 0, 0,-1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>(-1, 0, 0, 1),</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;<a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 0,-1, 0, 1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 0, 1, 0,-1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>(-1, 0, 1, 0), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 1, 0,-1, 0),</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160; </div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;<a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 0, 1, 1, 1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 0,-1,-1,-1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 1, 1, 1, 0), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>(-1,-1,-1, 0), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 1, 1, 0, 1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>(-1,-1, 0,-1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 1, 0, 1, 1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>(-1, 0,-1,-1),</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;<a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 0,-1, 1, 1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 0, 1,-1,-1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>(-1, 1, 1, 0), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 1,-1,-1, 0), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 1, 1, 0,-1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>(-1,-1, 0, 1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 1, 0,-1, 1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>(-1, 0, 1,-1),</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 0, 1,-1, 1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 0,-1, 1,-1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 1,-1, 1, 0), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>(-1, 1,-1, 0), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>(-1, 1, 0, 1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 1,-1, 0,-1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 1, 0, 1,-1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>(-1, 0,-1, 1),</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;<a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 0, 1, 1,-1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 0,-1,-1, 1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 1, 1,-1, 0), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>(-1,-1, 1, 0), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 1,-1, 0, 1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>(-1, 1, 0,-1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>(-1, 0, 1, 1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 1, 0,-1,-1),</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160; </div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;<a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 1, 1, 1, 1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>(-1,-1,-1,-1),</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;<a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 1, 1, 1,-1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>(-1,-1,-1, 1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 1, 1,-1, 1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>(-1,-1, 1,-1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 1,-1, 1, 1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>(-1, 1,-1,-1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>(-1, 1, 1, 1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 1,-1,-1,-1),</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;<a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 1, 1,-1,-1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>(-1,-1, 1, 1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 1,-1,-1, 1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>(-1, 1, 1,-1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>( 1,-1, 1,-1), <a class="code" href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a>(-1, 1,-1, 1),</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;};</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160; </div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="preprocessor">#define CHECK_BIDIR(fx,fy,bx,by)\</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;<span class="preprocessor">    if( !map[(hashidx+HASH(fx,fy,bx,by))&amp;255]\</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="preprocessor">       &amp;&amp;(fx&lt;=0 || motion_fx+fx&lt;=xmax) &amp;&amp; (fy&lt;=0 || motion_fy+fy&lt;=ymax) &amp;&amp; (bx&lt;=0 || motion_bx+bx&lt;=xmax) &amp;&amp; (by&lt;=0 || motion_by+by&lt;=ymax)\</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;<span class="preprocessor">       &amp;&amp;(fx&gt;=0 || motion_fx+fx&gt;=xmin) &amp;&amp; (fy&gt;=0 || motion_fy+fy&gt;=ymin) &amp;&amp; (bx&gt;=0 || motion_bx+bx&gt;=xmin) &amp;&amp; (by&gt;=0 || motion_by+by&gt;=ymin)){\</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;<span class="preprocessor">        int score;\</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;<span class="preprocessor">        map[(hashidx+HASH(fx,fy,bx,by))&amp;255] = 1;\</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;<span class="preprocessor">        score= check_bidir_mv(s, motion_fx+fx, motion_fy+fy, motion_bx+bx, motion_by+by, pred_fx, pred_fy, pred_bx, pred_by, 0, 16);\</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="preprocessor">        if(score &lt; fbmin){\</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;<span class="preprocessor">            hashidx += HASH(fx,fy,bx,by);\</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;<span class="preprocessor">            fbmin= score;\</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;<span class="preprocessor">            motion_fx+=fx;\</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;<span class="preprocessor">            motion_fy+=fy;\</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;<span class="preprocessor">            motion_bx+=bx;\</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;<span class="preprocessor">            motion_by+=by;\</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;<span class="preprocessor">            end=0;\</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;<span class="preprocessor">        }\</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;<span class="preprocessor">    }</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;<span class="preprocessor">#define CHECK_BIDIR2(a,b,c,d)\</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="preprocessor">CHECK_BIDIR(a,b,c,d)\</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="preprocessor">CHECK_BIDIR(-(a),-(b),-(c),-(d))</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160; </div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;        <span class="keywordflow">do</span>{</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;            <span class="keywordtype">int</span> borderdist=0;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;            <a class="code" href="avrndec_8c.html#a13191ba45577b1d4f9b37d64df91eb55">end</a>=1;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160; </div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;            <a class="code" href="motion__est_8c.html#a955e0bcc00eb62a789e71ac08020cc63">CHECK_BIDIR2</a>(0,0,0,1)</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;            <a class="code" href="motion__est_8c.html#a955e0bcc00eb62a789e71ac08020cc63">CHECK_BIDIR2</a>(0,0,1,0)</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;            <a class="code" href="motion__est_8c.html#a955e0bcc00eb62a789e71ac08020cc63">CHECK_BIDIR2</a>(0,1,0,0)</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;            <a class="code" href="motion__est_8c.html#a955e0bcc00eb62a789e71ac08020cc63">CHECK_BIDIR2</a>(1,0,0,0)</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160; </div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>=8; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;limit; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++){</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                <span class="keywordtype">int</span> fx= motion_fx+vect[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][0];</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                <span class="keywordtype">int</span> fy= motion_fy+vect[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][1];</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                <span class="keywordtype">int</span> bx= motion_bx+vect[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][2];</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                <span class="keywordtype">int</span> by= motion_by+vect[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][3];</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                <span class="keywordflow">if</span>(borderdist&lt;=0){</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                    <span class="keywordtype">int</span> <a class="code" href="undefined_8txt.html#ad99f336d4c117c453fef82993434eb4d">a</a>= (xmax - <a class="code" href="common_8h.html#a9960bd6780a9b16a216a57be1ee04359">FFMAX</a>(fx,bx))|(<a class="code" href="common_8h.html#a0f84cbd7fd810cd678157c98cbfad4b0">FFMIN</a>(fx,bx) - xmin);</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                    <span class="keywordtype">int</span> <a class="code" href="input_8c.html#ad6cdb6a14abe3eab42eaaadc93409aec">b</a>= (ymax - <a class="code" href="common_8h.html#a9960bd6780a9b16a216a57be1ee04359">FFMAX</a>(fy,by))|(<a class="code" href="common_8h.html#a0f84cbd7fd810cd678157c98cbfad4b0">FFMIN</a>(fy,by) - ymin);</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                    <span class="keywordflow">if</span>((<a class="code" href="undefined_8txt.html#ad99f336d4c117c453fef82993434eb4d">a</a>|<a class="code" href="input_8c.html#ad6cdb6a14abe3eab42eaaadc93409aec">b</a>) &lt; 0)</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                        <a class="code" href="hwcontext__vdpau_8c.html#a2996cc16b36e13c9010705bad768e866">map</a>[(hashidx+<a class="code" href="tests_2movenc_8c.html#a8509848f135e0b5f310c969a6c5344ec">hash</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>])&amp;255] = 1;</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;                }</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                <span class="keywordflow">if</span>(!<a class="code" href="hwcontext__vdpau_8c.html#a2996cc16b36e13c9010705bad768e866">map</a>[(hashidx+<a class="code" href="tests_2movenc_8c.html#a8509848f135e0b5f310c969a6c5344ec">hash</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>])&amp;255]){</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;                    <span class="keywordtype">int</span> score;</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;                    <a class="code" href="hwcontext__vdpau_8c.html#a2996cc16b36e13c9010705bad768e866">map</a>[(hashidx+<a class="code" href="tests_2movenc_8c.html#a8509848f135e0b5f310c969a6c5344ec">hash</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>])&amp;255] = 1;</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                    score= <a class="code" href="motion__est_8c.html#a8dac5469cef1b1fe735f72db3302e8e3">check_bidir_mv</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, fx, fy, bx, by, pred_fx, pred_fy, pred_bx, pred_by, 0, 16);</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                    <span class="keywordflow">if</span>(score &lt; fbmin){</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                        hashidx += <a class="code" href="tests_2movenc_8c.html#a8509848f135e0b5f310c969a6c5344ec">hash</a>[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                        fbmin= score;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                        motion_fx=fx;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                        motion_fy=fy;</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                        motion_bx=bx;</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                        motion_by=by;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                        <a class="code" href="avrndec_8c.html#a13191ba45577b1d4f9b37d64df91eb55">end</a>=0;</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                        borderdist--;</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                        <span class="keywordflow">if</span>(borderdist&lt;=0){</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                            <span class="keywordtype">int</span> <a class="code" href="undefined_8txt.html#ad99f336d4c117c453fef82993434eb4d">a</a>= <a class="code" href="common_8h.html#a0f84cbd7fd810cd678157c98cbfad4b0">FFMIN</a>(xmax - <a class="code" href="common_8h.html#a9960bd6780a9b16a216a57be1ee04359">FFMAX</a>(fx,bx), <a class="code" href="common_8h.html#a0f84cbd7fd810cd678157c98cbfad4b0">FFMIN</a>(fx,bx) - xmin);</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;                            <span class="keywordtype">int</span> <a class="code" href="input_8c.html#ad6cdb6a14abe3eab42eaaadc93409aec">b</a>= <a class="code" href="common_8h.html#a0f84cbd7fd810cd678157c98cbfad4b0">FFMIN</a>(ymax - <a class="code" href="common_8h.html#a9960bd6780a9b16a216a57be1ee04359">FFMAX</a>(fy,by), <a class="code" href="common_8h.html#a0f84cbd7fd810cd678157c98cbfad4b0">FFMIN</a>(fy,by) - ymin);</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                            borderdist= <a class="code" href="common_8h.html#a0f84cbd7fd810cd678157c98cbfad4b0">FFMIN</a>(<a class="code" href="undefined_8txt.html#ad99f336d4c117c453fef82993434eb4d">a</a>,<a class="code" href="input_8c.html#ad6cdb6a14abe3eab42eaaadc93409aec">b</a>);</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                        }</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                    }</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                }</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;            }</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;        }<span class="keywordflow">while</span>(!<a class="code" href="avrndec_8c.html#a13191ba45577b1d4f9b37d64df91eb55">end</a>);</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    }</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160; </div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_bidir_forw_mv_table[xy][0]= motion_fx;</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_bidir_forw_mv_table[xy][1]= motion_fy;</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_bidir_back_mv_table[xy][0]= motion_bx;</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_bidir_back_mv_table[xy][1]= motion_by;</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160; </div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <span class="keywordflow">return</span> fbmin;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;}</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160; </div>
<div class="line"><a name="l01388"></a><span class="lineno"><a class="line" href="motion__est_8c.html#ac1c01a1cce64441fc6c1dae645b68f9b"> 1388</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="motion__est_8c.html#ac1c01a1cce64441fc6c1dae645b68f9b">direct_search</a>(<a class="code" href="struct_mpeg_enc_context.html">MpegEncContext</a> * <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, <span class="keywordtype">int</span> mb_x, <span class="keywordtype">int</span> mb_y)</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;{</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    <a class="code" href="struct_motion_est_context.html">MotionEstContext</a> * <span class="keyword">const</span> <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>= &amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;me;</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="mpegaudioenc__template_8c.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[10][2];</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> mot_stride = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_stride;</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> mot_xy = mb_y*mot_stride + mb_x;</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>= 1+<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;quarter_sample;</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    <span class="keywordtype">int</span> dmin, <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> time_pp= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;pp_time;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> time_pb= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;pb_time;</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    <span class="keywordtype">int</span> mx, my, xmin, xmax, ymin, ymax;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    int16_t (*mv_table)[2]= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_direct_mv_table;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160; </div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;current_mv_penalty= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;mv_penalty[1] + <a class="code" href="motion__est_8h.html#aff5e63cbe9a89f209f562aa9a846c7ab">MAX_DMV</a>;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    ymin= xmin=(-32)&gt;&gt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>;</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    ymax= xmax=   31&gt;&gt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>;</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160; </div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="mpegutils_8h.html#ab8c5b21d0da9f13a58e04abc7c612a70">IS_8X8</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;next_picture.mb_type[mot_xy])) {</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;        <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mv_type= <a class="code" href="mpegvideo_8h.html#a98f9328b4f99d0b6a3974cf441633edf">MV_TYPE_8X8</a>;</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;        <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mv_type= <a class="code" href="mpegvideo_8h.html#ae17ddc0eaf08f5eea9e1d13399f1cb08">MV_TYPE_16X16</a>;</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    }</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160; </div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;4; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++){</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="gxfenc_8c.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;block_index[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="vorbis__enc__data_8h.html#ad2e88d75f808e6d4e78d48bceb10c336">min</a>, <a class="code" href="cuda__runtime_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a>;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160; </div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;co_located_mv[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][0] = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;next_picture.motion_val[0][<a class="code" href="gxfenc_8c.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>][0];</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;co_located_mv[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][1] = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;next_picture.motion_val[0][<a class="code" href="gxfenc_8c.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>][1];</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;direct_basis_mv[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][0]= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;co_located_mv[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][0]*time_pb/time_pp + ((<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>&amp; 1)&lt;&lt;(<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>+3));</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;direct_basis_mv[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][1]= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;co_located_mv[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][1]*time_pb/time_pp + ((<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>&gt;&gt;1)&lt;&lt;(<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>+3));</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="comment">//        c-&gt;direct_basis_mv[1][i][0]= c-&gt;co_located_mv[i][0]*(time_pb - time_pp)/time_pp + ((i &amp;1)&lt;&lt;(shift+3);</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="comment">//        c-&gt;direct_basis_mv[1][i][1]= c-&gt;co_located_mv[i][1]*(time_pb - time_pp)/time_pp + ((i&gt;&gt;1)&lt;&lt;(shift+3);</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160; </div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;        <a class="code" href="cuda__runtime_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a>= <a class="code" href="common_8h.html#a9960bd6780a9b16a216a57be1ee04359">FFMAX</a>(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;direct_basis_mv[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][0], <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;direct_basis_mv[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][0] - <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;co_located_mv[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][0])&gt;&gt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;        <a class="code" href="vorbis__enc__data_8h.html#ad2e88d75f808e6d4e78d48bceb10c336">min</a>= <a class="code" href="common_8h.html#a0f84cbd7fd810cd678157c98cbfad4b0">FFMIN</a>(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;direct_basis_mv[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][0], <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;direct_basis_mv[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][0] - <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;co_located_mv[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][0])&gt;&gt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;        <a class="code" href="cuda__runtime_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a>+= 16*mb_x + 1; <span class="comment">// +-1 is for the simpler rounding</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;        <a class="code" href="vorbis__enc__data_8h.html#ad2e88d75f808e6d4e78d48bceb10c336">min</a>+= 16*mb_x - 1;</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        xmax= <a class="code" href="common_8h.html#a0f84cbd7fd810cd678157c98cbfad4b0">FFMIN</a>(xmax, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;width - <a class="code" href="cuda__runtime_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a>);</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;        xmin= <a class="code" href="common_8h.html#a9960bd6780a9b16a216a57be1ee04359">FFMAX</a>(xmin, - 16     - <a class="code" href="vorbis__enc__data_8h.html#ad2e88d75f808e6d4e78d48bceb10c336">min</a>);</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160; </div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;        <a class="code" href="cuda__runtime_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a>= <a class="code" href="common_8h.html#a9960bd6780a9b16a216a57be1ee04359">FFMAX</a>(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;direct_basis_mv[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][1], <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;direct_basis_mv[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][1] - <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;co_located_mv[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][1])&gt;&gt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;        <a class="code" href="vorbis__enc__data_8h.html#ad2e88d75f808e6d4e78d48bceb10c336">min</a>= <a class="code" href="common_8h.html#a0f84cbd7fd810cd678157c98cbfad4b0">FFMIN</a>(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;direct_basis_mv[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][1], <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;direct_basis_mv[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][1] - <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;co_located_mv[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>][1])&gt;&gt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>;</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        <a class="code" href="cuda__runtime_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a>+= 16*mb_y + 1; <span class="comment">// +-1 is for the simpler rounding</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        <a class="code" href="vorbis__enc__data_8h.html#ad2e88d75f808e6d4e78d48bceb10c336">min</a>+= 16*mb_y - 1;</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        ymax= <a class="code" href="common_8h.html#a0f84cbd7fd810cd678157c98cbfad4b0">FFMIN</a>(ymax, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;height - <a class="code" href="cuda__runtime_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a>);</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        ymin= <a class="code" href="common_8h.html#a9960bd6780a9b16a216a57be1ee04359">FFMAX</a>(ymin, - 16      - <a class="code" href="vorbis__enc__data_8h.html#ad2e88d75f808e6d4e78d48bceb10c336">min</a>);</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160; </div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mv_type == <a class="code" href="mpegvideo_8h.html#ae17ddc0eaf08f5eea9e1d13399f1cb08">MV_TYPE_16X16</a>) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    }</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160; </div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    <a class="code" href="avassert_8h.html#a2764bf422e4df5bf3aac652f21fe780a">av_assert2</a>(xmax &lt;= 15 &amp;&amp; ymax &lt;= 15 &amp;&amp; xmin &gt;= -16 &amp;&amp; ymin &gt;= -16);</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160; </div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <span class="keywordflow">if</span>(xmax &lt; 0 || xmin &gt;0 || ymax &lt; 0 || ymin &gt; 0){</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;        <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_direct_mv_table[mot_xy][0]= 0;</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;        <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_direct_mv_table[mot_xy][1]= 0;</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160; </div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;        <span class="keywordflow">return</span> 256*256*256*64;</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    }</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160; </div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmin= xmin;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymin= ymin;</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;xmax= xmax;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;ymax= ymax;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;flags     |= <a class="code" href="motion__est_8c.html#a8d487dcbee8d1f4d01795a2c5abb43bd">FLAG_DIRECT</a>;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;sub_flags |= <a class="code" href="motion__est_8c.html#a8d487dcbee8d1f4d01795a2c5abb43bd">FLAG_DIRECT</a>;</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;pred_x=0;</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;pred_y=0;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160; </div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    <a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[0]        = av_clip(mv_table[mot_xy - 1][0], xmin&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>, xmax&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>);</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    <a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[1]        = av_clip(mv_table[mot_xy - 1][1], ymin&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>, ymax&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>);</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160; </div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    <span class="comment">/* special case for first line */</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;first_slice_line) { <span class="comment">//FIXME maybe allow this over thread boundary as it is clipped</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;        <a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[0]      = av_clip(mv_table[mot_xy - mot_stride             ][0], xmin&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>, xmax&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>);</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;        <a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[1]      = av_clip(mv_table[mot_xy - mot_stride             ][1], ymin&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>, ymax&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>);</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;        <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[0] = av_clip(mv_table[mot_xy - mot_stride + 1         ][0], xmin&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>, xmax&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>);</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[1] = av_clip(mv_table[mot_xy - mot_stride + 1         ][1], ymin&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>, ymax&lt;&lt;<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>);</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160; </div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;        <a class="code" href="motion__est_8c.html#a68d7a1b5a5e7aa7cb4a42f893b3cfc57">P_MEDIAN</a>[0]= <a class="code" href="mathops_8h.html#a6948a24017ba60d76640f7587429a9f6">mid_pred</a>(<a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[0], <a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[0], <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[0]);</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;        <a class="code" href="motion__est_8c.html#a68d7a1b5a5e7aa7cb4a42f893b3cfc57">P_MEDIAN</a>[1]= <a class="code" href="mathops_8h.html#a6948a24017ba60d76640f7587429a9f6">mid_pred</a>(<a class="code" href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a>[1], <a class="code" href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a>[1], <a class="code" href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a>[1]);</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    }</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160; </div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    dmin = <a class="code" href="motion__est_8h.html#a55c27d33d3ab1c93c0baa2923a85ff74">ff_epzs_motion_search</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, &amp;mx, &amp;my, <a class="code" href="mpegaudioenc__template_8c.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>, 0, 0, mv_table, 1&lt;&lt;(16-<a class="code" href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a>), 0, 16);</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;sub_flags&amp;<a class="code" href="motion__est_8c.html#aa24c5a6ce7cbb044271633d20a7b7a36">FLAG_QPEL</a>)</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;        dmin = <a class="code" href="motion__est__template_8c.html#a8c691b507e22d7d56ccc60d7bee24493">qpel_motion_search</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, &amp;mx, &amp;my, dmin, 0, 0, 0, 16);</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;        dmin = <a class="code" href="motion__est__template_8c.html#a6c3ca8691cc7091a5c12fb4deb648c01">hpel_motion_search</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, &amp;mx, &amp;my, dmin, 0, 0, 0, 16);</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160; </div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;me_sub_cmp != <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;mb_cmp &amp;&amp; !<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;skip)</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;        dmin= <a class="code" href="motion__est__template_8c.html#a754506c51e164526d8160ebfb3afc96b">get_mb_score</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, mx, my, 0, 0, 0, 16, 1);</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160; </div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    <a class="code" href="motion__est_8c.html#a8291c1722da711c174d2a08f04f86109">get_limits</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, 16*mb_x, 16*mb_y); <span class="comment">//restore c-&gt;?min/max, maybe not needed</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160; </div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    mv_table[mot_xy][0]= mx;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    mv_table[mot_xy][1]= my;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;flags     &amp;= ~<a class="code" href="motion__est_8c.html#a8d487dcbee8d1f4d01795a2c5abb43bd">FLAG_DIRECT</a>;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;sub_flags &amp;= ~<a class="code" href="motion__est_8c.html#a8d487dcbee8d1f4d01795a2c5abb43bd">FLAG_DIRECT</a>;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160; </div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <span class="keywordflow">return</span> dmin;</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;}</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160; </div>
<div class="line"><a name="l01490"></a><span class="lineno"><a class="line" href="motion__est_8h.html#ad3a1a4609076ebe7cb44df2dd56ba2d7"> 1490</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="motion__est_8c.html#ac88e2bef674db960a121abc44d6260f3">ff_estimate_b_frame_motion</a>(<a class="code" href="struct_mpeg_enc_context.html">MpegEncContext</a> * <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>,</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;                             <span class="keywordtype">int</span> mb_x, <span class="keywordtype">int</span> mb_y)</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;{</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    <a class="code" href="struct_motion_est_context.html">MotionEstContext</a> * <span class="keyword">const</span> <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>= &amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;me;</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> penalty_factor= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;mb_penalty_factor;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="djgpp_2math_8h.html#a28f5f6ee7e8f9f5f8487de5f736de821">fmin</a>, bmin, dmin, fbmin, bimin, fimin;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="writing__filters_8txt.html#a860450fba1f740387dc082792ad89517">type</a>=0;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> xy = mb_y*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_stride + mb_x;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <a class="code" href="motion__est_8c.html#a4fb3984ec1e5fa4ef18d3aec973394f6">init_ref</a>(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;new_picture.f-&gt;data, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;last_picture.f-&gt;data,</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;             <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;next_picture.f-&gt;data, 16 * mb_x, 16 * mb_y, 2);</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160; </div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    <a class="code" href="motion__est_8c.html#a8291c1722da711c174d2a08f04f86109">get_limits</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, 16*mb_x, 16*mb_y);</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160; </div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;skip=0;</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160; </div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;codec_id == <a class="code" href="group__lavc__core.html#ggaadca229ad2c20e060a14fec08a5cc7cead95dfdf68b462db508b45fb693a4c09e">AV_CODEC_ID_MPEG4</a> &amp;&amp; <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;next_picture.mbskip_table[xy]) {</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        <span class="keywordtype">int</span> score= <a class="code" href="motion__est_8c.html#ac1c01a1cce64441fc6c1dae645b68f9b">direct_search</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, mb_x, mb_y); <span class="comment">//FIXME just check 0,0</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160; </div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;        score= ((unsigned)(score*score + 128*256))&gt;&gt;16;</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;mc_mb_var_sum_temp += score;</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;        <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture.mc_mb_var[mb_y*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_stride + mb_x] = score; <span class="comment">//FIXME use SSE</span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;        <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_type[mb_y*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_stride + mb_x]= <a class="code" href="mpegutils_8h.html#adbe5395238975cefb77eecc7df8b83b6">CANDIDATE_MB_TYPE_DIRECT0</a>;</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160; </div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    }</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160; </div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;codec_id == <a class="code" href="group__lavc__core.html#ggaadca229ad2c20e060a14fec08a5cc7cead95dfdf68b462db508b45fb693a4c09e">AV_CODEC_ID_MPEG4</a>)</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;        dmin= <a class="code" href="motion__est_8c.html#ac1c01a1cce64441fc6c1dae645b68f9b">direct_search</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, mb_x, mb_y);</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;        dmin= INT_MAX;</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="comment">// FIXME penalty stuff for non-MPEG-4</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;skip=0;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    <a class="code" href="djgpp_2math_8h.html#a28f5f6ee7e8f9f5f8487de5f736de821">fmin</a> = <a class="code" href="motion__est_8c.html#a3b5b6bf22c2f7bac4e28094de2a47e64">estimate_motion_b</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, mb_x, mb_y, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_forw_mv_table, 0, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;f_code) +</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;           3 * penalty_factor;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160; </div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;skip=0;</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    bmin = <a class="code" href="motion__est_8c.html#a3b5b6bf22c2f7bac4e28094de2a47e64">estimate_motion_b</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, mb_x, mb_y, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_back_mv_table, 2, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_code) +</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;           2 * penalty_factor;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#a8e3eb32799f4637fcdd75bb9099142ff">ff_dlog</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, <span class="stringliteral">&quot; %d %d &quot;</span>, <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_forw_mv_table[xy][0], <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_forw_mv_table[xy][1]);</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160; </div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;skip=0;</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    fbmin= <a class="code" href="motion__est_8c.html#aae0d3379c290082fb581db00fbd3bb1e">bidir_refine</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, mb_x, mb_y) + penalty_factor;</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    <a class="code" href="tableprint__vlc_8h.html#a8e3eb32799f4637fcdd75bb9099142ff">ff_dlog</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, <span class="stringliteral">&quot;%d %d %d %d\n&quot;</span>, dmin, <a class="code" href="djgpp_2math_8h.html#a28f5f6ee7e8f9f5f8487de5f736de821">fmin</a>, bmin, fbmin);</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160; </div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;avctx-&gt;flags &amp; <a class="code" href="group__lavc__core.html#ga936c6ae1b3d24d7504f0a9aea1a24c74">AV_CODEC_FLAG_INTERLACED_ME</a>) {</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<span class="comment">//FIXME mb type penalty</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;skip=0;</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;current_mv_penalty= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;mv_penalty[<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;f_code] + <a class="code" href="motion__est_8h.html#aff5e63cbe9a89f209f562aa9a846c7ab">MAX_DMV</a>;</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;        fimin= <a class="code" href="motion__est_8c.html#a5f0418ef58399e169aa9383dd4d0b80c">interlaced_search</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, 0,</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;                                 <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_field_mv_table[0], <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_field_select_table[0],</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;                                 <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_forw_mv_table[xy][0], <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_forw_mv_table[xy][1], 0);</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;current_mv_penalty= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;mv_penalty[<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_code] + <a class="code" href="motion__est_8h.html#aff5e63cbe9a89f209f562aa9a846c7ab">MAX_DMV</a>;</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;        bimin= <a class="code" href="motion__est_8c.html#a5f0418ef58399e169aa9383dd4d0b80c">interlaced_search</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, 2,</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                                 <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_field_mv_table[1], <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_field_select_table[1],</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;                                 <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_back_mv_table[xy][0], <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_back_mv_table[xy][1], 0);</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    }<span class="keywordflow">else</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;        fimin= bimin= INT_MAX;</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160; </div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    {</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;        <span class="keywordtype">int</span> score= <a class="code" href="djgpp_2math_8h.html#a28f5f6ee7e8f9f5f8487de5f736de821">fmin</a>;</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;        <a class="code" href="writing__filters_8txt.html#a860450fba1f740387dc082792ad89517">type</a> = <a class="code" href="mpegutils_8h.html#a90d67c3d117b86b0b0cd28705364731c">CANDIDATE_MB_TYPE_FORWARD</a>;</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160; </div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;        <span class="keywordflow">if</span> (dmin &lt;= score){</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;            score = dmin;</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;            <a class="code" href="writing__filters_8txt.html#a860450fba1f740387dc082792ad89517">type</a> = <a class="code" href="mpegutils_8h.html#a6b6fdfcea7012d8c7dbdd4321c08b862">CANDIDATE_MB_TYPE_DIRECT</a>;</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;        }</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;        <span class="keywordflow">if</span>(bmin&lt;score){</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;            score=bmin;</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;            <a class="code" href="writing__filters_8txt.html#a860450fba1f740387dc082792ad89517">type</a>= <a class="code" href="mpegutils_8h.html#a1a0f48150ffb3c9ea7e5c1c92babbea2">CANDIDATE_MB_TYPE_BACKWARD</a>;</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;        }</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;        <span class="keywordflow">if</span>(fbmin&lt;score){</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;            score=fbmin;</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;            <a class="code" href="writing__filters_8txt.html#a860450fba1f740387dc082792ad89517">type</a>= <a class="code" href="mpegutils_8h.html#a7eb7af26474d13fd9c035ee9e0eef80b">CANDIDATE_MB_TYPE_BIDIR</a>;</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;        }</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;        <span class="keywordflow">if</span>(fimin&lt;score){</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;            score=fimin;</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;            <a class="code" href="writing__filters_8txt.html#a860450fba1f740387dc082792ad89517">type</a>= <a class="code" href="mpegutils_8h.html#a212f42cb822d94c3d5aa5358b7f3a782">CANDIDATE_MB_TYPE_FORWARD_I</a>;</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;        }</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;        <span class="keywordflow">if</span>(bimin&lt;score){</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;            score=bimin;</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;            <a class="code" href="writing__filters_8txt.html#a860450fba1f740387dc082792ad89517">type</a>= <a class="code" href="mpegutils_8h.html#a3ebccb069c656e698035efc292e59d78">CANDIDATE_MB_TYPE_BACKWARD_I</a>;</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;        }</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160; </div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        score= ((unsigned)(score*score + 128*256))&gt;&gt;16;</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;        <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;mc_mb_var_sum_temp += score;</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;        <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture.mc_mb_var[mb_y*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_stride + mb_x] = score; <span class="comment">//FIXME use SSE</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    }</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160; </div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;mb_decision &gt; <a class="code" href="avcodec_8h.html#ac07b09eadb08fd0c03b1a321bdd0a87e">FF_MB_DECISION_SIMPLE</a>){</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;        <a class="code" href="writing__filters_8txt.html#a860450fba1f740387dc082792ad89517">type</a>= <a class="code" href="mpegutils_8h.html#a90d67c3d117b86b0b0cd28705364731c">CANDIDATE_MB_TYPE_FORWARD</a> | <a class="code" href="mpegutils_8h.html#a1a0f48150ffb3c9ea7e5c1c92babbea2">CANDIDATE_MB_TYPE_BACKWARD</a> | <a class="code" href="mpegutils_8h.html#a7eb7af26474d13fd9c035ee9e0eef80b">CANDIDATE_MB_TYPE_BIDIR</a> | <a class="code" href="mpegutils_8h.html#a6b6fdfcea7012d8c7dbdd4321c08b862">CANDIDATE_MB_TYPE_DIRECT</a>;</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;        <span class="keywordflow">if</span>(fimin &lt; INT_MAX)</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;            <a class="code" href="writing__filters_8txt.html#a860450fba1f740387dc082792ad89517">type</a> |= <a class="code" href="mpegutils_8h.html#a212f42cb822d94c3d5aa5358b7f3a782">CANDIDATE_MB_TYPE_FORWARD_I</a>;</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;        <span class="keywordflow">if</span>(bimin &lt; INT_MAX)</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;            <a class="code" href="writing__filters_8txt.html#a860450fba1f740387dc082792ad89517">type</a> |= <a class="code" href="mpegutils_8h.html#a3ebccb069c656e698035efc292e59d78">CANDIDATE_MB_TYPE_BACKWARD_I</a>;</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;        <span class="keywordflow">if</span>(fimin &lt; INT_MAX &amp;&amp; bimin &lt; INT_MAX){</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;            <a class="code" href="writing__filters_8txt.html#a860450fba1f740387dc082792ad89517">type</a> |= <a class="code" href="mpegutils_8h.html#a3eb309beaf81e3cec0411160b4926e27">CANDIDATE_MB_TYPE_BIDIR_I</a>;</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;        }</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;         <span class="comment">//FIXME something smarter</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;        <span class="keywordflow">if</span>(dmin&gt;256*256*16) <a class="code" href="writing__filters_8txt.html#a860450fba1f740387dc082792ad89517">type</a>&amp;= ~<a class="code" href="mpegutils_8h.html#a6b6fdfcea7012d8c7dbdd4321c08b862">CANDIDATE_MB_TYPE_DIRECT</a>; <span class="comment">//do not try direct mode if it is invalid for this MB</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;codec_id == <a class="code" href="group__lavc__core.html#ggaadca229ad2c20e060a14fec08a5cc7cead95dfdf68b462db508b45fb693a4c09e">AV_CODEC_ID_MPEG4</a> &amp;&amp; <a class="code" href="writing__filters_8txt.html#a860450fba1f740387dc082792ad89517">type</a>&amp;<a class="code" href="mpegutils_8h.html#a6b6fdfcea7012d8c7dbdd4321c08b862">CANDIDATE_MB_TYPE_DIRECT</a> &amp;&amp;</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;            <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mpv_flags &amp; <a class="code" href="mpegvideo_8h.html#a7f5f72b0628939f9942f9e43bfa371cc">FF_MPV_FLAG_MV0</a> &amp;&amp; *(uint32_t*)<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b_direct_mv_table[xy])</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;            <a class="code" href="writing__filters_8txt.html#a860450fba1f740387dc082792ad89517">type</a> |= <a class="code" href="mpegutils_8h.html#adbe5395238975cefb77eecc7df8b83b6">CANDIDATE_MB_TYPE_DIRECT0</a>;</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    }</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160; </div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_type[mb_y*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_stride + mb_x]= <a class="code" href="writing__filters_8txt.html#a860450fba1f740387dc082792ad89517">type</a>;</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;}</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160; </div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;<span class="comment">/* find best f_code for ME which do unlimited searches */</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"><a class="line" href="motion__est_8h.html#aa85f215d62d38267c1495fb876bfa9bb"> 1598</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="motion__est_8c.html#ab85c46e90aba6dd6961a58415ac09eac">ff_get_best_fcode</a>(<a class="code" href="struct_mpeg_enc_context.html">MpegEncContext</a> * <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, int16_t (*mv_table)[2], <span class="keywordtype">int</span> <a class="code" href="writing__filters_8txt.html#a860450fba1f740387dc082792ad89517">type</a>)</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;{</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;motion_est != <a class="code" href="motion__est_8h.html#ae990b594d112ea5fd0574106cd9a0491">FF_ME_ZERO</a>) {</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;        <span class="keywordtype">int</span> score[8];</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, y, range= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;avctx-&gt;me_range ? <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;avctx-&gt;me_range : (INT_MAX/2);</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;        <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> * <a class="code" href="ituh263enc_8c.html#a147844932ed6da81f333ae30eb129e12">fcode_tab</a>= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;fcode_tab;</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;        <span class="keywordtype">int</span> best_fcode=-1;</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;        <span class="keywordtype">int</span> best_score=-10000000;</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160; </div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;msmpeg4_version)</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;            range= <a class="code" href="common_8h.html#a0f84cbd7fd810cd678157c98cbfad4b0">FFMIN</a>(range, 16);</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;codec_id == <a class="code" href="group__lavc__core.html#ggaadca229ad2c20e060a14fec08a5cc7ceaf614abb36f7c5d0c42ed522c1d6c99f0">AV_CODEC_ID_MPEG2VIDEO</a> &amp;&amp; <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;avctx-&gt;strict_std_compliance &gt;= <a class="code" href="avcodec_8h.html#a661eaec472e284a3b2920647349471dd">FF_COMPLIANCE_NORMAL</a>)</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;            range= <a class="code" href="common_8h.html#a0f84cbd7fd810cd678157c98cbfad4b0">FFMIN</a>(range, 256);</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160; </div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;8; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++) score[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>]= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_num*(8-<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160; </div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;        <span class="keywordflow">for</span>(y=0; y&lt;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_height; y++){</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;            <span class="keywordtype">int</span> x;</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;            <span class="keywordtype">int</span> xy= y*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_stride;</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;            <span class="keywordflow">for</span>(x=0; x&lt;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_width; x++){</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_type[xy] &amp; <a class="code" href="writing__filters_8txt.html#a860450fba1f740387dc082792ad89517">type</a>){</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;                    <span class="keywordtype">int</span> mx= mv_table[xy][0];</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                    <span class="keywordtype">int</span> my= mv_table[xy][1];</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                    <span class="keywordtype">int</span> fcode= <a class="code" href="common_8h.html#a9960bd6780a9b16a216a57be1ee04359">FFMAX</a>(<a class="code" href="ituh263enc_8c.html#a147844932ed6da81f333ae30eb129e12">fcode_tab</a>[mx + <a class="code" href="motion__est_8h.html#a1df7d470d965904adde0e67fed4480e4">MAX_MV</a>],</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                                     <a class="code" href="ituh263enc_8c.html#a147844932ed6da81f333ae30eb129e12">fcode_tab</a>[my + <a class="code" href="motion__est_8h.html#a1df7d470d965904adde0e67fed4480e4">MAX_MV</a>]);</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                    <span class="keywordtype">int</span> j;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160; </div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                        <span class="keywordflow">if</span>(mx &gt;= range || mx &lt; -range ||</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                           my &gt;= range || my &lt; -range)</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;                            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160; </div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;                    <span class="keywordflow">for</span>(j=0; j&lt;fcode &amp;&amp; j&lt;8; j++){</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;                        <span class="keywordflow">if</span>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;pict_type==<a class="code" href="group__lavu__picture.html#ggae6cbcab1f70d8e476757f1c1f5a0a78ead22f8968e99bc48897c3f4ac29e82dae">AV_PICTURE_TYPE_B</a> || <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture.mc_mb_var[xy] &lt; <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture.mb_var[xy])</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;                            score[j]-= 170;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;                    }</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;                }</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;                xy++;</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;            }</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;        }</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160; </div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>=1; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;8; <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++){</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;            <span class="keywordflow">if</span>(score[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>] &gt; best_score){</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                best_score= score[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                best_fcode= <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;            }</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;        }</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160; </div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;        <span class="keywordflow">return</span> best_fcode;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    }</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;}</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160; </div>
<div class="line"><a name="l01651"></a><span class="lineno"><a class="line" href="motion__est_8h.html#ab1e6e1e6479aace08efaeaa8b1f0e69a"> 1651</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="motion__est_8c.html#a49d9611c88d884f1c28694b2f96b7de6">ff_fix_long_p_mvs</a>(<a class="code" href="struct_mpeg_enc_context.html">MpegEncContext</a> * <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, <span class="keywordtype">int</span> <a class="code" href="writing__filters_8txt.html#a860450fba1f740387dc082792ad89517">type</a>)</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;{</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    <a class="code" href="struct_motion_est_context.html">MotionEstContext</a> * <span class="keyword">const</span> <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>= &amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;me;</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> f_code= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;f_code;</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    <span class="keywordtype">int</span> y, range;</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    <a class="code" href="avassert_8h.html#aae204192396f78cc8c5cd7ad5c57c23f">av_assert0</a>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;pict_type==<a class="code" href="group__lavu__picture.html#ggae6cbcab1f70d8e476757f1c1f5a0a78eaa6fc0479507a03f173f07fc75dab2193">AV_PICTURE_TYPE_P</a>);</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160; </div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    range = (((<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;out_format == <a class="code" href="mpegutils_8h.html#aeb712c6c6c0a8af0dfd79f451ecb9277a7c5d2ba13864b4679f30c4874acd753a">FMT_MPEG1</a> || <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;msmpeg4_version) ? 8 : 16) &lt;&lt; f_code);</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160; </div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    <a class="code" href="avassert_8h.html#aae204192396f78cc8c5cd7ad5c57c23f">av_assert0</a>(range &lt;= 16 || !s-&gt;msmpeg4_version);</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <a class="code" href="avassert_8h.html#aae204192396f78cc8c5cd7ad5c57c23f">av_assert0</a>(range &lt;=256 || !(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;codec_id == <a class="code" href="group__lavc__core.html#ggaadca229ad2c20e060a14fec08a5cc7ceaf614abb36f7c5d0c42ed522c1d6c99f0">AV_CODEC_ID_MPEG2VIDEO</a> &amp;&amp; <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;avctx-&gt;strict_std_compliance &gt;= <a class="code" href="avcodec_8h.html#a661eaec472e284a3b2920647349471dd">FF_COMPLIANCE_NORMAL</a>));</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160; </div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;me_range &amp;&amp; range &gt; <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;me_range) range= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;me_range;</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160; </div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;avctx-&gt;flags &amp; <a class="code" href="group__lavc__core.html#gac66356d3e9a7ae8b2b29e14402367649">AV_CODEC_FLAG_4MV</a>) {</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="aarch64_2neontest_8h.html#afcc3d9d5c7982d75dd9756085f644a01">wrap</a>= <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;b8_stride;</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160; </div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;        <span class="comment">/* clip / convert to intra 8x8 type MVs */</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;        <span class="keywordflow">for</span>(y=0; y&lt;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_height; y++){</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;            <span class="keywordtype">int</span> xy= y*2*<a class="code" href="aarch64_2neontest_8h.html#afcc3d9d5c7982d75dd9756085f644a01">wrap</a>;</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>= y*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_stride;</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;            <span class="keywordtype">int</span> x;</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160; </div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;            <span class="keywordflow">for</span>(x=0; x&lt;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_width; x++){</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_type[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>]&amp;<a class="code" href="mpegutils_8h.html#ac5b3437f815e738d56f4e61515500323">CANDIDATE_MB_TYPE_INTER4V</a>){</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;                    <span class="keywordtype">int</span> <a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>;</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                    <span class="keywordflow">for</span>(<a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>=0; <a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>&lt;4; <a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>++){</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;                        <span class="keywordtype">int</span> off= (<a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>&amp; 1) + (<a class="code" href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a>&gt;&gt;1)*<a class="code" href="aarch64_2neontest_8h.html#afcc3d9d5c7982d75dd9756085f644a01">wrap</a>;</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;                        <span class="keywordtype">int</span> mx = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture.motion_val[0][ xy + off ][0];</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;                        <span class="keywordtype">int</span> my = <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture.motion_val[0][ xy + off ][1];</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160; </div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;                        <span class="keywordflow">if</span>(   mx &gt;=range || mx &lt;-range</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;                           || my &gt;=range || my &lt;-range){</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;                            <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_type[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>] &amp;= ~<a class="code" href="mpegutils_8h.html#ac5b3437f815e738d56f4e61515500323">CANDIDATE_MB_TYPE_INTER4V</a>;</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;                            <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_type[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>] |= <a class="code" href="writing__filters_8txt.html#a860450fba1f740387dc082792ad89517">type</a>;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;                            <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;current_picture.mb_type[<a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="writing__filters_8txt.html#a860450fba1f740387dc082792ad89517">type</a>;</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;                        }</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;                    }</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;                }</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;                xy+=2;</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;                <a class="code" href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++;</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;            }</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;        }</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    }</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;}</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160; </div>
<div class="line"><a name="l01700"></a><span class="lineno"><a class="line" href="motion__est_8h.html#a5f6fe8c40fb76872a368a68e9462d360"> 1700</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="motion__est_8c.html#a5679cadd65e637f7a28c99a30099fbf3">ff_fix_long_mvs</a>(<a class="code" href="struct_mpeg_enc_context.html">MpegEncContext</a> * <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>, <a class="code" href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *field_select_table, <span class="keywordtype">int</span> field_select,</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;                     int16_t (*mv_table)[2], <span class="keywordtype">int</span> f_code, <span class="keywordtype">int</span> <a class="code" href="writing__filters_8txt.html#a860450fba1f740387dc082792ad89517">type</a>, <span class="keywordtype">int</span> truncate)</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;{</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    <a class="code" href="struct_motion_est_context.html">MotionEstContext</a> * <span class="keyword">const</span> <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>= &amp;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;me;</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    <span class="keywordtype">int</span> y, h_range, v_range;</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160; </div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    <span class="comment">// RAL: 8 in MPEG-1, 16 in MPEG-4</span></div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    <span class="keywordtype">int</span> range = (((<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;out_format == <a class="code" href="mpegutils_8h.html#aeb712c6c6c0a8af0dfd79f451ecb9277a7c5d2ba13864b4679f30c4874acd753a">FMT_MPEG1</a> || <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;msmpeg4_version) ? 8 : 16) &lt;&lt; f_code);</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160; </div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;me_range &amp;&amp; range &gt; <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;me_range) range= <a class="code" href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a>-&gt;avctx-&gt;me_range;</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160; </div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    h_range= range;</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    v_range= field_select_table ? range&gt;&gt;1 : range;</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160; </div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    <span class="comment">/* clip / convert to intra 16x16 type MVs */</span></div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    <span class="keywordflow">for</span>(y=0; y&lt;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_height; y++){</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;        <span class="keywordtype">int</span> x;</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;        <span class="keywordtype">int</span> xy= y*<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_stride;</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;        <span class="keywordflow">for</span>(x=0; x&lt;<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_width; x++){</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_type[xy] &amp; <a class="code" href="writing__filters_8txt.html#a860450fba1f740387dc082792ad89517">type</a>){    <span class="comment">// RAL: &quot;type&quot; test added...</span></div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;                <span class="keywordflow">if</span> (!field_select_table || field_select_table[xy] == field_select) {</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;                    <span class="keywordflow">if</span>(   mv_table[xy][0] &gt;=h_range || mv_table[xy][0] &lt;-h_range</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;                       || mv_table[xy][1] &gt;=v_range || mv_table[xy][1] &lt;-v_range){</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160; </div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;                        <span class="keywordflow">if</span>(truncate){</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;                            <span class="keywordflow">if</span>     (mv_table[xy][0] &gt; h_range-1) mv_table[xy][0]=  h_range-1;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;                            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(mv_table[xy][0] &lt; -h_range ) mv_table[xy][0]= -h_range;</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;                            <span class="keywordflow">if</span>     (mv_table[xy][1] &gt; v_range-1) mv_table[xy][1]=  v_range-1;</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;                            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(mv_table[xy][1] &lt; -v_range ) mv_table[xy][1]= -v_range;</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;                        }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;                            <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_type[xy] &amp;= ~<a class="code" href="writing__filters_8txt.html#a860450fba1f740387dc082792ad89517">type</a>;</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;                            <a class="code" href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a>-&gt;mb_type[xy] |= <a class="code" href="mpegutils_8h.html#a0628ca7c41ad229d1786fd2ccddd0ed8">CANDIDATE_MB_TYPE_INTRA</a>;</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;                            mv_table[xy][0]=</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;                            mv_table[xy][1]= 0;</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;                        }</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;                    }</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;                }</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;            }</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;            xy++;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;        }</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    }</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="amotion__est_8h_html_a7218b8d248303e9eee02438a35198ca7"><div class="ttname"><a href="motion__est_8h.html#a7218b8d248303e9eee02438a35198ca7">ff_h263_round_chroma</a></div><div class="ttdeci">static int ff_h263_round_chroma(int x)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8h_source.html#l00101">motion_est.h:101</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a955e0bcc00eb62a789e71ac08020cc63"><div class="ttname"><a href="motion__est_8c.html#a955e0bcc00eb62a789e71ac08020cc63">CHECK_BIDIR2</a></div><div class="ttdeci">#define CHECK_BIDIR2(a, b, c, d)</div></div>
<div class="ttc" id="amotion__est_8c_html_a9e8729707e5022a345cc130841eab01d"><div class="ttname"><a href="motion__est_8c.html#a9e8729707e5022a345cc130841eab01d">update_map_generation</a></div><div class="ttdeci">static unsigned update_map_generation(MotionEstContext *c)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00055">motion_est.c:55</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a12d74a50191081fc93ef9b40f9b736ea"><div class="ttname"><a href="motion__est_8c.html#a12d74a50191081fc93ef9b40f9b736ea">cmp_direct_inline</a></div><div class="ttdeci">static av_always_inline int cmp_direct_inline(MpegEncContext *s, const int x, const int y, const int subx, const int suby, const int size, const int h, int ref_index, int src_index, me_cmp_func cmp_func, me_cmp_func chroma_cmp_func, int qpel)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00107">motion_est.c:107</a></div></div>
<div class="ttc" id="ampegutils_8h_html_ab8c5b21d0da9f13a58e04abc7c612a70"><div class="ttname"><a href="mpegutils_8h.html#ab8c5b21d0da9f13a58e04abc7c612a70">IS_8X8</a></div><div class="ttdeci">#define IS_8X8(a)</div><div class="ttdef"><b>Definition:</b> <a href="mpegutils_8h_source.html#l00089">mpegutils.h:89</a></div></div>
<div class="ttc" id="amace_8c_html_a08f66a6870d87afcd5dc1b60d1019692"><div class="ttname"><a href="mace_8c.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a></div><div class="ttdeci">int stride</div><div class="ttdef"><b>Definition:</b> <a href="mace_8c_source.html#l00144">mace.c:144</a></div></div>
<div class="ttc" id="ampegvideo_8h_html_ae17ddc0eaf08f5eea9e1d13399f1cb08"><div class="ttname"><a href="mpegvideo_8h.html#ae17ddc0eaf08f5eea9e1d13399f1cb08">MV_TYPE_16X16</a></div><div class="ttdeci">#define MV_TYPE_16X16</div><div class="ttdoc">1 vector for the whole mb</div><div class="ttdef"><b>Definition:</b> <a href="mpegvideo_8h_source.html#l00266">mpegvideo.h:266</a></div></div>
<div class="ttc" id="alibavfilter_2af__afir_8c_html_a2935ad4574b6b85a524d227a44e8f171"><div class="ttname"><a href="libavfilter_2af__afir_8c.html#a2935ad4574b6b85a524d227a44e8f171">direct</a></div><div class="ttdeci">static void direct(const float *in, const FFTComplex *ir, int len, float *out)</div><div class="ttdef"><b>Definition:</b> <a href="libavfilter_2af__afir_8c_source.html#l00060">af_afir.c:60</a></div></div>
<div class="ttc" id="ampegutils_8h_html_aeb712c6c6c0a8af0dfd79f451ecb9277a7c5d2ba13864b4679f30c4874acd753a"><div class="ttname"><a href="mpegutils_8h.html#aeb712c6c6c0a8af0dfd79f451ecb9277a7c5d2ba13864b4679f30c4874acd753a">FMT_MPEG1</a></div><div class="ttdeci">@ FMT_MPEG1</div><div class="ttdef"><b>Definition:</b> <a href="mpegutils_8h_source.html#l00124">mpegutils.h:124</a></div></div>
<div class="ttc" id="avf__curves_8c_html_a33ac7b8ce37a3a60855883424fcf8b62"><div class="ttname"><a href="vf__curves_8c.html#a33ac7b8ce37a3a60855883424fcf8b62">r</a></div><div class="ttdeci">const char * r</div><div class="ttdef"><b>Definition:</b> <a href="vf__curves_8c_source.html#l00114">vf_curves.c:114</a></div></div>
<div class="ttc" id="aituh263enc_8c_html_a147844932ed6da81f333ae30eb129e12"><div class="ttname"><a href="ituh263enc_8c.html#a147844932ed6da81f333ae30eb129e12">fcode_tab</a></div><div class="ttdeci">static uint8_t fcode_tab[MAX_MV *2+1]</div><div class="ttdef"><b>Definition:</b> <a href="ituh263enc_8c_source.html#l00052">ituh263enc.c:52</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a49d9611c88d884f1c28694b2f96b7de6"><div class="ttname"><a href="motion__est_8c.html#a49d9611c88d884f1c28694b2f96b7de6">ff_fix_long_p_mvs</a></div><div class="ttdeci">void ff_fix_long_p_mvs(MpegEncContext *s, int type)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l01651">motion_est.c:1651</a></div></div>
<div class="ttc" id="astruct_minima_html"><div class="ttname"><a href="struct_minima.html">Minima</a></div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00066">motion_est.c:66</a></div></div>
<div class="ttc" id="amotion__est_8c_html_aad480cc0efda051e616451ee270b6343"><div class="ttname"><a href="motion__est_8c.html#aad480cc0efda051e616451ee270b6343">cmp_simple</a></div><div class="ttdeci">static int cmp_simple(MpegEncContext *s, const int x, const int y, int ref_index, int src_index, me_cmp_func cmp_func, me_cmp_func chroma_cmp_func)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00231">motion_est.c:231</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a8dac5469cef1b1fe735f72db3302e8e3"><div class="ttname"><a href="motion__est_8c.html#a8dac5469cef1b1fe735f72db3302e8e3">check_bidir_mv</a></div><div class="ttdeci">static int check_bidir_mv(MpegEncContext *s, int motion_fx, int motion_fy, int motion_bx, int motion_by, int pred_fx, int pred_fy, int pred_bx, int pred_by, int size, int h)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l01176">motion_est.c:1176</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a4fb3984ec1e5fa4ef18d3aec973394f6"><div class="ttname"><a href="motion__est_8c.html#a4fb3984ec1e5fa4ef18d3aec973394f6">init_ref</a></div><div class="ttdeci">static void init_ref(MotionEstContext *c, uint8_t *src[3], uint8_t *ref[3], uint8_t *ref2[3], int x, int y, int ref_index)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00083">motion_est.c:83</a></div></div>
<div class="ttc" id="agroup__lavc__core_html_ggaadca229ad2c20e060a14fec08a5cc7cead95dfdf68b462db508b45fb693a4c09e"><div class="ttname"><a href="group__lavc__core.html#ggaadca229ad2c20e060a14fec08a5cc7cead95dfdf68b462db508b45fb693a4c09e">AV_CODEC_ID_MPEG4</a></div><div class="ttdeci">@ AV_CODEC_ID_MPEG4</div><div class="ttdef"><b>Definition:</b> <a href="codec__id_8h_source.html#l00061">codec_id.h:61</a></div></div>
<div class="ttc" id="aavrndec_8c_html_a13191ba45577b1d4f9b37d64df91eb55"><div class="ttname"><a href="avrndec_8c.html#a13191ba45577b1d4f9b37d64df91eb55">end</a></div><div class="ttdeci">static av_cold int end(AVCodecContext *avctx)</div><div class="ttdef"><b>Definition:</b> <a href="avrndec_8c_source.html#l00092">avrndec.c:92</a></div></div>
<div class="ttc" id="amotion__est_8h_html_aff5e63cbe9a89f209f562aa9a846c7ab"><div class="ttname"><a href="motion__est_8h.html#aff5e63cbe9a89f209f562aa9a846c7ab">MAX_DMV</a></div><div class="ttdeci">#define MAX_DMV</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8h_source.html#l00037">motion_est.h:37</a></div></div>
<div class="ttc" id="ampegutils_8h_html_a3a8c485ab75c9815487bca56b8b2947a"><div class="ttname"><a href="mpegutils_8h.html#a3a8c485ab75c9815487bca56b8b2947a">CANDIDATE_MB_TYPE_INTER_I</a></div><div class="ttdeci">#define CANDIDATE_MB_TYPE_INTER_I</div><div class="ttdef"><b>Definition:</b> <a href="mpegutils_8h_source.html#l00114">mpegutils.h:114</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a9c7af2fe6dd8e68212dcb087534bfac2"><div class="ttname"><a href="motion__est_8c.html#a9c7af2fe6dd8e68212dcb087534bfac2">cmp_qpel</a></div><div class="ttdeci">static int cmp_qpel(MpegEncContext *s, const int x, const int y, const int subx, const int suby, const int size, const int h, int ref_index, int src_index, me_cmp_func cmp_func, me_cmp_func chroma_cmp_func, const int flags)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00285">motion_est.c:285</a></div></div>
<div class="ttc" id="ainput_8c_html_ad6cdb6a14abe3eab42eaaadc93409aec"><div class="ttname"><a href="input_8c.html#ad6cdb6a14abe3eab42eaaadc93409aec">b</a></div><div class="ttdeci">#define b</div><div class="ttdef"><b>Definition:</b> <a href="input_8c_source.html#l00041">input.c:41</a></div></div>
<div class="ttc" id="avf__waveform_8c_html_a155491a071a66a7795f49f3a5e079fac"><div class="ttname"><a href="vf__waveform_8c.html#a155491a071a66a7795f49f3a5e079fac">chroma</a></div><div class="ttdeci">static av_always_inline void chroma(WaveformContext *s, AVFrame *in, AVFrame *out, int component, int intensity, int offset_y, int offset_x, int column, int mirror, int jobnr, int nb_jobs)</div><div class="ttdef"><b>Definition:</b> <a href="vf__waveform_8c_source.html#l01631">vf_waveform.c:1631</a></div></div>
<div class="ttc" id="ampegutils_8h_html_a3ebccb069c656e698035efc292e59d78"><div class="ttname"><a href="mpegutils_8h.html#a3ebccb069c656e698035efc292e59d78">CANDIDATE_MB_TYPE_BACKWARD_I</a></div><div class="ttdeci">#define CANDIDATE_MB_TYPE_BACKWARD_I</div><div class="ttdef"><b>Definition:</b> <a href="mpegutils_8h_source.html#l00116">mpegutils.h:116</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a147b555fcbdd1e577cb0c0701dbfc9cb"><div class="ttname"><a href="motion__est_8c.html#a147b555fcbdd1e577cb0c0701dbfc9cb">cmp_inline</a></div><div class="ttdeci">static av_always_inline int cmp_inline(MpegEncContext *s, const int x, const int y, const int subx, const int suby, const int size, const int h, int ref_index, int src_index, me_cmp_func cmp_func, me_cmp_func chroma_cmp_func, int qpel, int chroma)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00179">motion_est.c:179</a></div></div>
<div class="ttc" id="acuda__runtime_8h_html_affe776513b24d84b39af8ab0930fef7f"><div class="ttname"><a href="cuda__runtime_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a></div><div class="ttdeci">#define max(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__runtime_8h_source.html#l00033">cuda_runtime.h:33</a></div></div>
<div class="ttc" id="ampegvideo_8h_html"><div class="ttname"><a href="mpegvideo_8h.html">mpegvideo.h</a></div></div>
<div class="ttc" id="ampegutils_8h_html_a5ad4a10962f36d81e69599049a2b81c8"><div class="ttname"><a href="mpegutils_8h.html#a5ad4a10962f36d81e69599049a2b81c8">CANDIDATE_MB_TYPE_SKIPPED</a></div><div class="ttdeci">#define CANDIDATE_MB_TYPE_SKIPPED</div><div class="ttdef"><b>Definition:</b> <a href="mpegutils_8h_source.html#l00107">mpegutils.h:107</a></div></div>
<div class="ttc" id="agroup__lavu__enc_html_ga979d8e4b4947c924436fcc3b62cafea7"><div class="ttname"><a href="group__lavu__enc.html#ga979d8e4b4947c924436fcc3b62cafea7">FF_LAMBDA_SHIFT</a></div><div class="ttdeci">#define FF_LAMBDA_SHIFT</div><div class="ttdef"><b>Definition:</b> <a href="avutil_8h_source.html#l00225">avutil.h:225</a></div></div>
<div class="ttc" id="ampegutils_8h_html_a660a22ba325af570369879cb392d3d21"><div class="ttname"><a href="mpegutils_8h.html#a660a22ba325af570369879cb392d3d21">CANDIDATE_MB_TYPE_INTER</a></div><div class="ttdeci">#define CANDIDATE_MB_TYPE_INTER</div><div class="ttdef"><b>Definition:</b> <a href="mpegutils_8h_source.html#l00105">mpegutils.h:105</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a0db0b24114e1621157fcf58f159f7199"><div class="ttname"><a href="motion__est_8c.html#a0db0b24114e1621157fcf58f159f7199">minima_cmp</a></div><div class="ttdeci">static int minima_cmp(const void *a, const void *b)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00072">motion_est.c:72</a></div></div>
<div class="ttc" id="agroup__lavc__core_html_ga936c6ae1b3d24d7504f0a9aea1a24c74"><div class="ttname"><a href="group__lavc__core.html#ga936c6ae1b3d24d7504f0a9aea1a24c74">AV_CODEC_FLAG_INTERLACED_ME</a></div><div class="ttdeci">#define AV_CODEC_FLAG_INTERLACED_ME</div><div class="ttdef"><b>Definition:</b> <a href="avcodec_8h_source.html#l00342">avcodec.h:342</a></div></div>
<div class="ttc" id="ampegutils_8h_html"><div class="ttname"><a href="mpegutils_8h.html">mpegutils.h</a></div></div>
<div class="ttc" id="atests_2movenc_8c_html_a8509848f135e0b5f310c969a6c5344ec"><div class="ttname"><a href="tests_2movenc_8c.html#a8509848f135e0b5f310c969a6c5344ec">hash</a></div><div class="ttdeci">uint8_t hash[HASH_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="tests_2movenc_8c_source.html#l00057">movenc.c:57</a></div></div>
<div class="ttc" id="agroup__lavc__core_html_gac66356d3e9a7ae8b2b29e14402367649"><div class="ttname"><a href="group__lavc__core.html#gac66356d3e9a7ae8b2b29e14402367649">AV_CODEC_FLAG_4MV</a></div><div class="ttdeci">#define AV_CODEC_FLAG_4MV</div><div class="ttdef"><b>Definition:</b> <a href="avcodec_8h_source.html#l00279">avcodec.h:279</a></div></div>
<div class="ttc" id="ame__cmp_8c_html_a75513e6a622cdbbe65d692568d21b81e"><div class="ttname"><a href="me__cmp_8c.html#a75513e6a622cdbbe65d692568d21b81e">ff_set_cmp</a></div><div class="ttdeci">void ff_set_cmp(MECmpContext *c, me_cmp_func *cmp, int type)</div><div class="ttdef"><b>Definition:</b> <a href="me__cmp_8c_source.html#l00474">me_cmp.c:474</a></div></div>
<div class="ttc" id="amotion__est_8c_html_aac3da2313b0621a1410853fab37dc00d"><div class="ttname"><a href="motion__est_8c.html#aac3da2313b0621a1410853fab37dc00d">P_LEFT</a></div><div class="ttdeci">#define P_LEFT</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00041">motion_est.c:41</a></div></div>
<div class="ttc" id="agroup__lavc__core_html_ggaadca229ad2c20e060a14fec08a5cc7cea11cf9a49627f70f6ab33d3bf93752ae4"><div class="ttname"><a href="group__lavc__core.html#ggaadca229ad2c20e060a14fec08a5cc7cea11cf9a49627f70f6ab33d3bf93752ae4">AV_CODEC_ID_H261</a></div><div class="ttdeci">@ AV_CODEC_ID_H261</div><div class="ttdef"><b>Definition:</b> <a href="codec__id_8h_source.html#l00052">codec_id.h:52</a></div></div>
<div class="ttc" id="ampegutils_8h_html_a212f42cb822d94c3d5aa5358b7f3a782"><div class="ttname"><a href="mpegutils_8h.html#a212f42cb822d94c3d5aa5358b7f3a782">CANDIDATE_MB_TYPE_FORWARD_I</a></div><div class="ttdeci">#define CANDIDATE_MB_TYPE_FORWARD_I</div><div class="ttdef"><b>Definition:</b> <a href="mpegutils_8h_source.html#l00115">mpegutils.h:115</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a5eb44f71317870c609c153e9d0960b16"><div class="ttname"><a href="motion__est_8c.html#a5eb44f71317870c609c153e9d0960b16">get_flags</a></div><div class="ttdeci">static int get_flags(MotionEstContext *c, int direct, int chroma)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00101">motion_est.c:101</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a5f0418ef58399e169aa9383dd4d0b80c"><div class="ttname"><a href="motion__est_8c.html#a5f0418ef58399e169aa9383dd4d0b80c">interlaced_search</a></div><div class="ttdeci">static int interlaced_search(MpegEncContext *s, int ref_index, int16_t(*mv_tables[2][2])[2], uint8_t *field_select_tables[2], int mx, int my, int user_field_select)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00738">motion_est.c:738</a></div></div>
<div class="ttc" id="astruct_picture_html"><div class="ttname"><a href="struct_picture.html">Picture</a></div><div class="ttdef"><b>Definition:</b> <a href="mpegpicture_8h_source.html#l00045">mpegpicture.h:45</a></div></div>
<div class="ttc" id="amotion__est__template_8c_html_a6c3ca8691cc7091a5c12fb4deb648c01"><div class="ttname"><a href="motion__est__template_8c.html#a6c3ca8691cc7091a5c12fb4deb648c01">hpel_motion_search</a></div><div class="ttdeci">static int hpel_motion_search(MpegEncContext *s, int *mx_ptr, int *my_ptr, int dmin, int src_index, int ref_index, int size, int h)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est__template_8c_source.html#l00050">motion_est_template.c:50</a></div></div>
<div class="ttc" id="amotion__est_8c_html_ab85c46e90aba6dd6961a58415ac09eac"><div class="ttname"><a href="motion__est_8c.html#ab85c46e90aba6dd6961a58415ac09eac">ff_get_best_fcode</a></div><div class="ttdeci">int ff_get_best_fcode(MpegEncContext *s, int16_t(*mv_table)[2], int type)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l01598">motion_est.c:1598</a></div></div>
<div class="ttc" id="aaarch64_2neontest_8h_html_afcc3d9d5c7982d75dd9756085f644a01"><div class="ttname"><a href="aarch64_2neontest_8h.html#afcc3d9d5c7982d75dd9756085f644a01">wrap</a></div><div class="ttdeci">#define wrap(func)</div><div class="ttdef"><b>Definition:</b> <a href="aarch64_2neontest_8h_source.html#l00065">neontest.h:65</a></div></div>
<div class="ttc" id="ampegutils_8h_html_a7eb7af26474d13fd9c035ee9e0eef80b"><div class="ttname"><a href="mpegutils_8h.html#a7eb7af26474d13fd9c035ee9e0eef80b">CANDIDATE_MB_TYPE_BIDIR</a></div><div class="ttdeci">#define CANDIDATE_MB_TYPE_BIDIR</div><div class="ttdef"><b>Definition:</b> <a href="mpegutils_8h_source.html#l00112">mpegutils.h:112</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a3a4d2d91da4f0c9d70bc3b8f1a8462c0"><div class="ttname"><a href="motion__est_8c.html#a3a4d2d91da4f0c9d70bc3b8f1a8462c0">CHECK_SAD_HALF_MV</a></div><div class="ttdeci">#define CHECK_SAD_HALF_MV(suffix, x, y)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00385">motion_est.c:385</a></div></div>
<div class="ttc" id="aituh263enc_8c_html_a35869db1e130a4cf46dc9163cb194531"><div class="ttname"><a href="ituh263enc_8c.html#a35869db1e130a4cf46dc9163cb194531">mv_penalty</a></div><div class="ttdeci">static uint8_t mv_penalty[MAX_FCODE+1][MAX_DMV *2+1]</div><div class="ttdef"><b>Definition:</b> <a href="ituh263enc_8c_source.html#l00047">ituh263enc.c:47</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a68d7a1b5a5e7aa7cb4a42f893b3cfc57"><div class="ttname"><a href="motion__est_8c.html#a68d7a1b5a5e7aa7cb4a42f893b3cfc57">P_MEDIAN</a></div><div class="ttdeci">#define P_MEDIAN</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00044">motion_est.c:44</a></div></div>
<div class="ttc" id="aavcodec_8h_html_a265e91f6d00ad75d918bedccfeedd08a"><div class="ttname"><a href="avcodec_8h.html#a265e91f6d00ad75d918bedccfeedd08a">FF_CMP_CHROMA</a></div><div class="ttdeci">#define FF_CMP_CHROMA</div><div class="ttdef"><b>Definition:</b> <a href="avcodec_8h_source.html#l00947">avcodec.h:947</a></div></div>
<div class="ttc" id="awriting__filters_8txt_html_a860450fba1f740387dc082792ad89517"><div class="ttname"><a href="writing__filters_8txt.html#a860450fba1f740387dc082792ad89517">type</a></div><div class="ttdeci">it s the only field you need to keep assuming you have a context There is some magic you don t need to care about around this just let it vf type</div><div class="ttdef"><b>Definition:</b> <a href="writing__filters_8txt_source.html#l00086">writing_filters.txt:86</a></div></div>
<div class="ttc" id="amotion__est_8h_html"><div class="ttname"><a href="motion__est_8h.html">motion_est.h</a></div></div>
<div class="ttc" id="aavcodec_8h_html_a08cc824c6da624325be6c0a48561729e"><div class="ttname"><a href="avcodec_8h.html#a08cc824c6da624325be6c0a48561729e">FF_CMP_SSE</a></div><div class="ttdeci">#define FF_CMP_SSE</div><div class="ttdef"><b>Definition:</b> <a href="avcodec_8h_source.html#l00932">avcodec.h:932</a></div></div>
<div class="ttc" id="amathops_8h_html_a7d92df17cf51f763cbd29c1bea3436dc"><div class="ttname"><a href="mathops_8h.html#a7d92df17cf51f763cbd29c1bea3436dc">ff_sqrt</a></div><div class="ttdeci">#define ff_sqrt</div><div class="ttdef"><b>Definition:</b> <a href="mathops_8h_source.html#l00206">mathops.h:206</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a49af71f3ffa9fa3c952ac93246ddbb27"><div class="ttname"><a href="motion__est_8c.html#a49af71f3ffa9fa3c952ac93246ddbb27">Minima</a></div><div class="ttdeci">struct Minima Minima</div></div>
<div class="ttc" id="ampegutils_8h_html_ac5b3437f815e738d56f4e61515500323"><div class="ttname"><a href="mpegutils_8h.html#ac5b3437f815e738d56f4e61515500323">CANDIDATE_MB_TYPE_INTER4V</a></div><div class="ttdeci">#define CANDIDATE_MB_TYPE_INTER4V</div><div class="ttdef"><b>Definition:</b> <a href="mpegutils_8h_source.html#l00106">mpegutils.h:106</a></div></div>
<div class="ttc" id="agroup__lavu__log__constants_html_gaffe151ff4cd8a24b2e77ac8d9616c85c"><div class="ttname"><a href="group__lavu__log__constants.html#gaffe151ff4cd8a24b2e77ac8d9616c85c">AV_LOG_ERROR</a></div><div class="ttdeci">#define AV_LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="log_8h_source.html#l00194">log.h:194</a></div></div>
<div class="ttc" id="amotion__est_8h_html_a1df7d470d965904adde0e67fed4480e4"><div class="ttname"><a href="motion__est_8h.html#a1df7d470d965904adde0e67fed4480e4">MAX_MV</a></div><div class="ttdeci">#define MAX_MV</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8h_source.html#l00035">motion_est.h:35</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a8291c1722da711c174d2a08f04f86109"><div class="ttname"><a href="motion__est_8c.html#a8291c1722da711c174d2a08f04f86109">get_limits</a></div><div class="ttdeci">static void get_limits(MpegEncContext *s, int x, int y)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00524">motion_est.c:524</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a7342164785de716c131fd37000235a42"><div class="ttname"><a href="motion__est_8c.html#a7342164785de716c131fd37000235a42">cmp_hpel</a></div><div class="ttdeci">static int cmp_hpel(MpegEncContext *s, const int x, const int y, const int subx, const int suby, const int size, const int h, int ref_index, int src_index, me_cmp_func cmp_func, me_cmp_func chroma_cmp_func, const int flags)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00275">motion_est.c:275</a></div></div>
<div class="ttc" id="aavcodec_8h_html_a4408d3a17a4de7dac2f99a751524ac27"><div class="ttname"><a href="avcodec_8h.html#a4408d3a17a4de7dac2f99a751524ac27">FF_CMP_BIT</a></div><div class="ttdeci">#define FF_CMP_BIT</div><div class="ttdef"><b>Definition:</b> <a href="avcodec_8h_source.html#l00936">avcodec.h:936</a></div></div>
<div class="ttc" id="alzw_8c_html_a450ea4ae52aeb4ca6e2fabf02c695153"><div class="ttname"><a href="lzw_8c.html#a450ea4ae52aeb4ca6e2fabf02c695153">mask</a></div><div class="ttdeci">static const uint16_t mask[17]</div><div class="ttdef"><b>Definition:</b> <a href="lzw_8c_source.html#l00038">lzw.c:38</a></div></div>
<div class="ttc" id="acbs__vp9_8c_html_a5950eda76c8ffc67651de936cd8c79ec"><div class="ttname"><a href="cbs__vp9_8c.html#a5950eda76c8ffc67651de936cd8c79ec">s</a></div><div class="ttdeci">#define s(width, name)</div><div class="ttdef"><b>Definition:</b> <a href="cbs__vp9_8c_source.html#l00257">cbs_vp9.c:257</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a569f503fc55139298e0a1b6e38cbe31b"><div class="ttname"><a href="motion__est_8c.html#a569f503fc55139298e0a1b6e38cbe31b">P_TOP</a></div><div class="ttdeci">#define P_TOP</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00042">motion_est.c:42</a></div></div>
<div class="ttc" id="amotion__est__template_8c_html_a982731b98e86abcd1af0d84102168e6e"><div class="ttname"><a href="motion__est__template_8c.html#a982731b98e86abcd1af0d84102168e6e">no_sub_motion_search</a></div><div class="ttdeci">static int no_sub_motion_search(MpegEncContext *s, int *mx_ptr, int *my_ptr, int dmin, int src_index, int ref_index, int size, int h)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est__template_8c_source.html#l00155">motion_est_template.c:155</a></div></div>
<div class="ttc" id="amotion__est_8c_html_ac88e2bef674db960a121abc44d6260f3"><div class="ttname"><a href="motion__est_8c.html#ac88e2bef674db960a121abc44d6260f3">ff_estimate_b_frame_motion</a></div><div class="ttdeci">void ff_estimate_b_frame_motion(MpegEncContext *s, int mb_x, int mb_y)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l01490">motion_est.c:1490</a></div></div>
<div class="ttc" id="ampegutils_8h_html_aeb712c6c6c0a8af0dfd79f451ecb9277a5bd89968f8e67aa8a34c703dcd1b5fd6"><div class="ttname"><a href="mpegutils_8h.html#aeb712c6c6c0a8af0dfd79f451ecb9277a5bd89968f8e67aa8a34c703dcd1b5fd6">FMT_H261</a></div><div class="ttdeci">@ FMT_H261</div><div class="ttdef"><b>Definition:</b> <a href="mpegutils_8h_source.html#l00125">mpegutils.h:125</a></div></div>
<div class="ttc" id="aavassert_8h_html_aae204192396f78cc8c5cd7ad5c57c23f"><div class="ttname"><a href="avassert_8h.html#aae204192396f78cc8c5cd7ad5c57c23f">av_assert0</a></div><div class="ttdeci">#define av_assert0(cond)</div><div class="ttdef"><b>Definition:</b> <a href="avassert_8h_source.html#l00037">avassert.h:37</a></div></div>
<div class="ttc" id="alimits_8h_html"><div class="ttname"><a href="limits_8h.html">limits.h</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a298213d16c81aa33a67382490e43c975"><div class="ttname"><a href="motion__est_8c.html#a298213d16c81aa33a67382490e43c975">get_penalty_factor</a></div><div class="ttdeci">static int get_penalty_factor(int lambda, int lambda2, int type)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00860">motion_est.c:860</a></div></div>
<div class="ttc" id="amotion__est_8c_html_ae9799fee842b207cf847788d5a2447f8"><div class="ttname"><a href="motion__est_8c.html#ae9799fee842b207cf847788d5a2447f8">init_interlaced_ref</a></div><div class="ttdeci">static void init_interlaced_ref(MpegEncContext *s, int ref_index)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00725">motion_est.c:725</a></div></div>
<div class="ttc" id="astruct_minima_html_a78fb665760d0fa71774e3354e7432db2"><div class="ttname"><a href="struct_minima.html#a78fb665760d0fa71774e3354e7432db2">Minima::checked</a></div><div class="ttdeci">int checked</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00069">motion_est.c:69</a></div></div>
<div class="ttc" id="amotion__est_8c_html_aa8dbd96e837401561874816377fb71a1"><div class="ttname"><a href="motion__est_8c.html#aa8dbd96e837401561874816377fb71a1">cmp</a></div><div class="ttdeci">static av_always_inline int cmp(MpegEncContext *s, const int x, const int y, const int subx, const int suby, const int size, const int h, int ref_index, int src_index, me_cmp_func cmp_func, me_cmp_func chroma_cmp_func, const int flags)</div><div class="ttdoc">compares a block (either a full macroblock or a partition thereof) against a proposed motion-compensa...</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00260">motion_est.c:260</a></div></div>
<div class="ttc" id="acommon_8h_html_ad6d88940cfc29c13a3e51ded211fc242"><div class="ttname"><a href="common_8h.html#ad6d88940cfc29c13a3e51ded211fc242">FFABS</a></div><div class="ttdeci">#define FFABS(a)</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00072">common.h:72</a></div></div>
<div class="ttc" id="afilter__design_8txt_html_a0e82f1088fdc24c14bf175d2ac77523f"><div class="ttname"><a href="filter__design_8txt.html#a0e82f1088fdc24c14bf175d2ac77523f">if</a></div><div class="ttdeci">if(ret)</div><div class="ttdef"><b>Definition:</b> <a href="filter__design_8txt_source.html#l00179">filter_design.txt:179</a></div></div>
<div class="ttc" id="amotion__est_8c_html_af890055a90af1f471bdec2fe9cb77231"><div class="ttname"><a href="motion__est_8c.html#af890055a90af1f471bdec2fe9cb77231">P_TOPRIGHT</a></div><div class="ttdeci">#define P_TOPRIGHT</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00043">motion_est.c:43</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a51273d274807fce7296dc30d6e79f4c1"><div class="ttname"><a href="motion__est_8c.html#a51273d274807fce7296dc30d6e79f4c1">P_MV1</a></div><div class="ttdeci">#define P_MV1</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00045">motion_est.c:45</a></div></div>
<div class="ttc" id="acoverity_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="coverity_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="coverity_8c_source.html#l00032">coverity.c:32</a></div></div>
<div class="ttc" id="avf__palettegen_8c_html_ae342d1a8ad4d2ea56462fc096983664e"><div class="ttname"><a href="vf__palettegen_8c.html#ae342d1a8ad4d2ea56462fc096983664e">cmp_func</a></div><div class="ttdeci">int(* cmp_func)(const void *, const void *)</div><div class="ttdef"><b>Definition:</b> <a href="vf__palettegen_8c_source.html#l00109">vf_palettegen.c:109</a></div></div>
<div class="ttc" id="amotion__est__template_8c_html_a754506c51e164526d8160ebfb3afc96b"><div class="ttname"><a href="motion__est__template_8c.html#a754506c51e164526d8160ebfb3afc96b">get_mb_score</a></div><div class="ttdeci">static int get_mb_score(MpegEncContext *s, int mx, int my, int src_index, int ref_index, int size, int h, int add_rate)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est__template_8c_source.html#l00165">motion_est_template.c:165</a></div></div>
<div class="ttc" id="amotion__est__template_8c_html"><div class="ttname"><a href="motion__est__template_8c.html">motion_est_template.c</a></div></div>
<div class="ttc" id="atests_2checkasm_2vp8dsp_8c_html_a858376c0918f93e656c8c0d76c63dbe8"><div class="ttname"><a href="tests_2checkasm_2vp8dsp_8c.html#a858376c0918f93e656c8c0d76c63dbe8">src</a></div><div class="ttdeci">#define src</div><div class="ttdef"><b>Definition:</b> <a href="tests_2checkasm_2vp8dsp_8c_source.html#l00254">vp8dsp.c:254</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a4f220553feb940f2d98d8ce2b4d1227d"><div class="ttname"><a href="motion__est_8c.html#a4f220553feb940f2d98d8ce2b4d1227d">ME_MAP_MV_BITS</a></div><div class="ttdeci">#define ME_MAP_MV_BITS</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00048">motion_est.c:48</a></div></div>
<div class="ttc" id="amotion__est_8c_html_ac1c01a1cce64441fc6c1dae645b68f9b"><div class="ttname"><a href="motion__est_8c.html#ac1c01a1cce64441fc6c1dae645b68f9b">direct_search</a></div><div class="ttdeci">static int direct_search(MpegEncContext *s, int mb_x, int mb_y)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l01388">motion_est.c:1388</a></div></div>
<div class="ttc" id="aavcodec_8h_html_ac07b09eadb08fd0c03b1a321bdd0a87e"><div class="ttname"><a href="avcodec_8h.html#ac07b09eadb08fd0c03b1a321bdd0a87e">FF_MB_DECISION_SIMPLE</a></div><div class="ttdeci">#define FF_MB_DECISION_SIMPLE</div><div class="ttdoc">uses mb_cmp</div><div class="ttdef"><b>Definition:</b> <a href="avcodec_8h_source.html#l01015">avcodec.h:1015</a></div></div>
<div class="ttc" id="aavcodec_8h_html_afd49ad1e465d3fc2dfa1307bd9f7bb71"><div class="ttname"><a href="avcodec_8h.html#afd49ad1e465d3fc2dfa1307bd9f7bb71">FF_CMP_MEDIAN_SAD</a></div><div class="ttdeci">#define FF_CMP_MEDIAN_SAD</div><div class="ttdef"><b>Definition:</b> <a href="avcodec_8h_source.html#l00946">avcodec.h:946</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a6d27971967536143702e3f8e23e71b32"><div class="ttname"><a href="motion__est_8c.html#a6d27971967536143702e3f8e23e71b32">h263_mv4_search</a></div><div class="ttdeci">static int h263_mv4_search(MpegEncContext *s, int mx, int my, int shift)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00571">motion_est.c:571</a></div></div>
<div class="ttc" id="amotion__est_8h_html_a503dd0cae8a23f8c6b5767888250a72f"><div class="ttname"><a href="motion__est_8h.html#a503dd0cae8a23f8c6b5767888250a72f">ME_MAP_SIZE</a></div><div class="ttdeci">#define ME_MAP_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8h_source.html#l00038">motion_est.h:38</a></div></div>
<div class="ttc" id="agxfenc_8c_html_a750b5d744c39a06bfb13e6eb010e35d0"><div class="ttname"><a href="gxfenc_8c.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a></div><div class="ttdeci">int index</div><div class="ttdef"><b>Definition:</b> <a href="gxfenc_8c_source.html#l00089">gxfenc.c:89</a></div></div>
<div class="ttc" id="aundefined_8txt_html_a12d8853991e25cc8d069554379c29ef6"><div class="ttname"><a href="undefined_8txt.html#a12d8853991e25cc8d069554379c29ef6">c</a></div><div class="ttdeci">Undefined Behavior In the C some operations are like signed integer dereferencing freed accessing outside allocated Undefined Behavior must not occur in a C it is not safe even if the output of undefined operations is unused The unsafety may seem nit picking but Optimizing compilers have in fact optimized code on the assumption that no undefined Behavior occurs Optimizing code based on wrong assumptions can and has in some cases lead to effects beyond the output of computations The signed integer overflow problem in speed critical code Code which is highly optimized and works with signed integers sometimes has the problem that often the output of the computation does not c</div><div class="ttdef"><b>Definition:</b> <a href="undefined_8txt_source.html#l00032">undefined.txt:32</a></div></div>
<div class="ttc" id="amotion__est_8h_html_a55c27d33d3ab1c93c0baa2923a85ff74"><div class="ttname"><a href="motion__est_8h.html#a55c27d33d3ab1c93c0baa2923a85ff74">ff_epzs_motion_search</a></div><div class="ttdeci">int ff_epzs_motion_search(struct MpegEncContext *s, int *mx_ptr, int *my_ptr, int P[10][2], int src_index, int ref_index, int16_t(*last_mv)[2], int ref_mv_scale, int size, int h)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est__template_8c_source.html#l00976">motion_est_template.c:976</a></div></div>
<div class="ttc" id="ampegvideo_8h_html_a98f9328b4f99d0b6a3974cf441633edf"><div class="ttname"><a href="mpegvideo_8h.html#a98f9328b4f99d0b6a3974cf441633edf">MV_TYPE_8X8</a></div><div class="ttdeci">#define MV_TYPE_8X8</div><div class="ttdoc">4 vectors (H.263, MPEG-4 4MV)</div><div class="ttdef"><b>Definition:</b> <a href="mpegvideo_8h_source.html#l00267">mpegvideo.h:267</a></div></div>
<div class="ttc" id="atableprint__vlc_8h_html_a8e3eb32799f4637fcdd75bb9099142ff"><div class="ttname"><a href="tableprint__vlc_8h.html#a8e3eb32799f4637fcdd75bb9099142ff">ff_dlog</a></div><div class="ttdeci">#define ff_dlog(a,...)</div><div class="ttdef"><b>Definition:</b> <a href="tableprint__vlc_8h_source.html#l00029">tableprint_vlc.h:29</a></div></div>
<div class="ttc" id="agroup__lavc__core_html_ga0e51f9240c85bc00f9dd684f020e2150"><div class="ttname"><a href="group__lavc__core.html#ga0e51f9240c85bc00f9dd684f020e2150">AV_CODEC_FLAG_QPEL</a></div><div class="ttdeci">#define AV_CODEC_FLAG_QPEL</div><div class="ttdef"><b>Definition:</b> <a href="avcodec_8h_source.html#l00287">avcodec.h:287</a></div></div>
<div class="ttc" id="aavcodec_8h_html_aa1a37935d19036f578c5e766178f59b6"><div class="ttname"><a href="avcodec_8h.html#aa1a37935d19036f578c5e766178f59b6">FF_CMP_PSNR</a></div><div class="ttdeci">#define FF_CMP_PSNR</div><div class="ttdef"><b>Definition:</b> <a href="avcodec_8h_source.html#l00935">avcodec.h:935</a></div></div>
<div class="ttc" id="ampegaudioenc__template_8c_html_a2748566f4c443ee77aa831e63dbb5ebe"><div class="ttname"><a href="mpegaudioenc__template_8c.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a></div><div class="ttdeci">#define P</div></div>
<div class="ttc" id="amotion__est_8c_html_a9c2bbf5027cde81a350968b13c82d698"><div class="ttname"><a href="motion__est_8c.html#a9c2bbf5027cde81a350968b13c82d698">ff_pre_estimate_p_frame_motion</a></div><div class="ttdeci">int ff_pre_estimate_p_frame_motion(MpegEncContext *s, int mb_x, int mb_y)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l01061">motion_est.c:1061</a></div></div>
<div class="ttc" id="acommon_8h_html_a9960bd6780a9b16a216a57be1ee04359"><div class="ttname"><a href="common_8h.html#a9960bd6780a9b16a216a57be1ee04359">FFMAX</a></div><div class="ttdeci">#define FFMAX(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00094">common.h:94</a></div></div>
<div class="ttc" id="aavcodec_8h_html_a083963028b2c118103c8f6bcfc2e024f"><div class="ttname"><a href="avcodec_8h.html#a083963028b2c118103c8f6bcfc2e024f">FF_CMP_W53</a></div><div class="ttdeci">#define FF_CMP_W53</div><div class="ttdef"><b>Definition:</b> <a href="avcodec_8h_source.html#l00942">avcodec.h:942</a></div></div>
<div class="ttc" id="adjgpp_2math_8h_html_a28f5f6ee7e8f9f5f8487de5f736de821"><div class="ttname"><a href="djgpp_2math_8h.html#a28f5f6ee7e8f9f5f8487de5f736de821">fmin</a></div><div class="ttdeci">double fmin(double, double)</div></div>
<div class="ttc" id="astruct_mpeg_enc_context_html"><div class="ttname"><a href="struct_mpeg_enc_context.html">MpegEncContext</a></div><div class="ttdef"><b>Definition:</b> <a href="mpegvideo_8h_source.html#l00081">mpegvideo.h:81</a></div></div>
<div class="ttc" id="amotion__est__template_8c_html_a0447f2099c0748d07a3a2cba75f34dc6"><div class="ttname"><a href="motion__est__template_8c.html#a0447f2099c0748d07a3a2cba75f34dc6">LOAD_COMMON</a></div><div class="ttdeci">#define LOAD_COMMON</div><div class="ttdef"><b>Definition:</b> <a href="motion__est__template_8c_source.html#l00031">motion_est_template.c:31</a></div></div>
<div class="ttc" id="ampegutils_8h_html_adbe5395238975cefb77eecc7df8b83b6"><div class="ttname"><a href="mpegutils_8h.html#adbe5395238975cefb77eecc7df8b83b6">CANDIDATE_MB_TYPE_DIRECT0</a></div><div class="ttdeci">#define CANDIDATE_MB_TYPE_DIRECT0</div><div class="ttdef"><b>Definition:</b> <a href="mpegutils_8h_source.html#l00119">mpegutils.h:119</a></div></div>
<div class="ttc" id="aavcodec_8h_html_a47d744af4e9db69ed15409ed056007c0"><div class="ttname"><a href="avcodec_8h.html#a47d744af4e9db69ed15409ed056007c0">FF_CMP_SATD</a></div><div class="ttdeci">#define FF_CMP_SATD</div><div class="ttdef"><b>Definition:</b> <a href="avcodec_8h_source.html#l00933">avcodec.h:933</a></div></div>
<div class="ttc" id="acommon_8h_html_a0f84cbd7fd810cd678157c98cbfad4b0"><div class="ttname"><a href="common_8h.html#a0f84cbd7fd810cd678157c98cbfad4b0">FFMIN</a></div><div class="ttdeci">#define FFMIN(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00096">common.h:96</a></div></div>
<div class="ttc" id="aundefined_8txt_html_ad99f336d4c117c453fef82993434eb4d"><div class="ttname"><a href="undefined_8txt.html#ad99f336d4c117c453fef82993434eb4d">a</a></div><div class="ttdeci">The reader does not expect b to be semantically here and if the code is changed by maybe adding a a division or other the signedness will almost certainly be mistaken To avoid this confusion a new type was SUINT is the C unsigned type but it holds a signed int to use the same example SUINT a</div><div class="ttdef"><b>Definition:</b> <a href="undefined_8txt_source.html#l00041">undefined.txt:41</a></div></div>
<div class="ttc" id="astruct_motion_est_context_html"><div class="ttname"><a href="struct_motion_est_context.html">MotionEstContext</a></div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8h_source.html#l00047">motion_est.h:47</a></div></div>
<div class="ttc" id="awriting__filters_8txt_html_ae1df9c886af8e844bb8849d403b76663"><div class="ttname"><a href="writing__filters_8txt.html#ae1df9c886af8e844bb8849d403b76663">offset</a></div><div class="ttdeci">it s the only field you need to keep assuming you have a context There is some magic you don t need to care about around this just let it vf offset</div><div class="ttdef"><b>Definition:</b> <a href="writing__filters_8txt_source.html#l00086">writing_filters.txt:86</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a7ffe1e53de97c1b596f6a274ce9a2c05"><div class="ttname"><a href="motion__est_8c.html#a7ffe1e53de97c1b596f6a274ce9a2c05">HASH8</a></div><div class="ttdeci">#define HASH8(fx, fy, bx, by)</div></div>
<div class="ttc" id="aavcodec_8h_html_a5ced04f38d12ad119dda509da1b43eb7"><div class="ttname"><a href="avcodec_8h.html#a5ced04f38d12ad119dda509da1b43eb7">FF_CMP_SAD</a></div><div class="ttdeci">#define FF_CMP_SAD</div><div class="ttdef"><b>Definition:</b> <a href="avcodec_8h_source.html#l00931">avcodec.h:931</a></div></div>
<div class="ttc" id="aavcodec_8h_html_a661eaec472e284a3b2920647349471dd"><div class="ttname"><a href="avcodec_8h.html#a661eaec472e284a3b2920647349471dd">FF_COMPLIANCE_NORMAL</a></div><div class="ttdeci">#define FF_COMPLIANCE_NORMAL</div><div class="ttdef"><b>Definition:</b> <a href="avcodec_8h_source.html#l01592">avcodec.h:1592</a></div></div>
<div class="ttc" id="amotion__est__template_8c_html_a8c691b507e22d7d56ccc60d7bee24493"><div class="ttname"><a href="motion__est__template_8c.html#a8c691b507e22d7d56ccc60d7bee24493">qpel_motion_search</a></div><div class="ttdeci">static int qpel_motion_search(MpegEncContext *s, int *mx_ptr, int *my_ptr, int dmin, int src_index, int ref_index, int size, int h)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est__template_8c_source.html#l00207">motion_est_template.c:207</a></div></div>
<div class="ttc" id="agroup__lavu__log__constants_html_gad172eacfed8653e454c6fdcbe53baab3"><div class="ttname"><a href="group__lavu__log__constants.html#gad172eacfed8653e454c6fdcbe53baab3">AV_LOG_INFO</a></div><div class="ttdeci">#define AV_LOG_INFO</div><div class="ttdef"><b>Definition:</b> <a href="log_8h_source.html#l00205">log.h:205</a></div></div>
<div class="ttc" id="astruct_picture_html_a58bd22d2d99b09d8b2bc7a2f33849255"><div class="ttname"><a href="struct_picture.html#a58bd22d2d99b09d8b2bc7a2f33849255">Picture::mb_mean</a></div><div class="ttdeci">uint8_t * mb_mean</div><div class="ttdoc">Table for MB luminance.</div><div class="ttdef"><b>Definition:</b> <a href="mpegpicture_8h_source.html#l00074">mpegpicture.h:74</a></div></div>
<div class="ttc" id="amotion__est_8c_html_aae0d3379c290082fb581db00fbd3bb1e"><div class="ttname"><a href="motion__est_8c.html#aae0d3379c290082fb581db00fbd3bb1e">bidir_refine</a></div><div class="ttdeci">static int bidir_refine(MpegEncContext *s, int mb_x, int mb_y)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l01241">motion_est.c:1241</a></div></div>
<div class="ttc" id="aavassert_8h_html_a2764bf422e4df5bf3aac652f21fe780a"><div class="ttname"><a href="avassert_8h.html#a2764bf422e4df5bf3aac652f21fe780a">av_assert2</a></div><div class="ttdeci">#define av_assert2(cond)</div><div class="ttdef"><b>Definition:</b> <a href="avassert_8h_source.html#l00064">avassert.h:64</a></div></div>
<div class="ttc" id="amotion__est_8c_html_abfcb2c97c1457c7be1ecfc61c26751a9"><div class="ttname"><a href="motion__est_8c.html#abfcb2c97c1457c7be1ecfc61c26751a9">ME_MAP_SHIFT</a></div><div class="ttdeci">#define ME_MAP_SHIFT</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00047">motion_est.c:47</a></div></div>
<div class="ttc" id="aattributes_8h_html_a438e7ed66a9e258ea0d1d1ff0c91e608"><div class="ttname"><a href="attributes_8h.html#a438e7ed66a9e258ea0d1d1ff0c91e608">av_builtin_constant_p</a></div><div class="ttdeci">#define av_builtin_constant_p(x)</div><div class="ttdef"><b>Definition:</b> <a href="attributes_8h_source.html#l00163">attributes.h:163</a></div></div>
<div class="ttc" id="ampegutils_8h_html_aeb712c6c6c0a8af0dfd79f451ecb9277acbc818c9ff383e30d36451d333dd1a1a"><div class="ttname"><a href="mpegutils_8h.html#aeb712c6c6c0a8af0dfd79f451ecb9277acbc818c9ff383e30d36451d333dd1a1a">FMT_H263</a></div><div class="ttdeci">@ FMT_H263</div><div class="ttdef"><b>Definition:</b> <a href="mpegutils_8h_source.html#l00126">mpegutils.h:126</a></div></div>
<div class="ttc" id="ainput_8c_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="input_8c.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="input_8c_source.html#l00407">input.c:407</a></div></div>
<div class="ttc" id="aavcodec_8h_html_af0e853ac6880d5ce4122b367f7f60b23"><div class="ttname"><a href="avcodec_8h.html#af0e853ac6880d5ce4122b367f7f60b23">FF_CMP_RD</a></div><div class="ttdeci">#define FF_CMP_RD</div><div class="ttdef"><b>Definition:</b> <a href="avcodec_8h_source.html#l00937">avcodec.h:937</a></div></div>
<div class="ttc" id="alibavutil_2internal_8h_html"><div class="ttname"><a href="libavutil_2internal_8h.html">internal.h</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a96d7936d8f679ebafa9f3d4f5e8e70a3"><div class="ttname"><a href="motion__est_8c.html#a96d7936d8f679ebafa9f3d4f5e8e70a3">init_mv4_ref</a></div><div class="ttdeci">static void init_mv4_ref(MotionEstContext *c)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00560">motion_est.c:560</a></div></div>
<div class="ttc" id="aavassert_8h_html_a557ed9c8df70c282bf6b7e0e07d7d5b0"><div class="ttname"><a href="avassert_8h.html#a557ed9c8df70c282bf6b7e0e07d7d5b0">av_assert1</a></div><div class="ttdeci">#define av_assert1(cond)</div><div class="ttdef"><b>Definition:</b> <a href="avassert_8h_source.html#l00053">avassert.h:53</a></div></div>
<div class="ttc" id="astruct_minima_html_ac1d307fee8b7d782734be2896e39e000"><div class="ttname"><a href="struct_minima.html#ac1d307fee8b7d782734be2896e39e000">Minima::height</a></div><div class="ttdeci">int height</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00067">motion_est.c:67</a></div></div>
<div class="ttc" id="aattributes_8h_html_a28f50f4c125959216885f01d56dbe866"><div class="ttname"><a href="attributes_8h.html#a28f50f4c125959216885f01d56dbe866">av_always_inline</a></div><div class="ttdeci">#define av_always_inline</div><div class="ttdef"><b>Definition:</b> <a href="attributes_8h_source.html#l00049">attributes.h:49</a></div></div>
<div class="ttc" id="aavcodec_8h_html_a4a7e6a77e5f27d3fc1a8de5effa3897c"><div class="ttname"><a href="avcodec_8h.html#a4a7e6a77e5f27d3fc1a8de5effa3897c">FF_CMP_NSSE</a></div><div class="ttdeci">#define FF_CMP_NSSE</div><div class="ttdef"><b>Definition:</b> <a href="avcodec_8h_source.html#l00941">avcodec.h:941</a></div></div>
<div class="ttc" id="aaudio__convert_8c_html_ae1affc9ca37cfb624959c866a73f83c2"><div class="ttname"><a href="audio__convert_8c.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a></div><div class="ttdeci">uint8_t</div><div class="ttdef"><b>Definition:</b> <a href="audio__convert_8c_source.html#l00194">audio_convert.c:194</a></div></div>
<div class="ttc" id="amotion__est__template_8c_html_ad2bc0764a3c0ba33006bcdec8228a282"><div class="ttname"><a href="motion__est__template_8c.html#ad2bc0764a3c0ba33006bcdec8228a282">MAX_SAB_SIZE</a></div><div class="ttdeci">#define MAX_SAB_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="motion__est__template_8c_source.html#l00679">motion_est_template.c:679</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a4a506db79296eee3bab2b087f27801ca"><div class="ttname"><a href="motion__est_8c.html#a4a506db79296eee3bab2b087f27801ca">ff_init_me</a></div><div class="ttdeci">int ff_init_me(MpegEncContext *s)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00306">motion_est.c:306</a></div></div>
<div class="ttc" id="ahevc__mvs_8c_html_a8ed92cefaaf458a85c494202a6b32409"><div class="ttname"><a href="hevc__mvs_8c.html#a8ed92cefaaf458a85c494202a6b32409">mv_scale</a></div><div class="ttdeci">static av_always_inline void mv_scale(Mv *dst, Mv *src, int td, int tb)</div><div class="ttdef"><b>Definition:</b> <a href="hevc__mvs_8c_source.html#l00115">hevc_mvs.c:115</a></div></div>
<div class="ttc" id="ampegutils_8h_html_a6b6fdfcea7012d8c7dbdd4321c08b862"><div class="ttname"><a href="mpegutils_8h.html#a6b6fdfcea7012d8c7dbdd4321c08b862">CANDIDATE_MB_TYPE_DIRECT</a></div><div class="ttdeci">#define CANDIDATE_MB_TYPE_DIRECT</div><div class="ttdef"><b>Definition:</b> <a href="mpegutils_8h_source.html#l00109">mpegutils.h:109</a></div></div>
<div class="ttc" id="aavcodec_8h_html"><div class="ttname"><a href="avcodec_8h.html">avcodec.h</a></div></div>
<div class="ttc" id="amotion__est_8c_html_ad11b393e2138c92edda4b5a9406e0eb8"><div class="ttname"><a href="motion__est_8c.html#ad11b393e2138c92edda4b5a9406e0eb8">zero_hpel</a></div><div class="ttdeci">static void zero_hpel(uint8_t *a, const uint8_t *b, ptrdiff_t stride, int h)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00303">motion_est.c:303</a></div></div>
<div class="ttc" id="amathops_8h_html_a6948a24017ba60d76640f7587429a9f6"><div class="ttname"><a href="mathops_8h.html#a6948a24017ba60d76640f7587429a9f6">mid_pred</a></div><div class="ttdeci">#define mid_pred</div><div class="ttdef"><b>Definition:</b> <a href="mathops_8h_source.html#l00097">mathops.h:97</a></div></div>
<div class="ttc" id="amotion__est__template_8c_html_a9060494a0b2837cbe7f85a352e2cfbf0"><div class="ttname"><a href="motion__est__template_8c.html#a9060494a0b2837cbe7f85a352e2cfbf0">epzs_motion_search2</a></div><div class="ttdeci">static int epzs_motion_search2(MpegEncContext *s, int *mx_ptr, int *my_ptr, int P[10][2], int src_index, int ref_index, int16_t(*last_mv)[2], int ref_mv_scale, const int size)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est__template_8c_source.html#l00992">motion_est_template.c:992</a></div></div>
<div class="ttc" id="ampegvideo_8h_html_a7f5f72b0628939f9942f9e43bfa371cc"><div class="ttname"><a href="mpegvideo_8h.html#a7f5f72b0628939f9942f9e43bfa371cc">FF_MPV_FLAG_MV0</a></div><div class="ttdeci">#define FF_MPV_FLAG_MV0</div><div class="ttdef"><b>Definition:</b> <a href="mpegvideo_8h_source.html#l00593">mpegvideo.h:593</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a40a1fad0d5f30fc21b6b4ee474b66b37"><div class="ttname"><a href="motion__est_8c.html#a40a1fad0d5f30fc21b6b4ee474b66b37">FLAG_CHROMA</a></div><div class="ttdeci">#define FLAG_CHROMA</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00080">motion_est.c:80</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a3b5b6bf22c2f7bac4e28094de2a47e64"><div class="ttname"><a href="motion__est_8c.html#a3b5b6bf22c2f7bac4e28094de2a47e64">estimate_motion_b</a></div><div class="ttdeci">static int estimate_motion_b(MpegEncContext *s, int mb_x, int mb_y, int16_t(*mv_table)[2], int ref_index, int f_code)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l01114">motion_est.c:1114</a></div></div>
<div class="ttc" id="astruct_picture_html_a702f8e577cd4df73f4b6f448319aef97"><div class="ttname"><a href="struct_picture.html#a702f8e577cd4df73f4b6f448319aef97">Picture::mb_var</a></div><div class="ttdeci">uint16_t * mb_var</div><div class="ttdoc">Table for MB variances.</div><div class="ttdef"><b>Definition:</b> <a href="mpegpicture_8h_source.html#l00065">mpegpicture.h:65</a></div></div>
<div class="ttc" id="astruct_picture_html_a6f5fb4157107761a2c16d3ec2710bb37"><div class="ttname"><a href="struct_picture.html#a6f5fb4157107761a2c16d3ec2710bb37">Picture::mc_mb_var</a></div><div class="ttdeci">uint16_t * mc_mb_var</div><div class="ttdoc">Table for motion compensated MB variances.</div><div class="ttdef"><b>Definition:</b> <a href="mpegpicture_8h_source.html#l00068">mpegpicture.h:68</a></div></div>
<div class="ttc" id="ampegutils_8h_html_a3eb309beaf81e3cec0411160b4926e27"><div class="ttname"><a href="mpegutils_8h.html#a3eb309beaf81e3cec0411160b4926e27">CANDIDATE_MB_TYPE_BIDIR_I</a></div><div class="ttdeci">#define CANDIDATE_MB_TYPE_BIDIR_I</div><div class="ttdef"><b>Definition:</b> <a href="mpegutils_8h_source.html#l00117">mpegutils.h:117</a></div></div>
<div class="ttc" id="amotion__est_8c_html_aa24c5a6ce7cbb044271633d20a7b7a36"><div class="ttname"><a href="motion__est_8c.html#aa24c5a6ce7cbb044271633d20a7b7a36">FLAG_QPEL</a></div><div class="ttdeci">#define FLAG_QPEL</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00079">motion_est.c:79</a></div></div>
<div class="ttc" id="agroup__lavu__mem__funcs_html_ga34e10fdac079a9ca4512b8ccd7f20b8a"><div class="ttname"><a href="group__lavu__mem__funcs.html#ga34e10fdac079a9ca4512b8ccd7f20b8a">size</a></div><div class="ttdeci">int size</div><div class="ttdef"><b>Definition:</b> <a href="twinvq__data_8h_source.html#l11134">twinvq_data.h:11134</a></div></div>
<div class="ttc" id="ax86_2mathops_8h_html"><div class="ttname"><a href="x86_2mathops_8h.html">mathops.h</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a5679cadd65e637f7a28c99a30099fbf3"><div class="ttname"><a href="motion__est_8c.html#a5679cadd65e637f7a28c99a30099fbf3">ff_fix_long_mvs</a></div><div class="ttdeci">void ff_fix_long_mvs(MpegEncContext *s, uint8_t *field_select_table, int field_select, int16_t(*mv_table)[2], int f_code, int type, int truncate)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l01700">motion_est.c:1700</a></div></div>
<div class="ttc" id="agroup__lavc__core_html_ggaadca229ad2c20e060a14fec08a5cc7cea253b7f23251a791e6f1d95a86dbab0cd"><div class="ttname"><a href="group__lavc__core.html#ggaadca229ad2c20e060a14fec08a5cc7cea253b7f23251a791e6f1d95a86dbab0cd">AV_CODEC_ID_SNOW</a></div><div class="ttdeci">@ AV_CODEC_ID_SNOW</div><div class="ttdef"><b>Definition:</b> <a href="codec__id_8h_source.html#l00259">codec_id.h:259</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a359a476e54bd7ef7176967224fdabf60"><div class="ttname"><a href="motion__est_8c.html#a359a476e54bd7ef7176967224fdabf60">ff_estimate_p_frame_motion</a></div><div class="ttdeci">void ff_estimate_p_frame_motion(MpegEncContext *s, int mb_x, int mb_y)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00885">motion_est.c:885</a></div></div>
<div class="ttc" id="ampegutils_8h_html_a0628ca7c41ad229d1786fd2ccddd0ed8"><div class="ttname"><a href="mpegutils_8h.html#a0628ca7c41ad229d1786fd2ccddd0ed8">CANDIDATE_MB_TYPE_INTRA</a></div><div class="ttdeci">#define CANDIDATE_MB_TYPE_INTRA</div><div class="ttdef"><b>Definition:</b> <a href="mpegutils_8h_source.html#l00104">mpegutils.h:104</a></div></div>
<div class="ttc" id="agroup__lavu__picture_html_ggae6cbcab1f70d8e476757f1c1f5a0a78ead22f8968e99bc48897c3f4ac29e82dae"><div class="ttname"><a href="group__lavu__picture.html#ggae6cbcab1f70d8e476757f1c1f5a0a78ead22f8968e99bc48897c3f4ac29e82dae">AV_PICTURE_TYPE_B</a></div><div class="ttdeci">@ AV_PICTURE_TYPE_B</div><div class="ttdoc">Bi-dir predicted.</div><div class="ttdef"><b>Definition:</b> <a href="avutil_8h_source.html#l00276">avutil.h:276</a></div></div>
<div class="ttc" id="aavcodec_8h_html_a25c94282d6ab84f5f8e6803105813527"><div class="ttname"><a href="avcodec_8h.html#a25c94282d6ab84f5f8e6803105813527">FF_CMP_DCT</a></div><div class="ttdeci">#define FF_CMP_DCT</div><div class="ttdef"><b>Definition:</b> <a href="avcodec_8h_source.html#l00934">avcodec.h:934</a></div></div>
<div class="ttc" id="atests_2jpeg2000dwt_8c_html_a5cabdd8be5af41f675fed06498e094b7"><div class="ttname"><a href="tests_2jpeg2000dwt_8c.html#a5cabdd8be5af41f675fed06498e094b7">ref</a></div><div class="ttdeci">static int ref[MAX_W *MAX_W]</div><div class="ttdef"><b>Definition:</b> <a href="tests_2jpeg2000dwt_8c_source.html#l00107">jpeg2000dwt.c:107</a></div></div>
<div class="ttc" id="ampegutils_8h_html_a90d67c3d117b86b0b0cd28705364731c"><div class="ttname"><a href="mpegutils_8h.html#a90d67c3d117b86b0b0cd28705364731c">CANDIDATE_MB_TYPE_FORWARD</a></div><div class="ttdeci">#define CANDIDATE_MB_TYPE_FORWARD</div><div class="ttdef"><b>Definition:</b> <a href="mpegutils_8h_source.html#l00110">mpegutils.h:110</a></div></div>
<div class="ttc" id="asonic_8c_html_aee201839e95f7edeff51ad9c8e072bda"><div class="ttname"><a href="sonic_8c.html#aee201839e95f7edeff51ad9c8e072bda">shift</a></div><div class="ttdeci">static int shift(int a, int b)</div><div class="ttdef"><b>Definition:</b> <a href="sonic_8c_source.html#l00082">sonic.c:82</a></div></div>
<div class="ttc" id="agroup__lavu__picture_html_ggae6cbcab1f70d8e476757f1c1f5a0a78eaa6fc0479507a03f173f07fc75dab2193"><div class="ttname"><a href="group__lavu__picture.html#ggae6cbcab1f70d8e476757f1c1f5a0a78eaa6fc0479507a03f173f07fc75dab2193">AV_PICTURE_TYPE_P</a></div><div class="ttdeci">@ AV_PICTURE_TYPE_P</div><div class="ttdoc">Predicted.</div><div class="ttdef"><b>Definition:</b> <a href="avutil_8h_source.html#l00275">avutil.h:275</a></div></div>
<div class="ttc" id="ahwcontext__vdpau_8c_html_a2996cc16b36e13c9010705bad768e866"><div class="ttname"><a href="hwcontext__vdpau_8c.html#a2996cc16b36e13c9010705bad768e866">map</a></div><div class="ttdeci">const VDPAUPixFmtMap * map</div><div class="ttdef"><b>Definition:</b> <a href="hwcontext__vdpau_8c_source.html#l00071">hwcontext_vdpau.c:71</a></div></div>
<div class="ttc" id="astruct_minima_html_aef76135c12e75fcf0aba085887cf6352"><div class="ttname"><a href="struct_minima.html#aef76135c12e75fcf0aba085887cf6352">Minima::x</a></div><div class="ttdeci">int x</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00068">motion_est.c:68</a></div></div>
<div class="ttc" id="aavcodec_8h_html_a02d665e44512df1db73fde009c8aa3ca"><div class="ttname"><a href="avcodec_8h.html#a02d665e44512df1db73fde009c8aa3ca">FF_CMP_DCT264</a></div><div class="ttdeci">#define FF_CMP_DCT264</div><div class="ttdef"><b>Definition:</b> <a href="avcodec_8h_source.html#l00945">avcodec.h:945</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a5712491315de45680cf9869c5fc0ce7a"><div class="ttname"><a href="motion__est_8c.html#a5712491315de45680cf9869c5fc0ce7a">cmp_fpel_internal</a></div><div class="ttdeci">static int cmp_fpel_internal(MpegEncContext *s, const int x, const int y, const int size, const int h, int ref_index, int src_index, me_cmp_func cmp_func, me_cmp_func chroma_cmp_func, const int flags)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00237">motion_est.c:237</a></div></div>
<div class="ttc" id="astruct_minima_html_ac5910eda3e4332d567f351f42bde117a"><div class="ttname"><a href="struct_minima.html#ac5910eda3e4332d567f351f42bde117a">Minima::y</a></div><div class="ttdeci">int y</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00068">motion_est.c:68</a></div></div>
<div class="ttc" id="ame__cmp_8h_html_aaaf0538a95053ebc8b9662cc61b7191f"><div class="ttname"><a href="me__cmp_8h.html#aaaf0538a95053ebc8b9662cc61b7191f">me_cmp_func</a></div><div class="ttdeci">int(* me_cmp_func)(struct MpegEncContext *c, uint8_t *blk1, uint8_t *blk2, ptrdiff_t stride, int h)</div><div class="ttdef"><b>Definition:</b> <a href="me__cmp_8h_source.html#l00048">me_cmp.h:48</a></div></div>
<div class="ttc" id="acbs__av1_8c_html_a67119bce106892b6dade1dc5aa405ac9"><div class="ttname"><a href="cbs__av1_8c.html#a67119bce106892b6dade1dc5aa405ac9">flags</a></div><div class="ttdeci">#define flags(name, subs,...)</div><div class="ttdef"><b>Definition:</b> <a href="cbs__av1_8c_source.html#l00560">cbs_av1.c:560</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a5022bf1a3af5defbb33270233241c2e7"><div class="ttname"><a href="motion__est_8c.html#a5022bf1a3af5defbb33270233241c2e7">set_p_mv_tables</a></div><div class="ttdeci">static void set_p_mv_tables(MpegEncContext *s, int mx, int my, int mv4)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00497">motion_est.c:497</a></div></div>
<div class="ttc" id="afilter__design_8txt_html_a17afa58b2bc574dedcd1cc02e1fdf165"><div class="ttname"><a href="filter__design_8txt.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a></div><div class="ttdeci">The exact code depends on how similar the blocks are and how related they are to the block</div><div class="ttdef"><b>Definition:</b> <a href="filter__design_8txt_source.html#l00207">filter_design.txt:207</a></div></div>
<div class="ttc" id="atableprint__vlc_8h_html_af38b91523053c244564a94f1ef862c2c"><div class="ttname"><a href="tableprint__vlc_8h.html#af38b91523053c244564a94f1ef862c2c">av_log</a></div><div class="ttdeci">#define av_log(a,...)</div><div class="ttdef"><b>Definition:</b> <a href="tableprint__vlc_8h_source.html#l00028">tableprint_vlc.h:28</a></div></div>
<div class="ttc" id="avp9dsp__template_8c_html_a5e36941b3d856737e81516acd45edc50"><div class="ttname"><a href="vp9dsp__template_8c.html#a5e36941b3d856737e81516acd45edc50">h</a></div><div class="ttdeci">h</div><div class="ttdef"><b>Definition:</b> <a href="vp9dsp__template_8c_source.html#l02038">vp9dsp_template.c:2038</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a9e27a3952c14e8c97b71028756924090"><div class="ttname"><a href="motion__est_8c.html#a9e27a3952c14e8c97b71028756924090">HASH</a></div><div class="ttdeci">#define HASH(fx, fy, bx, by)</div></div>
<div class="ttc" id="agroup__lavc__core_html_ggaadca229ad2c20e060a14fec08a5cc7ceaf614abb36f7c5d0c42ed522c1d6c99f0"><div class="ttname"><a href="group__lavc__core.html#ggaadca229ad2c20e060a14fec08a5cc7ceaf614abb36f7c5d0c42ed522c1d6c99f0">AV_CODEC_ID_MPEG2VIDEO</a></div><div class="ttdeci">@ AV_CODEC_ID_MPEG2VIDEO</div><div class="ttdoc">preferred ID for MPEG-1/2 video decoding</div><div class="ttdef"><b>Definition:</b> <a href="codec__id_8h_source.html#l00051">codec_id.h:51</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a7d41bef5a92f2cea22ac3ab24ce14c38"><div class="ttname"><a href="motion__est_8c.html#a7d41bef5a92f2cea22ac3ab24ce14c38">zero_cmp</a></div><div class="ttdeci">static int zero_cmp(MpegEncContext *s, uint8_t *a, uint8_t *b, ptrdiff_t stride, int h)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00297">motion_est.c:297</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a8d487dcbee8d1f4d01795a2c5abb43bd"><div class="ttname"><a href="motion__est_8c.html#a8d487dcbee8d1f4d01795a2c5abb43bd">FLAG_DIRECT</a></div><div class="ttdeci">#define FLAG_DIRECT</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00081">motion_est.c:81</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a922289dee948023bcdefbefa1c10bde7"><div class="ttname"><a href="motion__est_8c.html#a922289dee948023bcdefbefa1c10bde7">sad_hpel_motion_search</a></div><div class="ttdeci">static int sad_hpel_motion_search(MpegEncContext *s, int *mx_ptr, int *my_ptr, int dmin, int src_index, int ref_index, int size, int h)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00392">motion_est.c:392</a></div></div>
<div class="ttc" id="amotion__est_8c_html_a5b7a747060090a1ea17649555ef960f4"><div class="ttname"><a href="motion__est_8c.html#a5b7a747060090a1ea17649555ef960f4">cmp_internal</a></div><div class="ttdeci">static int cmp_internal(MpegEncContext *s, const int x, const int y, const int subx, const int suby, const int size, const int h, int ref_index, int src_index, me_cmp_func cmp_func, me_cmp_func chroma_cmp_func, const int flags)</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8c_source.html#l00247">motion_est.c:247</a></div></div>
<div class="ttc" id="ampegutils_8h_html_a1a0f48150ffb3c9ea7e5c1c92babbea2"><div class="ttname"><a href="mpegutils_8h.html#a1a0f48150ffb3c9ea7e5c1c92babbea2">CANDIDATE_MB_TYPE_BACKWARD</a></div><div class="ttdeci">#define CANDIDATE_MB_TYPE_BACKWARD</div><div class="ttdef"><b>Definition:</b> <a href="mpegutils_8h_source.html#l00111">mpegutils.h:111</a></div></div>
<div class="ttc" id="amotion__est_8h_html_ae990b594d112ea5fd0574106cd9a0491"><div class="ttname"><a href="motion__est_8h.html#ae990b594d112ea5fd0574106cd9a0491">FF_ME_ZERO</a></div><div class="ttdeci">#define FF_ME_ZERO</div><div class="ttdef"><b>Definition:</b> <a href="motion__est_8h_source.html#l00040">motion_est.h:40</a></div></div>
<div class="ttc" id="aavcodec_8h_html_a301cef5b2b4e3268be40c9f30c7f371f"><div class="ttname"><a href="avcodec_8h.html#a301cef5b2b4e3268be40c9f30c7f371f">FF_CMP_W97</a></div><div class="ttdeci">#define FF_CMP_W97</div><div class="ttdef"><b>Definition:</b> <a href="avcodec_8h_source.html#l00943">avcodec.h:943</a></div></div>
<div class="ttc" id="avorbis__enc__data_8h_html_ad2e88d75f808e6d4e78d48bceb10c336"><div class="ttname"><a href="vorbis__enc__data_8h.html#ad2e88d75f808e6d4e78d48bceb10c336">min</a></div><div class="ttdeci">float min</div><div class="ttdef"><b>Definition:</b> <a href="vorbis__enc__data_8h_source.html#l00456">vorbis_enc_data.h:456</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
