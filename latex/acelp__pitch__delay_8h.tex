\hypertarget{acelp__pitch__delay_8h}{}\doxysection{E\+:/github/ffmpeg/libavcodec/acelp\+\_\+pitch\+\_\+delay.h File Reference}
\label{acelp__pitch__delay_8h}\index{E:/github/ffmpeg/libavcodec/acelp\_pitch\_delay.h@{E:/github/ffmpeg/libavcodec/acelp\_pitch\_delay.h}}
{\ttfamily \#include $<$stdint.\+h$>$}\newline
{\ttfamily \#include \char`\"{}audiodsp.\+h\char`\"{}}\newline
Include dependency graph for acelp\+\_\+pitch\+\_\+delay.\+h\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=215pt]{acelp__pitch__delay_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{acelp__pitch__delay_8h__dep__incl}
\end{center}
\end{figure}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{acelp__pitch__delay_8h_a4a381d05e10bc1599cb453d15436d9ee}{P\+I\+T\+C\+H\+\_\+\+D\+E\+L\+A\+Y\+\_\+\+M\+IN}}~20
\item 
\#define \mbox{\hyperlink{acelp__pitch__delay_8h_a7d8198259cf5aa2575bffe89cc5cf390}{P\+I\+T\+C\+H\+\_\+\+D\+E\+L\+A\+Y\+\_\+\+M\+AX}}~143
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} \mbox{\hyperlink{acelp__pitch__delay_8h_a12c976b62a541e647d9577ef2ea8ab80}{ff\+\_\+acelp\+\_\+decode\+\_\+8bit\+\_\+to\+\_\+1st\+\_\+delay3}} (\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} ac\+\_\+index)
\begin{DoxyCompactList}\small\item\em Decode pitch delay of the first subframe encoded by 8 bits with 1/3 resolution. \end{DoxyCompactList}\item 
\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} \mbox{\hyperlink{acelp__pitch__delay_8h_a487e7fe30512fec76fcc8f37e769e250}{ff\+\_\+acelp\+\_\+decode\+\_\+5\+\_\+6\+\_\+bit\+\_\+to\+\_\+2nd\+\_\+delay3}} (\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} ac\+\_\+index, \mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} pitch\+\_\+delay\+\_\+min)
\begin{DoxyCompactList}\small\item\em Decode pitch delay of the second subframe encoded by 5 or 6 bits with 1/3 precision. \end{DoxyCompactList}\item 
\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} \mbox{\hyperlink{acelp__pitch__delay_8h_a93cba8dbd543adb1cbe7a51d5f28113c}{ff\+\_\+acelp\+\_\+decode\+\_\+4bit\+\_\+to\+\_\+2nd\+\_\+delay3}} (\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} ac\+\_\+index, \mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} pitch\+\_\+delay\+\_\+min)
\begin{DoxyCompactList}\small\item\em Decode pitch delay with 1/3 precision. \end{DoxyCompactList}\item 
\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} \mbox{\hyperlink{acelp__pitch__delay_8h_a584186d3e926843e75962a7da21c6ca4}{ff\+\_\+acelp\+\_\+decode\+\_\+9bit\+\_\+to\+\_\+1st\+\_\+delay6}} (\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} ac\+\_\+index)
\begin{DoxyCompactList}\small\item\em Decode pitch delay of the first subframe encoded by 9 bits with 1/6 precision. \end{DoxyCompactList}\item 
\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} \mbox{\hyperlink{acelp__pitch__delay_8h_a28895ee64b1ec36f98f27bfa8f3cfa42}{ff\+\_\+acelp\+\_\+decode\+\_\+6bit\+\_\+to\+\_\+2nd\+\_\+delay6}} (\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} ac\+\_\+index, \mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} pitch\+\_\+delay\+\_\+min)
\begin{DoxyCompactList}\small\item\em Decode pitch delay of the second subframe encoded by 6 bits with 1/6 precision. \end{DoxyCompactList}\item 
\mbox{\hyperlink{rematrix__template_8c_a4dfdfbb7b69470f1152e022432ee2d45}{void}} \mbox{\hyperlink{acelp__pitch__delay_8h_ae6d217e8e054b173d7b4b16af848a6c5}{ff\+\_\+acelp\+\_\+update\+\_\+past\+\_\+gain}} (int16\+\_\+t $\ast$quant\+\_\+energy, \mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} gain\+\_\+corr\+\_\+factor, \mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} log2\+\_\+ma\+\_\+pred\+\_\+order, \mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} erasure)
\begin{DoxyCompactList}\small\item\em Update past quantized energies. \end{DoxyCompactList}\item 
int16\+\_\+t \mbox{\hyperlink{acelp__pitch__delay_8h_a85686b78474d4b5ba2a494a8f8b56799}{ff\+\_\+acelp\+\_\+decode\+\_\+gain\+\_\+code}} (\mbox{\hyperlink{struct_audio_d_s_p_context}{Audio\+D\+S\+P\+Context}} $\ast$adsp, \mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} gain\+\_\+corr\+\_\+factor, const int16\+\_\+t $\ast$fc\+\_\+v, \mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} mr\+\_\+energy, const int16\+\_\+t $\ast$quant\+\_\+energy, const int16\+\_\+t $\ast$\mbox{\hyperlink{g729data_8h_aa6ced998684ebc8857f4b9d15d433fbe}{ma\+\_\+prediction\+\_\+coeff}}, \mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} subframe\+\_\+size, \mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} max\+\_\+pred\+\_\+order)
\begin{DoxyCompactList}\small\item\em Decode the adaptive codebook gain and add correction (4.\+1.\+5 and 3.\+9.\+1 of G.\+729). \end{DoxyCompactList}\item 
float \mbox{\hyperlink{acelp__pitch__delay_8h_a845e6137ff9bf95a6a460495f0363455}{ff\+\_\+amr\+\_\+set\+\_\+fixed\+\_\+gain}} (float fixed\+\_\+gain\+\_\+factor, float fixed\+\_\+mean\+\_\+energy, float $\ast$prediction\+\_\+error, float \mbox{\hyperlink{amrnbdata_8h_addaad1c85dde77750c5485cf22f05004}{energy\+\_\+mean}}, const float $\ast$pred\+\_\+table)
\item 
\mbox{\hyperlink{rematrix__template_8c_a4dfdfbb7b69470f1152e022432ee2d45}{void}} \mbox{\hyperlink{acelp__pitch__delay_8h_a874fd848faa735c0a85fe3c0e04d1190}{ff\+\_\+decode\+\_\+pitch\+\_\+lag}} (\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} $\ast$lag\+\_\+int, \mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} $\ast$lag\+\_\+frac, \mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} pitch\+\_\+index, const \mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} prev\+\_\+lag\+\_\+int, const \mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} subframe, \mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} third\+\_\+as\+\_\+first, \mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} \mbox{\hyperlink{swscale_8txt_a655d676e0d81176cb646a3f6a10708a5}{resolution}})
\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{acelp__pitch__delay_8h_a7d8198259cf5aa2575bffe89cc5cf390}\label{acelp__pitch__delay_8h_a7d8198259cf5aa2575bffe89cc5cf390}} 
\index{acelp\_pitch\_delay.h@{acelp\_pitch\_delay.h}!PITCH\_DELAY\_MAX@{PITCH\_DELAY\_MAX}}
\index{PITCH\_DELAY\_MAX@{PITCH\_DELAY\_MAX}!acelp\_pitch\_delay.h@{acelp\_pitch\_delay.h}}
\doxysubsubsection{\texorpdfstring{PITCH\_DELAY\_MAX}{PITCH\_DELAY\_MAX}}
{\footnotesize\ttfamily \#define P\+I\+T\+C\+H\+\_\+\+D\+E\+L\+A\+Y\+\_\+\+M\+AX~143}



Definition at line 31 of file acelp\+\_\+pitch\+\_\+delay.\+h.

\mbox{\Hypertarget{acelp__pitch__delay_8h_a4a381d05e10bc1599cb453d15436d9ee}\label{acelp__pitch__delay_8h_a4a381d05e10bc1599cb453d15436d9ee}} 
\index{acelp\_pitch\_delay.h@{acelp\_pitch\_delay.h}!PITCH\_DELAY\_MIN@{PITCH\_DELAY\_MIN}}
\index{PITCH\_DELAY\_MIN@{PITCH\_DELAY\_MIN}!acelp\_pitch\_delay.h@{acelp\_pitch\_delay.h}}
\doxysubsubsection{\texorpdfstring{PITCH\_DELAY\_MIN}{PITCH\_DELAY\_MIN}}
{\footnotesize\ttfamily \#define P\+I\+T\+C\+H\+\_\+\+D\+E\+L\+A\+Y\+\_\+\+M\+IN~20}



Definition at line 30 of file acelp\+\_\+pitch\+\_\+delay.\+h.



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{acelp__pitch__delay_8h_a93cba8dbd543adb1cbe7a51d5f28113c}\label{acelp__pitch__delay_8h_a93cba8dbd543adb1cbe7a51d5f28113c}} 
\index{acelp\_pitch\_delay.h@{acelp\_pitch\_delay.h}!ff\_acelp\_decode\_4bit\_to\_2nd\_delay3@{ff\_acelp\_decode\_4bit\_to\_2nd\_delay3}}
\index{ff\_acelp\_decode\_4bit\_to\_2nd\_delay3@{ff\_acelp\_decode\_4bit\_to\_2nd\_delay3}!acelp\_pitch\_delay.h@{acelp\_pitch\_delay.h}}
\doxysubsubsection{\texorpdfstring{ff\_acelp\_decode\_4bit\_to\_2nd\_delay3()}{ff\_acelp\_decode\_4bit\_to\_2nd\_delay3()}}
{\footnotesize\ttfamily \mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} ff\+\_\+acelp\+\_\+decode\+\_\+4bit\+\_\+to\+\_\+2nd\+\_\+delay3 (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}}}]{ac\+\_\+index,  }\item[{\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}}}]{pitch\+\_\+delay\+\_\+min }\end{DoxyParamCaption})}



Decode pitch delay with 1/3 precision. 


\begin{DoxyParams}{Parameters}
{\em ac\+\_\+index} & adaptive codebook index (4 bits) \\
\hline
{\em pitch\+\_\+delay\+\_\+min} & lower bound (integer) of pitch delay interval for second subframe\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
pitch delay in 1/3 units
\end{DoxyReturn}
Pitch delay is coded\+: integers only, -\/6 $<$ pitch\+\_\+delay -\/ int(prev\+\_\+pitch\+\_\+delay) $<$= -\/2 with 1/3 resolution, -\/2 $<$ pitch\+\_\+delay -\/ int(prev\+\_\+pitch\+\_\+delay) $<$ 1 integers only, 1 $<$= pitch\+\_\+delay -\/ int(prev\+\_\+pitch\+\_\+delay) $<$ 5

\begin{DoxyRemark}{Remarks}
The routine is used in G.\+729 @6.\+4k, A\+MR @6.\+7k, A\+MR @5.\+9k, A\+MR @5.\+15k, A\+MR @4.\+75k for the second subframe. 
\end{DoxyRemark}


Definition at line 40 of file acelp\+\_\+pitch\+\_\+delay.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=300pt]{acelp__pitch__delay_8h_a93cba8dbd543adb1cbe7a51d5f28113c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{acelp__pitch__delay_8h_a487e7fe30512fec76fcc8f37e769e250}\label{acelp__pitch__delay_8h_a487e7fe30512fec76fcc8f37e769e250}} 
\index{acelp\_pitch\_delay.h@{acelp\_pitch\_delay.h}!ff\_acelp\_decode\_5\_6\_bit\_to\_2nd\_delay3@{ff\_acelp\_decode\_5\_6\_bit\_to\_2nd\_delay3}}
\index{ff\_acelp\_decode\_5\_6\_bit\_to\_2nd\_delay3@{ff\_acelp\_decode\_5\_6\_bit\_to\_2nd\_delay3}!acelp\_pitch\_delay.h@{acelp\_pitch\_delay.h}}
\doxysubsubsection{\texorpdfstring{ff\_acelp\_decode\_5\_6\_bit\_to\_2nd\_delay3()}{ff\_acelp\_decode\_5\_6\_bit\_to\_2nd\_delay3()}}
{\footnotesize\ttfamily \mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} ff\+\_\+acelp\+\_\+decode\+\_\+5\+\_\+6\+\_\+bit\+\_\+to\+\_\+2nd\+\_\+delay3 (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}}}]{ac\+\_\+index,  }\item[{\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}}}]{pitch\+\_\+delay\+\_\+min }\end{DoxyParamCaption})}



Decode pitch delay of the second subframe encoded by 5 or 6 bits with 1/3 precision. 


\begin{DoxyParams}{Parameters}
{\em ac\+\_\+index} & adaptive codebook index (5 or 6 bits) \\
\hline
{\em pitch\+\_\+delay\+\_\+min} & lower bound (integer) of pitch delay interval for second subframe\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
pitch delay in 1/3 units
\end{DoxyReturn}
Pitch delay is coded\+: with 1/3 resolution, -\/6 $<$ pitch\+\_\+delay -\/ int(prev\+\_\+pitch\+\_\+delay) $<$ 5

\begin{DoxyRemark}{Remarks}
The routine is used in G.\+729 @8k, A\+MR @10.\+2k, A\+MR @7.\+95k, A\+MR @7.\+4k for the second subframe. 
\end{DoxyRemark}


Definition at line 52 of file acelp\+\_\+pitch\+\_\+delay.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=300pt]{acelp__pitch__delay_8h_a487e7fe30512fec76fcc8f37e769e250_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{acelp__pitch__delay_8h_a28895ee64b1ec36f98f27bfa8f3cfa42}\label{acelp__pitch__delay_8h_a28895ee64b1ec36f98f27bfa8f3cfa42}} 
\index{acelp\_pitch\_delay.h@{acelp\_pitch\_delay.h}!ff\_acelp\_decode\_6bit\_to\_2nd\_delay6@{ff\_acelp\_decode\_6bit\_to\_2nd\_delay6}}
\index{ff\_acelp\_decode\_6bit\_to\_2nd\_delay6@{ff\_acelp\_decode\_6bit\_to\_2nd\_delay6}!acelp\_pitch\_delay.h@{acelp\_pitch\_delay.h}}
\doxysubsubsection{\texorpdfstring{ff\_acelp\_decode\_6bit\_to\_2nd\_delay6()}{ff\_acelp\_decode\_6bit\_to\_2nd\_delay6()}}
{\footnotesize\ttfamily \mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} ff\+\_\+acelp\+\_\+decode\+\_\+6bit\+\_\+to\+\_\+2nd\+\_\+delay6 (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}}}]{ac\+\_\+index,  }\item[{\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}}}]{pitch\+\_\+delay\+\_\+min }\end{DoxyParamCaption})}



Decode pitch delay of the second subframe encoded by 6 bits with 1/6 precision. 


\begin{DoxyParams}{Parameters}
{\em ac\+\_\+index} & adaptive codebook index (6 bits) \\
\hline
{\em pitch\+\_\+delay\+\_\+min} & lower bound (integer) of pitch delay interval for second subframe\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
pitch delay in 1/6 units
\end{DoxyReturn}
Pitch delay is coded\+: with 1/6 resolution, -\/6 $<$ pitch\+\_\+delay -\/ int(prev\+\_\+pitch\+\_\+delay) $<$ 5

\begin{DoxyRemark}{Remarks}
The routine is used in A\+MR @12.\+2k for the second and fourth subframes. 
\end{DoxyRemark}


Definition at line 66 of file acelp\+\_\+pitch\+\_\+delay.\+c.

\mbox{\Hypertarget{acelp__pitch__delay_8h_a12c976b62a541e647d9577ef2ea8ab80}\label{acelp__pitch__delay_8h_a12c976b62a541e647d9577ef2ea8ab80}} 
\index{acelp\_pitch\_delay.h@{acelp\_pitch\_delay.h}!ff\_acelp\_decode\_8bit\_to\_1st\_delay3@{ff\_acelp\_decode\_8bit\_to\_1st\_delay3}}
\index{ff\_acelp\_decode\_8bit\_to\_1st\_delay3@{ff\_acelp\_decode\_8bit\_to\_1st\_delay3}!acelp\_pitch\_delay.h@{acelp\_pitch\_delay.h}}
\doxysubsubsection{\texorpdfstring{ff\_acelp\_decode\_8bit\_to\_1st\_delay3()}{ff\_acelp\_decode\_8bit\_to\_1st\_delay3()}}
{\footnotesize\ttfamily \mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} ff\+\_\+acelp\+\_\+decode\+\_\+8bit\+\_\+to\+\_\+1st\+\_\+delay3 (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}}}]{ac\+\_\+index }\end{DoxyParamCaption})}



Decode pitch delay of the first subframe encoded by 8 bits with 1/3 resolution. 


\begin{DoxyParams}{Parameters}
{\em ac\+\_\+index} & adaptive codebook index (8 bits)\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
pitch delay in 1/3 units
\end{DoxyReturn}
Pitch delay is coded\+: with 1/3 resolution, 19 $<$ pitch\+\_\+delay $<$ 85 integers only, 85 $<$= pitch\+\_\+delay $<$= 143 

Definition at line 32 of file acelp\+\_\+pitch\+\_\+delay.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=300pt]{acelp__pitch__delay_8h_a12c976b62a541e647d9577ef2ea8ab80_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{acelp__pitch__delay_8h_a584186d3e926843e75962a7da21c6ca4}\label{acelp__pitch__delay_8h_a584186d3e926843e75962a7da21c6ca4}} 
\index{acelp\_pitch\_delay.h@{acelp\_pitch\_delay.h}!ff\_acelp\_decode\_9bit\_to\_1st\_delay6@{ff\_acelp\_decode\_9bit\_to\_1st\_delay6}}
\index{ff\_acelp\_decode\_9bit\_to\_1st\_delay6@{ff\_acelp\_decode\_9bit\_to\_1st\_delay6}!acelp\_pitch\_delay.h@{acelp\_pitch\_delay.h}}
\doxysubsubsection{\texorpdfstring{ff\_acelp\_decode\_9bit\_to\_1st\_delay6()}{ff\_acelp\_decode\_9bit\_to\_1st\_delay6()}}
{\footnotesize\ttfamily \mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} ff\+\_\+acelp\+\_\+decode\+\_\+9bit\+\_\+to\+\_\+1st\+\_\+delay6 (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}}}]{ac\+\_\+index }\end{DoxyParamCaption})}



Decode pitch delay of the first subframe encoded by 9 bits with 1/6 precision. 


\begin{DoxyParams}{Parameters}
{\em ac\+\_\+index} & adaptive codebook index (9 bits)\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
pitch delay in 1/6 units
\end{DoxyReturn}
Pitch delay is coded\+: with 1/6 resolution, 17 $<$ pitch\+\_\+delay $<$ 95 integers only, 95 $<$= pitch\+\_\+delay $<$= 143

\begin{DoxyRemark}{Remarks}
The routine is used in A\+MR @12.\+2k for the first and third subframes. 
\end{DoxyRemark}


Definition at line 59 of file acelp\+\_\+pitch\+\_\+delay.\+c.

\mbox{\Hypertarget{acelp__pitch__delay_8h_a85686b78474d4b5ba2a494a8f8b56799}\label{acelp__pitch__delay_8h_a85686b78474d4b5ba2a494a8f8b56799}} 
\index{acelp\_pitch\_delay.h@{acelp\_pitch\_delay.h}!ff\_acelp\_decode\_gain\_code@{ff\_acelp\_decode\_gain\_code}}
\index{ff\_acelp\_decode\_gain\_code@{ff\_acelp\_decode\_gain\_code}!acelp\_pitch\_delay.h@{acelp\_pitch\_delay.h}}
\doxysubsubsection{\texorpdfstring{ff\_acelp\_decode\_gain\_code()}{ff\_acelp\_decode\_gain\_code()}}
{\footnotesize\ttfamily int16\+\_\+t ff\+\_\+acelp\+\_\+decode\+\_\+gain\+\_\+code (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_audio_d_s_p_context}{Audio\+D\+S\+P\+Context}} $\ast$}]{adsp,  }\item[{\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}}}]{gain\+\_\+corr\+\_\+factor,  }\item[{const int16\+\_\+t $\ast$}]{fc\+\_\+v,  }\item[{\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}}}]{mr\+\_\+energy,  }\item[{const int16\+\_\+t $\ast$}]{quant\+\_\+energy,  }\item[{const int16\+\_\+t $\ast$}]{ma\+\_\+prediction\+\_\+coeff,  }\item[{\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}}}]{subframe\+\_\+size,  }\item[{\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}}}]{max\+\_\+pred\+\_\+order }\end{DoxyParamCaption})}



Decode the adaptive codebook gain and add correction (4.\+1.\+5 and 3.\+9.\+1 of G.\+729). 


\begin{DoxyParams}[1]{Parameters}
 & {\em adsp} & initialized audio D\+SP context \\
\hline
 & {\em gain\+\_\+corr\+\_\+factor} & gain correction factor (2.\+13) \\
\hline
 & {\em fc\+\_\+v} & fixed-\/codebook vector (2.\+13) \\
\hline
 & {\em mr\+\_\+energy} & mean innovation energy and fixed-\/point correction (7.\+13) \\
\hline
\mbox{\texttt{ in,out}}  & {\em quant\+\_\+energy} & past quantized energies (5.\+10) \\
\hline
 & {\em subframe\+\_\+size} & length of subframe\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
quantized fixed-\/codebook gain (14.\+1)
\end{DoxyReturn}
The routine implements equations 69, 66 and 71 of the G.\+729 specification (3.\+9.\+1)

Em -\/ mean innovation energy (dB, constant, depends on decoding algorithm) Ep -\/ mean-\/removed predicted energy (dB) Er -\/ mean-\/removed innovation energy (dB) Ei -\/ mean energy of the fixed-\/codebook contribution (dB) N -\/ subframe\+\_\+size M -\/ MA (Moving Average) prediction order gc -\/ fixed-\/codebook gain gc\+\_\+p -\/ predicted fixed-\/codebook gain

Fixed codebook gain is computed using predicted gain gc\+\_\+p and correction factor gain\+\_\+corr\+\_\+factor as shown below\+: \begin{DoxyVerb}gc = gc_p * gain_corr_factor
\end{DoxyVerb}


The predicted fixed codebook gain gc\+\_\+p is found by predicting the energy of the fixed-\/codebook contribution from the energy of previous fixed-\/codebook contributions. \begin{DoxyVerb}mean = 1/N * sum(i,0,N){ fc_v[i] * fc_v[i] }

Ei = 10log(mean)

Er = 10log(1/N * gc^2 * mean) - Em = 20log(gc) + Ei - Em
\end{DoxyVerb}


Replacing Er with Ep and gc with gc\+\_\+p we will receive\+: \begin{DoxyVerb}Ep = 10log(1/N * gc_p^2 * mean) - Em = 20log(gc_p) + Ei - Em
\end{DoxyVerb}


and from above\+: \begin{DoxyVerb}gc_p = 10^((Ep - Ei + Em) / 20)
\end{DoxyVerb}


Ep is predicted using past energies and prediction coefficients\+: \begin{DoxyVerb}Ep = sum(i,0,M){ ma_prediction_coeff[i] * quant_energy[i] }
\end{DoxyVerb}


gc\+\_\+p in fixed-\/point arithmetic is calculated as following\+: \begin{DoxyVerb}mean = 1/N * sum(i,0,N){ (fc_v[i] / 2^13) * (fc_v[i] / 2^13) } =
= 1/N * sum(i,0,N) { fc_v[i] * fc_v[i] } / 2^26

Ei = 10log(mean) = -10log(N) - 10log(2^26) +
+ 10log(sum(i,0,N) { fc_v[i] * fc_v[i] })

Ep - Ei + Em = Ep + Em + 10log(N) + 10log(2^26) -
- 10log(sum(i,0,N) { fc_v[i] * fc_v[i] }) =
= Ep + mr_energy - 10log(sum(i,0,N) { fc_v[i] * fc_v[i] })

gc_p = 10 ^ ((Ep - Ei + Em) / 20) =
= 2 ^ (3.3219 * (Ep - Ei + Em) / 20) = 2 ^ (0.166 * (Ep - Ei + Em))
\end{DoxyVerb}


where \begin{DoxyVerb}mr_energy = Em + 10log(N) + 10log(2^26)
\end{DoxyVerb}


\begin{DoxyRemark}{Remarks}
The routine is used in G.\+729 and A\+MR (all modes). 
\end{DoxyRemark}


Definition at line 94 of file acelp\+\_\+pitch\+\_\+delay.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{acelp__pitch__delay_8h_a85686b78474d4b5ba2a494a8f8b56799_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=329pt]{acelp__pitch__delay_8h_a85686b78474d4b5ba2a494a8f8b56799_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{acelp__pitch__delay_8h_ae6d217e8e054b173d7b4b16af848a6c5}\label{acelp__pitch__delay_8h_ae6d217e8e054b173d7b4b16af848a6c5}} 
\index{acelp\_pitch\_delay.h@{acelp\_pitch\_delay.h}!ff\_acelp\_update\_past\_gain@{ff\_acelp\_update\_past\_gain}}
\index{ff\_acelp\_update\_past\_gain@{ff\_acelp\_update\_past\_gain}!acelp\_pitch\_delay.h@{acelp\_pitch\_delay.h}}
\doxysubsubsection{\texorpdfstring{ff\_acelp\_update\_past\_gain()}{ff\_acelp\_update\_past\_gain()}}
{\footnotesize\ttfamily \mbox{\hyperlink{rematrix__template_8c_a4dfdfbb7b69470f1152e022432ee2d45}{void}} ff\+\_\+acelp\+\_\+update\+\_\+past\+\_\+gain (\begin{DoxyParamCaption}\item[{int16\+\_\+t $\ast$}]{quant\+\_\+energy,  }\item[{\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}}}]{gain\+\_\+corr\+\_\+factor,  }\item[{\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}}}]{log2\+\_\+ma\+\_\+pred\+\_\+order,  }\item[{\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}}}]{erasure }\end{DoxyParamCaption})}



Update past quantized energies. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in,out}}  & {\em quant\+\_\+energy} & past quantized energies (5.\+10) \\
\hline
 & {\em gain\+\_\+corr\+\_\+factor} & gain correction factor \\
\hline
 & {\em log2\+\_\+ma\+\_\+pred\+\_\+order} & \mbox{\hyperlink{libm_8h_a18af743c2cec4baeee9ffb27999ddaad}{log2()}} of MA prediction order \\
\hline
 & {\em erasure} & frame erasure flag\\
\hline
\end{DoxyParams}
If frame erasure flag is not equal to zero, memory is updated with averaged energy, attenuated by 4dB\+: max(\mbox{\hyperlink{colorspacedsp__template_8c_ad904214e066ed0a4293ea4a278094313}{avg(quant\+\_\+energy\mbox{[}i\mbox{]})}}-\/4, -\/14), i=0,ma\+\_\+pred\+\_\+order

In normal mode memory is updated with Er -\/ Ep = 20 $\ast$ log10(gain\+\_\+corr\+\_\+factor)

\begin{DoxyRemark}{Remarks}
The routine is used in G.\+729 and A\+MR (all modes). 
\end{DoxyRemark}


Definition at line 73 of file acelp\+\_\+pitch\+\_\+delay.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=312pt]{acelp__pitch__delay_8h_ae6d217e8e054b173d7b4b16af848a6c5_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=324pt]{acelp__pitch__delay_8h_ae6d217e8e054b173d7b4b16af848a6c5_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{acelp__pitch__delay_8h_a845e6137ff9bf95a6a460495f0363455}\label{acelp__pitch__delay_8h_a845e6137ff9bf95a6a460495f0363455}} 
\index{acelp\_pitch\_delay.h@{acelp\_pitch\_delay.h}!ff\_amr\_set\_fixed\_gain@{ff\_amr\_set\_fixed\_gain}}
\index{ff\_amr\_set\_fixed\_gain@{ff\_amr\_set\_fixed\_gain}!acelp\_pitch\_delay.h@{acelp\_pitch\_delay.h}}
\doxysubsubsection{\texorpdfstring{ff\_amr\_set\_fixed\_gain()}{ff\_amr\_set\_fixed\_gain()}}
{\footnotesize\ttfamily float ff\+\_\+amr\+\_\+set\+\_\+fixed\+\_\+gain (\begin{DoxyParamCaption}\item[{float}]{fixed\+\_\+gain\+\_\+factor,  }\item[{float}]{fixed\+\_\+mean\+\_\+energy,  }\item[{float $\ast$}]{prediction\+\_\+error,  }\item[{float}]{energy\+\_\+mean,  }\item[{const float $\ast$}]{pred\+\_\+table }\end{DoxyParamCaption})}

Calculate fixed gain (part of section 6.\+1.\+3 of A\+MR spec)


\begin{DoxyParams}{Parameters}
{\em fixed\+\_\+gain\+\_\+factor} & gain correction factor \\
\hline
{\em fixed\+\_\+mean\+\_\+energy} & mean decoded algebraic codebook vector energy \\
\hline
{\em prediction\+\_\+error} & vector of the quantified predictor errors of the four previous subframes. It is updated by this function. \\
\hline
{\em energy\+\_\+mean} & desired mean innovation energy \\
\hline
{\em pred\+\_\+table} & table of four moving average coefficients \\
\hline
\end{DoxyParams}


Definition at line 127 of file acelp\+\_\+pitch\+\_\+delay.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=330pt]{acelp__pitch__delay_8h_a845e6137ff9bf95a6a460495f0363455_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{acelp__pitch__delay_8h_a845e6137ff9bf95a6a460495f0363455_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{acelp__pitch__delay_8h_a874fd848faa735c0a85fe3c0e04d1190}\label{acelp__pitch__delay_8h_a874fd848faa735c0a85fe3c0e04d1190}} 
\index{acelp\_pitch\_delay.h@{acelp\_pitch\_delay.h}!ff\_decode\_pitch\_lag@{ff\_decode\_pitch\_lag}}
\index{ff\_decode\_pitch\_lag@{ff\_decode\_pitch\_lag}!acelp\_pitch\_delay.h@{acelp\_pitch\_delay.h}}
\doxysubsubsection{\texorpdfstring{ff\_decode\_pitch\_lag()}{ff\_decode\_pitch\_lag()}}
{\footnotesize\ttfamily \mbox{\hyperlink{rematrix__template_8c_a4dfdfbb7b69470f1152e022432ee2d45}{void}} ff\+\_\+decode\+\_\+pitch\+\_\+lag (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} $\ast$}]{lag\+\_\+int,  }\item[{\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} $\ast$}]{lag\+\_\+frac,  }\item[{\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}}}]{pitch\+\_\+index,  }\item[{const \mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}}}]{prev\+\_\+lag\+\_\+int,  }\item[{const \mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}}}]{subframe,  }\item[{\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}}}]{third\+\_\+as\+\_\+first,  }\item[{\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}}}]{resolution }\end{DoxyParamCaption})}

Decode the adaptive codebook index to the integer and fractional parts of the pitch lag for one subframe at 1/3 fractional precision.

The choice of pitch lag is described in 3G\+PP TS 26.\+090 section 5.\+6.\+1.


\begin{DoxyParams}{Parameters}
{\em lag\+\_\+int} & integer part of pitch lag of the current subframe \\
\hline
{\em lag\+\_\+frac} & fractional part of pitch lag of the current subframe \\
\hline
{\em pitch\+\_\+index} & parsed adaptive codebook (pitch) index \\
\hline
{\em prev\+\_\+lag\+\_\+int} & integer part of pitch lag for the previous subframe \\
\hline
{\em subframe} & current subframe number \\
\hline
{\em third\+\_\+as\+\_\+first} & treat the third frame the same way as the first \\
\hline
\end{DoxyParams}


Definition at line 148 of file acelp\+\_\+pitch\+\_\+delay.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{acelp__pitch__delay_8h_a874fd848faa735c0a85fe3c0e04d1190_icgraph}
\end{center}
\end{figure}
