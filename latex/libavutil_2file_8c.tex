\hypertarget{libavutil_2file_8c}{}\doxysection{E\+:/github/ffmpeg/libavutil/file.c File Reference}
\label{libavutil_2file_8c}\index{E:/github/ffmpeg/libavutil/file.c@{E:/github/ffmpeg/libavutil/file.c}}
{\ttfamily \#include \char`\"{}config.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}file.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}internal.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}log.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mem.\+h\char`\"{}}\newline
{\ttfamily \#include $<$fcntl.\+h$>$}\newline
{\ttfamily \#include $<$sys/stat.\+h$>$}\newline
Include dependency graph for file.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{libavutil_2file_8c__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=202pt]{libavutil_2file_8c__dep__incl}
\end{center}
\end{figure}
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{struct_file_log_context}{File\+Log\+Context}}
\end{DoxyCompactItemize}
\doxysubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \mbox{\hyperlink{struct_file_log_context}{File\+Log\+Context}} \mbox{\hyperlink{libavutil_2file_8c_aedd440962ab1186ea735a4d761148b26}{File\+Log\+Context}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} \mbox{\hyperlink{libavutil_2file_8c_a20ab80637ab92af5fbbe4c00be406ad3}{av\+\_\+file\+\_\+map}} (const char $\ast$filename, \mbox{\hyperlink{audio__convert_8c_ae1affc9ca37cfb624959c866a73f83c2}{uint8\+\_\+t}} $\ast$$\ast$bufptr, size\+\_\+t $\ast$\mbox{\hyperlink{group__lavu__mem__funcs_ga34e10fdac079a9ca4512b8ccd7f20b8a}{size}}, \mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} log\+\_\+offset, \mbox{\hyperlink{rematrix__template_8c_a4dfdfbb7b69470f1152e022432ee2d45}{void}} $\ast$log\+\_\+ctx)
\item 
\mbox{\hyperlink{rematrix__template_8c_a4dfdfbb7b69470f1152e022432ee2d45}{void}} \mbox{\hyperlink{libavutil_2file_8c_a12e643af4a329ae6d1d567d8a782af1e}{av\+\_\+file\+\_\+unmap}} (\mbox{\hyperlink{audio__convert_8c_ae1affc9ca37cfb624959c866a73f83c2}{uint8\+\_\+t}} $\ast$bufptr, size\+\_\+t \mbox{\hyperlink{group__lavu__mem__funcs_ga34e10fdac079a9ca4512b8ccd7f20b8a}{size}})
\item 
\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} \mbox{\hyperlink{libavutil_2file_8c_a8c2cb7d30f32e871d353c2f2b2dd6ba2}{av\+\_\+tempfile}} (const char $\ast$prefix, char $\ast$$\ast$filename, \mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} log\+\_\+offset, \mbox{\hyperlink{rematrix__template_8c_a4dfdfbb7b69470f1152e022432ee2d45}{void}} $\ast$log\+\_\+ctx)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static const \mbox{\hyperlink{struct_a_v_class}{A\+V\+Class}} \mbox{\hyperlink{libavutil_2file_8c_a244d6304ca927c45fef00b2c7c49e097}{file\+\_\+log\+\_\+ctx\+\_\+class}}
\end{DoxyCompactItemize}


\doxysubsection{Typedef Documentation}
\mbox{\Hypertarget{libavutil_2file_8c_aedd440962ab1186ea735a4d761148b26}\label{libavutil_2file_8c_aedd440962ab1186ea735a4d761148b26}} 
\index{file.c@{file.c}!FileLogContext@{FileLogContext}}
\index{FileLogContext@{FileLogContext}!file.c@{file.c}}
\doxysubsubsection{\texorpdfstring{FileLogContext}{FileLogContext}}
{\footnotesize\ttfamily typedef struct \mbox{\hyperlink{struct_file_log_context}{File\+Log\+Context}} \mbox{\hyperlink{struct_file_log_context}{File\+Log\+Context}}}



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{libavutil_2file_8c_a20ab80637ab92af5fbbe4c00be406ad3}\label{libavutil_2file_8c_a20ab80637ab92af5fbbe4c00be406ad3}} 
\index{file.c@{file.c}!av\_file\_map@{av\_file\_map}}
\index{av\_file\_map@{av\_file\_map}!file.c@{file.c}}
\doxysubsubsection{\texorpdfstring{av\_file\_map()}{av\_file\_map()}}
{\footnotesize\ttfamily \mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} av\+\_\+file\+\_\+map (\begin{DoxyParamCaption}\item[{const char $\ast$}]{filename,  }\item[{\mbox{\hyperlink{audio__convert_8c_ae1affc9ca37cfb624959c866a73f83c2}{uint8\+\_\+t}} $\ast$$\ast$}]{bufptr,  }\item[{size\+\_\+t $\ast$}]{size,  }\item[{\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}}}]{log\+\_\+offset,  }\item[{\mbox{\hyperlink{rematrix__template_8c_a4dfdfbb7b69470f1152e022432ee2d45}{void}} $\ast$}]{log\+\_\+ctx }\end{DoxyParamCaption})}

Read the file with name filename, and put its content in a newly allocated buffer or map it with mmap() when available. In case of success set $\ast$bufptr to the read or mmapped buffer, and $\ast$size to the size in bytes of the buffer in $\ast$bufptr. Unlike mmap this function succeeds with zero sized files, in this case $\ast$bufptr will be set to N\+U\+LL and $\ast$size will be set to 0. The returned buffer must be released with \mbox{\hyperlink{file_8h_a12e643af4a329ae6d1d567d8a782af1e}{av\+\_\+file\+\_\+unmap()}}.


\begin{DoxyParams}{Parameters}
{\em log\+\_\+offset} & loglevel offset used for logging \\
\hline
{\em log\+\_\+ctx} & context used for logging \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
a non negative number in case of success, a negative value corresponding to an A\+V\+E\+R\+R\+OR error code in case of failure 
\end{DoxyReturn}


Definition at line 53 of file file.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{libavutil_2file_8c_a20ab80637ab92af5fbbe4c00be406ad3_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{libavutil_2file_8c_a20ab80637ab92af5fbbe4c00be406ad3_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{libavutil_2file_8c_a12e643af4a329ae6d1d567d8a782af1e}\label{libavutil_2file_8c_a12e643af4a329ae6d1d567d8a782af1e}} 
\index{file.c@{file.c}!av\_file\_unmap@{av\_file\_unmap}}
\index{av\_file\_unmap@{av\_file\_unmap}!file.c@{file.c}}
\doxysubsubsection{\texorpdfstring{av\_file\_unmap()}{av\_file\_unmap()}}
{\footnotesize\ttfamily \mbox{\hyperlink{rematrix__template_8c_a4dfdfbb7b69470f1152e022432ee2d45}{void}} av\+\_\+file\+\_\+unmap (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{audio__convert_8c_ae1affc9ca37cfb624959c866a73f83c2}{uint8\+\_\+t}} $\ast$}]{bufptr,  }\item[{size\+\_\+t}]{size }\end{DoxyParamCaption})}

Unmap or free the buffer bufptr created by \mbox{\hyperlink{file_8h_ade51c2ba717b70fab329362952906cfe}{av\+\_\+file\+\_\+map()}}.


\begin{DoxyParams}{Parameters}
{\em size} & size in bytes of bufptr, must be the same as returned by \mbox{\hyperlink{file_8h_ade51c2ba717b70fab329362952906cfe}{av\+\_\+file\+\_\+map()}} \\
\hline
\end{DoxyParams}


Definition at line 144 of file file.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{libavutil_2file_8c_a12e643af4a329ae6d1d567d8a782af1e_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{libavutil_2file_8c_a8c2cb7d30f32e871d353c2f2b2dd6ba2}\label{libavutil_2file_8c_a8c2cb7d30f32e871d353c2f2b2dd6ba2}} 
\index{file.c@{file.c}!av\_tempfile@{av\_tempfile}}
\index{av\_tempfile@{av\_tempfile}!file.c@{file.c}}
\doxysubsubsection{\texorpdfstring{av\_tempfile()}{av\_tempfile()}}
{\footnotesize\ttfamily \mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} av\+\_\+tempfile (\begin{DoxyParamCaption}\item[{const char $\ast$}]{prefix,  }\item[{char $\ast$$\ast$}]{filename,  }\item[{\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}}}]{log\+\_\+offset,  }\item[{\mbox{\hyperlink{rematrix__template_8c_a4dfdfbb7b69470f1152e022432ee2d45}{void}} $\ast$}]{log\+\_\+ctx }\end{DoxyParamCaption})}

Wrapper to work around the lack of mkstemp() on mingw. Also, tries to create file in /tmp first, if possible. $\ast$prefix can be a character constant; $\ast$filename will be allocated internally. \begin{DoxyReturn}{Returns}
file descriptor of opened file (or negative value corresponding to an A\+V\+E\+R\+R\+OR code on error) and opened file name in $\ast$$\ast$filename. 
\end{DoxyReturn}
\begin{DoxyNote}{Note}
On very old libcs it is necessary to set a secure umask before calling this, \mbox{\hyperlink{file_8h_a8c2cb7d30f32e871d353c2f2b2dd6ba2}{av\+\_\+tempfile()}} can\textquotesingle{}t call umask itself as it is used in libraries and could interfere with the calling application. 
\end{DoxyNote}
\begin{DoxyRefDesc}{Deprecated}
\item[\mbox{\hyperlink{deprecated__deprecated000085}{Deprecated}}]as fd numbers cannot be passed saftely between libs on some platforms \end{DoxyRefDesc}


Definition at line 157 of file file.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{libavutil_2file_8c_a8c2cb7d30f32e871d353c2f2b2dd6ba2_cgraph}
\end{center}
\end{figure}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{libavutil_2file_8c_a244d6304ca927c45fef00b2c7c49e097}\label{libavutil_2file_8c_a244d6304ca927c45fef00b2c7c49e097}} 
\index{file.c@{file.c}!file\_log\_ctx\_class@{file\_log\_ctx\_class}}
\index{file\_log\_ctx\_class@{file\_log\_ctx\_class}!file.c@{file.c}}
\doxysubsubsection{\texorpdfstring{file\_log\_ctx\_class}{file\_log\_ctx\_class}}
{\footnotesize\ttfamily const \mbox{\hyperlink{struct_a_v_class}{A\+V\+Class}} file\+\_\+log\+\_\+ctx\+\_\+class\hspace{0.3cm}{\ttfamily [static]}}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{= \{}
\DoxyCodeLine{    .class\_name                = \textcolor{stringliteral}{"{}FILE"{}},}
\DoxyCodeLine{    .item\_name                 = \mbox{\hyperlink{group__lavu__log_ga791fcd0dba1d19fe0c3677509344328e}{av\_default\_item\_name}},}
\DoxyCodeLine{    .option                    = \mbox{\hyperlink{coverity_8c_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}},}
\DoxyCodeLine{    .version                   = \mbox{\hyperlink{group__lavu__ver_ga36e17e3fc9bcbe5c55820a8ac8b47e3c}{LIBAVUTIL\_VERSION\_INT}},}
\DoxyCodeLine{    .log\_level\_offset\_offset   = offsetof(\mbox{\hyperlink{struct_file_log_context}{FileLogContext}}, log\_offset),}
\DoxyCodeLine{    .parent\_log\_context\_offset = offsetof(\mbox{\hyperlink{struct_file_log_context}{FileLogContext}}, log\_ctx),}
\DoxyCodeLine{\}}

\end{DoxyCode}


Definition at line 44 of file file.\+c.

