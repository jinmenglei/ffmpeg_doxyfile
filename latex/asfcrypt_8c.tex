\hypertarget{asfcrypt_8c}{}\doxysection{E\+:/github/ffmpeg/libavformat/asfcrypt.c File Reference}
\label{asfcrypt_8c}\index{E:/github/ffmpeg/libavformat/asfcrypt.c@{E:/github/ffmpeg/libavformat/asfcrypt.c}}
{\ttfamily \#include \char`\"{}libavutil/bswap.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}libavutil/common.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}libavutil/des.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}libavutil/intreadwrite.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}libavutil/rc4.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}asfcrypt.\+h\char`\"{}}\newline
Include dependency graph for asfcrypt.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{asfcrypt_8c__incl}
\end{center}
\end{figure}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static uint32\+\_\+t \mbox{\hyperlink{asfcrypt_8c_a1daab37d5201e2de0ffa163447a51c0f}{inverse}} (uint32\+\_\+t v)
\begin{DoxyCompactList}\small\item\em find multiplicative inverse modulo 2 $^\wedge$ 32 \end{DoxyCompactList}\item 
static \mbox{\hyperlink{rematrix__template_8c_a4dfdfbb7b69470f1152e022432ee2d45}{void}} \mbox{\hyperlink{asfcrypt_8c_ab0acd87513a5670d0e07dfcfd6c3ff6a}{multiswap\+\_\+init}} (const \mbox{\hyperlink{audio__convert_8c_ae1affc9ca37cfb624959c866a73f83c2}{uint8\+\_\+t}} keybuf\mbox{[}48\mbox{]}, uint32\+\_\+t keys\mbox{[}12\mbox{]})
\begin{DoxyCompactList}\small\item\em read keys from keybuf into keys \end{DoxyCompactList}\item 
static \mbox{\hyperlink{rematrix__template_8c_a4dfdfbb7b69470f1152e022432ee2d45}{void}} \mbox{\hyperlink{asfcrypt_8c_ac9da60dac1a40222e572af41552723e4}{multiswap\+\_\+invert\+\_\+keys}} (uint32\+\_\+t keys\mbox{[}12\mbox{]})
\begin{DoxyCompactList}\small\item\em invert the keys so that encryption become decryption keys and the other way round. \end{DoxyCompactList}\item 
static uint32\+\_\+t \mbox{\hyperlink{asfcrypt_8c_a13fc610dfd829ef4fcb22063e1dfb37d}{multiswap\+\_\+step}} (const uint32\+\_\+t keys\mbox{[}12\mbox{]}, uint32\+\_\+t v)
\item 
static uint32\+\_\+t \mbox{\hyperlink{asfcrypt_8c_a1fa111e3702e2d8611dc7c23d31623bf}{multiswap\+\_\+inv\+\_\+step}} (const uint32\+\_\+t keys\mbox{[}12\mbox{]}, uint32\+\_\+t v)
\item 
static uint64\+\_\+t \mbox{\hyperlink{asfcrypt_8c_a65b4a3abe32a3017d4dfc33c061a16c7}{multiswap\+\_\+enc}} (const uint32\+\_\+t keys\mbox{[}12\mbox{]}, uint64\+\_\+t \mbox{\hyperlink{hwcontext__opencl_8c_acd3d88da3c0e0313c3645ff34f62f542}{key}}, uint64\+\_\+t \mbox{\hyperlink{filter__design_8txt_ac6f0a759dab43b0d58cd04fb6513534c}{data}})
\begin{DoxyCompactList}\small\item\em \char`\"{}\+Multi\+Swap\char`\"{} encryption \end{DoxyCompactList}\item 
static uint64\+\_\+t \mbox{\hyperlink{asfcrypt_8c_a0dffd8ea994173ecadd8640b520e2c1d}{multiswap\+\_\+dec}} (const uint32\+\_\+t keys\mbox{[}12\mbox{]}, uint64\+\_\+t \mbox{\hyperlink{hwcontext__opencl_8c_acd3d88da3c0e0313c3645ff34f62f542}{key}}, uint64\+\_\+t \mbox{\hyperlink{filter__design_8txt_ac6f0a759dab43b0d58cd04fb6513534c}{data}})
\begin{DoxyCompactList}\small\item\em \char`\"{}\+Multi\+Swap\char`\"{} decryption \end{DoxyCompactList}\item 
\mbox{\hyperlink{rematrix__template_8c_a4dfdfbb7b69470f1152e022432ee2d45}{void}} \mbox{\hyperlink{asfcrypt_8c_a31a452e8f05fd82a72b451dbc175a9a2}{ff\+\_\+asfcrypt\+\_\+dec}} (const \mbox{\hyperlink{audio__convert_8c_ae1affc9ca37cfb624959c866a73f83c2}{uint8\+\_\+t}} \mbox{\hyperlink{hwcontext__opencl_8c_acd3d88da3c0e0313c3645ff34f62f542}{key}}\mbox{[}20\mbox{]}, \mbox{\hyperlink{audio__convert_8c_ae1affc9ca37cfb624959c866a73f83c2}{uint8\+\_\+t}} $\ast$\mbox{\hyperlink{filter__design_8txt_ac6f0a759dab43b0d58cd04fb6513534c}{data}}, \mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}} \mbox{\hyperlink{spdifenc_8c_a77124bd5f7e31e6fffc19f335da0c23f}{len}})
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{asfcrypt_8c_a31a452e8f05fd82a72b451dbc175a9a2}\label{asfcrypt_8c_a31a452e8f05fd82a72b451dbc175a9a2}} 
\index{asfcrypt.c@{asfcrypt.c}!ff\_asfcrypt\_dec@{ff\_asfcrypt\_dec}}
\index{ff\_asfcrypt\_dec@{ff\_asfcrypt\_dec}!asfcrypt.c@{asfcrypt.c}}
\doxysubsubsection{\texorpdfstring{ff\_asfcrypt\_dec()}{ff\_asfcrypt\_dec()}}
{\footnotesize\ttfamily \mbox{\hyperlink{rematrix__template_8c_a4dfdfbb7b69470f1152e022432ee2d45}{void}} ff\+\_\+asfcrypt\+\_\+dec (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{audio__convert_8c_ae1affc9ca37cfb624959c866a73f83c2}{uint8\+\_\+t}}}]{key\mbox{[}20\mbox{]},  }\item[{\mbox{\hyperlink{audio__convert_8c_ae1affc9ca37cfb624959c866a73f83c2}{uint8\+\_\+t}} $\ast$}]{data,  }\item[{\mbox{\hyperlink{ffmpeg__filter_8c_a61569f2965b7a369eb10b6d75d410d11}{int}}}]{len }\end{DoxyParamCaption})}



Definition at line 147 of file asfcrypt.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{asfcrypt_8c_a31a452e8f05fd82a72b451dbc175a9a2_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{asfcrypt_8c_a31a452e8f05fd82a72b451dbc175a9a2_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{asfcrypt_8c_a1daab37d5201e2de0ffa163447a51c0f}\label{asfcrypt_8c_a1daab37d5201e2de0ffa163447a51c0f}} 
\index{asfcrypt.c@{asfcrypt.c}!inverse@{inverse}}
\index{inverse@{inverse}!asfcrypt.c@{asfcrypt.c}}
\doxysubsubsection{\texorpdfstring{inverse()}{inverse()}}
{\footnotesize\ttfamily static uint32\+\_\+t inverse (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{v }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



find multiplicative inverse modulo 2 $^\wedge$ 32 


\begin{DoxyParams}{Parameters}
{\em v} & number to invert, must be odd! \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
number so that result $\ast$ v = 1 (mod 2$^\wedge$32) 
\end{DoxyReturn}


Definition at line 35 of file asfcrypt.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{asfcrypt_8c_a1daab37d5201e2de0ffa163447a51c0f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{asfcrypt_8c_a0dffd8ea994173ecadd8640b520e2c1d}\label{asfcrypt_8c_a0dffd8ea994173ecadd8640b520e2c1d}} 
\index{asfcrypt.c@{asfcrypt.c}!multiswap\_dec@{multiswap\_dec}}
\index{multiswap\_dec@{multiswap\_dec}!asfcrypt.c@{asfcrypt.c}}
\doxysubsubsection{\texorpdfstring{multiswap\_dec()}{multiswap\_dec()}}
{\footnotesize\ttfamily static uint64\+\_\+t multiswap\+\_\+dec (\begin{DoxyParamCaption}\item[{const uint32\+\_\+t}]{keys\mbox{[}12\mbox{]},  }\item[{uint64\+\_\+t}]{key,  }\item[{uint64\+\_\+t}]{data }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



\char`\"{}\+Multi\+Swap\char`\"{} decryption 


\begin{DoxyParams}{Parameters}
{\em keys} & 32 bit numbers in machine endianness, 0-\/4 and 6-\/10 must be inverted from encryption \\
\hline
{\em key} & another key, this one must be the same as for the encryption \\
\hline
{\em data} & data to decrypt \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
decrypted data 
\end{DoxyReturn}


Definition at line 131 of file asfcrypt.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=298pt]{asfcrypt_8c_a0dffd8ea994173ecadd8640b520e2c1d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{asfcrypt_8c_a0dffd8ea994173ecadd8640b520e2c1d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{asfcrypt_8c_a65b4a3abe32a3017d4dfc33c061a16c7}\label{asfcrypt_8c_a65b4a3abe32a3017d4dfc33c061a16c7}} 
\index{asfcrypt.c@{asfcrypt.c}!multiswap\_enc@{multiswap\_enc}}
\index{multiswap\_enc@{multiswap\_enc}!asfcrypt.c@{asfcrypt.c}}
\doxysubsubsection{\texorpdfstring{multiswap\_enc()}{multiswap\_enc()}}
{\footnotesize\ttfamily static uint64\+\_\+t multiswap\+\_\+enc (\begin{DoxyParamCaption}\item[{const uint32\+\_\+t}]{keys\mbox{[}12\mbox{]},  }\item[{uint64\+\_\+t}]{key,  }\item[{uint64\+\_\+t}]{data }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



\char`\"{}\+Multi\+Swap\char`\"{} encryption 


\begin{DoxyParams}{Parameters}
{\em keys} & 32 bit numbers in machine endianness, 0-\/4 and 6-\/10 must be inverted from decryption \\
\hline
{\em key} & another key, this one must be the same for the decryption \\
\hline
{\em data} & data to encrypt \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
encrypted data 
\end{DoxyReturn}


Definition at line 107 of file asfcrypt.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=281pt]{asfcrypt_8c_a65b4a3abe32a3017d4dfc33c061a16c7_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{asfcrypt_8c_a65b4a3abe32a3017d4dfc33c061a16c7_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{asfcrypt_8c_ab0acd87513a5670d0e07dfcfd6c3ff6a}\label{asfcrypt_8c_ab0acd87513a5670d0e07dfcfd6c3ff6a}} 
\index{asfcrypt.c@{asfcrypt.c}!multiswap\_init@{multiswap\_init}}
\index{multiswap\_init@{multiswap\_init}!asfcrypt.c@{asfcrypt.c}}
\doxysubsubsection{\texorpdfstring{multiswap\_init()}{multiswap\_init()}}
{\footnotesize\ttfamily static \mbox{\hyperlink{rematrix__template_8c_a4dfdfbb7b69470f1152e022432ee2d45}{void}} multiswap\+\_\+init (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{audio__convert_8c_ae1affc9ca37cfb624959c866a73f83c2}{uint8\+\_\+t}}}]{keybuf\mbox{[}48\mbox{]},  }\item[{uint32\+\_\+t}]{keys\mbox{[}12\mbox{]} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



read keys from keybuf into keys 


\begin{DoxyParams}{Parameters}
{\em keybuf} & buffer containing the keys \\
\hline
{\em keys} & output key array containing the keys for encryption in native endianness \\
\hline
\end{DoxyParams}


Definition at line 54 of file asfcrypt.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{asfcrypt_8c_ab0acd87513a5670d0e07dfcfd6c3ff6a_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{asfcrypt_8c_a1fa111e3702e2d8611dc7c23d31623bf}\label{asfcrypt_8c_a1fa111e3702e2d8611dc7c23d31623bf}} 
\index{asfcrypt.c@{asfcrypt.c}!multiswap\_inv\_step@{multiswap\_inv\_step}}
\index{multiswap\_inv\_step@{multiswap\_inv\_step}!asfcrypt.c@{asfcrypt.c}}
\doxysubsubsection{\texorpdfstring{multiswap\_inv\_step()}{multiswap\_inv\_step()}}
{\footnotesize\ttfamily static uint32\+\_\+t multiswap\+\_\+inv\+\_\+step (\begin{DoxyParamCaption}\item[{const uint32\+\_\+t}]{keys\mbox{[}12\mbox{]},  }\item[{uint32\+\_\+t}]{v }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 87 of file asfcrypt.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{asfcrypt_8c_a1fa111e3702e2d8611dc7c23d31623bf_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{asfcrypt_8c_ac9da60dac1a40222e572af41552723e4}\label{asfcrypt_8c_ac9da60dac1a40222e572af41552723e4}} 
\index{asfcrypt.c@{asfcrypt.c}!multiswap\_invert\_keys@{multiswap\_invert\_keys}}
\index{multiswap\_invert\_keys@{multiswap\_invert\_keys}!asfcrypt.c@{asfcrypt.c}}
\doxysubsubsection{\texorpdfstring{multiswap\_invert\_keys()}{multiswap\_invert\_keys()}}
{\footnotesize\ttfamily static \mbox{\hyperlink{rematrix__template_8c_a4dfdfbb7b69470f1152e022432ee2d45}{void}} multiswap\+\_\+invert\+\_\+keys (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{keys\mbox{[}12\mbox{]} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



invert the keys so that encryption become decryption keys and the other way round. 


\begin{DoxyParams}{Parameters}
{\em keys} & key array of ints to invert \\
\hline
\end{DoxyParams}


Definition at line 66 of file asfcrypt.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=277pt]{asfcrypt_8c_ac9da60dac1a40222e572af41552723e4_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{asfcrypt_8c_ac9da60dac1a40222e572af41552723e4_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{asfcrypt_8c_a13fc610dfd829ef4fcb22063e1dfb37d}\label{asfcrypt_8c_a13fc610dfd829ef4fcb22063e1dfb37d}} 
\index{asfcrypt.c@{asfcrypt.c}!multiswap\_step@{multiswap\_step}}
\index{multiswap\_step@{multiswap\_step}!asfcrypt.c@{asfcrypt.c}}
\doxysubsubsection{\texorpdfstring{multiswap\_step()}{multiswap\_step()}}
{\footnotesize\ttfamily static uint32\+\_\+t multiswap\+\_\+step (\begin{DoxyParamCaption}\item[{const uint32\+\_\+t}]{keys\mbox{[}12\mbox{]},  }\item[{uint32\+\_\+t}]{v }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 75 of file asfcrypt.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{asfcrypt_8c_a13fc610dfd829ef4fcb22063e1dfb37d_icgraph}
\end{center}
\end{figure}
